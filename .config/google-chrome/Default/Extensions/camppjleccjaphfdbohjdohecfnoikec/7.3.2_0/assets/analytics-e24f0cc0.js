import{B as i,q as f,Q as y,L as p,x as E}from"./index-5ad58ea9.js";import{A as l}from"./constants-e5712b98.js";const D="https://www.google-analytics.com/mp/collect",O="https://www.google-analytics.com/debug/mp/collect",Q="G-JZS898GQ18",v="9Sv1BQIYSX2647_jkbulrA",g=100,N=30,_=async()=>{let{clientId:e}=await i.storage.local.get("clientId");return e||(e=self.crypto.randomUUID(),await i.storage.local.set({clientId:e})),e},d=async()=>{let{sessionData:e}=await i.storage.local.get("sessionData");const t=Date.now();return e&&e.timestamp&&((t-e.timestamp)/6e4>N?e=null:(e.timestamp=t,await i.storage.local.set({sessionData:e}))),e||(e={session_id:t.toString(),timestamp:t.toString()},await i.storage.local.set({sessionData:e})),e.session_id},S=async()=>{const e=await f.ensureQueryData(E.UserSession);return e!=null&&e.uid?e==null?void 0:e.uid:null};function A(e,t=500){const a=new Map;function o(n){return JSON.stringify(n.map(s=>typeof s=="object"?JSON.stringify(s):s))}return function(...n){const s=this,r=o(n),c=a.get(r);clearTimeout(c);const m=setTimeout(()=>{e.apply(s,n),a.delete(r)},t);a.set(r,m)}}const G=A(async e=>{const t=await f.fetchQuery(y);if(t&&!t.ga4Config.active)return;const a=await p.get("installedAt"),o=await S();a&&o&&(i.runtime.sendMessage({action:l.ANALYTICS,payload:{client_id:await _(),events:[{name:"FirstInteraction",params:{engagement_time_msec:g,session_id:await d(),timestamp:Date.now(),user_id:o}}]}}),await p.remove("installedAt")),e.session_id&&(e.session_id=await d()),e.engagement_time_msec&&(e.engagement_time_msec=g);const{engagement_time_msec:n,eventData:s,eventName:r,eventType:c,feature:m,firedFromFile:u,session_id:w}=e,I={engagement_time_msec:n,eventData:s,eventType:c,feature:m,firedFromFile:u,session_id:w};try{i.runtime.sendMessage({action:l.ANALYTICS,payload:{client_id:await _(),events:[{name:r,params:I}]}})}catch(T){console.error(T)}}),L=A(async e=>{const t=await f.fetchQuery(y);if(t&&!t.ga4Config.active)return;e.session_id&&(e.session_id=await d()),e.engagement_time_msec&&(e.engagement_time_msec=g);const{engagement_time_msec:a,page_location:o,page_title:n,session_id:s}=e,r={engagement_time_msec:a,page_location:o,page_title:n,session_id:s};try{i.runtime.sendMessage({action:l.ANALYTICS,payload:{client_id:await _(),events:[{name:"page_view",params:r}]}})}catch(c){console.error(c)}}),F=A(async e=>{const t=await f.fetchQuery(y);if(t&&!t.ga4Config.active)return;const a=await p.get("installedAt"),o=await S();a&&o&&(i.runtime.sendMessage({action:l.ANALYTICS,payload:{client_id:await _(),events:[{name:"FirstInteraction",params:{engagement_time_msec:g,session_id:await d(),timestamp:Date.now(),user_id:o}}]}}),await p.remove("installedAt")),e.session_id&&(e.session_id=await d()),e.engagement_time_msec&&(e.engagement_time_msec=g);const{engagement_time_msec:n,feature:s,firedFromFile:r,prompt_text:c,prompt_type:m,session_id:u}=e,w={engagement_time_msec:n,feature:s,firedFromFile:r,prompt_text:c,prompt_type:m,session_id:u};try{i.runtime.sendMessage({action:l.ANALYTICS,payload:{client_id:await _(),events:[{name:s+m+"Prompt",params:w}]}})}catch(I){console.error(I)}});export{v as A,g as D,O as G,Q as M,L as a,F as b,D as c,d,G as f,_ as g};
