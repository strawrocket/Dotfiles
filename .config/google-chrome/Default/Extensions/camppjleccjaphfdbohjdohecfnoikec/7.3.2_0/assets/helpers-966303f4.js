import{q as h,Q as N,d as b}from"./index-5ad58ea9.js";import{h as p}from"./cloudFunctions-51487c9d.js";import{L as g,m as y}from"./constants-e5712b98.js";import{f as v}from"./analytics-e24f0cc0.js";const w=14,C=100,m=2e3;var f=(e=>(e.NOT_FOUND="NOT_FOUND",e.UNKNOWN="UNKNOWN",e.FOUND="FOUND",e))(f||{}),U=(e=>(e.INITIATED="INITIATED",e.SUCCESS="SUCCESS",e.UNKNOWN="UNKNOWN",e))(U||{}),I=(e=>(e.DEFAULT="default",e.LOADING="loading",e.GLIMPSE="glimpse",e.SUMMARY="summary",e.SUCCESS="SUCCESS",e.TRANSCRIPT="transcript",e.ERROR="error",e))(I||{});function P(e){const t=e;document.getElementsByTagName("video")[0].currentTime=Number(t),v({eventName:"SeekVideo",eventType:"Button",feature:"YoutubeSummaryContainer",firedFromFile:"content-migrated/youtubeSummary/YoutubeSummaryContainer"})}function O(e){var t;if(e=decodeURI(e),typeof e=="string"){const n=(t=(e==null?void 0:e.split("?"))[1])==null?void 0:t.split("&"),r={};return n&&n.length&&n.map(a=>{const s=a==null?void 0:a.split("="),i=s[0],c=s[1];r[i]=c}),r}}const d=e=>{const t=[/^https?:\/\/youtu\.be\/(.*)$/,/^https?:\/\/www\.youtube\.com\/watch\?v=(.*)$/,/^https?:\/\/www\.youtube\.com\/embed\/(.*)$/,/^https?:\/\/www\.youtube\.com\/v\/(.*)$/,/^https?:\/\/www\.youtube\.com\/live\/([^?&]*)$/];let o=null;for(const n of t){const r=e.match(n);if(r){o=r[1];break}}if(!o){const n=O(e);o=n==null?void 0:n.v}if(!o)throw new Error(`Could not parse video ID from YouTube URL: ${e}`);return o=o==null?void 0:o.split("&")[0],o},Y=()=>{const e=d(document.URL),t=document.querySelector("div#title h1 yt-formatted-string"),o=document.querySelector("#above-the-fold #upload-info #channel-name #container #text-container #text a.yt-simple-endpoint"),n=t==null?void 0:t.innerText;return{channelName:o==null?void 0:o.innerText,videoId:e,videoTitle:n}},x=()=>{const e=document.getElementsByClassName("video-ads ytp-ad-module")[0];return!!(e&&e.hasChildNodes())},L=()=>{const e=window.location.href;return d(e)},T=async(e,t,o)=>{const n=await h.fetchQuery(N);let r=n.summarizer.youtube.costPerHour??w;t===f.NOT_FOUND&&(r=n.summarizer.whisper.costPerHour??C);let a=null,s=null;if(e){const[i,c=0,u=0]=e.split(":").reverse();a=Number(i)+Number(c)*60+Number(u)*3600}return a&&(s=Math.ceil(a/3600*r)),o&&(s*=m),s??null},E=async(e,t,o)=>{let n;if(e){const[r,a=0,s=0]=e.split(":").reverse();n=s<3?t+(o?1*m:1):s<6?t+(o?2*m:2):s<9?t+(o?3*m:3):t+(o?4*m:4)}return n},R=e=>{const t=Math.floor(Number(e)/3600),o=Math.floor(Number(e)%3600/60),n=Math.floor(Number(e)%3600%60);return`${t>0?`${t}:`:""}${o<10?`0${o}`:o}:${n<10?`0${n}`:n}`},F=()=>{var n;const e=(n=document.querySelector("span.ytp-time-duration"))==null?void 0:n.textContent;let t,o=3e3;if(e){const[r,a=0,s=0]=e.split(":").reverse();t=Number(r)+Number(a)*60+Number(s)*3600,t<1800?o=3e3:t<3600?o=8e3:o=12e3}return o},l=(e,t)=>{e.click();const o=document.getElementById("contenteditable-root");b(o,t)},A=(e,t)=>{const o=`Timestamps (Powered by Merlin AI)
`+e.map(r=>`${R(r.timeStamp)} - ${r.content}`).join(`
`),n=document.getElementById("comments");if(n){n.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"});const r=document.getElementById("placeholder-area");if(r){l(r,o);const s=d(document.URL);t&&s&&p(t,s);return}new MutationObserver((s,i)=>{for(const c of s)if(c.addedNodes){for(const u of c.addedNodes)if(u instanceof HTMLElement&&u.id==="placeholder-area"){l(u,o),i.disconnect();return}}}).observe(n,{childList:!0,subtree:!0})}},H=()=>document.documentElement.hasAttribute("dark")?"dark":"light";function Q(e,t){return`https://www.youtube.com/watch?v=${t}&t=${Math.floor(Number(e))}`}const S=e=>e?e.trim().replace(/["]/g,"").replace(/^Title:\s*/i,""):"";function V(e){var n;if(!e||e==="AUTO")return"en";const t=y[e];return t==="Chinese Si."?"zh":t==="China Tr."?"zh-TW":((n=Object.entries(g).find(([r,a])=>a.split(";")[0].split(",")[0].split("(")[0].trim()===t))==null?void 0:n[0])??"en"}export{f as C,I as U,U as a,T as b,E as c,Y as d,d as e,H as f,x as g,A as h,S as i,R as j,L as k,Q as l,V as m,F as n,P as s};
