import{j as e,r as d,c as v}from"./constants-e5712b98.js";import{c as P}from"./font-e4ec73e1.js";import{S as x}from"./merlin-logo-d3b9496d.js";import{am as i,an as I,ao as S,B as l}from"./index-5ad58ea9.js";import{u as k}from"./i18n-6c9556b7.js";import{P as E,u as B}from"./useMedia-c48a250e.js";(function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&a(u)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}})();const T=["https://.*.hdblog.it/.*"];function L(){const{t:s}=k(),[c,n]=d.useState(!1),[a,r]=d.useState(null),[o=null]=E({instance:new v({area:"local"}),key:"userThemePreference"}),u=B(["(prefers-color-scheme: dark)"],[!0],!1),p=o==="system"?u?"dark":"light":o,[y,w]=d.useState(!1),_=async()=>{a?await l.tabs.reload(a.id):await l.tabs.query({active:!0,currentWindow:!0}).then(t=>{l.tabs.reload(t[0].id)}),l.action.setPopup({popup:"",tabId:a.id}).then(()=>{n(!1),window.close()})};d.useEffect(()=>{p&&c&&(document.documentElement.className+=" "+p)},[p,c]),d.useEffect(()=>{(async()=>{try{const t=(await i.tabs.query({active:!0,currentWindow:!0}))[0];if(r(t),await I()){i.action.setPopup({popup:i.runtime.getURL("/popup.html"),tabId:t.id}).then(()=>{n(!0),w(!0)});return}if(t.url=="https://getmerlin.in/chat"){i.action.setPopup({popup:"",tabId:t.id}).then(()=>{n(!1),window.close()});return}if(t.url.includes("chrome://")||t.url.includes("edge://")||t.url.includes("extension://"))t.url.includes("shortcut")||i.tabs.create({url:"https://getmerlin.in/chat"}),i.action.setPopup({popup:"",tabId:t.id}).then(()=>{n(!1),window.close()});else{let b=0,m=!1;const N=4;for(;b<N&&!m;)await new Promise(h=>setTimeout(h,50)),b++,m=await i.tabs.sendMessage(t.id,{data:{from:"extPopupButton"}}).then(()=>!0).catch(h=>!1);if(m){i.action.setPopup({popup:"",tabId:t.id}).then(()=>{n(!1),window.close()});return}i.tabs.sendMessage(t.id,{data:{from:"extPopupButton"}}).then(()=>{i.action.setPopup({popup:"",tabId:t.id}).then(()=>{n(!1),window.close()})}).catch(h=>{n(!0)})}}catch{n(!0)}})()},[]);function j(){return c?y?e.jsxs("div",{className:"bg-background flex h-64 w-96 flex-col justify-center gap-2 px-3 py-2 text-zinc-100",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(x,{className:"h-8 w-8"}),e.jsx("div",{className:"text-lg font-medium",children:s("popup_index.shortcut_conflict")})]}),e.jsxs("div",{className:"text-zinc-400",children:[e.jsxs("div",{children:[s("popup_index.message")," ",e.jsx("kbd",{className:"rounded-lg border border-gray-500 bg-gray-600 px-1 py-0.5 text-xs font-semibold text-gray-100",children:s("popup_index.ctrl_m")})," ",s("popup_index.here_what_to_do")]}),e.jsxs("ul",{className:"my-2 list-inside list-disc",children:[e.jsx("li",{children:s("popup_index.goto_shortcut")}),e.jsx("li",{children:s("popup_index.switch_custom")})]}),s("popup_index.this_ensures")," ",e.jsx("kbd",{className:"rounded-lg border border-gray-500 bg-gray-600 px-1 py-0.5 text-xs font-semibold text-gray-100",children:s("popup_index.ctrl_m")})," ",s("popup_index.wont_summon")]}),e.jsx("button",{type:"button",onClick:()=>{const t=S(),f=t==="firefox"?"about:addons":t==="edge"?"edge://extensions/shortcuts":"chrome://extensions/shortcuts";l.tabs.create({active:!0,url:f})},className:"border-cornblue-500 bg-cornblue-600 hover:bg-cornblue-500 cursor-pointer gap-2 rounded-md border px-4 py-1.5 text-base text-zinc-50 transition-all duration-500 [border-style:solid] dark:text-zinc-900",children:s("popup_index.open_shortcut")})]}):T.some(t=>new RegExp(t).test(a.url))?e.jsxs("div",{className:"bg-background text-primary flex h-40 w-80 flex-col justify-center gap-2 px-3 py-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(x,{className:"h-8 w-8"}),e.jsx("div",{className:"text-lg font-medium",children:s("popup_index.not_supported")})]}),e.jsx("div",{className:"text-muted-foreground",children:s("popup_index.go_to_magic")}),e.jsx("button",{type:"button",onClick:()=>{l.tabs.create({url:"https://getmerlin.in/chat"})},className:"border-cornblue-500 bg-cornblue-600 hover:bg-cornblue-500 text-primary cursor-pointer gap-2 rounded-md border px-4 py-1.5 text-base transition-all duration-500 [border-style:solid]",children:s("popup_index.open_magic")})]}):e.jsxs("div",{className:"bg-background text-primary flex h-40 w-80 flex-col justify-center gap-2 px-3 py-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(x,{className:"h-8 w-8"}),e.jsx("div",{className:"text-lg font-medium",children:s("popup_index.merlin_refresh")})]}),e.jsx("div",{className:"text-muted-foreground",children:s("popup_index.plz_refresh")}),e.jsx("button",{type:"button",onClick:_,className:"border-cornblue-500 bg-cornblue-600 hover:bg-cornblue-500 text-primary cursor-pointer gap-2 rounded-md border px-4 py-1.5 text-base transition-all duration-500 [border-style:solid]",children:s("popup_index.refresh")})]}):null}return e.jsx("div",{className:"bg-background h-full w-full",children:j()})}const g=document.getElementById("root");g&&P(g).render(e.jsx(L,{}));
