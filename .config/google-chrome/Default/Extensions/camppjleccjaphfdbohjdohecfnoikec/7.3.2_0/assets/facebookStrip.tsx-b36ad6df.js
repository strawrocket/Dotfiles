import{r as v,P as N,F as we,j as t,a as ke,S as c,D as le}from"./constants-e5712b98.js";import{c as ce}from"./font-e4ec73e1.js";import{u as xe}from"./button-e2ac6183.js";import{b as Oe,q as Ae,Q as je,i as ue}from"./index-5ad58ea9.js";import{b as Ce,u as Be,C as de,R as fe,a as pe}from"./index-f00bab01.js";import{u as Ne,a as Pe,C as ze,S as Fe,b as Me,G as Te,D as Le,E as Re,c as Ie,F as Ke}from"./index-f0d39e78.js";import{c as C}from"./index-f8d4d59a.js";import{g as _e}from"./cloudFunctions-51487c9d.js";import{T as Ue}from"./index-d6d87676.js";import{u as We}from"./i18n-6c9556b7.js";import{v as De}from"./v4-4a60fe23.js";import{A as W}from"./index-c40a070c.js";import{m as B}from"./motion-ec7ce7e0.js";import{I as Ge,a as Ve}from"./fuzzysort-48427cba.js";import{I as Qe}from"./IconReload-9b2d2e3d.js";import{I as He,a as $e}from"./IconSend-07f8814c.js";import{I as Je}from"./IconChevronRight-89acbc25.js";import{T as me}from"./themeContext-b5ecfc73.js";import{c as ye}from"./index-0c67d257.js";import"./index-39819034.js";import"./backend-f1dada26.js";import"./createLucideIcon-b09954cb.js";import"./analytics-e24f0cc0.js";import"./useMedia-c48a250e.js";import"./useSSE-d3d13984.js";import"./languageLogoMap-b1afba5a.js";import"./index-52d9b6b3.js";import"./foyerLogo-8a2dc06a.js";import"./useOnClickOutside-cc638742.js";import"./createReactComponent-85aa5d18.js";import"./IconX-5b78e9ec.js";import"./IconCheck-f452d2aa.js";import"./IconLanguage-a0ed4545.js";import"./IconSettings-58104ccf.js";import"./cache-2436a988.js";const _={NONE:"",SAVE_PROMPT:"Edit your prompt",SAVED_PROMPTS:"Saved Prompts"};function Xe(u){const{t:o}=We(),{editor:y,promptsFor:l}=u,{...r}=v.useContext(Ce),[d,f]=v.useState(!1),E=v.useRef(null),s=v.useRef(null);v.useEffect(()=>{const n=De(),x=document.querySelector('div[role="main"].x9f619.x1n2onr6.x1ja2u2z.x78zum5.x1iyjqo2.xs83m0k.xeuugli.xl56j7k.x1qjc9v5.xozqiw3.x1q0g3np.x1iplk16.x1xfsgkm.xqmdsaz.x1mtsufr.x1w9j1nh .x9f619.x1n2onr6.x1ja2u2z.x78zum5.xdt5ytf.x2lah0s.x193iq5w.xeuugli');x&&x.setAttribute("data-message-id",n),E.current=n},[y]);const{[E.current]:e}=Ne(E.current,"facebook"),[a,h]=v.useState(!1),[i,Q]=v.useState(null),[R,K]=v.useState(null),[p,b]=v.useState("none"),[w,q]=v.useState(!1),[O,k]=v.useState(""),[S,P]=v.useState(""),[z,F]=v.useState(0),[m,A]=v.useState("left"),{model:M}=Pe("facebook");function L(n){Object.values(_).includes(n)?b(n):(console.error("Invalid window name passed to changeActiveWindow"),b(_.NONE))}function I(n,x=!0){x&&h(!0),P(n),k(n),b(_.NONE)}function be(){if(s.current){const n=s.current.scrollLeft===0,x=Math.ceil(s.current.scrollLeft)>=s.current.scrollWidth-s.current.clientWidth;n&&A("left"),x&&A("right"),n&&x&&A("both"),!x&&!n&&A("none")}}function H(n){const x=s.current,j=x.offsetWidth,D={left:-j+60,right:j-60};x.scrollBy(D[n],0),setTimeout(()=>{be()},350)}async function U(n){let x=null;try{x=y.parentNode.querySelector("div[role='button']")}catch{}x&&x.click(),await new Promise(j=>setTimeout(j,800)),await e.setSharedState({model:M,prompt:n!=""?n:O,status:"loading"}),n!=""&&k(n),h(!1)}const Se=Be();v.useEffect(()=>{r.isAuthenticated&&!r.isLoading&&(async()=>{try{let n=await _e(),x;Object.keys(n).includes(l)?(x=[...n[l]],n=n[l]):(x=[...n[N.FALLBACK]],n=n[N.FALLBACK]),Q(x);const j=await Se.fetchQuery(Oe);j&&j!=null&&j.userMade&&j.userMade.forEach(D=>{const{id:ve,promptName:Ee,promptTag:$,promptText:qe}=D,J={content:qe,id:ve,name:Ee};$&&$===l?n.unshift(J):n.push(J)}),K(n)}catch{K(we)}})()},[r.isLoading,r.isAuthenticated,z]),v.useEffect(()=>{if(s.current){const n=s.current.offsetWidth;s.current.scrollWidth>n?q(!0):q(!1)}},[s.current,R]);function ge(){return e.state==="error"?t.jsxs("span",{className:C({"flex items-stretch justify-end gap-2 py-1":!0}),children:[t.jsx(B.span,{initial:{opacity:0,y:-10},animate:{opacity:1,transition:{delay:0*.1+.3,duration:.3},y:0},children:t.jsxs("button",{type:"button",className:"center-with-flex relative cursor-default gap-1 overflow-hidden whitespace-nowrap rounded-full border-2 border-rose-500 bg-rose-100 px-2 py-1 text-sm text-rose-500 dark:border-rose-600 dark:bg-rose-900 dark:text-rose-100",children:[t.jsx(Ge,{size:20,strokeWidth:1.5}),o("external_mount.something_wrong")]})}),t.jsx(B.span,{initial:{opacity:0,y:-10},animate:{opacity:1,transition:{delay:1*.1+.3,duration:.3},y:0},children:t.jsxs("button",{type:"button",className:"center-with-flex dark:bg-background relative gap-1 overflow-hidden whitespace-nowrap rounded-full border-2 border-violet-400 bg-violet-100 px-2 py-1 text-sm text-zinc-800 transition-colors duration-300 ease-in-out hover:bg-violet-400 dark:border-violet-700 dark:text-zinc-100 dark:hover:bg-violet-700",onClick:()=>U(""),children:[t.jsx(Qe,{size:20,strokeWidth:1.5}),o("external_mount.retry")]})})]},"error"):R?a?t.jsxs(B.div,{className:"center-with-flex min-h-[33px] w-full gap-2",initial:{opacity:0,y:-10},animate:{opacity:1,transition:{delay:.4,duration:.3},y:0},children:[t.jsx(B.button,{initial:{opacity:0,y:-10},animate:{opacity:1,transition:{delay:.6,duration:.3},y:0},className:"appearance-none",onClick:()=>{h(!1),I("",!1)},children:t.jsx(Ve,{className:"h-5 w-5 text-zinc-600 dark:text-zinc-300"})}),t.jsx(Re,{value:S,setValue:I,host:"facebook",setActiveWindow:b,handleCustomPrompt:U}),t.jsx("div",{className:"flex items-center gap-2",children:t.jsx(B.button,{initial:{opacity:0,y:-10},animate:{opacity:1,transition:{delay:.5,duration:.3},y:0},className:"appearance-none",onClick:()=>{U(S)},children:t.jsx(He,{className:"h-5 w-5 text-zinc-600 dark:text-zinc-300"})})})]}):t.jsxs(t.Fragment,{children:[t.jsx(W,{children:t.jsx(B.button,{initial:{opacity:0,y:-10},animate:{opacity:1,transition:{delay:0*.1+.3,duration:.3},y:0},exit:{opacity:0,y:-10},onClick:()=>H("left"),disabled:m==="left"||m==="both",className:C("center-with-flex",m==="left"||m==="both"?"text-gray-500 focus-visible:outline-none":"text-cornblue-500 focus-visible:outline-cornblue-400 dark:text-cornblue-200 dark:focus-visible:text-cornblue-300 dark:focus-visible:outline-cornblue-500 rounded-full outline-none transition-[colors,outline] duration-300 ease-in-out focus-visible:outline-2 focus-visible:outline-offset-0"),id:"leftBtn",children:t.jsx($e,{size:20,className:C("rounded-full transition-colors duration-200 ease-in-out",m==="left"||m==="both"?"":"hover:bg-cornblue-100 dark:hover:bg-cornblue-300/50 bg-transparent")})})}),t.jsx("span",{ref:s,className:C({"merlinExt-custom-scrollbar scrollbar-h-1 flex snap-x scroll-px-0.5 items-stretch justify-between gap-2 overflow-x-auto scroll-smooth px-0.5 py-1":!0,"pr-1":!w}),children:R.map((n,x)=>t.jsx(B.span,{initial:{opacity:0,y:-10},animate:{opacity:1,transition:{delay:x*.1+.4,duration:.3},y:0},children:t.jsx(Ie,{id:x,prompt:n.content,promptsFor:l,handleStripBtn:U,setTextareaValue:P,setCustomPromptActive:h,children:n.name})},x))}),t.jsx(W,{children:w&&t.jsx(B.button,{initial:{opacity:0,y:-10},animate:{opacity:1,transition:{delay:4*.1+.3,duration:.3},y:0},exit:{opacity:0,y:-10},onClick:()=>H("right"),disabled:m==="right"||m==="both",className:C("center-with-flex",m==="right"||m==="both"?"text-gray-500 focus-visible:outline-none":"text-cornblue-500 focus-visible:outline-cornblue-400 dark:text-cornblue-200 dark:focus-visible:text-cornblue-300 dark:focus-visible:outline-cornblue-500 rounded-full outline-none transition-[colors,outline] duration-300 ease-in-out focus-visible:outline-2 focus-visible:outline-offset-0"),id:"rightBtn",children:t.jsx(Je,{size:20,className:C("rounded-full transition-colors duration-200 ease-in-out",m==="right"||m==="both"?"":"hover:bg-cornblue-100 dark:hover:bg-cornblue-300/50 bg-transparent")})})}),t.jsxs("div",{className:"center-with-flex",children:[t.jsx(B.button,{initial:{opacity:0,y:-10},animate:{opacity:1,transition:{delay:5*.1+.3,duration:.3},y:0},exit:{opacity:0},className:C("center-with-flex border-cornblue-500 text-cornblue-500 hover:border-cornblue-600 hover:bg-cornblue-100 focus-visible:ring-cornblue-400 active:border-cornblue-700 disabled:border-cornblue-200 dark:border-cornblue-400 dark:text-cornblue-200 dark:hover:bg-cornblue-300/50 dark:focus-visible:text-cornblue-300 dark:focus-visible:ring-cornblue-500 dark:active:bg-cornblue-300/30 dark:disabled:border-cornblue-800 gap-1 rounded-full border px-2 py-1 text-sm font-semibold ring-0 transition-[colors,box-shadow] duration-300 focus-visible:outline-none focus-visible:ring"),onMouseEnter:()=>{f(!0)},onMouseLeave:()=>{f(!1)},onMouseDownCapture:()=>{h(!0),f(!1)},children:o("external_mount.create")}),t.jsx(W,{children:d&&t.jsx(Ue,{text:o("external_mount.create_prompt"),className:C("absolute bottom-[110%] z-[99999] text-xs font-medium")})})]})]}):t.jsx("span",{className:C({"flex items-stretch justify-end gap-2 py-1":!0}),children:t.jsx(B.span,{initial:{opacity:0,y:-10},animate:{opacity:1,transition:{delay:.3,duration:.3},y:0},children:t.jsxs("span",{children:[o("external_mount.loading"),"..."]})})})}return t.jsx(ze,{children:t.jsx(W,{children:t.jsxs(B.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:C("center-with-flex merlin-fab-strip flex gap-1 px-1"),children:[!r.isLoading&&r.isAuthenticated&&t.jsxs("div",{className:"flex flex-1 items-stretch justify-end gap-1 overflow-hidden",children:[ge(),p===_.SAVE_PROMPT&&t.jsx("div",{className:"dark:bg-background fixed left-2/4 top-2/4 z-[2147483647] flex h-[40vh] min-h-[420px] w-[30vw] max-w-[360px] -translate-x-2/4 -translate-y-2/4 flex-col items-stretch rounded-lg border border-zinc-200 bg-zinc-50 dark:border-zinc-800",children:t.jsx(Fe,{userPrompt:O||S,changeActiveWindow:L,host:"facebook",from:"FAB_STRIP",setUserPromptsUpdated:F,promptsFor:l})}),p===_.SAVED_PROMPTS&&t.jsx("div",{className:"dark:bg-background fixed left-2/4 top-2/4 z-[2147483647] flex h-[40vh] min-h-[420px] w-[30vw] max-w-[360px] -translate-x-2/4 -translate-y-2/4 flex-col items-stretch rounded-lg border border-zinc-200 bg-zinc-50 dark:border-zinc-800",children:t.jsx(Me,{changeActiveWindow:L,updateUserPrompt:I,host:"facebook",from:"FAB_STRIP",merlinPrompts:i,setUserPromptsUpdated:F,promptsFor:l})})]}),!r.isLoading&&!r.isAuthenticated&&t.jsx(B.span,{className:C({"ml-auto py-1":!0}),initial:{opacity:0},animate:{opacity:1,transition:{duration:.3}},children:t.jsx("button",{type:"button",className:"center-with-flex dark:bg-background relative gap-1 overflow-hidden whitespace-nowrap rounded-full border-2 border-violet-400 bg-violet-100 px-2 py-1 text-sm text-zinc-800 transition-colors duration-300 ease-in-out hover:bg-violet-400 dark:border-violet-700 dark:text-zinc-100 dark:hover:bg-violet-700",onClick:()=>window.open(ke,"_blank"),children:o("external_mount.login")})}),t.jsxs("div",{className:C({"flex items-stretch justify-between gap-1":!0}),children:[t.jsx(Te,{position:u.dotMenuPosition,promptsFor:l,isTwitterModal:!1,setActiveWindow:b,host:"facebook",value:M}),t.jsx(Le,{position:u.dotMenuPosition,promptsFor:l,isTwitterModal:!1,mountOn:c.FACEBOOK.PERSONAL.POST,setActiveWindow:b,host:"facebook"})]})]})})})}function Ye(u){var s,e;const{contextData:o,editor:y,mountOn:l,promptsFor:r}=u,[d,f]=v.useState(""),E=xe();if(!window.location.href.includes("facebook.com/messages"))return(e=(s=E.details)==null?void 0:s.facebook)!=null&&e.isEnabled?t.jsx(de,{children:t.jsx(fe,{children:t.jsx(pe,{children:t.jsx(me,{websiteOverride:!0,children:t.jsx(Ke,{editor:y,host:"facebook",contextData:o,promptsFor:r,dotMenuPosition:"bottom",mountOn:l,textareaValue:d,setTextareaValue:f})})})})}):null}function Ze(u){var d,f;const{dotMenuPosition:o,editor:y,promptsFor:l}=u;return(f=(d=xe().details)==null?void 0:d.facebook)!=null&&f.isEnabled?t.jsx(de,{children:t.jsx(fe,{children:t.jsx(pe,{children:t.jsx(me,{websiteOverride:!0,children:t.jsx(Xe,{promptsFor:l,dotMenuPosition:o,editor:y})})})})}):null}const he={createAPostElement:".x1l90r2v.xyamay9.x1n2onr6",createAdFBBusinessType1:"div.x9f619.x1n2onr6.x1ja2u2z.xjbqb8w.x1qpq9i9.xdney7k.xu5ydu1.xt3gfkd.xh8yej3.x6ikm8r.x10wlt62.xquyuld",createCommentType1:".x1n2onr6.x1ja2u2z.x9f619.x78zum5.xdt5ytf.x2lah0s.x193iq5w.x1xmf6yo.x1e56ztr",createCommentType2:".x2lah0s.x96k8nx.x4uap5.xdvlbce.xkhd6sd",createCommentTypeEmojiTray:".x10b6aqq.x4b6v7d.x1ojsi0c.x1u6ievf.x67ttcy",createPostFBBusinessType1:".x1iyjqo2.xs83m0k.xdl72j9.x3igimt.xedcshv.x1t2pt76.x1l90r2v.x1swvt13.x1pi30zi.xexx8yu",createPostFBExtMount1:'div[aria-label="Create a post"].x6s0dn4.x78zum5.x1a02dak.x1a8lsjc.x1pi30zi.x1swvt13.xz9dl7a',createPostFBExtMount2:"div.x9f619.x1n2onr6.x1ja2u2z.x2bj2ny.x1qpq9i9.xdney7k.xu5ydu1.xt3gfkd.xh8yej3.x6ikm8r.x10wlt62.xquyuld",createPostFBExtMount3:"div.x1qjc9v5.x78zum5.xdt5ytf.x1a8lsjc.x1pi30zi.x1swvt13.xz9dl7a",createPostFBType1:"form .x9f619.x5yr21d.x1n2onr6.xh8yej3 .x1l90r2v.xyamay9.x1n2onr6",createReelFBBusinessType1:".x78zum5.xdt5ytf.x5yr21d.xedcshv.x1t2pt76.xh8yej3",sendMessageBusinessType1:"div.xeuugli.x2lwn1j.x78zum5.xdt5ytf.x12peec7.x1iorvi4.x150jy0e.xjkvuk6.x1e558r4.x14vqqas.xq8finb.xod5an3.x16n37ib.x1laasgj.x9vhear.xhsx6p2.xtll85i.x1lq5wgf.xgqcy7u.x30kzoy.x9jhf4c",sendMessageType1:'div.x5yr21d.x1uvtmcs[role="none"][tabindex="-1"]',sendMessageType2:".xuk3077.x78zum5.x6prxxf.xz9dl7a.xsag5q8"},{createAdFBBusinessType1:X,createCommentType1:Y,createCommentType2:Z,createCommentTypeEmojiTray:ee,createPostFBBusinessType1:te,createPostFBExtMount1:re,createPostFBExtMount2:oe,createPostFBExtMount3:ne,createPostFBType1:ie,createReelFBBusinessType1:se,sendMessageBusinessType1:G,sendMessageType1:ae}=he;let g;function et(){return new Promise(u=>{const o=new MutationObserver(ue(()=>{const y=Object.values(he).join(", "),l=document.querySelector(y);l&&(u(l),o.disconnect())},50));o.observe(document.body,{childList:!0,subtree:!0})})}function tt(u,o){var l;const y={postContent:null,user:o||null};try{let r="";const d=(l=u.parentElement.parentElement)==null?void 0:l.querySelector(".xh8yej3.x5yr21d.x18d9i69");d&&(r=d==null?void 0:d.querySelector('div[data-ad-preview="message"]').textContent,r&&(r=r.replaceAll(`
`," "),y.postContent=r))}catch{}return y}const T=async(u,o,y,l)=>{var R,K;const r=document.createElement("merlin-component");r.className="merlin fab-writer";const d=r.attachShadow({mode:"open"}),f=document.createElement("style");f.textContent=`${ye}
    :host(.merlin.fab-writer) {
      all: initial; /* 1st rule so subsequent properties are reset. */
      width: 100%;
      display: block;
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      z-index: 1000;
    }

    .fabStrip {
      all: initial; /* 1st rule so subsequent properties are reset. */
      position: relative;
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    .fabStrip ::-webkit-scrollbar {
      display: none;
      -ms-overflow-style: none;
      scrollbar-width: none;
    }
    `;const E=document.createElement("div");E.id="reactAppRoot",E.className="reactAppRoot fabStrip",le.forEach(p=>{E.addEventListener(p,b=>{b.stopPropagation()})}),d.appendChild(f),d.appendChild(E),(o===c.FACEBOOK.PERSONAL.POST||o===c.FACEBOOK.BUSINESS.MESSAGE||o===c.FACEBOOK.BUSINESS.REEL)&&(r.style.paddingBottom="10px"),(o===c.FACEBOOK.PERSONAL.COMMENT||o===c.FACEBOOK.PERSONAL.POST)&&(r.style.paddingTop="10px"),y==="pre"&&u.prepend(r),y==="push"&&u.appendChild(r),y==="before"&&u.insertBefore(r,l);let s={userName:null},e=N.FALLBACK;const a=o;let h=null,i;if(o===c.FACEBOOK.PERSONAL.POST&&(i=r.parentElement.parentElement,s=tt(r,h)),o===c.FACEBOOK.PERSONAL.MESSAGE){i=r.parentElement.parentElement;const p=((R=i.querySelectorAll('div.__fb-dark-mode.x1n2onr6[role="row"]'))==null?void 0:R.length)>0?i.querySelectorAll('div.__fb-dark-mode.x1n2onr6[role="row"]'):i.querySelectorAll('div.__fb-light-mode.x1n2onr6[role="row"]'),b=[];i&&p.length>0&&p.forEach((w,q)=>{var z,F,m,A,M,L,I;let O,k,S;(z=w.children[0])!=null&&z.querySelector("img.x1rg5ohu.x5yr21d.xl1xv1r.xh8yej3")?(S="receiver",O=(m=(F=w.children[0])==null?void 0:F.querySelector("img.x1rg5ohu.x5yr21d.xl1xv1r.xh8yej3"))==null?void 0:m.getAttribute("alt"),k=(M=(A=w.children[0])==null?void 0:A.querySelector('div.x6prxxf.x1fc57z9.x1yc453h.x126k92a.xzsf02u[dir="auto"][role="none"]'))==null?void 0:M.textContent):(O=h||"user",S="sender",k=(I=(L=w.children[0])==null?void 0:L.querySelector('div.x6prxxf.x1fc57z9.x1yc453h.x126k92a.x14ctfv[dir="auto"][role="none"]'))==null?void 0:I.textContent);const P={content:k,index:q,name:O,participantType:S};b.push(P)}),s={messages:b,userName:h}}if(o===c.FACEBOOK.PERSONAL.COMMENT){s={article:null,postContent:null,userName:h};const p='div.x1i10hfl.xjbqb8w.x6umtig.x1b1mbwd.xaqea5y.xav7gou.x9f619.x1ypdohk.xt0psk2.xe8uvvx.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x16tdsg8.x1hl2dhg.xggy1nq.x1a2a7pz.xt0b8zv.xzsf02u.x1s688f[role="button"]',b="div.x1iorvi4.x1pi30zi.x1l90r2v.x1swvt13",w="div.x9f619.x1n2onr6.x1ja2u2z.x193iq5w.xeuugli.x1r8uery.x1iyjqo2.xs83m0k.xsyo7zv.x16hj40l",q=".x193iq5w.xeuugli.x13faqbe.x1vvkbs.x1xmvt09.x1nxh6w3.x1sibtaa.x1s688f.xi81zsa",O='a.x1i10hfl.xjbqb8w.x6umtig.x1b1mbwd.xaqea5y.xav7gou.x9f619.x1ypdohk.xt0psk2.xe8uvvx.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x16tdsg8.x1hl2dhg.xggy1nq.x1a2a7pz.xt0b8zv.xzsf02u.x1s688f[role="link"] strong';try{i=r.closest(".x9f619.x1n2onr6.x1ja2u2z.x2bj2ny.x1qpq9i9.xdney7k.xu5ydu1.xt3gfkd.xh8yej3.x6ikm8r.x10wlt62.xquyuld"),i||(i=r.closest("div.x1qjc9v5.x78zum5.xdt5ytf.x1n2onr6.x1al4vs7.x1jx94hy.x1qpq9i9.xdney7k.xu5ydu1.xt3gfkd.x104qc98.x1gj8qfm.x1iyjqo2.x6ikm8r.x10wlt62.x1likypf.x7b354b.x1e9k66k.x12l8kdc")),i||(i=r.closest(".x1lliihq")),i||(i=r.closest('[role="dialog"]')),i.querySelector(p)&&i.querySelector(p).click(),setTimeout(()=>{var P,z;let k="";if(i.querySelector(w)){const F=i.querySelector(w).closest(".x6ikm8r.x10wlt62");let m,A;if(F){const{height:M,width:L}=window.getComputedStyle(F);A=M,m=L}(!F||parseInt(m)>0&&parseInt(A)>0)&&(k=i.querySelector(w).textContent)}s.article=k;let S="";i.querySelector(b)&&(S=i.querySelector(b).textContent),S||(S=(P=i.querySelector('[data-ad-preview="message"]'))==null?void 0:P.textContent),S||(S=(z=i.querySelector("blockquote span div"))==null?void 0:z.textContent),s.postContent=S,i.querySelector(q)&&(s.author=i.querySelector(q).textContent),i.querySelector(O)&&(s.author=i.querySelector(O).textContent)},200)}catch{}}if((o===c.FACEBOOK.BUSINESS.POST||o===c.FACEBOOK.BUSINESS.REEL)&&(document.querySelector(".x193iq5w.xeuugli.x13faqbe.x1vvkbs.x1xmvt09.x1lliihq.x1s928wv.xhkezso.x1gmr53x.x1cpjm7i.x1fgarty.x1943h6x.xudqn12.x3x7a5m.x6prxxf.xvq8zen.x1s688f.xzsf02u")&&(h=(K=document.querySelector(".x193iq5w.xeuugli.x13faqbe.x1vvkbs.x1xmvt09.x1lliihq.x1s928wv.xhkezso.x1gmr53x.x1cpjm7i.x1fgarty.x1943h6x.xudqn12.x3x7a5m.x6prxxf.xvq8zen.x1s688f.xzsf02u"))==null?void 0:K.textContent),s.userName=h),o===c.FACEBOOK.BUSINESS.AD){const p='div.x10l6tqk.x6ikm8r.x10wlt62.x13vifvy.x17qophe.xh8yej3.x5yr21d.x1o1ewxj.x3x9cwd.x1e5q0jg.x13rtm0m.xosibs0.xt24udd.xw53kvy.x1dka6rp.x47corl.x10cdfl8[role="img"]';document.querySelector(p)&&(s.userName=document.querySelector(p).getAttribute("aria-label"))}if(o===c.FACEBOOK.BUSINESS.MESSAGE){let p;r.closest("div.xeuugli.x2lwn1j.x78zum5.x1r8uery.xdt5ytf.x1ikap7u")&&(i=r.closest("div.xeuugli.x2lwn1j.x78zum5.x1r8uery.xdt5ytf.x1ikap7u"),p=i.querySelectorAll(".x1fqp7bg"));const b=[];p.length>0&&p.forEach((q,O)=>{var A;let k;const S=[];let P;const z="img.x6umtig.x1b1mbwd.xaqea5y.xav7gou.x14yjl9h.xudhj91.x18nykt9.xww2gxu.x1ypdohk.x1lliihq";Array.from(q.children).forEach(M=>{M.textContent!==""&&S.push(M.textContent)}),q!=null&&q.querySelector(z)?(P="receiver",k=(A=q.querySelector(z))==null?void 0:A.getAttribute("alt")):(k=h||"user",P="sender");const m={content:S,index:O,name:k,participantType:P};b.push(m)});const w='div.x5yr21d[data-pagelet="LeftNav"]';document.querySelector(w)&&(s.userName=document.querySelector('div.x5yr21d[data-pagelet="LeftNav"]').querySelector("img").getAttribute("alt")),s.messages=b}switch(Object.values(c.FACEBOOK.BUSINESS).includes(o)||document.querySelectorAll("script").forEach(p=>{if(p.textContent.includes('"NAME"')){const b=p.textContent,w=/"NAME":"([^"]+)"/,q=b.match(w),O=q?q[1]:null;s.userName=O}}),o){case c.FACEBOOK.PERSONAL.POST:e=N.FACEBOOK_POST;break;case c.FACEBOOK.PERSONAL.MESSAGE:e=N.FACEBOOK_MESSAGE;break;case c.FACEBOOK.PERSONAL.COMMENT:e=N.FACEBOOK_COMMENT;break;case c.FACEBOOK.BUSINESS.POST:e=N.FACEBOOK_BUSINESS_POST;break;case c.FACEBOOK.BUSINESS.REEL:e=N.FACEBOOK_BUSINESS_REEL_CAPTION;break;case c.FACEBOOK.BUSINESS.AD:e=N.FACEBOOK_BUSINESS_AD;break;case c.FACEBOOK.BUSINESS.MESSAGE:e=N.FACEBOOK_BUSINESS_MESSAGES;break;default:e=N.FALLBACK;break}ce(E).render(t.jsx(Ye,{editor:r,contextData:s,promptsFor:e,mountOn:a}))},V=async(u,o,y)=>{const l=document.createElement("merlin-component");l.className="merlin fab-writer merlin-external";const r=l.attachShadow({mode:"open"}),d=document.createElement("style");d.textContent=`${ye}
    :host(.merlin.fab-writer) {
      all: initial; /* 1st rule so subsequent properties are reset. */
      width: 100%;
      display: block;
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      z-index: 1000;
    }
    .fabStrip {
      all: initial; /* 1st rule so subsequent properties are reset. */
      position: relative;
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    .fabStrip ::-webkit-scrollbar {
      display: none;
      -ms-overflow-style: none;
      scrollbar-width: none;
    }
    `;const f=document.createElement("div");f.id="reactAppRoot",f.className="reactAppRoot fabStrip",le.forEach(e=>{f.addEventListener(e,a=>{a.stopPropagation()})}),r.appendChild(d),r.appendChild(f),l.style.paddingTop="10px",o==="before"&&u.insertBefore(l,y);const E=N.FACEBOOK_POST;ce(f).render(t.jsx(Ze,{promptsFor:E,dotMenuPosition:"bottom",editor:l}))},rt=async()=>{var l,r;const u=await Ae.fetchQuery(je);if(u&&!((r=(l=u.fabStrip)==null?void 0:l.facebook)!=null&&r.visible))return;await et();const o=new MutationObserver(ue(()=>{var d,f,E,s;try{document.querySelectorAll(se).length>0&&(g=document.querySelectorAll(se),g.forEach(e=>{var a;(a=e.querySelector("span"))!=null&&a.textContent.toLowerCase().includes("reel details")&&(e.querySelector(".merlin.fab-writer")||T(e,c.FACEBOOK.BUSINESS.REEL,"push"))}))}catch{}try{document.querySelectorAll(te).length>0&&(g=document.querySelectorAll(te),g.forEach(e=>{e.querySelector(".xeuugli.x2lwn1j.x78zum5.x1xmf6yo")&&(e.querySelector(".merlin.fab-writer")||T(e,c.FACEBOOK.BUSINESS.POST,"before",e.querySelector(".xeuugli.x2lwn1j.x78zum5.x1xmf6yo")))}))}catch{}try{if(document.querySelector(X)){const e=document.querySelector(X);if(e.querySelector('textarea[aria-busy="false"][aria-disabled="false"][aria-invalid="true"]')&&!e.querySelector(".merlin.fab-writer")){const a=(d=e.querySelector('textarea[aria-busy="false"][aria-disabled="false"][aria-invalid="true"]'))==null?void 0:d.closest(".x9f619.x1n2onr6.x1ja2u2z.x78zum5.x2lah0s.x1qughib.x1qjc9v5.xozqiw3.x1q0g3np.x1pi30zi.x1swvt13.xyamay9.xykv574.xbmpl8g.x4cne27.xifccgj"),i=Array.from((f=a==null?void 0:a.parentElement)==null?void 0:f.children).indexOf(a)+1;T(a.parentElement,c.FACEBOOK.BUSINESS.AD,"before",a.parentElement.children[i])}}}catch{}try{document.querySelector(G)&&(document.querySelector(G).parentElement.querySelector(".merlin.fab-writer")||T(document.querySelector(G).parentElement,c.FACEBOOK.BUSINESS.MESSAGE,"push"))}catch{}try{document.querySelectorAll(Y).length>0&&(g=document.querySelectorAll(Y),g.forEach(e=>{e.querySelector(ee)?e.querySelector(".merlin.fab-writer")||T(e,c.FACEBOOK.PERSONAL.COMMENT,"push"):e.querySelector(".merlin.fab-writer")&&e.removeChild(e.lastElementChild)})),document.querySelectorAll(Z).length>0&&(g=document.querySelectorAll(Z),g.forEach(e=>{e.querySelector(ee)?e.querySelector(".merlin.fab-writer")||T(e,c.FACEBOOK.PERSONAL.COMMENT,"push"):e.querySelector(".merlin.fab-writer")&&e.removeChild(e.lastElementChild)}))}catch{}try{document.querySelectorAll(ie).length>0&&(g=document.querySelectorAll(ie),g[g.length-1].querySelector(".merlin.fab-writer")||T(g[g.length-1],c.FACEBOOK.PERSONAL.POST,"pre"))}catch{}try{if(document.querySelectorAll(re).length>0){g=document.querySelectorAll(re);const e="div.xe4j0kc.x78zum5.x1a02dak.x1vqgdyp.x1l1ennw.x14vqqas.x6ikm8r.x10wlt62.x1y1aw1k.xh8yej3";g.forEach(a=>{a.querySelector(e)&&(a.querySelector(".merlin.fab-writer")||V(a,"before",a.querySelector(e)))})}if(document.querySelector(oe)){const e=document.querySelector(oe);try{e.children.length>0&&((E=e==null?void 0:e.children[1])==null?void 0:E.children[0].children.length)===4&&(e.querySelector(".merlin.fab-writer")||V(e,"before",e.children[1]))}catch(a){}}if(document.querySelector(ne)){const e=document.querySelector(ne);try{e.children.length>0&&((s=e==null?void 0:e.children[1])==null?void 0:s.children.length)===3&&(e.querySelector(".merlin.fab-writer")||V(e,"before",e.children[1]))}catch(a){}}}catch{}try{document.querySelectorAll(ae).length>0&&(g=document.querySelectorAll(ae),g.forEach(e=>{var i;const a=".x78zum5.xdt5ytf.x1iyjqo2.x193iq5w.x2lwn1j.x1n2onr6",h='span.x193iq5w.xeuugli.x13faqbe.x1vvkbs.x1xmvt09.x1lliihq.x1s928wv.xhkezso.x1gmr53x.x1cpjm7i.x1fgarty.x1943h6x.xudqn12.x3x7a5m.x6prxxf.xvq8zen.xk50ysn.xzsf02u[dir="auto"]';if(e.querySelector(h)){e.querySelector(h).textContent==="New message"&&!e.querySelector(a).lastElementChild.querySelector(".merlin.fab-writer")&&e.querySelector(a).querySelector(".x2lah0s.x879a55")&&T(e.querySelector(a).querySelector(".x2lah0s.x879a55"),c.FACEBOOK.PERSONAL.MESSAGE,"pre");return}if(e.querySelector(a)&&!e.querySelector(a).lastElementChild.querySelector(".merlin.fab-writer")&&(i=e==null?void 0:e.querySelector(a))!=null&&i.querySelector(".xuk3077.x78zum5.x6prxxf.xz9dl7a.xsag5q8")){T(e.querySelector(a).lastElementChild,c.FACEBOOK.PERSONAL.MESSAGE,"pre");return}}))}catch{}},300)),y={childList:!0,subtree:!0};o.observe(document.body,y)};rt();
