(()=>{var e={131:function(e,t){var n,s,r;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,s=[e],n=function(e){"use strict";if(!globalThis.chrome?.runtime?.id)throw new Error("This script should only be loaded in a browser extension.");if(void 0===globalThis.browser||Object.getPrototypeOf(globalThis.browser)!==Object.prototype){const t="The message port closed before a response was received.",n=e=>{const n={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(0===Object.keys(n).length)throw new Error("api-metadata.json has not been included in browser-polyfill");class s extends WeakMap{constructor(e,t=void 0){super(t),this.createItem=e}get(e){return this.has(e)||this.set(e,this.createItem(e)),super.get(e)}}const r=e=>e&&"object"==typeof e&&"function"==typeof e.then,i=(t,n)=>(...s)=>{e.runtime.lastError?t.reject(new Error(e.runtime.lastError.message)):n.singleCallbackArg||s.length<=1&&!1!==n.singleCallbackArg?t.resolve(s[0]):t.resolve(s)},a=e=>1==e?"argument":"arguments",o=(e,t)=>function(n,...s){if(s.length<t.minArgs)throw new Error(`Expected at least ${t.minArgs} ${a(t.minArgs)} for ${e}(), got ${s.length}`);if(s.length>t.maxArgs)throw new Error(`Expected at most ${t.maxArgs} ${a(t.maxArgs)} for ${e}(), got ${s.length}`);return new Promise(((r,a)=>{if(t.fallbackToNoCallback)try{n[e](...s,i({resolve:r,reject:a},t))}catch(i){console.warn(`${e} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,i),n[e](...s),t.fallbackToNoCallback=!1,t.noCallback=!0,r()}else t.noCallback?(n[e](...s),r()):n[e](...s,i({resolve:r,reject:a},t))}))},l=(e,t,n)=>new Proxy(t,{apply:(t,s,r)=>n.call(s,e,...r)});let c=Function.call.bind(Object.prototype.hasOwnProperty);const d=(e,t={},n={})=>{let s=Object.create(null),r={has:(t,n)=>n in e||n in s,get(r,i,a){if(i in s)return s[i];if(!(i in e))return;let g=e[i];if("function"==typeof g)if("function"==typeof t[i])g=l(e,e[i],t[i]);else if(c(n,i)){let t=o(i,n[i]);g=l(e,e[i],t)}else g=g.bind(e);else if("object"==typeof g&&null!==g&&(c(t,i)||c(n,i)))g=d(g,t[i],n[i]);else{if(!c(n,"*"))return Object.defineProperty(s,i,{configurable:!0,enumerable:!0,get:()=>e[i],set(t){e[i]=t}}),g;g=d(g,t[i],n["*"])}return s[i]=g,g},set:(t,n,r,i)=>(n in s?s[n]=r:e[n]=r,!0),defineProperty:(e,t,n)=>Reflect.defineProperty(s,t,n),deleteProperty:(e,t)=>Reflect.deleteProperty(s,t)},i=Object.create(e);return new Proxy(i,r)},g=e=>({addListener(t,n,...s){t.addListener(e.get(n),...s)},hasListener:(t,n)=>t.hasListener(e.get(n)),removeListener(t,n){t.removeListener(e.get(n))}}),u=new s((e=>"function"!=typeof e?e:function(t){const n=d(t,{},{getContent:{minArgs:0,maxArgs:0}});e(n)})),m=new s((e=>"function"!=typeof e?e:function(t,n,s){let i,a,o=!1,l=new Promise((e=>{i=function(t){o=!0,e(t)}}));try{a=e(t,n,i)}catch(e){a=Promise.reject(e)}const c=!0!==a&&r(a);if(!0!==a&&!c&&!o)return!1;const d=e=>{e.then((e=>{s(e)}),(e=>{let t;t=e&&(e instanceof Error||"string"==typeof e.message)?e.message:"An unexpected error occurred",s({__mozWebExtensionPolyfillReject__:!0,message:t})})).catch((e=>{console.error("Failed to send onMessage rejected reply",e)}))};return d(c?a:l),!0})),h=({reject:n,resolve:s},r)=>{e.runtime.lastError?e.runtime.lastError.message===t?s():n(new Error(e.runtime.lastError.message)):r&&r.__mozWebExtensionPolyfillReject__?n(new Error(r.message)):s(r)},E=(e,t,n,...s)=>{if(s.length<t.minArgs)throw new Error(`Expected at least ${t.minArgs} ${a(t.minArgs)} for ${e}(), got ${s.length}`);if(s.length>t.maxArgs)throw new Error(`Expected at most ${t.maxArgs} ${a(t.maxArgs)} for ${e}(), got ${s.length}`);return new Promise(((e,t)=>{const r=h.bind(null,{resolve:e,reject:t});s.push(r),n.sendMessage(...s)}))},_={devtools:{network:{onRequestFinished:g(u)}},runtime:{onMessage:g(m),onMessageExternal:g(m),sendMessage:E.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:E.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},p={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return n.privacy={network:{"*":p},services:{"*":p},websites:{"*":p}},d(e,_,n)};e.exports=n(chrome)}else e.exports=globalThis.browser},void 0===(r="function"==typeof n?n.apply(t,s):n)||(e.exports=r)}},t={};function n(s){var r=t[s];if(void 0!==r)return r.exports;var i=t[s]={exports:{}};return e[s].call(i.exports,i,i.exports,n),i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";
/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
class e{static _contructor(){if(this._isInitialized)return;e._isChromium=navigator.userAgent.includes("Chrome/")||navigator.userAgent.includes("Chromium/"),e._isFirefox=navigator.userAgent.includes("Firefox/"),e._isThunderbird=navigator.userAgent.includes("Thunderbird/"),e._isOpera=navigator.userAgent.includes("OPR/"),e._isEdge=navigator.userAgent.includes("Edg/"),e._isOldEdge=navigator.userAgent.includes("Edge/"),e._isSafari=(navigator.userAgent.includes("Safari/")||navigator.userAgent.includes("AppleWebKit"))&&!e._isChromium&&!e._isEdge&&!e._isOpera,e._isYaBrowser=navigator.userAgent.includes("YaBrowser/"),e._isChrome=e._isChromium&&!e._isOpera&&!e._isEdge&&!e._isOldEdge&&!e._isYaBrowser;const t=navigator.userAgent.match(/Chrome\/(\d+)/);t&&(e._isUnsupportedChrome=parseInt(t[1])<67&&!navigator.userAgent.includes("Edge/"));const n=navigator.userAgent.match(/Firefox\/(\d+)/);n&&(e._isUnsupportedFirefox=parseInt(n[1])<60),this._isInitialized=!0}static getOS(){return navigator.userAgent.includes("Macintosh")?"Mac":navigator.userAgent.includes("Windows")?"Windows":navigator.userAgent.includes("CrOS")?"CrOS":navigator.userAgent.includes("Linux")?"Linux":"Other"}static isChromium(){return e._isChromium}static isChrome(){return e._isChrome}static isThunderbird(){return e._isThunderbird}static isFirefox(){return e._isFirefox}static isOpera(){return e._isOpera}static isEdge(){return e._isEdge}static isSafari(){return e._isSafari}static isYaBrowser(){return e._isYaBrowser}static isUnsupportedChrome(){return e._isUnsupportedChrome}static isUnsupportedFirefox(){return e._isUnsupportedFirefox}static isUnsupportedBrowser(){return e.isUnsupportedChrome()||e.isUnsupportedFirefox()}static getBrowserName(){return e.isChrome()?"Chrome":e.isFirefox()?"Firefox":e.isOpera()?"Opera":e.isEdge()?"Edge":e.isSafari()?"Safari":e.isYaBrowser()?"Yandex":"Unknown Browser"}static getUserAgentIdentifier(){let e="webextension";return this.isChrome()?e+="-chrome":this.isFirefox()?e+="-firefox":this.isOpera()?e+="-opera":this.isEdge()?e+="-edge":this.isYaBrowser()?e+="-chrome":this.isSafari()?e+="-safari":e+="-unknown",e+"-ng"}static isTouchDevice(){if(!("ontouchstart"in self))return!1;const e=navigator.userAgent.includes("Android");return this.isIOS()||e}static isIOS(){const e=navigator.userAgent.includes("iPhone OS"),t=navigator.userAgent.includes("Macintosh")&&Boolean(navigator.maxTouchPoints&&navigator.maxTouchPoints>2);return e||t}static isIOSTouchDevice(){return"ontouchstart"in self&&this.isIOS()}static isMacApp(){return navigator.userAgent.includes("AppleWebKit/")&&navigator.userAgent.includes("LanguageTool/")&&!navigator.userAgent.includes("Chrome/")&&!navigator.userAgent.includes("Chromium/")}static isWindowsApp(){return navigator.userAgent.includes("LanguageToolWindows/")}}e._isChromium=!1,e._isChrome=!1,e._isFirefox=!1,e._isThunderbird=!1,e._isOpera=!1,e._isOldEdge=!1,e._isEdge=!1,e._isSafari=!1,e._isYaBrowser=!1,e._isUnsupportedChrome=!1,e._isUnsupportedFirefox=!1,e._isInitialized=!1,e._contructor();let t;try{t=new RegExp("\\p{L}","u")}catch(e){t=/[a-zäöüß]/i}function s(e){return t.test(e)}let r,i,a,o,l;!function(){const e="\b\t          ‏　",t=new RegExp("^["+e+"]$"),n=new RegExp("["+e+"]","g");r=function(e){return" "===e||" "===e||t.test(e)},i=function(e){return e.replace(n," ")}}(),function(){const e="​‌‍­⁠‪‫‬‭",t=new RegExp("^["+e+"]$"),n=new RegExp("["+e+"]"),s=new RegExp("["+e+"]","g");a=function(e){return t.test(e)},o=function(e){const t=e.match(n);return t?t.index:-1},l=function(e){return e.replace(s,"")}}();const c=function(){const e=/^[A-ZÈÉÊÁÀÂÓÒÔÚÙÛÍÌÎÄÜÖ]+[A-ZÈÉÊÁÀÂÓÒÔÚÙÛÍÌÎÄÜÖ\-!?#@=%().:;<>'’´`"”“*+,\s]+[A-ZÈÉÊÁÀÂÓÒÔÍÌÎÄÜÖ]$/;return function(t){return e.test(t)}}();function d(e,t){const{start:n,end:s=n}=t||{start:-1};if(!e||-1===n)return;const r=e.map((e=>Array.isArray(e)?e:[e.start,e.end])).findIndex((([e,t])=>n>=e&&s<=t));return r<0?void 0:e[r]}let g,u,m,h;function E(e,t){if(e===t)return null;let n=0;const s=Math.max(e.length,t.length);for(n=0;n<s&&e[n]===t[n];n++);let r=0;const i=Math.min(e.length,t.length);for(;n+r<i;){if(e[e.length-r-1]!==t[t.length-r-1])break;r++}return{from:n,oldFragment:e.substring(n,e.length-r),newFragment:t.substring(n,t.length-r)}}function _(e,t){const n=[],s=e.split("\n"),r=t.split("\n");let i=0;const a=Math.max(s.length,r.length);for(i=0;i<a&&s[i]===r[i];i++);let o=0;const l=Math.min(s.length,r.length);for(;i+o<l;){if(s[s.length-o-1]!==r[r.length-o-1])break;o++}let c=0;for(let e=0;e<i;e++)c+=s[e].length+1;let d=c;for(let e=i;e<a-o;e++){const t=e<s.length-o?s[e]:null,i=e<r.length-o?r[e]:null;t===i&&c===d||n.push({oldText:t,newText:i,oldOffset:c,newOffset:d,textDiff:E(t||"",i||"")}),null!==t&&(c+=t.length+1),null!==i&&(d+=i.length+1)}if(c!==d)for(let e=o-1;e>=0;e--){const t=s[s.length-e-1],i=r[r.length-e-1];n.push({oldText:t,newText:i,oldOffset:c,newOffset:d,textDiff:null}),c+=t.length+1,d+=i.length+1}return n}function p(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/`/g,"&#x60;").replace(/\//g,"&#x2F;")}function f(e,t){let n=0,s=e.length-1;for(;n<=s;){const r=n+Math.ceil((s-n)/2),i=t(e[r]);if(i>0)n=r+1;else{if(!(i<0)){for(let n=r;n>0;n--)if(0!==t(e[n-1]))return e[n];return e[0]}s=r-1}}return null}function A(e){const t=[];return e.forEach((e=>{-1===t.indexOf(e)&&t.push(e)})),t}function S(e){return null===e||"object"!=typeof e?e:e instanceof Date?new Date(e):e instanceof RegExp?new RegExp(e):Array.isArray(e)?Array.from(e):Object.assign({},e)}function T(e){if(null===e||"object"!=typeof e)return e;if(e instanceof Date)return new Date(e);if(e instanceof RegExp)return new RegExp(e);const t=Array.isArray(e)?[]:{};for(const n in e)t[n]=T(e[n]);return t}function I(e){const t=e.toString();return 1===t.length?"0"+t:t}!function(){let e,t;const n=/(?:\S+\s+){0,4}\S+$/,r=/^\S+(?:\s+\S+){0,4}/;try{e=new RegExp("^\\s*(-?\\p{L}+){0,3}-?\\s*$","u"),t=new RegExp("^\\s*\\p{L}+(-\\p{L}+){0,3}\\s*$","u")}catch(n){e=/^\s*(-?[a-zäöüß]+){0,3}-?\s*$/i,t=/^\s*[a-zäöüß]+(-[a-zäöüß]+){0,3}\s*$/i}g=(n,r,i=r)=>{const a=n.substring(r,i);if(!e.test(a))return null;let o=0===a.length||s(a[0]),l="-"===a[0],c=r;if(o||l)for(;c>0;){const e=n[c-1],t=s(e),r="-"===e;if(!t&&!r)break;if(r&&l)return null;c--,o=t,l=r}o=s(a[a.length-1]),l=a.endsWith("-");let d=i;if(o||l)for(;d<n.length;){const e=n[d],t=s(e),r="-"===e;if(!t&&!r)break;if(r&&l)return null;d++,o=t,l=r}const g=a.match(/\s+$/);g&&(d-=g[0].length);const u=n.substring(c,d);return t.test(u)?{start:c,end:d}:null},u=(e,t,s=t,i)=>{const a=g(e,t,s);if(!a)return null;const o=d(i,{start:t,end:s});let l="",c="",u="";if(o)u=e.substring(o.start,o.end).trim(),l=e.slice(o.start,a.start).trim(),c=e.slice(a.end,o.end).trim();else{const t=n.exec(e.substring(0,a.start).trim());l=t?t[0]:"",l=l.replace(/^.+\n\n/,"");const s=r.exec(e.substring(a.end).trim());c=s?s[0]:"",c=c.replace(/\n\n.+/,"")}return{word:e.substring(a.start,a.end),position:a,sentence:u,beforeText:l,afterText:c}}}(),function(){let e;const t=/(?:\S+\s+){0,4}\S+$/,n=/^\S+(?:\s+\S+){0,4}/;try{e=new RegExp("^\\s*\\p{L}+(-\\p{L}+)*\\s*$","u")}catch(t){e=/^\s*[a-zäöüß]+(-[a-zäöüß]+)*\s*$/i}m=(t,n,s=n,r)=>{const i=t.substring(n,s);if(i.split(" ").length>5)return null;const a=function(e,t){const{start:n}=t||{start:-1};if(!e||-1===n)return;const s=e.sort(((e,t)=>e.start-t.start)).find((e=>{if(n<=e.end&&n>=e.start)return!0}));return s||void 0}(r,{start:n,end:s})?.start||0,o=function(e,t){const{end:n}=t||{end:-1};if(!e||void 0===n||-1===n)return;const s=e.sort(((e,t)=>e.start-t.start)).find((e=>{if(n<=e.end&&n>=e.start)return!0}));return s||void 0}(r,{start:n,end:s})?.end||t.length-1;let l=n;for(;l>a;){if(!(" "!==t[l-1]))break;l--}let c=s-1;for(;c<o-1;){if(!(" "!==t[c+1]))break;c++}c+=1;const d=i.match(/\s+$/);if(d&&(c-=d[0].length),l===a&&c===o)return null;return t.substring(l,c).split(e).length<6?{start:l,end:c}:null},h=(e,s,r=s,i)=>{const a=m(e,s,r,i);if(!a)return null;const o=d(i,{start:s,end:r});let l="",c="",g="";if(o)g=e.substring(o.start,o.end).trim(),l=e.slice(o.start,a.start).trim(),c=e.slice(a.end,o.end).trim();else{const s=t.exec(e.substring(0,a.start).trim());l=s?s[0]:"",l=l.replace(/^.+\n\n/,"");const r=n.exec(e.substring(a.end).trim());c=r?r[0]:"",c=c.replace(/\n\n.+/,"")}return{word:e.substring(a.start,a.end),position:a,sentence:g,beforeText:l,afterText:c}}}();let y=null;function C(e){return Intl.Segmenter?(y||(y=new Intl.Segmenter(void 0,{granularity:"grapheme"})),Array.from(y.segment(e),(e=>e.segment))):[...e]}function R(){if("about:blank"===location.href||"about:srcdoc"===location.href)try{return(self.opener||self.parent).location.href}catch(e){}return location.href}function N(e,t=e){if(e.startsWith("about:blank"))return"blank";if(e.startsWith("about:srcdoc"))return"srcdoc";if(e.startsWith("file:"))return"file";e&&!/^([a-z\-]+:\/\/)/i.test(e)&&(e="http://"+e);try{return new URL(e).hostname}catch(e){return t}}function L(e){return N(e).toLowerCase().trim().replace(/^www\./,"")}function O(e,t){const n=L(t);return(e||[]).some((e=>{const t=L(e);return t===n||n.endsWith("."+t)}))}var P;!function(e){e.GC="GC",e.GC_RECOMMENDATION="GC_RECOMMENDATION",e.REPHRASING="PPHR"}(P||(P={}));const b=function(){const e=/^\w+\.$/;return(t,n)=>{if(!t.isSpellingError)return!1;let s=t.originalPhrase;if(e.test(s)&&(s=s.substring(0,s.length-1)),n.includes(s))return!0;if(function(e){const t=e.charAt(0);return t===t.toUpperCase()&&t!==t.toLowerCase()}(s)){const e=(r=s).charAt(0).toLowerCase()+r.substr(1);if(n.includes(e))return!0}var r;return!1}}();!function(){const e=/[\u0300-\u036f]/g,t=/\u0142/g,n=/\u00F8/g}();function v(e,t,n,s,r=!1){return r?e<=s&&t>=n:e<s&&t>n}function D(e,t,n,s=!1){if(s){if(t<=e&&e<n)return 0}else if(t<=e&&e<=n)return 0;return e-t}async function x(e,t,n){if(t.signal)throw new Error("cannot fetchWithTimeout if 'signal' is already set");const s=new AbortController;t.signal=s.signal;const r=self.setTimeout((()=>s.abort()),n);return await fetch(e,t).finally((()=>{clearTimeout(r)}))}function k(){return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,(e=>(Number(e)^crypto.getRandomValues(new Uint8Array(1))[0]&15>>Number(e)/4).toString(16)))}
/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
class U{}const w=class{static init(e){this._instance=e}static isProductionEnvironment(){return this._instance.isProductionEnvironment()}static isRuntimeConnected(){return this._instance.isRuntimeConnected()}static getVersion(){return this._instance.getVersion()}static getTrackingId(){return this._instance.getTrackingId()}static getPinnedState(){return this._instance.getPinnedState()}static shouldTrack(){return this._instance.shouldTrack()}static getType(){return this._instance.getType()}static getBeforeUnloadEventName(){return this._instance.getBeforeUnloadEventName()}static getURL(e){return this._instance.getURL(e)}static getUILanguageCode(){return this._instance.getUILanguageCode()}static openWindow(e){return this._instance.openWindow(e)}static canLoadContentScripts(e){return this._instance.canLoadContentScripts(e)}static loadContentScripts(e,t){return this._instance.loadContentScripts(e,t)}static loadStylesheets(e,t){return this._instance.loadStylesheets(e,t)}static injectShadowStyles(e){return this._instance.injectShadowStyles(e)}static initializeLTAssistant(e,t={}){return this._instance.initializeLTAssistant(e,t)}static getPreferredLanguages(){return this._instance.getPreferredLanguages()}static startDictionarySync(){return this._instance.startDictionarySync()}static addWordToDictionary(e){return this._instance.addWordToDictionary(e)}static addWordsToDictionary(e){return this._instance.addWordsToDictionary(e)}static removeWordFromDictionary(e){return this._instance.removeWordFromDictionary(e)}static clearDictionary(){return this._instance.clearDictionary()}static updateDictionary(){return this._instance.updateDictionary()}static injectExecutor(){return this._instance.injectExecutor()}static destroyExecutor(){return this._instance.destroyExecutor()}static executeScript(e,t){return this._instance.executeScript(e,t)}static linkInputAreaProperties(e){return this._instance.linkInputAreaProperties(e)}static ping(){return this._instance.ping()}static loadSynonyms(e,t,n){return this._instance.loadSynonyms(e,t,n)}static abortSynonymsRequest(){return this._instance.abortSynonymsRequest()}static loadPhrases(e,t,n,s,r){return this._instance.loadPhrases(e,t,n,s,r)}static initializeUserActivity(e){return this._instance.initializeUserActivity(e)}static sendUserActivityPings(e){return this._instance.sendUserActivityPings(e)}static updateUserActivityTextStatistics(e,t){return this._instance.updateUserActivityTextStatistics(e,t)}static updateUserActivityAppliedSuggestions(e,t,n){return this._instance.updateUserActivityAppliedSuggestions(e,t,n)}static updateUserActivityAppliedRewritings(e){return this._instance.updateUserActivityAppliedRewritings(e)}static updateUserActivityMeta(e,t){return this._instance.updateUserActivityMeta(e,t)}static sendUserActivity(e){return this._instance.sendUserActivity(e)}static destroyUserActivity(e){return this._instance.destroyUserActivity(e)}static abortPhraseRequests(e){return this._instance.abortPhraseRequests(e)}static loadSplitSentence(e,t,n,s,r){return this._instance.loadSplitSentence(e,t,n,s,r)}static trackEvent(e,t){return this._instance.trackEvent(e,t)}static pageLoaded(e,t,n,s,r){return this._instance.pageLoaded(e,t,n,s,r)}static ltAssistantStatusChanged(e,t){return"number"==typeof e?this._instance.ltAssistantStatusChanged(e,t):this._instance.ltAssistantStatusChanged(e)}static check(e,t,n,s,r,i,a){return this._instance.check(e,t,n,s,r,i,a)}static fetchRecommendationForSentence(e){return this._instance.fetchRecommendationForSentence(e)}static isOptionsPageSupported(){return this._instance.isOptionsPageSupported()}static openOptionsPage(e,t){return this._instance.openOptionsPage(e,t)}static isFeedbackFormSupported(){return this._instance.isFeedbackFormSupported()}static openFeedbackForm(e,t,n){return this._instance.openFeedbackForm(e,t,n)}static openPremiumPage(e,t=0,n=0,s=0,r="",i){return this._instance.openPremiumPage(e,t,n,s,r,i)}static checkForPaidSubscription(){return this._instance.checkForPaidSubscription()}static canUseShadowDom(){return this._instance.canUseShadowDom()}static toolboxNetworkInitiateRequest(e){return this._instance.toolboxNetworkInitiateRequest(e)}static toolboxNetworkInitiateStream(e){return this._instance.toolboxNetworkInitiateStream(e)}static abortAllRequests(e){return this._instance.abortAllRequests(e)}static getTermsOfServiceInfo(e){return this._instance.getTermsOfServiceInfo(e)}static acceptTermsOfService(e){return this._instance.acceptTermsOfService(e)}};var M;!function(e){e.CHROME_EXTENSION_ID="CHROME_EXTENSION_ID",e.EXTN_PREFIX="EVENT_PREFIX",e.COLORS_GRAMMAR="COLORS_GRAMMAR",e.CARD_LAYOUT="CARD_LAYOUT",e.COLORS_SPELLING="COLORS_SPELLING",e.COLORS_STYLE="COLORS_LONG_SENTENCE",e.SUPPORTED_LANGUAGES="SUPPORTED_LANGUAGES",e.INSTALLED_ATTRIBUTE="INSTALLED_ATTRIBUTE",e.GDOCS_ATTRIBUTE="GDOCS_ATTRIBUTE",e.TWEAKS_ATTRIBUTE="TWEAKS_ATTRIBUTE",e.TMP_ID_ATTRIBUTE="TMP_ID_ATTRIBUTE",e.AI_RULE_ID_REGEX="AI_RULE_ID_REGEX",e.COLORS_PARAPHRASE="COLORS_PARAPHRASE",e.COLORS_RECOMMENDATION="COLORS_RECOMMENDATION",e.COLORS_RECOMMENDATION_TEASE="COLORS_RECOMMENDATION_TEASE",e.VALID_START_SENTENCE_REGEX="VALID_START_SENTENCE_REGEX",e.VALID_END_SENTENCE_REGEX="VALID_END_SENTENCE_REGEX",e.MULTI_SENTENCE_SELECTION_FOR_PARAPHRASE_ALLOWED="MULTI_SENTENCE_SELECTION_FOR_PARAPHRASE_ALLOWED",e.MAX_TEXT_LENGTH_ALLOWED_FOR_PAGELESS="MAX_TEXT_LENGTH_ALLOWED_FOR_PAGELESS",e.MAX_TEXT_LENGTH_ALLOWED="MAX_TEXT_LENGTH_ALLOWED",e.SELECTED_UNDERLINE_THICKNESS="SELECTED_UNDERLINE_THICKNESS",e.BULLET_POINT_PARSING_PREFIX="BULLET_POINT_PARSING_PREFIX",e.TOOLBAR_SIZE="TOOLBAR_SIZE",e.FIX_ALL_CONFIG="FIX_ALL_CONFIG",e.IGNORE_EDITOR_WITH_ATTRIBUTES="IGNORE_EDITOR_WITH_ATTRIBUTES",e.SHOW_TOOLBAR_ON_EMPTY_INPUT_AREA="SHOW_TOOLBAR_ON_EMPTY_INPUT_AREA",e.MAIN_CONTENT_SCRIPT_FILENAME="MAIN_CONTENT_SCRIPT_FILENAME",e.SPECIAL_INTRODUCTORY_TEASER_ENABLED="SPECIAL_INTRODUCTORY_TEASER_ENABLED",e.TERMS_OF_SERVICE_MODAL_ENABLED="TERMS_OF_SERVICE_MODAL_ENABLED",e.LOLLIPOP_CONFIG="LOLLIPOP_CONFIG"}(M||(M={}));const G={[M.CHROME_EXTENSION_ID]:"oldceeleldhonbafppcapldpdifcinji",[M.EXTN_PREFIX]:"lt",[M.COLORS_GRAMMAR]:{UNDERLINE:"#f2b24c",SELECTED_UNDERLINE:"#f2b24c",BACKGROUND:"rgba(242,179,77,0.3)",EMPHASIZE:"rgba(241,179,76,0.1)"},[M.COLORS_SPELLING]:{UNDERLINE:"#EB5757",SELECTED_UNDERLINE:"#EB5757",BACKGROUND:"rgba(235,88,88,0.2)",EMPHASIZE:"rgba(239,88,88,0.1)"},[M.COLORS_STYLE]:{UNDERLINE:"#8F7FFF",SELECTED_UNDERLINE:"#8F7FFF",BACKGROUND:"rgba(142,128,255,0.2)",EMPHASIZE:"rgba(138,128,255,0.2)",TITLE:"#5C4CFF"},[M.COLORS_PARAPHRASE]:{UNDERLINE:"#8F7FFF",BACKGROUND:"rgba(142,128,255,0.2)",EMPHASIZE:"rgba(138,128,255,0.2)",TITLE:"#5C4CFF"},[M.COLORS_RECOMMENDATION]:{UNDERLINE:"#80B3E2",SELECTED_UNDERLINE:"#0067C5",BACKGROUND:"rgba(0, 103, 199, 0.16)",EMPHASIZE:"rgba(0, 103, 199, 0.16)"},[M.COLORS_RECOMMENDATION_TEASE]:{UNDERLINE:"#f4c03e",SELECTED_UNDERLINE:"#F2B518",BACKGROUND:"rgba(242,181,24,0.16)",EMPHASIZE:"rgba(242,181,24,0.16)"},[M.SUPPORTED_LANGUAGES]:["ar","ast-es","be-by","br-fr","ca-es","ca-es-valencia","da-dk","de-at","de-ch","de-de","el-gr","en-au","en-ca","en-gb","en-nz","en-us","en-za","eo","es","fa","ga-ie","fr","gl-es","it","ja-jp","km-kh","nl","no","pl-pl","pt-ao","pt-br","pt-mz","pt-pt","ro-ro","ru-ru","sk-sk","sl-si","sv","ta-in","tl-ph","uk-ua","zh-cn"],[M.CARD_LAYOUT]:{TARGET_BOX_HORIZONTAL_MARGIN:0,TARGET_BOX_VERTICAL_MARGIN:5,HEADER_HEIGHT:36,FOOTER_HEIGHT:36,KEYBOARD_HINT_HEIGHT:60,MIN_HEIGHT_PARAPHRASE:200,MIN_HEIGHT_TOOLBOX:230,MAX_HEIGHT_TOOLBOX:372},[M.INSTALLED_ATTRIBUTE]:"data-lt-installed",[M.GDOCS_ATTRIBUTE]:"data-lt-site",[M.TWEAKS_ATTRIBUTE]:"data-lt-tweaks",[M.TMP_ID_ATTRIBUTE]:"data-lt-tmp-id",[M.AI_RULE_ID_REGEX]:/^(QB|AI)_/,[M.VALID_START_SENTENCE_REGEX]:"[¿¡(@]",[M.VALID_END_SENTENCE_REGEX]:"[?!.,)…:;‽]",[M.MULTI_SENTENCE_SELECTION_FOR_PARAPHRASE_ALLOWED]:!1,[M.MAX_TEXT_LENGTH_ALLOWED_FOR_PAGELESS]:Number.MAX_SAFE_INTEGER,[M.MAX_TEXT_LENGTH_ALLOWED]:1e4,[M.SELECTED_UNDERLINE_THICKNESS]:2,[M.BULLET_POINT_PARSING_PREFIX]:"• ",[M.TOOLBAR_SIZE]:{width:20,height:20},[M.FIX_ALL_CONFIG]:{FIX_GC_ERRORS:!0,FIX_RECOMMENDATIONS:!1,FIX_STYLE_ERRORS:!1},[M.IGNORE_EDITOR_WITH_ATTRIBUTES]:["spellcheck"],[M.SHOW_TOOLBAR_ON_EMPTY_INPUT_AREA]:!1,[M.MAIN_CONTENT_SCRIPT_FILENAME]:"/content.js",[M.SPECIAL_INTRODUCTORY_TEASER_ENABLED]:!0,[M.TERMS_OF_SERVICE_MODAL_ENABLED]:!0,[M.LOLLIPOP_CONFIG]:{LOLLIPOP_FREEZE_STATE_COLOR:"purple",TOOLBOX_CSS_PATH:"/content/styles/toolbox.css",LOLLIPOP_CSS_PATH:"/content/styles/lollipop.css",ONBOARDING_IMAGE_PATH:"/assets/images/toolbox/lollipop-onboarding-lt.svg",ONBOARDING_BORDER_RADIUS:"5px",LOLLIPOP_CIRCLE_IMAGE_PATH:"/assets/images/toolbox/lollipop-icon.svg",SUPPORTS_DARK_MODE:!0}};class B{constructor(){this.extnConfig=G}static getInstance(){return this.instance||self._qb_lt_config||(this.instance=new B,self._qb_lt_config=this.instance),this.instance||self._qb_lt_config}get(e){return this.extnConfig[e]}set(e,t){this.extnConfig[e]=t}setAll(e){this.extnConfig=e}getAll(){return this.extnConfig}}const F=B.getInstance(),W="https://api.languagetool.org/v2",H="https://api.languagetoolplus.com/v2",V="http://localhost:8081/v2",X=[502,503,504],Z=18e4,Y=(F.get(M.MAX_TEXT_LENGTH_ALLOWED),Number.MAX_SAFE_INTEGER,/@(languagetool(er)?|quillbot|scribbr|learneo|coursehero|spellboy)\.(com|org|de|nl)$/i),K=(F.get(M.COLORS_GRAMMAR),F.get(M.COLORS_STYLE),F.get(M.COLORS_PARAPHRASE),F.get(M.COLORS_RECOMMENDATION),F.get(M.COLORS_RECOMMENDATION_TEASE),F.get(M.COLORS_SPELLING),["de","de-CH","ru","sv","pt","pt-BR","el","en","eo","it","fr","es","uk","sk","sl","pl","da","ro","nl","ca"]),$={UKRAINE:{countries:["UA","BY"],percent:50},"ITALY-DISCOUNT":{countries:["IT"],percent:20},"SPAIN-DISCOUNT":{countries:["ES"],percent:20},SOUTH_EUROPE:{countries:["RO","AL","GR","ME","EE","LT","LV","BG","CY","MT","SK","SI","RS","HR","XK","HU","MD","TR","PT"],percent:20},AFRICA:{countries:["NG","ET","EG","CD","CG","TZ","KE","UG","DZ","SD","MA","AO","MZ","TN","CI","DJ","SZ","MU","GQ","GA","BW","SO","CD","ER","MG"],percent:50},ASIA:{countries:["ID","PK","BD","VN","MM","PH","UZ","MY","NP","KZ","KH","UZ","TH","YE","SY","JO"],percent:50},LATIN_AMERICA:{countries:["PE","VE","EC","SV","DO","BO","SR","AR","HN","BZ","CR","PA","GT","NI","GY","UY","HT","JM","TT","CU"],percent:50},BRAZIL:{countries:["BR"],percent:50}},j="Basic",q="Premium",z=["EN_QUOTES","PASSIVE_VOICE","DASH_RULE","SENTENCE_FRAGMENT","PONCTUATION_DOUBLE","TOO_LONG_SENTENCE","COMETES_TIPOGRAFIQUES","APOSTROF_TIPOGRAFIC","FALSCHE_VERWENDUNG_DES_BINDESTRICHS","HALBGEVIERTSTRICH","PARAGRAF_LEERZEICHEN","TYPOGRAFISCHE_APOSTROPHE","TYPOGRAFISCHE_ANFUEHRUNGSZEICHEN","TYPOGRAFISCHE_ANFUEHRUNGSZEICHEN_CH","TYPOGRAFISCHE_ANFUEHRUNGSZEICHEN_2","PUNCTUATION_PARAGRAPH_END","FINAL_STOPS","FINAL_PUNCTUATION","SMART_QUOTES","PT_SMART_QUOTES","DASH_SPACE_RULES","HIPHEN_SPACE_RULES","BRAK_KROPKI","DYWIZ","CUDZYSLOW_DRUKARSKI","TYPOGRAFISCHE_AANHALINGSTEKENS","TYPOGRAFISCHE_AANHALINGSTEKENS_2","EINDE_ZIN_ONVERWACHT","BACKTICK","GEDACHTESTREEPJE","OPTIONAL_HYPHEN","COMILLAS_TIPOGRAFICAS","COMETES_TIPOGRAFIQUES","GL_SMART_QUOTES"],J=["OXFORD_SPELLING_Z_NOT_S"],Q=["de","fr"];
/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
class ee{constructor(){this._eventHandlers=new Map}subscribe(e,t){this._eventHandlers.has(e)||this._eventHandlers.set(e,[]),this._eventHandlers.get(e).push(t)}unsubscribe(e,t){const n=this._eventHandlers.get(e)?.indexOf(t)??-1;n>-1&&(this._eventHandlers.get(e).splice(n,1),this._eventHandlers.get(e).length||this._eventHandlers.delete(e))}fire(e,t){const n=this._eventHandlers.get(e);n&&n.forEach((e=>{try{e(t)}catch(e){console.error(e)}}))}destroy(){this._eventHandlers.clear()}}var te,ne=function(e,t,n){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})};
/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
const se=F.get(M.EXTN_PREFIX);class re{}re.eventNames={localeChanged:`${se}-i18nManager.localeChanged`};const ie=(ne(te=class{static init(e){this._instance=e}static addEventListener(e,t){this._instance.addEventListener(e,t)}static setLocale(e){this._instance.setLocale(e)}static getMessage(e,t){return this._instance.getMessage(e,t)}static getLanguageNameForCode(e){return this.getMessage(this._languageCodeToTranslationKeyMap[e])}},"i18nManager"),te._languageCodeToTranslationKeyMap={ar:"ar",ast:"ast","ast-es":"ast",be:"be","be-by":"be",br:"br","br-fr":"br",ca:"ca","ca-es":"ca","ca-es-valencia":"ca_ES_valencia","da-dk":"da_DK",de:"de","de-at":"de_AT","de-ch":"de_CH","de-de":"de_DE",el:"el","el-gr":"el",en:"en","en-au":"en_AU","en-ca":"en_CA","en-gb":"en_GB","en-nz":"en_NZ","en-us":"en_US","en-za":"en_ZA",eo:"eo",es:"es","es-es":"es",fa:"fa",ga:"ga","ga-ie":"ga",fr:"fr","fr-fr":"fr",gl:"gl","gl-es":"gl",it:"it",ja:"ja","ja-jp":"ja",km:"km","km-kh":"km",nl:"nl",no:"no",pl:"pl","pl-pl":"pl",pt:"pt","pt-ao":"pt_AO","pt-br":"pt_BR","pt-mz":"pt_MZ","pt-pt":"pt_PT",ro:"ro","ro-ro":"ro","ru-ru":"ru",sk:"sk","sk-sk":"sk",sl:"sl","sl-si":"sl",sv:"sv",ta:"ta","ta-in":"ta",tl:"tl","tl-ph":"tl",uk:"uk","uk-ua":"uk",zh:"zh","zh-cn":"zh"},te);
/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
class ae{static get SUPPORTED_LANGUAGES(){return this._supportedLanguages||(this._supportedLanguages=F.get(M.SUPPORTED_LANGUAGES).map((e=>({code:e,name:ie.getLanguageNameForCode(e)}))),this._supportedLanguages.sort((function(e,t){return e.name<t.name?-1:e.name>t.name?1:0})),this._isSubscribed||(ie.addEventListener(re.eventNames.localeChanged,(()=>this._supportedLanguages=null)),this._isSubscribed=!0)),this._supportedLanguages}static isLanguageVariant(e){return e.code.includes("-")}static getPrimaryLanguageCode(e){return e.split("-")[0]}static formatLanguageCode(e){const t=e.split("-");return 1===t.length?t[0]:2===t.length?t[0]+"-"+t[1].toUpperCase():t[0]+"-"+t[1].toUpperCase()+"-"+t[2]}static getUserLanguageCode(){for(const e of navigator.languages){if(e.includes("-")&&e.startsWith(navigator.language))return e}return navigator.language}static getUserLanguageCodes(){const e=Array.from(navigator.languages,(e=>this.getPrimaryLanguageCode(e).toLowerCase()));try{e.push(this.getPrimaryLanguageCode(w.getUILanguageCode()).toLowerCase())}catch(e){}return A(e)}static getPreferredLanguageVariant(e){const t={"en-in":"en-us","en-ie":"en-gb"},n=navigator.languages||[];for(let s of n){s=s.toLowerCase(),s=t[s]||s;for(const t of e){const e=t.toLowerCase();if(s.length>2&&s===e)return t}}return null}static getLanguagesForGeoIPCountry(){return new Promise((function(e,t){let n=!1;const s=self.setTimeout((()=>{n=!0,t(new Error("geoip timeout"))}),15e3);fetch("https://languagetool.org/webextension/init",{method:"GET",mode:"cors",referrerPolicy:"no-referrer",headers:{Accept:"application/json"}}).then((e=>e.json())).then((t=>{if(!n){const n=(t.geoIpCountry||"").toUpperCase();e({geoIpLanguages:t.geoIpLanguages||[],geoIpCountry:n}),clearTimeout(s)}})).catch((e=>{console.error(e),n||(t(e),clearTimeout(s))}))}))}static getSynonymsRequestLanguage(e){let t=this.getPrimaryLanguageCode(e);return"de-ch"===e.toLowerCase()?t="de-CH":"pt-br"===e.toLowerCase()&&(t="pt-BR"),K.includes(t)?t:null}}ae._supportedLanguages=null,ae._isSubscribed=!1,ae.ALL_LANGUAGES=[{code:"af",name:"Afrikaans"},{code:"ak",name:"Akan"},{code:"am",name:"አማርኛ"},{code:"an",name:"aragonés"},{code:"ar",name:"عربي"},{code:"as",name:"অসমীয়া"},{code:"ast",name:"Asturianu"},{code:"be",name:"Беларуская"},{code:"bg",name:"Български"},{code:"bm",name:"Bamanankan"},{code:"bn",name:"বাংলা"},{code:"br",name:"Brezhoneg"},{code:"bs",name:"босански"},{code:"ca",name:"Català"},{code:"cs",name:"čeština"},{code:"cy",name:"Cymraeg"},{code:"da",name:"Dansk"},{code:"de",name:"Deutsch"},{code:"el",name:"Ελληνικά"},{code:"en",name:"English"},{code:"eo",name:"Esperanto"},{code:"es",name:"Español"},{code:"et",name:"Eesti keel"},{code:"eu",name:"Euskara"},{code:"fa",name:"فارسی"},{code:"fi",name:"suomi"},{code:"fj",name:"Vosa vaka-Viti"},{code:"fr",name:"Français"},{code:"ga",name:"Gaeilge"},{code:"gd",name:"Gàidhlig"},{code:"gl",name:"Galego"},{code:"gn",name:"Avañe'ẽ"},{code:"gu",name:"ગુજરાતી"},{code:"ha",name:"هَرْشَن هَوْسَ‎"},{code:"he",name:"עברית"},{code:"hi",name:"हिन्दी"},{code:"hr",name:"hrvatski"},{code:"hu",name:"magyar"},{code:"hy",name:"Հայերեն"},{code:"ia",name:"Interlingua"},{code:"id",name:"Bahasa Indonesia"},{code:"ig",name:"Ásụ̀sụ̀ Ìgbò"},{code:"is",name:"íslenska"},{code:"it",name:"Italiano"},{code:"ja",name:"日本語"},{code:"kk",name:"Қазақ"},{code:"km",name:"ខ្មែរ"},{code:"kn",name:"ಕನ್ನಡ"},{code:"ko",name:"한국어"},{code:"ku",name:"Kurdî"},{code:"ks",name:"كشمیری"},{code:"la",name:"Latina"},{code:"lg",name:"Luganda"},{code:"lo",name:"ພາສາລາວ"},{code:"lt",name:"Lietuvių"},{code:"lv",name:"Latviešu"},{code:"mg",name:"malagasy"},{code:"mi",name:"Māori"},{code:"ml",name:"മലയാളം"},{code:"mk",name:"Македонски"},{code:"mn",name:"Монгол"},{code:"mr",name:"मराठी"},{code:"ms",name:"Melayu"},{code:"my",name:"မြန်မာဘာသာ"},{code:"nb",name:"Norsk bokmål"},{code:"ne",name:"नेपाली"},{code:"nn",name:"Norsk nynorsk"},{code:"no",name:"Norsk"},{code:"nl",name:"Nederlands"},{code:"nr",name:"isiNdebele"},{code:"oc",name:"Occitano"},{code:"or",name:"ଓଡ଼ିଆ"},{code:"pa",name:"ਪੰਜਾਬੀ"},{code:"pl",name:"Polski"},{code:"ps",name:"پښتو"},{code:"pt",name:"Português"},{code:"rm",name:"rumantsch"},{code:"ro",name:"românesc"},{code:"ru",name:"Русский"},{code:"rw",name:"Ikinyarwanda"},{code:"sa",name:"संस्कृत"},{code:"si",name:"සිංහල"},{code:"sk",name:"slovenčina"},{code:"sl",name:"Slovenščina"},{code:"so",name:"Soomaali"},{code:"sr",name:"Српски"},{code:"ss",name:"siSwati"},{code:"st",name:"Sesotho"},{code:"sv",name:"Svenska"},{code:"ta",name:"தமிழ்"},{code:"te",name:"తెలుగు"},{code:"th",name:"ภาษาไทย"},{code:"tl",name:"Tagalog"},{code:"fil",name:"Filipino"},{code:"tr",name:"Türkçe"},{code:"ts",name:"Xitsonga"},{code:"tt",name:"Tatarça"},{code:"uk",name:"Українська"},{code:"ur",name:"اُردو"},{code:"uz",name:"Oʻzbek tili"},{code:"ve",name:"Tshivenḓa"},{code:"vi",name:"Tiếng Việt"},{code:"yo",name:"عِدعِ يوْرُبا"},{code:"zh",name:"中文"},{code:"zu",name:"isiZulu"}],ae.POPULAR_LANGUAGES=["de","en","es","fr","nl","pl","pt","ru","uk","zh","it","hi"];
/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
const oe=F.get(M.EXTN_PREFIX);class le{static get DEFAULT_SETTINGS(){return null===this.DEFAULT_SETTINGS_CACHED&&(this.DEFAULT_SETTINGS_CACHED={apiServerUrl:W,autoCheck:!0,knownEmail:"",username:"",password:"",token:"",userId:null,dpaLevel:0,motherTongue:"",geoIpLanguages:[],geoIpCountry:"",preferredLanguages:[],forcePreferredLanguages:!1,enVariant:ae.getPreferredLanguageVariant(["en-US","en-GB","en-AU","en-CA","en-NZ","en-ZA"])||"en-US",deVariant:ae.getPreferredLanguageVariant(["de-DE","de-AT","de-CH"])||"de-DE",ptVariant:ae.getPreferredLanguageVariant(["pt-PT","pt-BR","pt-MZ","pt-AO"])||"pt-BR",caVariant:"ca-ES",dictionary:[],hasSynonymsEnabled:!1,hasPickyModeEnabledGlobally:!1,openCardHotkey:"",isDictionarySynced:!1,ignoredRules:[],disabledDomains:[],disabledEditorGroups:[],ignoreCheckOnDomains:[],disableRecommendationOnDomains:[],autoCheckOnDomains:[],remainingRephrasingsAmount:null,remainingRephrasingsDate:null,hasRephrasingEnabled:!0,hasContextMenuOptionEnabled:!0,hasLollipopEnabled:!1}),this.DEFAULT_SETTINGS_CACHED}static _combineObjects(e,t){const n=T(e);for(const e in n)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}static _dec2hex(e){return("0"+e.toString(16)).substr(-2)}static _generateUniqueId(){const e=new Uint8Array(8);return crypto.getRandomValues(e),Array.from(e,le._dec2hex).join("")}static _isListContainsDomain(e,t){return O(e,t)}static getDefaultSettings(){return T(le.DEFAULT_SETTINGS)}static getDefaultPrivacySettings(){return S(le.DEFAULT_PRIVACY_SETTINGS)}constructor(){this._eventBus=new ee,this._onReadyCallbacks=[]}addEventListener(e,t){this._eventBus.subscribe(e,t)}removeEventListener(e,t){this._eventBus.unsubscribe(e,t)}disableDomain(e){const t=L(e),n=this.getSettings(),s="object"==typeof n.disabledDomains?n.disabledDomains:[];return s.push(t),this.updateSettings({disabledDomains:s})}enableDomain(e){const t=L(e),n=this.getSettings();let s="object"==typeof n.disabledDomains?n.disabledDomains:[];return s=s.filter((e=>{const n=L(e);return n!==t&&!t.endsWith("."+n)})),this.updateSettings({disabledDomains:s})}addToDomainSettings(e,t){const n=L(e),s=this.getSettings()[t]||[];return s.push(n),this.updateSettings({[t]:A(s)})}removeFromDomainSettings(e,t){const n=L(e);let s=this.getSettings()[t]||[];return s=s.filter((e=>{const t=L(e);return t!==n&&!n.endsWith("."+t)})),this.updateSettings({[t]:s})}isInternalTester(){const e=this.getSettings();return this.getUIState().showRuleId||Y.test(e.username)}disableEditorGroup(e,t){const n=L(e),s=this.getSettings(),r="object"==typeof s.disabledEditorGroups?s.disabledEditorGroups:[];return r.push({domain:n,editorGroupId:t}),this.updateSettings({disabledEditorGroups:r})}enableEditorGroup(e,t){const n=L(e),s=this.getSettings(),r="object"==typeof s.disabledEditorGroups?s.disabledEditorGroups:[],i=r.filter((e=>!(e.domain===n&&e.editorGroupId===t)));return i.length!==r.length?this.updateSettings({disabledEditorGroups:i}):Promise.resolve()}enableDomainAndEditorGroup(e,t){return this.getCheckSettings(e,t).isEditorGroupDisabled&&this.enableEditorGroup(e,t),this.enableDomain(e)}grantUnlimitedRephrasings(){return this.updateSettings({remainingRephrasingsAmount:null,remainingRephrasingsDate:null})}restrictRephrasings(){const{remainingRephrasingsAmount:e,remainingRephrasingsDate:t}=this.getSettings();return this.updateSettings({remainingRephrasingsAmount:e??3,remainingRephrasingsDate:t||(new Date).toISOString()})}enablePaidSubscription(){return this.updateUIState({hasPaidSubscription:!0})}disablePaidSubscription(){return this.updateUIState({hasPaidSubscription:!1})}getIgnoredRuleIds(){return this.getManagedSettings().disableIgnoredRules?[]:this.getSettings().ignoredRules.map((e=>e.id))}hasIgnoredRule(e){return this.getIgnoredRuleIds().includes(e)}addIgnoredRule(e){const{ignoredRules:t}=this.getSettings();this.hasIgnoredRule(e.id)||this.updateSettings({ignoredRules:[...t,e]})}async removeIgnoredRule(e){if(this.hasIgnoredRule(e)){const t=this.getSettings().ignoredRules.filter((t=>t.id!==e));await this.updateSettings({ignoredRules:t})}}destroy(){this._eventBus.destroy(),this._onReadyCallbacks=[]}}le.eventNames={settingsChanged:`${oe}-storageController.settingsChanged`,userCredentialsChanged:`${oe}-storageController.userCredentialsChanged`,configurationChanged:`${oe}-storageController.configurationChanged`,privacySettingsChanged:`${oe}-storageController.privacySettingsChanged`,uiStateChanged:`${oe}-storageController.uiStateChanged`},le.DEFAULT_SETTINGS_CACHED=null,le.DEFAULT_MANAGED_SETTINGS={apiServerUrl:"",loginUrl:"",disablePrivacyConfirmation:!1,disablePersonalDictionary:!1,disableIgnoredRules:!1,disableOpenInEditor:!1,allowedURLs:[]},le.DEFAULT_REMOTE_CONFIGURATION={unsupportedDomains:[]},le.DEFAULT_PRIVACY_SETTINGS={allowRemoteCheck:!1,confirmedGPT3:!1,hasStatisticsCollectionEnabled:!0,hasMLDataCollectionEnabled:!1,acceptedTermsOfServiceVersion:null,lastTermsOfServiceModalShown:null},le.DEFAULT_STATISTICS={usageCount:0,sessionCount:0,appliedSuggestions:0,appliedSynonyms:0,hiddenErrors:[],firstVisit:null,lastActivity:null,ratingValue:null,premiumClicks:0,campaign:null,lastPing:null},le.DEFAULT_UI_STATE={hasSeenPrivacyConfirmationDialog:!1,hasPaidSubscription:!1,hasRated:!1,hasUsedValidator:!1,hasSeenOnboarding:!1,isNewUser:!1,hasSeenNewOverleafTeaser:!1,hasSeenNewGoogleDocsTeaser:!1,hasSeenNewGoogleSlidesTeaser:!1,hasSeenDesktopAppTeaser:!1,hasSeenGoogleDocsMenuBarHint:!1,lastChangelogNov2024Seen:null,changelogNov2024CountdownEnd:null,changelogNov2024Coupon:null,showRuleId:!1,dialogPosition:"default",countMode:"characters",hasSeenTurnOnMessagePopup:!1,isDarkModeEnabled:!1,skipFixAllConfirmation:!1,skipFixAllOverLimitConfirmation:!1,hasClickedLollipop:!1,hasSeenLollipopOnboarding:!1},le.DEFAULT_TEST_FLAGS={testGroups:{}};class ce{static init(e){this._instanceCtor=e}static create(){return this._instanceCtor()}}
/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
class de{static _update(e){return this._storageController.updateSettings({dictionary:e})}static init(e,t=[]){this._isInitialized||(this._storageController=e||ce.create(),this._defaultWords=t,this._isInitialized=!0)}static get(){let e=this._storageController.getSettings().dictionary;return Array.isArray(e)||(e=[]),this._defaultWords.length&&(e=e.concat(this._defaultWords),e=A(e)),e}static getSorted(){return this.get().sort(((e,t)=>e.toLowerCase().localeCompare(t.toLowerCase())))}static add(e){const t=this.get();return t.push(e.trim()),w.addWordToDictionary(e),this._update(t)}static addBatch(e){const t=this.get();return e.forEach((e=>{e&&e.trim()&&!e.trim().match(/\s/)&&t.push(e.trim())})),w.addWordsToDictionary(e),this._update(t)}static remove(e){const t=this.get(),n=t.indexOf(e);return-1===n?Promise.resolve():(t.splice(n,1),w.removeWordFromDictionary(e),this._update(t))}static clear(){return w.clearDictionary(),this._update([])}}de._isInitialized=!1;class ge{static merge(e,t=!1,n=!1){let{errors:s,pickyErrors:r,premiumErrors:i,premiumPickyErrors:a,sentenceRanges:o=[]}=this.filterAndMigrateErrors(e.existing.errors,e.existing.pickyErrors,e.existing.premiumErrors,e.existing.premiumPickyErrors,e.existing.sentenceRanges,e.existingCheckedText,e.newCheckedText,n);this.mergeParagraphLevelErrors(s,r,i,a,o,e.new.paragraphLevel.errors,e.new.paragraphLevel.pickyErrors,e.new.paragraphLevel.premiumErrors,e.new.paragraphLevel.premiumPickyErrors,e.new.paragraphLevel.sentenceRanges),this.mergeTextLevelErrors(s,r,i,a,e.new.textLevel.errors,e.new.textLevel.pickyErrors,e.new.textLevel.premiumErrors,e.new.textLevel.premiumPickyErrors);const l=this.getDuplicateErrors(e.existing,e.existingCheckedText,e.newCheckedText);return this.sortErrors(s,r,i,a),this.setIdsOnErrors(s,r,i,a,l),s=this.migrateOffsetsToOriginalText(s,e.newCheckedText.usedParts),r=this.migrateOffsetsToOriginalText(r,e.newCheckedText.usedParts),i=this.migrateOffsetsToOriginalText(i,e.newCheckedText.usedParts),a=this.migrateOffsetsToOriginalText(a,e.newCheckedText.usedParts),o=this.migrateOffsetsToOriginalText(o,e.newCheckedText.usedParts),t&&(r=r.filter((e=>!z.includes(e.rule.id))),r.forEach((e=>{e.rule.id="HIDDEN_RULE",e.fixes=[]})),i=[...i,...a,...r],a=[],r=[],this.sortErrorsByOffset(i)),{errors:s,pickyErrors:r,premiumErrors:i,premiumPickyErrors:a,sentenceRanges:o}}static getDuplicateErrors(e,t,n){let{errors:s,pickyErrors:r,premiumErrors:i,premiumPickyErrors:a}=e;s=this.migrateOffsetsToValuableText(s,t.usedParts),r=this.migrateOffsetsToValuableText(r,t.usedParts),i=this.migrateOffsetsToValuableText(i,t.usedParts),a=this.migrateOffsetsToValuableText(a,t.usedParts);const o=_(t.text,n.text),l=e=>{if(!e.isParagraphLevelCheck)return!0;const t=f(o,(t=>{const n=t.oldOffset;if(null===t.oldText)return e.start>=n?1:-1;const s=t.oldOffset+t.oldText.length+1;return D(e.start,n,s,!0)}));return!(!t||!t.textDiff)||void 0};return s=s.filter(l),r=r.filter(l),i=i.filter(l),a=a.filter(l),s=this.migrateOffsetsBetweenTexts(s,o),r=this.migrateOffsetsBetweenTexts(r,o),i=this.migrateOffsetsBetweenTexts(i,o),a=this.migrateOffsetsBetweenTexts(a,o),{errors:s,pickyErrors:r,premiumErrors:i,premiumPickyErrors:a}}static migrateOffsetsToValuableText(e,t){const n=[];for(const s of e){const e=f(t,(e=>D(s.start,e.originalStart,e.originalEnd,!0))),r=f(t,(e=>D(s.end,e.originalStart,e.originalEnd)));if(!e||!r)continue;const i=T(s);i.start-=e.posDiff,i.end-=r.posDiff,i.length=i.end-i.start,n.push(i)}return n}static migrateOffsetsBetweenTexts(e,t,n,s,r){let i,a=!1,o=!1;"string"==typeof t&&"string"==typeof n?(i=_(t,n),a="boolean"==typeof s&&s,o="boolean"==typeof r&&r):(i=t,a="boolean"==typeof n&&n,o="boolean"==typeof s&&s);const l=[];for(const t of e){const e=f(i,(e=>{const n=e.oldOffset;if(null===e.oldText)return t.start>=n?1:-1;const s=e.oldOffset+e.oldText.length+1;return D(t.start,n,s,!0)})),n=T(t);if(e){if(e.textDiff){if(a)continue;{const t=e.oldOffset+e.textDiff.from,s=t+e.textDiff.oldFragment.length,r=!o;if(v(t,s,n.start,n.end,r))continue;if(n.start>=s){const t=e.textDiff.newFragment.length-e.textDiff.oldFragment.length;n.start+=t,n.end+=t}}}n.start+=e.newOffset-e.oldOffset,n.end=n.start+n.length}l.push(n)}return l}static migrateOffsetsToOriginalText(e,t){const n=[];for(const s of e){const e=f(t,(e=>D(s.start,e.start,e.end,!0))),r=f(t,(e=>D(s.end,e.start,e.end)));if(!e||!r)continue;const i=T(s);i.start+=e.posDiff,i.end+=r.posDiff,i.length=i.end-i.start,n.push(i)}return n}static filterAndMigrateErrors(e,t,n,s,r,i,a,o=!1){e=e.filter((e=>e.isParagraphLevelCheck)),t=t.filter((e=>e.isParagraphLevelCheck)),n=n.filter((e=>e.isParagraphLevelCheck)),s=s.filter((e=>e.isParagraphLevelCheck)),e=this.migrateOffsetsToValuableText(e,i.usedParts),t=this.migrateOffsetsToValuableText(t,i.usedParts),n=this.migrateOffsetsToValuableText(n,i.usedParts),s=this.migrateOffsetsToValuableText(s,i.usedParts),r=this.migrateOffsetsToValuableText(r||[],i.usedParts);const l=_(i.text,a.text);return o?(e=this.migrateOffsetsBetweenTexts(e,i.text,a.text),t=this.migrateOffsetsBetweenTexts(t,i.text,a.text),n=this.migrateOffsetsBetweenTexts(n,i.text,a.text),s=this.migrateOffsetsBetweenTexts(s,i.text,a.text)):(e=this.migrateOffsetsBetweenTexts(e,l,!0),t=this.migrateOffsetsBetweenTexts(t,l,!0),n=this.migrateOffsetsBetweenTexts(n,l,!0),s=this.migrateOffsetsBetweenTexts(s,l,!0)),{errors:e,pickyErrors:t,premiumErrors:n,premiumPickyErrors:s,sentenceRanges:r=this.migrateOffsetsBetweenTexts(r,l,!0)}}static mergeParagraphLevelErrors(e,t,n,s,r,i,a,o,l,c=[]){e.push(...i),t.push(...a),n.push(...o),s.push(...l),r.push(...c)}static mergeTextLevelErrors(e,t,n,s,r,i,a,o){for(const t of r)e.some((e=>e.start===t.start&&e.end===t.end))||e.push(t);for(const e of i)t.some((t=>t.start===e.start&&t.end===e.end))||t.push(e);for(const e of a)n.some((t=>t.start===e.start&&t.end===e.end))||n.push(e);for(const e of o)s.some((t=>t.start===e.start&&t.end===e.end))||s.push(e)}static sortErrors(e,t,n,s){this.sortErrorsByOffset(e),this.sortErrorsByOffset(t),this.sortErrorsByOffset(n),this.sortErrorsByOffset(s)}static sortErrorsByOffset(e){e.sort(((e,t)=>e.start===t.start?e.isParagraphLevelCheck?1:-1:e.start>t.start?1:-1))}static migrateErrorsBetweenSameOriginalTexts(e,t,n){const s=[];for(const r of e){let e=r.start,i=r.end,a=f(t.usedParts,(t=>D(e,t.originalStart,t.originalEnd,!0))),o=f(t.usedParts,(e=>D(i,e.originalStart,e.originalEnd)));if(!a||!o)continue;if(e-=a.posDiff,i-=o.posDiff,a=f(n.usedParts,(t=>D(e,t.start,t.end,!0))),o=f(n.usedParts,(e=>D(i,e.start,e.end))),!a||!o)continue;e+=a.posDiff,i+=o.posDiff;const l=T(r);l.start=e,l.end=i,l.length=i-e,s.push(l)}return s}static setIdsOnErrors(e,t,n,s,r){function i(e,t){if(e.id)return;const n=t.find((t=>{return s=e,(n=t).start===s.start&&n.end===s.end&&n.isParagraphLevelCheck===s.isParagraphLevelCheck;var n,s}));e.id=n?n.id:"error:"+ ++ge.INCREMENTAL_ID}e.forEach((e=>i(e,r.errors))),t.forEach((e=>i(e,r.pickyErrors))),n.forEach((e=>i(e,r.premiumErrors))),s.forEach((e=>i(e,r.premiumPickyErrors)))}static sortSentenceRanges(e){e.sort((({start:e},{start:t})=>e-t))}}ge.INCREMENTAL_ID=0;
/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
class ue{constructor(e=document){this._window=e.defaultView,this._document=e,this.clearCache()}_getElementCache(e){let t=this._elementCache.get(e);return t||(t={},this._elementCache.set(e,t)),t}_consolidateSVGTransformMatrix(e){const t={a:1,b:0,c:0,d:1,e:0,f:0};for(let n=0;n<e.transform.baseVal.length;n++){const s=e.transform.baseVal[n];1===s.type?(t.a=s.matrix.a,t.b=s.matrix.b,t.c=s.matrix.c,t.d=s.matrix.d,t.e=s.matrix.e,t.f=s.matrix.f):2===s.type?(t.e=s.matrix.e,t.f=s.matrix.f):3===s.type?(t.a=s.matrix.a,t.d=s.matrix.d):5===s.type?t.b=s.matrix.b:6===s.type&&(t.c=s.matrix.c)}return t}clearCache(){this._documentVisibleBox=null,this._documentGap=null,this._documentScroll=null,this._elementCache=new WeakMap}_contains(e,t){return e&&e!==t&&e.contains(t)}_getComputedStyle(e,t,n){let s,r;return"object"==typeof t?(s=t,r=""):(s=n,r=t),s.computedStyle||(s.computedStyle=new Map),s.computedStyle.has(r)||s.computedStyle.set(r,this._window.getComputedStyle(e,r||null)),s.computedStyle.get(r)}getComputedStyle(e,t=""){return this._getComputedStyle(e,t,this._getElementCache(e))}_getComputedStyleMap(e,t){return e.computedStyleMap?(t.computedStyleMap||(t.computedStyleMap=e.computedStyleMap()),t.computedStyleMap):null}getComputedStyleMap(e){return this._getComputedStyleMap(e,this._getElementCache(e))}getInlineStyle(e,t){return e.style instanceof CSSStyleDeclaration?e.style.getPropertyValue(t):""}getStyle(e,t,n){let s,r;return"string"==typeof n?(s=t,r=n):(s="",r=t),this.getStyles(e,s,[r])[r]}getStyles(t,n,s){const r="string"==typeof n?n:"",i=this._getElementCache(t),a=this._getComputedStyle(t,r,i);let o=null;if(Array.isArray(n))o=n;else if(Array.isArray(s))o=s;else{o=[];for(let e=0;e<a.length;e++)o.push(a[e])}const l={};for(const n of o)if("line-height"===n||"lineHeight"===n){const e=this.getInlineStyle(t,n);e&&e.includes("px")?l[n]=e:l[n]=a[n]||""}else if("font"!==n||a[n])if("transform"===n&&t instanceof SVGGElement&&e.isSafari()&&t.hasAttribute("transform")){const e=this._consolidateSVGTransformMatrix(t);l[n]=`matrix(${e.a}, ${e.b}, ${e.c}, ${e.d}, ${e.e}, ${e.f})`}else l[n]="zoom"===n?a[n]||"1":a[n]||"";else{const e=a["font-style"],s=a["font-variant"],r=a["font-weight"],i=a["font-size"],o=this.getInlineStyle(t,"line-height")||a["line-height"]||"",c=a["font-family"];l[n]=`${e} ${s} ${r} ${i} ${o?"/ "+o:""} ${c}`}return l}getExactStyle(e,t){return this.getExactStyles(e,[t])[t]}getExactStyles(e,t){const n=this._getElementCache(e),s=this._getComputedStyleMap(e,n);if(s){const e={};for(const n of t){const t=s.get(n);t?"number"==typeof(r=t).value&&"string"==typeof r.unit?"number"===t.unit?e[n]=t.value.toString():e[n]=t.value+t.unit:e[n]=t.toString():e[n]=""}return e}return this.getStyles(e,t);var r}setStyle(e,t,n,s=!1){Array.isArray(e)||(e=[e]);const r={[t]:n};this.setStyles(e,r,s)}setStyles(e,t,n=!1){Array.isArray(e)||(e=[e]);for(const s of e)for(const e in t){let r=t[e].trim();const i=n||ue.IMPORTANT_REG_EXP.test(r);r=r.replace(ue.IMPORTANT_REG_EXP,""),s.style.setProperty(e,r,i?"important":"")}}copyStyles(e,t,n,s=!1){const r=this.getStyles(e,n);this.setStyles(t,r,s)}resetStyles(e,t,n=!1){Array.isArray(e)||(e=[e]);let s="";for(const e in t){let r=t[e].trim();n&&!ue.IMPORTANT_REG_EXP.test(r)&&(r+=" !important"),s+=`${e}: ${r};`}for(const t of e)t.style.cssText=s}removeStyle(e,t){Array.isArray(e)||(e=[e]),this.removeStyles(e,[t])}removeStyles(e,t){Array.isArray(e)||(e=[e]);for(const n of e)for(const e of t)n.style.removeProperty(e)}_getBoundingClientRect(e,t){return t.boundingClientRect||(t.boundingClientRect=T(e.getBoundingClientRect())),t.boundingClientRect}getRelativeClientRect(e,t){const n=this._getBoundingClientRect(e,this._getElementCache(e)),s=this._getBoundingClientRect(t,this._getElementCache(t)),r=n.top-s.top,i=n.left-s.left,a=n.width,o=n.height;return{top:r,right:i+a,bottom:r+o,left:i,width:a,height:o}}_getBorderBox(e,t,n,s){const r="borderBox"+(t?"WithScroll":"")+(n?"WithScale":"");if(!s[r]){const i=this._getBoundingClientRect(e,s);let{top:a,left:o,width:l,height:c}=i;if(n){const t=this.getZoom(e);a*=t,o*=t,l*=t,c*=t}else{const t=this._getScaleFactor(e,s);l/=t.x,c/=t.y}if(t){const t=this.getDocumentScroll();if(a+=t.top,o+=t.left,this._document.body&&this._contains(this._document.body,e)){const e=this.getDocumentGap();a-=e.top,o-=e.left}}s[r]={top:a,right:o+l,bottom:a+c,left:o,width:l,height:c}}return s[r]}getBorderBox(e,t=!0,n=!0){return this._getBorderBox(e,t,n,this._getElementCache(e))}_getPaddingBox(e,t,n,s){const r="paddingBox"+(t?"WithScroll":"")+(n?"WithScale":"");if(!s[r]){let{top:i,left:a,width:o,height:l}=this._getBorderBox(e,t,n,s),c={x:1,y:1};n&&(c=this._getScaleFactor(e,s));const d=n?this._getZoom(e,s):1,g=this._getComputedStyle(e,s),u=(parseFloat(g["border-top-width"])||0)*c.y*d,m=(parseFloat(g["border-right-width"])||0)*c.x*d,h=(parseFloat(g["border-bottom-width"])||0)*c.y*d,E=(parseFloat(g["border-left-width"])||0)*c.x*d;let _=0,p=0;if("BackCompat"!==this._document.compatMode||e!==this._document.body||e!==this._document.scrollingElement){let{width:t,height:n}=this._getClientWidthAndHeight(e,s);t=t*c.x*d,n=n*c.y*d;let r=o;r%1>0&&"offsetWidth"in e&&(r=e.offsetWidth*c.x*d);let i=l;i%1>0&&"offsetHeight"in e&&(i=e.offsetHeight*c.y*d),_=r-E-t-m,p=i-u-n-h,_<1&&(_=0),p<1&&(p=0)}i+=u,a+=E,o=o-E-_-m,l=l-u-p-h,this._isRTL(e,s)&&(a+=_),s[r]={top:i,right:a+o,bottom:i+l,left:a,width:o,height:l,border:{top:u,right:m,bottom:h,left:E}}}return s[r]}getPaddingBox(e,t=!0,n=!0){return this._getPaddingBox(e,t,n,this._getElementCache(e))}_getContentBox(e,t,n,s){const r="contentBox"+(t?"WithScroll":"")+(n?"WithScale":"");if(!s[r]){let{top:i,left:a,width:o,height:l,border:c}=this._getPaddingBox(e,t,n,s),d={x:1,y:1};n&&(d=this._getScaleFactor(e,s));const g=n?this._getZoom(e,s):1,u=this._getComputedStyle(e,s),m=(parseFloat(u["padding-top"])||0)*d.y*g,h=(parseFloat(u["padding-right"])||0)*d.x*g,E=(parseFloat(u["padding-bottom"])||0)*d.y*g,_=(parseFloat(u["padding-left"])||0)*d.x*g;i+=m,a+=_,o=o-_-h,l=l-m-E,s[r]={top:i,right:a+o,bottom:i+l,left:a,width:o,height:l,border:c,padding:{top:m,right:h,bottom:E,left:_}}}return s[r]}getContentBox(e,t=!0,n=!0){return this._getContentBox(e,t,n,this._getElementCache(e))}_getClientWidthAndHeight(e,t){let n=e.clientWidth,s=e.clientHeight;if(0===n&&0===s&&"offsetWidth"in e){const r=this._getComputedStyle(e,t);"inline"===r.display&&(n=e.offsetWidth-parseInt(r["border-left-width"])-parseInt(r["border-right-width"]),s=e.offsetHeight-parseInt(r["border-top-width"])-parseInt(r["border-bottom-width"]))}return{width:n,height:s}}_getScrollDimensions(e,t,n){const s="scrollDimensions"+(t?"WithScale":"");if(!n[s]){let r=e.scrollWidth,i=e.scrollHeight;if(0===r&&(0===i||0===e.clientHeight)){const t=this._getClientWidthAndHeight(e,n);r=t.width,i=t.height}if(t){const t=this._getScaleFactor(e,n),s=this._getZoom(e,n);r=r*t.x*s,i=i*t.y*s}n[s]={width:r,height:i}}return n[s]}getScrollDimensions(e,t=!0){return this._getScrollDimensions(e,t,this._getElementCache(e))}_getScrollPosition(e,t,n,s){const r="scrollPosition"+(t?"WithScale":"")+(n?"WithZoom":"");if(!s[r]){let i={x:1,y:1};t&&(i=this._getScaleFactor(e,s));const a=n?this._getZoom(e,s):1,o=e===this._document.body&&"BackCompat"===this._document.compatMode,l=o?0:e.scrollTop*i.y*a,c=o?0:e.scrollLeft*i.x*a;s[r]={top:l,left:c}}return s[r]}getScrollPosition(e,t=!0,n=t){return this._getScrollPosition(e,t,n,this._getElementCache(e))}_isPositionFixed(e,t){if(void 0===t.isPositionFixed){t.isPositionFixed=!1;let n=e;for(;n;){if("fixed"===this.getStyle(n,"position")){t.isPositionFixed=!0;break}n=n.parentElement}}return t.isPositionFixed}isPositionFixed(e){return this._isPositionFixed(e,this._getElementCache(e))}_getContainingBlock(t,n,s){const r="absolute"===n,i=r?"containingBlockForAbsolutePosition":"containingBlockForFixedPosition";let a=s[i];if(void 0===a){a=null;const n=[document.documentElement,document.body],s=["layout","paint","strict","content"],i=["transform","perspective"];let o=t;for(;o&&!n.includes(o);){const t=this.getStyles(o,["position","transform","perspective","will-change","filter","contain","container-type","backdrop-filter"]);if(r&&"static"!==t.position||"none"!==t.transform||"none"!==t.perspective||"none"!==t.filter||s.includes(t.contain)||i.includes(t["will-change"])||"normal"!==t["container-type"]||"none"!==t["backdrop-filter"]&&""!==t["backdrop-filter"]||e.isFirefox()&&"filter"===t["will-change"]){a=this.getPaddingBox(o);break}o=o.parentElement}}return s[i]=a,a}getContainingBlock(e,t="absolute"){return this._getContainingBlock(e,t,this._getElementCache(e))}getScaleFactor(e){return this._getScaleFactor(e,this._getElementCache(e))}_getScaleFactor(e,t){if(void 0===t.scaleFactor){if(e instanceof SVGElement){let t=1;const n=e.getAttribute("transform")||"",s=/scale\((\d+(\.\d+)?)\)/.exec(n);return s&&(t=+s[1]),{x:t,y:t}}{const n=this._getBoundingClientRect(e,t),s=e.offsetWidth,r=e.offsetHeight;t.scaleFactor={x:1,y:1},n.width>0&&s>0&&Math.abs(n.width-s)>1&&(t.scaleFactor.x=n.width/s),n.height>0&&r>0&&Math.abs(n.height-r)>1&&(t.scaleFactor.y=n.height/r)}}return t.scaleFactor}_getZoom(t,n){if(e.isFirefox()||e.isThunderbird())return 1;if("number"!=typeof n.zoom){let e=1,s=t;for(;s&&s!==this._document.documentElement;){e*=+this.getStyle(s,"zoom"),s=s.parentNode instanceof ShadowRoot&&s.parentNode.host instanceof HTMLElement?s.parentNode.host:s.parentElement}n.zoom=e}return n.zoom}getZoom(e){return this._getZoom(e,this._getElementCache(e))}_getStackingContextWithZIndex(e){const t=this.getComputedStyle(e),n=parseInt(t.zIndex||"");if(isNaN(n))return null;if(t.position&&ue.NON_STATIC_POSITIONS.indexOf(t.position)>-1)return{zIndex:n};if(e.parentElement){const t=this.getComputedStyle(e.parentElement);if("flex"===t.display||"grid"===t.display)return{zIndex:n}}return null}getZIndex(e,t=this._document.documentElement){let n="auto",s=e;if(!s.ownerDocument)return"auto";const r=s.ownerDocument.defaultView;if(!r)throw new Error("Failed to retrieve the current element's window object.");const{Element:i,ShadowRoot:a}=r;for(;s&&s!==this._document&&s!==t&&s instanceof i;){const e=this._getStackingContextWithZIndex(s);e&&(n=e.zIndex),s=s.parentNode instanceof a?s.parentNode.host:s.parentElement}return n}_isRTL(e,t){return"boolean"!=typeof t.isRTL&&(t.isRTL="rtl"===this.getStyle(e,"direction")),t.isRTL}isRTL(e){return this._isRTL(e,this._getElementCache(e))}isStackingContext(e){const t=this.getComputedStyle(e);return!!(t.position&&ue.NON_STATIC_POSITIONS.indexOf(t.position)>-1)||("none"!==t.transform||"none"!==t.filter||"none"!==t.clipPath||"none"!==t.perspective||Number(t.opacity)<1)}_getTextClientRects(e){const t=this._document.createRange();return t.setStart(e.node,e.start),t.setEnd(e.node,e.end),Array.from(t.getClientRects())}getTextBoundingBoxes(e,t,n=!0){Array.isArray(e)||(e=[e]);const s=[];let r=0,i=0;if(n){const e=this.getDocumentScroll();if(r+=e.top,i+=e.left,this._document.body&&this._contains(this._document.body,t)){const e=this.getDocumentGap();r-=e.top,i-=e.left}}for(const t of e)try{const e=this._getTextClientRects(t);for(const t of e){if(t.width<ue.MIN_TEXT_BOX_WIDTH)continue;const e=s[s.length-1],n=t.top+r,a=t.right+i,o=t.bottom+r,l=t.left+i,c=t.width,d=t.height;e&&e.right===l&&e.top===n&&e.bottom===o&&e.height===d?(e.right=a,e.width=e.width+c):s.push({top:n,right:a,bottom:o,left:l,width:c,height:d})}}catch(e){}return s}getRelativeTextBoundingBoxes(e,t,n=this.getScrollPosition(t)){Array.isArray(e)||(e=[e]);const s=[],r=this.getPaddingBox(t,!1,!1),i=r.left-n.left,a=r.top-n.top;for(const t of e)try{const e=this._getTextClientRects(t);for(const t of e){if(t.width<ue.MIN_TEXT_BOX_WIDTH)continue;const e=s[s.length-1],n=t.top-a,r=t.right-i,o=t.bottom-a,l=t.left-i,c=t.width,d=t.height;e&&e.right===l&&e.top===n&&e.bottom===o&&e.height===d?(e.right=r,e.width=e.width+c):s.push({top:n,right:r,bottom:o,left:l,width:c,height:d})}}catch(e){console.error("LT range error",e)}const o=this.getScaleFactor(t);for(const e of s)e.top=Math.round(e.top/o.y),e.right=Math.round(e.right/o.x),e.bottom=Math.round(e.bottom/o.y),e.left=Math.round(e.left/o.x),e.width=e.right-e.left,e.height=e.bottom-e.top;return s}getRelativeTextBoundingBox(e,t){const n=this.getRelativeTextBoundingBoxes(e,t),s=Math.min(...n.map((e=>e.top))),r=Math.max(...n.map((e=>e.right))),i=Math.max(...n.map((e=>e.bottom))),a=Math.min(...n.map((e=>e.left)));return{top:s,right:r,bottom:i,left:a,width:r-a,height:i-s}}_hasRelativePosition(e,t){const n=this._getComputedStyle(e,t).position||"static";return ue.NON_STATIC_POSITIONS.indexOf(n)>-1}getDocumentGap(){if(!this._documentGap&&(this._documentGap={top:0,left:0},this._document.body&&this._hasRelativePosition(this._document.body,this._getElementCache(this._document.body)))){const t=this.getBorderBox(this._document.documentElement),n=this.getBorderBox(this._document.body);let s=this._document.documentElement.offsetTop,r=this._document.documentElement.offsetLeft;if(e.isFirefox()||e.isThunderbird()){let e=null;0===s&&(e=this.getComputedStyle(this._document.documentElement),s=parseInt(e["margin-top"])||0),0===r&&(e=e||this.getComputedStyle(this._document.documentElement),r=parseInt(e["margin-left"])||0)}const i=n.top-t.top+s,a=n.left-t.left+r,o=this.getComputedStyle(this._document.body),l=parseFloat(o["border-top-width"])||0,c=parseFloat(o["border-left-width"])||0;this._documentGap={top:i+l,left:a+c}}return this._documentGap}getDocumentVisibleBox(){if(!this._documentVisibleBox){const t=this.getDocumentScroll();let n=this._document.documentElement.clientHeight,s=this._document.documentElement.clientWidth;e.isThunderbird()&&(n=self.innerHeight,s=self.innerWidth),this._documentVisibleBox={top:t.top,right:t.left+s,bottom:t.top+n,left:t.left,width:s,height:n}}return this._documentVisibleBox}getDocumentScroll(){if(!this._documentScroll){const e=this._document.documentElement&&this._document.documentElement.scrollTop||this._document.body&&this._document.body.scrollTop||0,t=this._document.documentElement&&this._document.documentElement.scrollLeft||this._document.body&&this._document.body.scrollLeft||0;this._documentScroll={top:e,left:t}}return this._documentScroll}}ue.IMPORTANT_REG_EXP=/!important$/,ue.TRANSFORM_MATRIX_REG_EXP=/(?:matrix|scale)\(([\d\.]+),/,ue.NON_STATIC_POSITIONS=["relative","fixed","absolute","sticky"],ue.MIN_TEXT_BOX_WIDTH=.1;var me=n(131),he=n.n(me);function Ee(){return he()}
/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
F.get(M.EXTN_PREFIX);function _e(e=25,t){return new Promise((n=>setTimeout((()=>n(t)),e)))}function pe(e,t){let n=null,s=!1;const r=()=>{n=function(e,t){let n=null,s=!1;const r=self.setTimeout((()=>{s||(n=requestAnimationFrame((()=>e())))}),t);return{destroy:()=>{s=!0,clearTimeout(r),n&&cancelAnimationFrame(n)}}}((()=>{s||(e(),r())}),t)};return r(),{destroy:()=>{s=!0,n&&(n.destroy(),n=null)}}}function fe(e,t){"string"==typeof e&&(e=document.querySelector(e)),"string"==typeof t&&(t={key:t}),t.isHTML?e.innerHTML=ie.getMessage(t.key,t.interpolations):t.attr&&t.attr in e?e[t.attr]=ie.getMessage(t.key,t.interpolations):t.attr?e.setAttribute(t.attr,ie.getMessage(t.key,t.interpolations)):e.textContent=ie.getMessage(t.key,t.interpolations)}function Ae(e){Array.from(e.querySelectorAll("[data-t]")).forEach((e=>{fe(e,e.getAttribute("data-t"))})),Array.from(e.querySelectorAll("[data-t-placeholder]")).forEach((e=>{fe(e,{key:e.getAttribute("data-t-placeholder"),attr:"placeholder"})})),Array.from(e.querySelectorAll("[data-t-html]")).forEach((e=>{fe(e,{key:e.getAttribute("data-t-html"),isHTML:!0})})),Array.from(e.querySelectorAll("[data-t-title]")).forEach((e=>{fe(e,{key:e.getAttribute("data-t-title"),attr:"title"})})),Array.from(e.querySelectorAll("[data-t-attr]")).forEach((e=>{const[t,n]=(e=>{const t=String(e.getAttribute("data-t-attr"));try{const e=JSON.parse(t);if((e=>Array.isArray(e)&&"string"==typeof e[0]&&"string"==typeof e[1]&&2===e.length)(e))return e;throw Error()}catch{return["",""]}})(e);t&&n&&fe(e,{key:n,attr:t})}))}(()=>{const e=(e,t,n,s)=>{const r=e.ownerDocument;let i=r.elementFromPoint(n,s);if(!i)return!1;if(e===i||e.contains(i))return!0;if(!t.length)return!1;return t.find((e=>e.contains(i)))&&(i=r.elementsFromPoint(n,s).find((e=>!1===t.some((t=>t.contains(e)))))||null),Boolean(i&&(e===i||e.contains(i)))}})();function Se(e,t){let n=1;const s=new ue(e.ownerDocument),r=pe((()=>{if(n-=.08,n<=0)return r.destroy(),void(t&&t());s.setStyles(e,{opacity:n+" !important"})}),16)}function Te(e,t,n){const s=new CustomEvent(t,{detail:n,cancelable:!0});return e.dispatchEvent(s)}function Ie(e,t,n){const s=e.nodeType===Node.DOCUMENT_NODE?e:e.ownerDocument;const r=t=>{const s=function(e){if("function"==typeof e.composedPath){const t=e.composedPath();if(t[0])return t[0]}return e.target}(t);(function(e){return e.nodeType===Node.ELEMENT_NODE}(s)||function(e){return e.nodeType===Node.TEXT_NODE}(s))&&e.contains(s)&&n(t)};return s.defaultView.addEventListener(t,r,!0),{destroy(){s.defaultView.removeEventListener(t,r,!0)}}}(()=>{let e;const t=[]})(),(()=>{let e;const t=[]})();function ye(e){if(e.ownerDocument&&e.ownerDocument.contains(e))return!0;let t=e;for(;t&&t.parentNode;){if(t.parentNode===document)return!0;t.parentNode instanceof DocumentFragment?t.parentNode.host:t.parentNode}return!1}new Set(["article","aside","blockquote","body","div","footer","h1","h2","h3","h4","h5","h6","header","main","nav","p","section","span"]);function Ce(e,t,n,s=Date.now().toString()){const r=self,i=void 0!==r.screenLeft?r.screenLeft:r.screenX,a=void 0!==r.screenTop?r.screenTop:r.screenY,o=r.innerWidth?r.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,l=r.innerHeight?r.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,c=o/r.screen.availWidth,d=(o-t)/2/c+i,g=(l-n)/2/c+a;return r.open(e,s,`\n      scrollbars=yes,\n\t  resizable=yes,\n      width=${t/c},\n      height=${n/c},\n      top=${g},\n      left=${d}\n      `)}const Re=function(){let e,t=null;const n=t=>{t.origin.match(/^chrome|moz|safari/)&&e(t.data)};return function(s,r){const i=self;let a=null;e=function(e){const[t,n]=JSON.parse(e);t&&n&&(o(),r(t,n))};const o=function(){t&&clearInterval(t),i.removeEventListener("message",n);try{Ee().storage.local.remove("managedLoginCredentials")}catch(e){}try{a&&a.close()}catch(e){}};o(),t=self.setInterval((()=>{Ee().storage.local.get("managedLoginCredentials").then((t=>{t.managedLoginCredentials&&e(t.managedLoginCredentials)})).catch((()=>null))}),400),i.addEventListener("message",n);const l=Ee().runtime.getURL("/welcome/managedLoginRedirectUri.html"),c=new URL(s);c.searchParams.set("redirect_uri",l),a=Ce(c.toString(),640,480)}}(),Ne=function(){let e,t=null;const n=t=>{e(t.data)};return function(s,r){const i=self;let a=null;e=function(e){const[t,n]=JSON.parse(e);t&&n&&(o(),r(t,n))};const o=function(){t&&clearInterval(t),i.removeEventListener("message",n);try{Ee().storage.local.remove("loginCredentials")}catch(e){}try{a&&a.close()}catch(e){}};o(),t=self.setInterval((()=>{Ee().storage.local.get("loginCredentials").then((t=>{t.loginCredentials&&e(t.loginCredentials)})).catch((()=>null))}),400),i.addEventListener("message",n);const l=Ee().runtime.getURL("/welcome/loginRedirectUri.html"),c=new URL(s);c.searchParams.set("callback_uri",l),a=Ce(c.toString(),640,480,"lt-login-"+Date.now())}}();Array.from({length:16},((e,t)=>t.toString(16)));const Le=/^(https?:\/\/)?localhost(:[0-9]{1,5})?(\/.*)?$/i,Oe=/^(https?:\/\/)?[a-z0-9]+([-.]{1}[a-z0-9]+)*\.[a-z]{2,15}(:[0-9]{1,5})?(\/.*)?$/i,Pe=/^(?:https?:\/\/)?(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])(?:\.(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])){3}(?::[0-9]{1,5})?$/;function be(e){return Le.test(e)||Oe.test(e)||Pe.test(e)}function ve(e){return e.length>0&&e.every((e=>be(e)))}function De(e){return e.filter((e=>be(e)))}new Map([["paraphrase","rephrase"],["correct","correct"]]),new Map([["hover","hover"],["click","click"],["toolbar","click"],["dblClick","click"],["dblPress","click"]]);
/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
class xe{static getServerBaseUrl(e,t=!1,n=!0){const s=n&&(t?this._useFallbackServerForParagraphLevelRequests:this._useFallbackServerForTextLevelRequests)&&!e.apiServerUrl;return e.apiServerUrl&&!this._isLanguageToolServer(e.apiServerUrl)?e.apiServerUrl:e.isPremium||e.user||e.apiServerUrl===H?s?"https://languagetoolplus.com/api/v2":H:s?"https://api-fallback.languagetool.org/v2":W}static _getServerFullUrl(e,t=!1,n=!1){const s=this.getServerBaseUrl(e,t),r=s.endsWith("/")?"":"/",i=new URL(s+r+"check");return i.searchParams.set("c","1"),t&&!1===e.useParagraphLevelCaching||i.searchParams.set("instanceId",e.instanceId),n&&i.searchParams.set("languageChanged","true"),e.version&&i.searchParams.set("v",e.version),i.toString()}static _abortTextLevelCheckRequest(e){this._textLevelAbortControllers.has(e)&&(this._textLevelAbortControllers.get(e).abort(),this._textLevelAbortControllers.delete(e))}static _abortParagraphLevelCheckRequest(e){this._paragraphLevelAbortControllers.has(e)&&(this._paragraphLevelAbortControllers.get(e).abort(),this._paragraphLevelAbortControllers.delete(e))}static _abortLanguageDetectionRequest(e){this._languageDetectionAbortControllers.has(e)&&(this._languageDetectionAbortControllers.get(e).abort(),this._languageDetectionAbortControllers.delete(e))}static _prepareText(e){return e.replace(this.ZWNJ_REGEXP,this.ZWS)}static _joinInChunks(e,t=5e3){const n=[];let s=0,r=[];return e.forEach((e=>{s>t&&(s=0,r=[]),r.push(e),s+=e.text.length,n.includes(r)||n.push(r)})),n}static _getRequestData(e,t,n){const s=new URLSearchParams,r={text:e};n.recipientInfo&&(n.recipientInfo.address||n.recipientInfo.fullName)&&(r.metaData={EmailToAddress:n.recipientInfo.address,FullName:n.recipientInfo.fullName}),s.append("data",JSON.stringify(r));const i=Boolean(n.isPremium||!n.apiServerUrl||n.apiServerUrl&&n.apiServerUrl.startsWith(H)||n.apiServerUrl&&!this._isLanguageToolServer(n.apiServerUrl));if(i&&n.user&&"password"in n.user?(s.append("username",n.user.email),s.append("password",n.user.password)):i&&n.user&&"token"in n.user&&(s.append("username",n.user.email),s.append("tokenV2",n.user.token)),s.append("textSessionId",n.instanceId),n.isPremium||s.append("enableHiddenRules","true"),n.motherTongue&&Q.includes(n.motherTongue)&&s.append("motherTongue",n.motherTongue),"normal"!==n.checkLevel&&s.append("level",n.checkLevel.replace("hidden-","")),t)s.append("language",t.code);else{s.append("language","auto"),s.append("noopLanguages",n.preferredLanguages.join(","));const e=this._getPreferredVariants(n.languageVariants.en,n.languageVariants.de,n.languageVariants.pt,n.languageVariants.ca);e.length>0&&s.append("preferredVariants",e.toString())}if(n.testGroups){const e=[];for(const[t,s]of Object.entries(n.testGroups))s&&e.push(t);e.length&&s.append("abtest",e.join(","))}if(s.append("preferredLanguages",n.preferredLanguages.join(",")),n.forcePreferredLanguages&&s.append("forcePreferredLanguages","true"),n.writingGoalId){const e=this.HIGH_LEVEL_GOALS.find((e=>e.id===n.writingGoalId));e&&s.append("toneTags",e.tags.join(","))}const a=["WHITESPACE_RULE"].concat(n.disabledRules.filter((e=>J.includes(e))));return s.append("disabledRules",a.join(",")),n.userAgent&&s.append("useragent",n.userAgent),s}static _getPreferredVariants(e,t,n,s){const r=[];return e&&r.push(e),t&&r.push(t),n&&r.push(n),s&&r.push(s),r}static _getTextLevelRequestData(e,t,n){const s=this._getRequestData(e,t,n);return s.append("mode","textLevelOnly"),s}static _getParagraphLevelCheckRequestData(e,t,n,s){const r=this._getRequestData(e,t,n);return r.append("mode","allButTextLevelOnly"),r.append("allowIncompleteResults",String(s)),r}static async _sendRequest(e,t,n=5e4){const s=fetch(e,t).catch((t=>{throw"AbortError"===t.name?{reason:"AbortError",status:0,response:t.message||""}:{reason:"ConnectionError",status:0,url:e.replace(/\?.*/,""),response:t.message||""}})).then(this._checkForException).then((e=>e.json())),r=new Promise(((t,s)=>{setTimeout((()=>{s({reason:"TimeoutError",status:0,url:e.replace(/\?.*/,""),response:""})}),n)}));return Promise.race([s,r])}static _isConnectionOrServerIssue(e){return X.includes(e.status)||["ConnectionError","TimeoutError"].includes(e.reason)}static _getGraphemesCount(e,t,n=0){for(let s=n;s<e.length;s++){if(t<=0)return s-n;t-=e[s].length}return e.length-n}static _getCodepointsCount(e,t,n=0){let s=0;for(let r=n;r<Math.min(e.length,n+t);r++)s+=e[r].length;return s}static _correctMatches(e,t,n){if(t!==n){const s=C(t),r=C(n);for(const t of e){const e=xe._getGraphemesCount(s,t.offset),n=xe._getGraphemesCount(s,t.length,e);t.offset=xe._getCodepointsCount(r,e),t.length=xe._getCodepointsCount(r,n,e)}}return e}static _getLeftText(e,t,n,s=15){let r=Math.max(t-s,0);if(n){const n=e.lastIndexOf("\n",t);n>=r&&(r=n+1)}let i=e.substring(r,t).replace(this.NON_ALPHANUMERIC_AT_BEGINNING_REGEXP,"");return 0===r||n&&"\n"===e[r-1]||(i="..."+i),i}static _getRightText(e,t,n,s=15){let r=Math.min(t+s,e.length);if(n){const n=e.indexOf("\n",t);-1!==n&&n<=r&&(r=n)}let i=e.substring(t,r).replace(this.NON_ALPHANUMERIC_AT_END_REGEXP,"");return r===e.length||n&&"\n"===e[r]||(i+="..."),i}static _transformMatches(e,t,n,s=!1){return e.map((e=>{const r=e.rule.id.startsWith("DB_"),i=this.SPELLING_RULES_ID.some((t=>e.rule.id.includes(t))),a=this.STYLE_ISSUE_TYPES.some((t=>e.rule.issueType===t)),o="typographical"===e.rule.issueType&&"CASING"!==e.rule.category.id||"PUNCTUATION"===e.rule.category.id||"TYPOGRAPHY"===e.rule.category.id||e.rule.category.id.includes("KOMMA"),l=Boolean(e.rule.tags&&e.rule.tags.includes("picky")),c="RECOMMENDATION"===e.rule.issueType,d=t.substr(e.offset,e.length),g=`${xe._getLeftText(t,e.offset,s)}|${d}|${xe._getRightText(t,e.offset+e.length,s)}`,u=xe._getLeftText(t,e.offset,!0,60),m=xe._getRightText(t,e.offset+e.length,!0,60),h=`${p(u)}<lt-em>${p(d)}</lt-em>${p(m)}`;let E="";e.shortMessage&&e.shortMessage.length<60&&e.shortMessage!==e.message&&(E=e.shortMessage.replace(this.PUNCTUATION_AT_END,""));const _=e.replacements.map((e=>({value:e.value,prefix:e.prefix,suffix:e.suffix,type:e.type,shortDescription:e.shortDescription})));return{isParagraphLevelCheck:s,rule:e.rule,isCustomError:r,isSpellingError:i,isStyleError:a,isPunctuationError:o,isPicky:l,isRecommendation:c,contextForSureMatch:e.contextForSureMatch,language:{code:n.code,name:n.name},description:e.message,shortDescription:E,goodExample:e.goodExample,badExample:e.badExample,start:e.offset,end:e.offset+e.length,length:e.length,originalPhrase:d,contextPhrase:g,longContextPhrase:h,fixes:_}}))}static _adjustErrors(e,t,n){const s=n.recipientInfo?n.recipientInfo.fullName.split(" ").filter((e=>e)):[];return e.filter((e=>{e.fixes=e.fixes.filter((t=>t.value!=="("+e.originalPhrase+")"&&t.value!==e.originalPhrase&&"(suggestion limit reached)"!==t.value&&"(se ha alcanzado el límite de sugerencias)"!==t.value&&"(Vorschlagslimit erreicht)"!==t.value)),e.language.code.startsWith("en")&&c(e.originalPhrase)&&!/[a-z]/i.test(e.contextPhrase)&&e.fixes.forEach((t=>{t.value.toLowerCase()!==e.originalPhrase.toLowerCase()&&(t.value=t.value.toUpperCase())})),"PT_CLICHE_REPLACE"!==e.rule.id&&"PT_WORDINESS_REPLACE"!==e.rule.id||e.fixes.forEach((t=>{(t.value.startsWith("REFORMULAR")||t.value.startsWith("APAGAR")||t.value.startsWith("ESPECIFICAR"))&&(e.description=e.description.replace(/\sÉ preferível dizer.+(REFORMULAR|APAGAR|ESPECIFICAR).+$/,""),t.value="")}));if(this.EMAIL_SIGNATURE_SEPARATOR_REGEXP.test(e.originalPhrase))return!1;if(this.ZWS_REGEXP.test(e.originalPhrase))return!1;if(e.rule.id.endsWith("WORD_REPEAT_BEGINNING_RULE")&&this.ONLY_NUMBERS_REGEXP.test(e.originalPhrase))return!1;if("LEERZEICHEN_HINTER_DOPPELPUNKT"===e.rule.id&&this.COLON_WHITESPACE_REGEXP.test(e.originalPhrase))return!1;const r=t.substring(e.start-25,e.start),i=t.substr(e.end,25);if(n.ignoreCapitalizationErrorsAtLineStart&&"UPPERCASE_SENTENCE_START"===e.rule.id&&this.PREVENT_MID_SENTENCE_CAPITALIZATION.test(r))return!1;if(n.ignoreCapitalizationErrorsAtLineStart&&"PUNCTUATION_PARAGRAPH_END"===e.rule.id&&this.PREVENT_MID_SENTENCE_PUNCTUATION.test(i))return!1;if("DE_CASE"===e.rule.id&&this.BULLET_POINT_REGEXP.test(r))return!1;if("DE_CASE"===e.rule.id&&this.NUMBER_WITH_PARENTHESIS_AT_END_REGEXP.test(r))return!1;if("DE_CASE"===e.rule.id&&this.PIPE_AT_END_REGEXP.test(r))return!1;if("DE_CASE"===e.rule.id&&this.MARKDOWN_HEADLINE_REGEXP.test(r))return!1;if("DE_CASE"===e.rule.id&&this.EMOJI_SENTENCE_START_REGEXP.test(r))return!1;if("LEERZEICHEN_HINTER_DOPPELPUNKT"===e.rule.id&&this.MARKDOWN_INLINE_FORMAT_AT_BEGINNING_REGEXP.test(i))return!1;if("LEERZEICHEN_HINTER_DOPPELPUNKT"===e.rule.id&&this.WIKI_MARKUP_AT_END_REGEXP.test(r))return!1;if(e.rule.id.endsWith("UNPAIRED_BRACKETS")&&("!"===e.originalPhrase||"?"===e.originalPhrase)&&(r.endsWith("!")||r.endsWith("?")))return!1;if(e.rule.id.endsWith("UNPAIRED_BRACKETS")&&this.ONE_LETTER_AT_END_REGEXP.test(r))return!1;if(e.rule.id.endsWith("UNPAIRED_BRACKETS")&&this.NUMBER_WITH_DOT_AT_END_REGEXP.test(r))return!1;if("SENTENCE_WHITESPACE"===e.rule.id&&r.endsWith("{!"))return!1;if("SENTENCE_WHITESPACE"===e.rule.id&&this.SINGLE_UPPERCASE_LETTER_REGEXP.test(e.originalPhrase)&&this.ABBREVIATION_AT_END_REGEXP.test(r))return!1;if("SENTENCE_WHITESPACE"===e.rule.id&&"net"===e.originalPhrase.toLowerCase())return!1;if("COMMA_PARENTHESIS_WHITESPACE"===e.rule.id&&this.NET_AT_BEGINNING_REGEXP.test(i))return!1;if("COMMA_PARENTHESIS_WHITESPACE"===e.rule.id&&e.originalPhrase.endsWith(")")&&r.endsWith(this.ZWS))return!1;if("COMMA_PARENTHESIS_WHITESPACE"===e.rule.id&&e.originalPhrase.endsWith(".")&&this.FILE_TYPE_AT_BEGINNING_REGEXP.test(i))return!1;if("COMMA_PARENTHESIS_WHITESPACE"===e.rule.id&&r.endsWith("(")&&(",)"===e.originalPhrase||".)"===e.originalPhrase))return!1;if("COMMA_PARENTHESIS_WHITESPACE"===e.rule.id&&r.endsWith("\n")&&[")","}","]","."].includes(e.originalPhrase))return!1;if("COMMA_PARENTHESIS_WHITESPACE"===e.rule.id&&i.startsWith("/"))return!1;if("COMMA_PARENTHESIS_WHITESPACE"===e.rule.id&&e.originalPhrase.includes(this.ZWS))return!1;if("WORT1_BINDESTRICH_SPACE_WORT2"===e.rule.id&&e.originalPhrase.endsWith(this.ZWS))return!1;if("MULTIPLICATION_SIGN"===e.rule.id&&(this.AT_LEAST_TWO_LETTERS_AT_END_REGEXP.test(r)||!i||this.PUNCTUATION_AT_BEGINNING_REGEXP.test(i)))return!1;if("ZBEDNA_SPACJA_PRZED"===e.rule.id&&e.originalPhrase.includes(this.ZWS))return!1;if("UNLIKELY_OPENING_PUNCTUATION"===e.rule.id&&this.PUNCTUATION_SPACE_AT_END_REGEXP.test(r))return!1;if("WORD_CONTAINS_UNDERSCORE"===e.rule.id&&(!this.LOWERCASE_REGEXP.test(e.originalPhrase)||e.originalPhrase.includes("-")||e.originalPhrase.includes("__")||this.SLASH_AT_END_REGEXP.test(r)||this.SLASH_AT_BEGINNING_REGEXP.test(i)))return!1;if("WORD_CONTAINS_UNDERSCORE"===e.rule.id&&r.endsWith("[")&&i.startsWith("]"))return!1;if("WORD_CONTAINS_UNDERSCORE"===e.rule.id&&this.QUOTE_AT_END_REGEXP.test(r)&&this.QUOTE_AT_BEGINNING_REGEXP.test(i))return!1;if("WORD_CONTAINS_UNDERSCORE"===e.rule.id&&(r.endsWith("=")||r.endsWith("&")||r.endsWith("?")))return!1;if(["APOS_INCORRECT","LOOSE_ACCENTS"].includes(e.rule.id)&&"`"===e.originalPhrase)return!1;if(["_2_AANH_B","FALSCHES_ANFUEHRUNGSZEICHEN_2"].includes(e.rule.id)&&"``"===e.originalPhrase)return!1;if("DASH_RULE"===e.rule.id&&i.startsWith(" [")&&(!r||r.endsWith("\n")))return!1;if(e.isSpellingError&&e.originalPhrase.length>6&&e.fixes.length>4&&e.language.code.startsWith("de")&&(e.fixes.length=4),e.isSpellingError||"WORD_CONTAINS_UNDERSCORE"===e.rule.id){const t=e.originalPhrase.charAt(0),a=e.originalPhrase.toLowerCase();if(b(e,n.dictionary))return!1;if((i.startsWith("_")||r.endsWith("_"))&&!e.language.code.startsWith("de"))return!1;if(e.originalPhrase.startsWith("$")&&i.startsWith("}")&&r.endsWith("{"))return!1;if(e.originalPhrase.startsWith("$")&&e.originalPhrase.endsWith("$"))return!1;if(this.HTML_ENTITIES.includes(e.originalPhrase)&&r.endsWith("&")||this.HTML_ENTITIES_WITH_AND.includes(e.originalPhrase)||this.HTML_ENTITIES_WITH_AND.includes("&"+e.originalPhrase))return!1;if(this.COMMON_TLDS.some(((e,t)=>a.endsWith("."+e)||this.COMMON_TLD_WITH_DOT_REGEXPS[t].test(i))))return!1;if(this.DOT_WITH_PREFIX_REGEXP.test(r)&&this.COMMON_TLDS.includes(a))return!1;if(this.COMMON_FILE_TYPES.some(((e,t)=>a.endsWith("."+e)||this.COMMON_FILE_TYPE_WITH_DOT_REGEXPS[t].test(i))))return!1;if(this.DOT_WITH_PREFIX_REGEXP.test(r)&&this.COMMON_FILE_TYPES.includes(a))return!1;const o="@"===t||this.MENTION_SYMBOL_AT_BEGINNING_REGEXP.test(r),l="#"===t||this.HASH_SYMBOL_AT_BEGINNING_REGEXP.test(r);if(o||l)return!1;if(s.some((t=>t===e.originalPhrase)))return!1;if(this.WAVY_DASH_REGEXP.test(e.originalPhrase))return!1;for(const t of s)if(t.toLowerCase()===e.originalPhrase.toLowerCase()&&!e.fixes.some((e=>e.value===t))){e.fixes.unshift({value:t});break}}return!0}))}static _processResponse(e,t,n,s,r,i=!1,a=!1,o=!1){e.matches=this._correctMatches(e.matches,n,s);let l=this._transformMatches(e.matches,s,e.language,i);l=this._adjustErrors(l,s,r);let c=[];const d=[],g=[],u=!r.apiServerUrl||this._isLanguageToolServer(r.apiServerUrl);if(t=this._correctMatches(t.filter((({start:e,end:t})=>t-e>-1)).map((({start:e,end:t,detectedLanguages:n})=>({offset:e,length:t-e,detectedLanguages:n}))),n,s).map((({offset:e,length:t,detectedLanguages:n})=>({start:e,end:e+t,length:t,detectedLanguages:n}))),a)return{errors:[],premiumErrors:[],pickyErrors:[],premiumPickyErrors:[],sentenceRanges:t};if(o){const e=F.get(M.FIX_ALL_CONFIG);return{errors:l.filter((t=>!(!t.isRecommendation||e.FIX_RECOMMENDATIONS)||(!(!t.isStyleError||e.FIX_STYLE_ERRORS)||!e.FIX_GC_ERRORS))),premiumErrors:[],pickyErrors:[],premiumPickyErrors:[],sentenceRanges:t}}return!r.isPremium&&u&&e.language&&e.language.code.startsWith("nl")&&(l=l.filter((e=>!this.NL_PREMIUM_RULES.includes(e.rule.id)||(e.rule.id="HIDDEN_RULE",e.fixes=[],c.push(e),!1)))),!r.isPremium&&u&&e.language&&e.language.code.startsWith("pl")&&(l=l.filter((e=>!this.PL_PREMIUM_RULES.includes(e.rule.id)||(e.rule.id="HIDDEN_RULE",e.fixes=[],c.push(e),!1)))),r.isPremium&&l.forEach((e=>{this.NL_PREMIUM_RULES.includes(e.rule.id)&&(e.rule.isPremium=!0),this.PL_PREMIUM_RULES.includes(e.rule.id)&&(e.rule.isPremium=!0)})),r.debug&&l.forEach((e=>{e.description=(e.rule.isPremium?"prem:":"")+e.rule.id+"["+(e.rule.subId||"")+"] "+e.description})),e.hiddenMatches&&(c=c.concat(this._transformMatches(e.hiddenMatches,s,e.language,i))),"hidden-picky"===r.checkLevel&&(l=l.filter((e=>!e.isPicky||(g.push(e),!1))),e.hiddenMatches&&(c=c.filter((e=>!e.isPicky||(d.push(e),!1))))),{errors:l,premiumErrors:c,pickyErrors:g,premiumPickyErrors:d,sentenceRanges:t}}static _getNonAlphaNumericalOffsets(e,t){const n=new RegExp(`^(?:\\p{L}|\\p{N}|${t.start})$`,"gu"),s=new RegExp(`^(?:\\p{L}|\\p{N}|${t.end})$`,"gu"),r=e.split("").reverse().join(""),i=Math.floor(e.length/2);let a,o,l=!1,c=!1,d=0,g=0;for(let t=0;t<i;t++){const i=e.charAt(t),u=r.charAt(t);if(!0===a||null!==i.match(n)&&!i.match(/\s/)?a=!0:(l=null!==i.match(this.QUOTE_AT_BEGINNING_REGEXP),d+=1,a=!1),!0===o||null!==u.match(s)&&!u.match(/\s/)?o=!0:(c=null!==u.match(this.QUOTE_AT_END_REGEXP),g+=1,o=!1),a&&o)break}return l&&!c&&(d-=1),c&&!l&&(g-=1),[d,g]}static _trimSentenceRanges(e,t){const n=[];for(const s of e){const{start:e,end:r}=s,i=t.substring(e,r);if(!i.replace(this.INVISIBLE_SEPARATOR_REGEX,"").trim())continue;const[a,o]=this._getNonAlphaNumericalOffsets(i,{start:F.get(M.VALID_START_SENTENCE_REGEX),end:F.get(M.VALID_END_SENTENCE_REGEX)}),l=e+a,c=l+i.length-a-o,d=c-l;n.push({start:l,end:c,length:d,detectedLanguages:s.detectedLanguages})}return n}static _correctErrorOffsets(e,t){const n=[];let s=0;for(const r of e){const e=r.text.length;for(const i of t)if(i.start>=s&&i.end<=s+e){const e=Object.assign({},i);e.start=e.start-s+r.offset,e.end=e.start+e.length,n.push(e)}s+=e+2}return n}static async checkTextLevel(e,t,n,s=!1){e=this._prepareText(e);const r=Boolean(n.adapter);if(!e.trim()||r)return{language:t,errors:[],premiumErrors:[],pickyErrors:[],premiumPickyErrors:[]};this._abortTextLevelCheckRequest(n.instanceId),this._textLevelAbortControllers.set(n.instanceId,new AbortController),this._useFallbackServerForTextLevelRequests&&Date.now()-this._mainServerUnavailabilityTimeStamp>=Z&&(this._useFallbackServerForTextLevelRequests=!1);const i=e.normalize(),a=this._getServerFullUrl(n,!1,s),o={method:"post",mode:"cors",credentials:"omit",body:this._getTextLevelRequestData(i,t,n),signal:this._textLevelAbortControllers.get(n.instanceId).signal};return this._sendRequest(a,o).then((t=>{const{errors:s,premiumErrors:r,pickyErrors:a,premiumPickyErrors:o}=this._processResponse(t,[],i,e,n);return{language:{code:t.language.code,name:t.language.name,detectedLanguage:t.language.detectedLanguage},errors:s,premiumErrors:r,pickyErrors:a,premiumPickyErrors:o}})).catch((s=>{if(this._isConnectionOrServerIssue(s)){this._abortTextLevelCheckRequest(n.instanceId);if(!n.apiServerUrl&&!this._useFallbackServerForTextLevelRequests)return this._useFallbackServerForTextLevelRequests=!0,this._mainServerUnavailabilityTimeStamp=Date.now(),this.checkTextLevel(e,t,n)}throw s}))}static _buildSentenceRanges(e,t){if(!t.extendedSentenceRanges&&!t.sentenceRanges)return[];let n=t.extendedSentenceRanges;n||(n=(t.sentenceRanges||[]).map((e=>({from:e[0],to:e[1],detectedLanguages:[{language:t.language.code.split("-")[0],rate:1}]}))));const s=n.map((e=>({start:e.from,end:e.to,length:e.to-e.from,detectedLanguages:e.detectedLanguages.map((e=>({language:e.language,confidence:e.rate})))})));return this._trimSentenceRanges(s,e)}static cancelAllRequests(e){this._abortParagraphLevelCheckRequest(e),this._abortLanguageDetectionRequest(e),this._abortTextLevelCheckRequest(e)}static async checkParagraphLevel(e,t,n,s=!1,r,i,a,o){e.forEach((e=>{e.text=this._prepareText(e.text)}));if(!e.some((e=>!!e.text.trim())))return{language:t,errors:[],premiumErrors:[],pickyErrors:[],premiumPickyErrors:[],isIncompleteResult:!1,areErrorsSuppressed:!1};this._abortParagraphLevelCheckRequest(n.instanceId),this._paragraphLevelAbortControllers.set(n.instanceId,new AbortController),this._useFallbackServerForParagraphLevelRequests&&Date.now()-this._mainServerUnavailabilityTimeStamp>=Z&&(this._useFallbackServerForParagraphLevelRequests=!1);let l=!1;if(a&&a.ruleId){const e=F.get(M.AI_RULE_ID_REGEX);l=e.test(a.ruleId)}const c=this._getServerFullUrl(n,!0),d=this._joinInChunks(e),g=[];for(const e of d){const d=e.map((e=>e.text)).join("\n\n"),u=d.normalize(),m={method:"post",mode:"cors",credentials:"omit",body:this._getParagraphLevelCheckRequestData(u,t,n,s),signal:this._paragraphLevelAbortControllers.get(n.instanceId).signal},h=t=>{const s=this._postProcessParagraphLevelCheckResult(t,e,u,d,n,l,i,o);n.recommendationCallback?.(s)};let E;E="REPHRASING"===a?.ruleId?P.REPHRASING:a?.isRecommendation?P.GC_RECOMMENDATION:P.GC;const _={input:{acceptChangeType:E,language:t?.code,paragraphs:e,editorCompleteText:r||"",preferredVariants:this._getPreferredVariants(n.languageVariants.en,n.languageVariants.de,n.languageVariants.pt,n.languageVariants.ca),disableRecommendations:n.disableRecommendations,replacementText:a?.replacementText,hasUserAppliedFix:!!a&&l,changedParagraphsSentencesLength:i,appliedFixAll:o,writingGoal:n.writingGoalId},signal:this._paragraphLevelAbortControllers.get(n.instanceId).signal,recommendationResponseCallback:h,metaData:{instanceId:n.instanceId,tabId:n.tabId,domain:n.domain||""}},p=(n.adapter?n.adapter?.grammarCheck(_):this._sendRequest(c,m)).then((t=>this._postProcessParagraphLevelCheckResult(t,e,u,d,n,l,i,o)));g.push(p)}return Promise.all(g).then((e=>{const t=e[0].language,n=e[0].areErrorsSuppressed,s=e[0].metaData;return{language:t,errors:Array.prototype.concat.apply([],e.map((e=>e.errors))),premiumErrors:Array.prototype.concat.apply([],e.map((e=>e.premiumErrors))),premiumPickyErrors:Array.prototype.concat.apply([],e.map((e=>e.premiumPickyErrors))),pickyErrors:Array.prototype.concat.apply([],e.map((e=>e.pickyErrors))),isIncompleteResult:e.some((e=>e.isIncompleteResult)),sentenceRanges:Array.prototype.concat.apply([],e.filter((e=>Boolean(e.sentenceRanges))).map((e=>e.sentenceRanges))),areErrorsSuppressed:n,metaData:s}})).catch((i=>{if(this._isConnectionOrServerIssue(i)){this._abortParagraphLevelCheckRequest(n.instanceId);if((!n.apiServerUrl||this._isLanguageToolServer(n.apiServerUrl))&&!this._useFallbackServerForParagraphLevelRequests)return this._useFallbackServerForParagraphLevelRequests=!0,this._mainServerUnavailabilityTimeStamp=Date.now(),this.checkParagraphLevel(e,t,n,s,r)}throw i}))}static _postProcessParagraphLevelCheckResult(e,t,n,s,r,i,a,o){const{language:l,warnings:c}=e,d=e.ignoreRanges||[];r.debug&&d.length&&(e.matches=this._filterErrorsInIgnoredRanges(e.matches,d),e.hiddenMatches&&(e.hiddenMatches=this._filterErrorsInIgnoredRanges(e.hiddenMatches,d)),this._addIgnoredRangeMatches(n,e.matches,d));let g=this._buildSentenceRanges(n,e);const u=i&&1===t.length&&g.length===a,{errors:m,premiumErrors:h,pickyErrors:E,premiumPickyErrors:_,...p}=this._processResponse(e,g,n,s,r,!0,u,o);g=p.sentenceRanges;const f=this._correctErrorOffsets(t,m),A=this._correctErrorOffsets(t,h),S=this._correctErrorOffsets(t,E),T=this._correctErrorOffsets(t,_);return g=this._correctErrorOffsets(t,g),{language:{code:l.code,name:l.name},errors:f,premiumErrors:A,pickyErrors:S,premiumPickyErrors:T,isIncompleteResult:!!c&&c.incompleteResults,areErrorsSuppressed:u,sentenceRanges:g,metaData:e?.metaData}}static async checkRecommendation(e,t){const n=await t.adapter.recommendation({input:{language:e.language.code,texts:e.texts,priorities:e.priorities,writingGoal:e.writingGoal||""}});return this._transformMatches(n.matches||[],e.originalText,e.language,!0)}static _filterErrorsInIgnoredRanges(e,t){return e.filter((e=>{const n=e.offset,s=e.offset+e.length;return!t.some((e=>n>=e.from&&n<=e.to||s>=e.from&&s<=e.to))}))}static _addIgnoredRangeMatches(e,t,n){n.forEach((n=>{let s=n.to-n.from;const r=e.substring(n.from,n.to).match(/\s+$/);r&&(s-=r[0].length);const i={offset:n.from,length:s,rule:{id:"IGNORED_RANGE",category:{id:"IGNORED_RANGE",name:"Ignored Range"},issueType:"ignoredRange",description:"",isPremium:!1},contextForSureMatch:0,message:"This text is in a different language than the rest of the text.",shortMessage:"Different language: "+n.language.code,replacements:[]};t.push(i)}))}static async detectLanguage(e,t,n){e=this._prepareText(e);const s=Boolean(n.adapter);if(!e.trim()||t||s)return{language:t,errors:[],premiumErrors:[],pickyErrors:[],premiumPickyErrors:[]};this._abortLanguageDetectionRequest(n.instanceId),this._languageDetectionAbortControllers.set(n.instanceId,new AbortController),this._useFallbackServerForLanguageDetection&&Date.now()-this._mainServerUnavailabilityTimeStamp>=Z&&(this._useFallbackServerForLanguageDetection=!1);const r=e.substr(0,1e3).normalize(),i=this._getServerFullUrl(n,!1),a={method:"post",mode:"cors",credentials:"omit",body:this._getTextLevelRequestData(r,t,n),signal:this._languageDetectionAbortControllers.get(n.instanceId).signal};return this._sendRequest(i,a).then((e=>({language:{code:e.language.code,name:e.language.name},errors:[],premiumErrors:[],premiumPickyErrors:[],pickyErrors:[]}))).catch((s=>{if(this._isConnectionOrServerIssue(s)){this._abortLanguageDetectionRequest(n.instanceId);if((!n.apiServerUrl||this._isLanguageToolServer(n.apiServerUrl))&&!this._useFallbackServerForLanguageDetection)return this._useFallbackServerForLanguageDetection=!0,this._mainServerUnavailabilityTimeStamp=Date.now(),this.detectLanguage(e,t,n)}throw s}))}static _isLanguageToolServer(e){return!!e&&(e.includes("api.languagetool.org")||e.includes("languagetool.org/api")||e.includes("api.languagetoolplus.com"))}static checkForPaidSubscription(e,t,n,s=H){return new Promise(((r,i)=>{s+=s.endsWith("/")?"check":"/check";const a=new URLSearchParams;a.append("language","en-us"),a.append("data",JSON.stringify({text:"The languagetool testrule 8634756."})),e&&t?(a.append("username",e),a.append("password",t)):e&&n&&(a.append("username",e),a.append("tokenV2",n));const o={method:"post",mode:"cors",credentials:"omit",body:a};this._sendRequest(s,o).then((e=>{const t=e.matches.some((e=>"PREMIUM_FAKE_RULE"===e.rule.id));r(t)})).catch(i)}))}static addWordToDictionary(e,t){if(Boolean(t.adapter))return;const n=this.getServerBaseUrl(t),s=n.endsWith("/")?"":"/",r=new URL(n+s+"words/add");if(t.user&&"token"in t.user)r.searchParams.set("username",t.user.email),r.searchParams.set("tokenV2",t.user.token);else{if(!t.user||!("password"in t.user))return Promise.reject(new Error("Not logged-in for adding words to dictionary"));r.searchParams.set("username",t.user.email),r.searchParams.set("password",t.user.password)}return r.searchParams.set("word",e.trim()),fetch(r.toString(),{method:"POST"}).then((e=>e.ok?Promise.resolve():Promise.reject(new Error(`Status: ${e.status}`))))}}xe.NL_PREMIUM_RULES=["FAAG_VAAG","TOO_LONG_SENTENCE","_2_LEESTEKENS","WEEKEND","CASU_QUO","MOMENTEEL","SLECHTS","LEENWOORDEN","KOMMA_HOOR","RELEVANT","HINTS","CHECKEN","ALLEEN_BE","MACHTE","ECHTER","COMMUNICEREN","DESIGN","SANDAAL_ZANDAAL","N","MIDDELS","INTEGREREN","PRIMAIR","OVERIGENS","BETREFFENDE","AGENDA","ERGO","TEN_BEHOEVE","KOMMA_AANH","TM","IE","TER_ZAKE","SIGNIFICANT","GELIEVE","BEHOREN","NAAR_AANLEIDING_VAN","VAN_PLAN_ZIJN","HEDEN","TEN_DODE","VREEMD_VRZ_HIJ","DES","IMPACT","IMMER","BOVENSTAAND","XXXYJE","DUTCH_WRONG_WORD_IN_CONTEXT","LANCEREN","MET_BEHULP_VAN","PRIORITEIT","UWENTWEGE","CATEGORIE","CRITERIUM","GEMOTIVEERD"],xe.PL_PREMIUM_RULES=["BOWIEM_ZAS","ZE_Z_SPOL","SPACJA_ZNAK_ROWNOSCI","BRAK_PRZECINKA_GDY","PYTANIE_CO","BRAK_PRZECINKA_JESLI","PRZECINEK_ANI","SKROTOWCE_BEZ_DYWIZU","NIEZGODNOSC_PRZYPADKU_PO_LICZEBNIKU","PODMIOT_ORZECZENIE","ROWNIE_JAK","JAK_I","PRZECINEK_POROWNANIE","WOLACZ_BEZ_PRZECINKA","ODNOSNIE_DO","GENERALNIE","BOWIEM_ZAS_PRZECINEK","WYDAWAC_SIE_BYC","POSIADAC_MIEC","PL_GUILLEMET","ITP_ITD","SPACJA_PROCENT","PO","W_TEMACIE","PL_DWA_WYRAZY","W_NAWIAZANIU_DO","WE_W","POKI_CO","VS","DZIEN_DZISIEJSZY","WIELOKROTNE_WYSTPIENIE_TEGO_SAMEGO_WYRAENIA_PRZYIMKOWEGO","I_LUB","PELNIC_ROLE","OKRES_CZASU","UZNAC_JAKO","EFEKT_KONCOWY","DLATEGO_PONIEWAZ","NA_DZIEN_DZISIEJSZY","DODATKOWO_CO_WIECEJ","OWY_W","DZIEN_JUTRZEJSZY","ADRES_ZAMIESZKANIA","W_CHWILI_OBECNEJ","BYC_ZNAJDOWAC_SIE_W_POSIADANIU","DO_TERAZ","PROTOKOL_Z_CZEGO","PO_NAJMNIEJSZEJ_LINII","POTRAFIACY","zarowno_jak_rowniez","GRAC_FAIR_PLAY","DRUGI_NAJWIEKSZY","COFAC_SIE_DO_TYLU","DZIEN_WCZORAJSZY","NA_PRZESTRZENI","IDENTYCZNY_JAK","ZA_WYJATKIEM","MAPA_DROGOWA","W_PRZECIGU_TYGODNIA_W_CIGU","NAPOTKAC_NA","PRZERWA_KAWOWA","WYSOKA_FREKWENCJA","UBRAC_ZALOZYC","PRZY_UDZIALE","W_SLAD_ZA","WYRAZIC_POPARCIE","W_TYM_WZGLEDZIE","PO_PIERWSZE_PRIMO","DOMYSLEC_SIE","WARTY","IDENTYCZNY_DO","W_DRODZE_WYJATKU","PRZEDKLADAC_WNIOSEK","POD_RZAD","PRZYJAZNY_DLA_UZYTKOWNIKA","NA_WSKUTEK","SWIECIC_SUKCESY","W_WEGRZECH","KONDYCJA_FINANSOWA","RULE_NIEMNIEJ","FORMULA_KREMU","PODDAWAC_W_WATPLIWOSC","OPATRZEC_SIE","ODGRYWAC_ZNACZENIE","INFORMACJE_WRAZLIWE","DO_DZIS_DZIEN","CO_I_RAZ","OKRAGLY_ROK","SZERSZE_INFORMACJE","WYSOKA_FORMA","CZEKAC_ZA","BYNAJMNIEJ","WYWIERAC_PIETNO","DOPATRZEC_SIE","ZLA_RENOMA","W_PELNYM_TEGO","W_KAZDYM_BADZ","KOSZTOWAC_TANIEJ","DYGITALNY"],xe.SPELLING_RULES_ID=["SPELLER_RULE","MORFOLOGIK_RULE","HUNSPELL","SPELLING_RULE","ORTHOGRAPHY"],xe.STYLE_ISSUE_TYPES=["style","locale-violation","register"],xe.EMAIL_SIGNATURE_SEPARATOR_REGEXP=/^[‐|\-]{2,}|[‐|\-]{2,}$/,xe.ONLY_NUMBERS_REGEXP=/^[0-9]+$/,xe.COLON_WHITESPACE_REGEXP=/^[;:]\s/,xe.ONE_LETTER_AT_END_REGEXP=/(\s|^|\()[a-z]\.?\s?$/i,xe.NUMBER_WITH_DOT_AT_END_REGEXP=/\d\.?\s?$/,xe.NUMBER_WITH_PARENTHESIS_AT_END_REGEXP=/\d\.?\)\s$/,xe.PUNCTUATION_AT_END=/(\.|\!)$/,xe.BULLET_POINT_REGEXP=/(\u25b6\ufe0e|\u25BA|\*|-|–|\u2606|\u2605|\u25cf|\u2022|\u25e6|\u27A4|\u2714)\s+$/,xe.LOWERCASE_REGEXP=/[a-z]/,xe.DOT_WITH_PREFIX_REGEXP=/\w\.$/,xe.SLASH_AT_END_REGEXP=/(\/|\\)$/,xe.AT_LEAST_TWO_LETTERS_AT_END_REGEXP=/[a-z]{2}$/i,xe.SLASH_AT_BEGINNING_REGEXP=/^(\/|\\)/,xe.QUOTE_AT_END_REGEXP=/[\"“”„]$/,xe.QUOTE_AT_BEGINNING_REGEXP=/^[\"“”„]/,xe.PUNCTUATION_AT_BEGINNING_REGEXP=/^\s?[\.\!\?,:…]/,xe.PUNCTUATION_SPACE_AT_END_REGEXP=/[\.…\?\!]\s+/,xe.MARKDOWN_HEADLINE_REGEXP=/^#{1,6}\s/m,xe.MARKDOWN_INLINE_FORMAT_AT_BEGINNING_REGEXP=/^[\*\~\_\^\+\%\@]/m,xe.WIKI_MARKUP_AT_END_REGEXP=/\[\[[a-z]+$/,xe.PIPE_AT_END_REGEXP=/\|\s+$/,xe.MENTION_SYMBOL_AT_BEGINNING_REGEXP=/@[a-z\.\-]*$/i,xe.HASH_SYMBOL_AT_BEGINNING_REGEXP=/#[a-z\.\-]*$/i,xe.EMOJI_SENTENCE_START_REGEXP=/(\.|!|\?|^)\s?(\u00a9|\u00ae|[\u2000-\u3300]|\ud83c[\ud000-\udfff]|\ud83d[\ud000-\udfff]|\ud83e[\ud000-\udfff])\s+/,xe.ABBREVIATION_AT_END_REGEXP=/(\s|\(|^)[A-Z]\.$/,xe.NET_AT_BEGINNING_REGEXP=/^net\b/i,xe.SINGLE_UPPERCASE_LETTER_REGEXP=/^[A-Z]$/,xe.NON_ALPHANUMERIC_AT_BEGINNING_REGEXP=/^[^a-z0-9äöüßáàâéèêíìîóòôúùû\.\?\!,\:\;¿¡]+/i,xe.NON_ALPHANUMERIC_AT_END_REGEXP=/[^a-z0-9äöüßáàâéèêíìîóòôúùû\.\?\!,\:\;¿¡]+$/i,xe.HTML_ENTITIES=["amp","nbsp","gt","lt","bull","euro","copy","laquo","raquo","hellip","middot"],xe.HTML_ENTITIES_WITH_AND=xe.HTML_ENTITIES.map((e=>`&${e}`)),xe.WAVY_DASH_REGEXP=/^\u3030+$/,xe.ZWS_REGEXP=/^\uFEFF+$/,xe.ZWNJ_REGEXP=/\u200B|\u200C/g,xe.ZWS="\ufeff",xe.PREVENT_MID_SENTENCE_CAPITALIZATION=/[\wáàâóòìíéèùúâôîêûäöüß,\)][\u0020\u00A0\uFEFF]*\n\n\n?[\u0020\u00A0\uFEFF"„»«“‘]*$/,xe.PREVENT_MID_SENTENCE_PUNCTUATION=/^[\u0020\u00A0\uFEFF]*\n\n\n?[a-záàâóòìíéèùúâôîêûäöüß,\)]/,xe.INVISIBLE_SEPARATOR_REGEX=new RegExp("⁣","g"),xe.COMMON_TLDS=["com","co","org","net","de","info","biz","es","fr","be","in","gov","nl","ca","com.br","br","at","us","au","ru","pl","ly","it","cat","edu","jp","ko","cn","se","no","mil","ch","dk","com.mx","mx","eu","co.uk","uk","ir","cz","ua","kr","gr","tw","nz","co.nz","za","ro","vn","io","tr","me","fi","tv","xyz","pt","ie","app"],xe.COMMON_TLD_WITH_DOT_REGEXPS=xe.COMMON_TLDS.map((e=>new RegExp(`^\\.${e.replace(".","\\.")}\\b`,"i"))),xe.COMMON_FILE_TYPES=["jpeg","jpg","gif","png","bmp","indd","stl","svg","ai","sketch","ico","ics","env","amf","ps","psd","tiff","tif","mp3","wav","midi","mid","aif","mpa","ogg","wma","wpl","cda","7z","arj","deb","pkg","plist","rar","rpm","tar.gz","tar","zip","bin","dmg","iso","toast","vcd","csv","dat","db","log","mdb","sav","sql","xml","apk","bat","bin","cgi","com","exe","gadget","jar","py","js","jsx","json","wsf","ts","tsx","fnt","fon","otf","ttf","woff","woff2","rb","java","php","html","asp","aspx","cer","cfm","cgi","pl","css","scss","htm","jsp","part","rss","xhtml","key","odp","pps","ppt","pptx","class","cpp","cs","h","sh","swift","vb","ods","odt","xlr","xls","xlsx","xlt","xltx","bak","cab","cfg","cpl","cur","dll","dmp","msi","ini","tmp","3g2","3gp","avi","flv","h264","m4v","mkv","mov","mp4","mpg","mpeg","rm","swf","vob","wmv","doc","docx","dot","dotx","pdf","rtf","srx","text","tex","wks","wps","wpd","txt","yaml","yml","csl","md","adm"],xe.COMMON_FILE_TYPE_WITH_DOT_REGEXPS=xe.COMMON_FILE_TYPES.map((e=>new RegExp(`^[\\wáàâóòìíéèùúâôîêûäöüß\\-\\.\\(\\)]*?\\.${e}\\b`,"i"))),xe.FILE_TYPE_AT_BEGINNING_REGEXP=new RegExp(`(${xe.COMMON_FILE_TYPES.join("|")})\b`,"i"),xe.HIGH_LEVEL_GOALS=[{id:"professional",tags:["clarity","confident","formal","general","positive","professional"]},{id:"scientific",tags:["academic","clarity","formal","general","objective","povrem","scientific"]},{id:"persuasive",tags:["clarity","confident","general","persuasive","positive"]},{id:"personal",tags:["clarity","general","informal","positive","povadd"]},{id:"creative",tags:["clarity","general"]}],xe._textLevelAbortControllers=new Map,xe._paragraphLevelAbortControllers=new Map,xe._languageDetectionAbortControllers=new Map,xe._useFallbackServerForTextLevelRequests=!1,xe._useFallbackServerForParagraphLevelRequests=!1,xe._useFallbackServerForLanguageDetection=!1,xe._mainServerUnavailabilityTimeStamp=0,xe._checkForException=e=>e.ok?e:e.text().catch((()=>"")).then((t=>{const n=t.toLowerCase();if(n.includes("too many error"))throw{reason:"TooManyErrors",status:e.status,response:t};if(413===e.status||n.includes("text exceeds the limit"))throw{reason:"TextTooLong",status:e.status,response:t};if(t.toLowerCase().includes("checking took longer than"))throw{reason:"TimeoutError",status:e.status,url:e.url?e.url.replace(/\?.*/,"?..."):"unknown",response:t};if(429===e.status)throw{reason:"TooManyRequests",status:e.status,response:t};if(403===e.status){if(n.includes("client request size limit")||n.includes("client request limit")||n.includes("ip request limit")||n.includes("ip request size limit"))throw{reason:"TooManyRequests",status:e.status,response:t};if(n.includes("authexception"))throw{reason:"InvalidCredentials",status:e.status,response:t};throw{reason:"AccessDenied",status:e.status,response:t}}if(n.includes("checking took longer than"))throw{reason:"TimeoutError",status:e.status,url:e.url?e.url.replace(/\?.*/,"?..."):"unknown",response:t};throw{reason:"UnknownError",status:e.status,response:t}}));const ke=class{static init(e){this._instance=e,e.initialize()}static initialize(){this._instance.initialize()}static trackPageView(e,t){this._instance.trackPageView(e,t)}static trackDisabledRule(e,t,n,s){return this._instance.trackDisabledRule(e,t,n,s)}static trackDictionaryEvent(e,t,n){return this._instance.trackDictionaryEvent(e,t,n)}static trackEvent(e,t,n,s,r){this._instance.trackEvent(e,t,n,s,r)}static trackInstall(){this._instance.trackInstall()}static trackActivity(){this._instance.trackActivity()}static trackActiveAfterOneWeek(){return this._instance.trackActiveAfterOneWeek()}static trackUserActivity(){this._instance.trackUserActivity()}static trackError(e,t,n){this._instance.trackError(e,t,n)}static trackStat(e,t){this._instance.trackStat(e,t)}static trackPerformanceMetrics(e){this._instance.trackPerformanceMetrics(e)}};
/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
class Ue extends le{static _getStringSize(...e){let t=0;for(const n of e)for(let e=0;e<n.length;e++){const s=n.charCodeAt(e);t+=s<128?1:s<2048?2:s<65536?3:s<1<<21?4:s<1<<26?5:s<1<<31?6:Number.NaN}return t}static _getStorage(){const t=Ee();return t.storage.sync&&!e.isFirefox()?t.storage.sync:t.storage.local}static _getManagedStorage(){return Ee().storage.managed}constructor(){super(),this._onStoredDataChanged=(e,t)=>{const n=["username","token"].filter((t=>e.hasOwnProperty(t)&&e[t].oldValue!==e[t].newValue)),s=[],r=[];for(const e of Ue.SETTINGS_CHUNKED_PROPERTIES)s.push(!1),r.push(new RegExp(`^${e}(_\\d+)?$`));let i=!1,a=!1,o=!1,l=!1;for(const n in e)if("managed"!==t){for(let e=0;e<Ue.SETTINGS_CHUNKED_PROPERTIES.length;e++)if(r[e].test(n)){s[e]=!0;break}if(this._settings&&le.DEFAULT_SETTINGS.hasOwnProperty(n)&&!Ue.SETTINGS_CHUNKED_PROPERTIES.includes(n)){const t=!("oldValue"in e[n])&&le.DEFAULT_SETTINGS[n]===e[n].newValue,s=e[n].oldValue!==e[n].newValue;this._settings[n]=e[n].newValue,i=!1===t&&s}this._configuration&&le.DEFAULT_REMOTE_CONFIGURATION.hasOwnProperty(n)&&(this._configuration[n]=e[n].newValue,a=!0),this._privacySettings&&le.DEFAULT_PRIVACY_SETTINGS.hasOwnProperty(n)&&(this._privacySettings[n]=e[n].newValue,o=!0),this._statistics&&le.DEFAULT_STATISTICS.hasOwnProperty(n)&&(this._statistics[n]=e[n].newValue),this._uiState&&le.DEFAULT_UI_STATE.hasOwnProperty(n)&&(this._uiState[n]=e[n].newValue,l=!0),this._testFlags&&le.DEFAULT_TEST_FLAGS.hasOwnProperty(n)&&(this._testFlags[n]=e[n].newValue),"uniqueId"===n&&(this._uniqueId=e[n].newValue)}else this._managedSettings&&le.DEFAULT_MANAGED_SETTINGS.hasOwnProperty(n)&&(this._managedSettings[n]=e[n].newValue);i&&(this._ensureIgnoredRuleTurnOffDate(),this._eventBus.fire(le.eventNames.settingsChanged,e)),n.length&&this._eventBus.fire(le.eventNames.userCredentialsChanged,n.reduce(((t,n)=>({...t,[n]:e[n]})),{})),s.some((e=>e))&&this._storage.get().then((e=>{if(!this._settings)return;const t={};for(let n=0;n<Ue.SETTINGS_CHUNKED_PROPERTIES.length;n++)if(s[n]){const s=Ue.SETTINGS_CHUNKED_PROPERTIES[n];if(!Ue._isSettingsPropertyArrayName(s))continue;const r=this._joinChunks(e,s);t[s]={oldValue:this._settings[s],newValue:r},this._settings[s]=r}this._ensureIgnoredRuleTurnOffDate(),this._eventBus.fire(le.eventNames.settingsChanged,t)})),a&&this._eventBus.fire(le.eventNames.configurationChanged,e),o&&this._eventBus.fire(le.eventNames.privacySettingsChanged,e),l&&this._eventBus.fire(le.eventNames.uiStateChanged,e)},this._storage=Ue._getStorage(),this._managedStorage=Ue._getManagedStorage(),this._isInitialized=!1,this._loadData(),Ee().storage.onChanged.addListener(this._onStoredDataChanged)}_splitInChunks(e,t,n=this._storage.QUOTA_BYTES_PER_ITEM){const s=e[t];if(!s)return;let r=0,i=[],a=Ue._getStringSize(t,"[]");for(;s.length;){const o=s.shift(),l=JSON.stringify(o),c=Ue._getStringSize(`,${l}`);if(a+c<=n)i.push(o),a+=c;else{e[0===r?t:`${t}_${r}`]=i,r++,i=[o],a=Ue._getStringSize(`${t}_${r}`,`[${l}]`)}if(0===s.length){e[0===r?t:`${t}_${r}`]=i}}e[`${t}_${r+1}`]=[]}_joinChunks(e,t,n=this._storage.MAX_ITEMS){let s=e[t]||[];for(let r=1;r<n;r++){const n=e[`${t}_${r}`];if(void 0===n||0===n.length)break;s=s.concat(n)}return s}_loadData(){const e=this._storage.get().then((e=>{const t=le._combineObjects(le.DEFAULT_SETTINGS,e);for(const n of Ue.SETTINGS_CHUNKED_PROPERTIES)t[n]=this._joinChunks(e,n);for(const e of t.ignoredRules){if(void 0===e.description){const t=le.DEFAULT_SETTINGS.ignoredRules.find((t=>t.id===e.id&&t.language===e.language));e.description=t?t.description:""}if(void 0===e.turnOffDate){const t=le.DEFAULT_SETTINGS.ignoredRules.some((t=>t.id===e.id&&t.language===e.language));e.turnOffDate=t?null:new Date(2019,9,1)}else null!==e.turnOffDate&&(e.turnOffDate=new Date(e.turnOffDate))}t.disabledDomains=t.disabledDomains.map((e=>N(e,""))).filter((e=>e)),t.ignoreCheckOnDomains=t.ignoreCheckOnDomains.map((e=>N(e,""))).filter((e=>e)),t.autoCheckOnDomains=t.autoCheckOnDomains.map((e=>N(e,""))).filter((e=>e)),this._settings=t,this._configuration=le._combineObjects(le.DEFAULT_REMOTE_CONFIGURATION,e),this._privacySettings=le._combineObjects(le.DEFAULT_PRIVACY_SETTINGS,e),this._statistics=le._combineObjects(le.DEFAULT_STATISTICS,e),this._uiState=le._combineObjects(le.DEFAULT_UI_STATE,e),this._testFlags=le._combineObjects(le.DEFAULT_TEST_FLAGS,e),e.uniqueId?this._uniqueId=e.uniqueId:(this._uniqueId=le._generateUniqueId(),this._storage.set({uniqueId:this._uniqueId})),this._statistics.firstVisit||this.updateStatistics({firstVisit:Math.round(Date.now()/1e3)})})),t=this._managedStorage.get().then((e=>{this._managedSettings=le._combineObjects(le.DEFAULT_MANAGED_SETTINGS,e)})).catch((e=>{Math.random()<.01&&ke.trackError("other","storage_controller:managed_storage",e&&e.toString()),this._managedSettings=le._combineObjects(le.DEFAULT_MANAGED_SETTINGS,{})}));Promise.all([e,t]).then((()=>{this._isInitialized=!0,this._onReadyCallbacks.forEach((e=>e(this))),this._onReadyCallbacks=[]}))}_ensureIgnoredRuleTurnOffDate(){if(this._settings)for(const e of this._settings.ignoredRules)e.turnOffDate&&"string"==typeof e.turnOffDate&&(e.turnOffDate=new Date(e.turnOffDate))}isReady(){return this._isInitialized}onReady(e){this._isInitialized?e(this):this._onReadyCallbacks.push(e)}getUniqueId(){return this._uniqueId}getSettings(){return T(this._settings)}updateSettings(t){for(const e in t)if(!le.DEFAULT_SETTINGS.hasOwnProperty(e))throw new Error(`Unknown setting ${e}`);if(Object.assign(this._settings||{},T(t)),void 0!==t.ignoredRules)for(const e of t.ignoredRules)e.turnOffDate&&"string"!=typeof e.turnOffDate&&(e.turnOffDate=e.turnOffDate.toISOString());if(!e.isFirefox()&&!e.isThunderbird()&&!e.isSafari()){t=T(t);for(let e=0;e<Ue.SETTINGS_CHUNKED_PROPERTIES.length;e++){const n=Ue.SETTINGS_CHUNKED_PROPERTIES[e];void 0!==t[n]&&Ue._isSettingsPropertyArrayName(n)&&this._splitInChunks(t,n)}}return this._storage.set(t)}getCheckSettings(e,t){if(!this._settings)return{isDomainDisabled:!1,isEditorGroupDisabled:!1,isAutoCheckEnabled:!0};if(e===Ee().runtime.id)return{isDomainDisabled:!1,isEditorGroupDisabled:!1,isAutoCheckEnabled:!0};const n=(this._settings.disabledEditorGroups||[]).some((n=>L(n.domain)===L(e)&&n.editorGroupId===t)),s=le._isListContainsDomain(this._settings.disabledDomains,e),r=ve(this._managedSettings?.allowedURLs||[]);if(this._settings.autoCheck&&!r){return{isDomainDisabled:s,isEditorGroupDisabled:n,isAutoCheckEnabled:!le._isListContainsDomain(this._settings.ignoreCheckOnDomains,e)}}return{isDomainDisabled:s,isEditorGroupDisabled:n,isAutoCheckEnabled:le._isListContainsDomain([...this._settings.autoCheckOnDomains,...(i=this._managedSettings?.allowedURLs||[],De(i).map((e=>{try{return N(e)}catch{return null}})).filter((e=>!!e)))],e)};var i}hasLanguageToolAccount(){return Boolean(this._settings&&this._settings.username&&!this.hasCustomServer())}hasCustomServer(){return this._managedSettings&&this._managedSettings.apiServerUrl?this._managedSettings.apiServerUrl!==le.DEFAULT_SETTINGS.apiServerUrl:Boolean(this._settings&&this._settings.apiServerUrl&&this._settings.apiServerUrl.trim()&&this._settings.apiServerUrl!==W&&this._settings.apiServerUrl!==H)}getCustomServerUrl(){if(this.hasCustomServer())return this._managedSettings.apiServerUrl||this._settings.apiServerUrl}hasCustomLogin(){return!!this._managedSettings?.loginUrl}getManagedSettings(){return S(this._managedSettings)}getConfiguration(){return S(this._configuration)}updateRemoteConfiguration(e){for(const t in e)if(!le.DEFAULT_REMOTE_CONFIGURATION.hasOwnProperty(t))throw new Error(`Unknown configuration ${t}`);return this._configuration&&this._isInitialized&&!this._hasAnythingChanged(this._configuration,e)?Promise.resolve():(Object.assign(this._configuration||{},S(e)),this._storage.set(e))}isDomainSupported(e){return!this._configuration||!this._configuration.unsupportedDomains.includes("*")&&!le._isListContainsDomain(this._configuration.unsupportedDomains,e)}isDomainExcludedByGroupPolicy(e){const t=De(this._managedSettings?.allowedURLs||[]);return!!t.length&&!1===O(t,e)}getPrivacySettings(){return S(this._privacySettings)}updatePrivacySettings(e){for(const t in e)if(!le.DEFAULT_PRIVACY_SETTINGS.hasOwnProperty(t))throw new Error(`Unknown privacy setting ${t}`);return this._privacySettings&&this._isInitialized&&!this._hasAnythingChanged(this._privacySettings,e)?Promise.resolve():(Object.assign(this._privacySettings||{},e),this._storage.set(e))}getStatistics(){return T(this._statistics)}updateStatistics(e){for(const t in e)if(!le.DEFAULT_STATISTICS.hasOwnProperty(t))throw new Error(`Unknown privacy setting ${t}`);return this._statistics&&this._isInitialized&&!this._hasAnythingChanged(this._statistics,e)?Promise.resolve():(Object.assign(this._statistics||{},e),this._storage.set(e))}getUIState(){return T(this._uiState)}updateUIState(e){for(const t in e)if(!le.DEFAULT_UI_STATE.hasOwnProperty(t))throw new Error(`Unknown UI state ${t}`);return this._uiState&&this._isInitialized&&!this._hasAnythingChanged(this._uiState,e)?Promise.resolve():(Object.assign(this._uiState||{},e),this._storage.set(e))}_hasAnythingChanged(e,t){let n=!1;for(const s in t)if(t.hasOwnProperty(s)&&(t[s]!==e[s]||"object"==typeof t[s])){n=!0;break}return n}checkForPaidSubscription(){return new Promise(((e,t)=>{this.onReady((()=>{const{username:n,password:s,token:r}=this.getSettings();let i;this.hasCustomServer()&&(i=this.getCustomServerUrl()),xe.checkForPaidSubscription(n,s,r,i).then((t=>{t?(this.enablePaidSubscription(),this.grantUnlimitedRephrasings()):(this.disablePaidSubscription(),this.restrictRephrasings()),e(t)})).catch(t)}))}))}getTestFlags(){return S(this._testFlags)}updateTestFlags(e){for(const t in e)if(!le.DEFAULT_TEST_FLAGS.hasOwnProperty(t))throw new Error(`Unknown test flag ${t}`);return Object.assign(this._testFlags||{},e),this._storage.set(e)}getActiveCoupon(){const{changelogNov2024CountdownEnd:e,changelogNov2024Coupon:t,hasPaidSubscription:n}=this.getUIState();if(n)return null;if(e&&t&&Date.now()<e){const n=20,{geoIpCountry:s}=this.getSettings(),r=this._getDefaultCoupon(s);return 20===r?.percent?{code:"2024-NOV-CHANGELOG-SOUTH-EUROPE",expires:e,percent:33}:r&&r.percent>n?{...r,expires:e}:{code:t,expires:e,percent:n}}return null}_getDefaultCoupon(e){for(const t in $)if($.hasOwnProperty(t)&&$[t].countries.includes(e))return{code:t,percent:$[t].percent};return null}isRelevantForChangelogCoupon(){if(this.hasCustomServer())return{status:!1,reason:1};if(navigator.webdriver)return{status:!1,reason:6};const{hasPaidSubscription:e}=this.getUIState();if(e)return{status:!1,reason:3};let{firstVisit:t}=this.getStatistics();if(!t)return{status:!1,reason:4};t*=1e3;return Date.now()-t<6048e5?{status:!1,reason:5}:{status:!0}}startChangelogCoupon(){if(!this.canStartChangelogCoupon())return;const e=Date.now();var t,n;this.updateUIState({changelogNov2024Coupon:"2024-NOV-CHANGELOG",changelogNov2024CountdownEnd:e+1656e5+(t=0,n=72e5,t=Math.ceil(t),n=Math.floor(n),Math.floor(Math.random()*(n-t+1))+t)})}isChangelogCouponRunning(){if(!this.isRelevantForChangelogCoupon().status)return!1;const{changelogNov2024CountdownEnd:e}=this.getUIState();return Boolean(e&&e>Date.now())}canStartChangelogCoupon(){if(!this.isRelevantForChangelogCoupon().status)return!1;const e=Date.now(),{changelogNov2024CountdownEnd:t}=this.getUIState();return!t||e-t>7776e6}destroy(){this._isInitialized=!1,super.destroy();try{Ee().storage.onChanged.removeListener(this._onStoredDataChanged)}catch(e){}}}Ue.SETTINGS_CHUNKED_PROPERTIES=["dictionary","ignoredRules","disabledDomains","disabledEditorGroups","ignoreCheckOnDomains","autoCheckOnDomains"],Ue._isSettingsPropertyArrayName=e=>Ue.SETTINGS_CHUNKED_PROPERTIES.includes(e);class we{constructor(t,n,s=null,r=null,i=null){this._listeners=[],this._parentElement=t,this._headline=s,this._text=r,this._buttonText=i,this._trackingEvent=n,this._document=t.ownerDocument,this._isMacOs="Mac"===e.getOS(),this._storageController=ce.create(),this._element=this._document.createElement("lt-div"),this._element.className="lt-desktop-app-teaser lt-desktop-app-teaser--visible",this._element.classList.add(this._isMacOs?"lt-desktop-app-teaser--mac":"lt-desktop-app-teaser--windows"),this._parentElement.appendChild(this._element),this._renderDesktopAppTeaser()}_observe(){this._closeButton?.addEventListener("click",(e=>{e.stopImmediatePropagation(),e.preventDefault(),ke.trackEvent("Action",`${this._trackingEvent}:close`),this._hideElement()})),this._primaryButton&&this._listeners.push(Ie(this._primaryButton,"click",(e=>{e.stopImmediatePropagation(),e.preventDefault(),ke.trackEvent("Action",`${this._trackingEvent}:click`),this._hideElement();const t={command:"OPEN_URL",url:this._isMacOs?"https://languagetool.org/mac-desktop":"https://languagetool.org/windows-desktop"};Ee().runtime.sendMessage(t)})))}_hideElement(){this._storageController.updateUIState({hasSeenDesktopAppTeaser:!0}),this._element.classList.remove("lt-desktop-app-teaser--visible")}_renderDesktopAppTeaser(){if(ke.trackEvent("Action",this._trackingEvent),!this._headline&&!this._text&&!this._buttonText)return;const e=this._document.createElement("lt-div");if(e.className="lt-desktop-app-teaser__content",this._element.appendChild(e),this._headline){const t=this._document.createElement("lt-span");t.className="lt-desktop-app-teaser__content__headline",t.textContent=this._headline,e.appendChild(t)}if(this._text){const t=this._document.createElement("lt-span");t.className="lt-desktop-app-teaser__content__text",t.innerHTML=this._text,e.appendChild(t)}this._buttonText&&(this._primaryButton=this._document.createElement("lt-span"),this._primaryButton.className="lt-desktop-app-teaser__content__button",this._primaryButton.textContent=this._buttonText,e.appendChild(this._primaryButton)),this._closeButton=this._document.createElement("lt_button"),this._closeButton.className="lt-desktop-app-teaser__content__close-button",e.appendChild(this._closeButton),this._observe()}destroy(){this._listeners.forEach((({destroy:e})=>e()))}}class Me{constructor(e,t,n,s){this._className=e,this._type=t,this._size=n,this._parentElement=s,this._document=s.ownerDocument,this._render()}_render(){this._element=this._document.createElement("lt-div"),this._element.classList.add("lt-package-badge","lt-package-badge--"+this._type,"lt-package-badge--"+this._size),this._element.textContent=this._type,this._parentElement.appendChild(this._element)}getElement(){return this._element}}
/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
ie.init(new
/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
class extends re{addEventListener(e,t){}setLocale(e){}getMessage(e,t){return Ee().i18n.getMessage?Ee().i18n.getMessage(e,t):e}}),ce.init((()=>new Ue)),w.init(new
/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
class extends U{constructor(){super(...arguments),this._isProductionEnvironmentCached=null}isProductionEnvironment(){if(null===this._isProductionEnvironmentCached){if(e.isSafari())return!0;e.isFirefox()||e.isThunderbird()?this._isProductionEnvironmentCached=!Ee().runtime.id.match("languagetool.dev"):this._isProductionEnvironmentCached="update_url"in Ee().runtime.getManifest()}return this._isProductionEnvironmentCached}isRuntimeConnected(){try{return Ee().runtime.getManifest(),!0}catch(e){return!1}}getVersion(){if(this.isRuntimeConnected()){const e=Ee().runtime.getManifest();return e&&e.version?e.version:"unknown"}return"unknown"}getTrackingId(){return e.isSafari()?"13":e.isThunderbird()?"22":"12"}shouldTrack(){return"1"!==navigator.doNotTrack&&!e.isFirefox()}getPinnedState(){const e=Ee();return e.action&&"function"==typeof e.action.getUserSettings?e.action.getUserSettings().then((e=>Promise.resolve("boolean"==typeof e.isOnToolbar?e.isOnToolbar:null))).catch((()=>Promise.resolve(null))):Promise.resolve(null)}getType(){return"extension"}getBeforeUnloadEventName(){return"pagehide"}getURL(e){return Ee().runtime.getURL(e)}getUILanguageCode(){return Ee().i18n.getUILanguage?Ee().i18n.getUILanguage():navigator.language}openWindow(e){Ee().runtime.sendMessage({command:"OPEN_URL",url:e})}injectExecutor(){return new Promise(((t,n)=>{if(e.isThunderbird())return t();const s=setTimeout((()=>{n()}),2e3),r=function(){const e=document.createElement("script");return e.setAttribute("data-cookieconsent","ignore"),e}();r.src=Ee().runtime.getURL("/content/executor.js"),r.async=!0,r.setAttribute("fetchpriority","low"),r.onload=function(){r.remove(),clearTimeout(s),t()},r.onerror=function(){r.remove(),clearTimeout(s),n()},(document.head||document.documentElement).appendChild(r)}))}destroyExecutor(){Te(document,"lt-execute-destroy")}executeScript(e,t){const n=new self.Object;n.code=t,Te(e,"lt-execute-code",n)}linkInputAreaProperties(e){Te(e,"lt-execute-link-properties")}ping(){return new Promise(((e,t)=>{const n=self.setTimeout((()=>t("timeout")),5e3);Ee().runtime.sendMessage({command:"BACKGROUND_PING"}).then((s=>{self.clearTimeout(n),"success"===s?e():t("unknown")})).catch((()=>{self.clearTimeout(n),t("error")}))}))}canLoadContentScripts(e){return"css"===e||2===Ee().runtime.getManifest().manifest_version}loadContentScripts(e,t){return this.isRuntimeConnected()&&this.canLoadContentScripts(t)?(Ee().runtime.getManifest().content_scripts.forEach((n=>{if("js"===t&&n.js){const t=n.js.map((e=>{const t=this.getURL(e);return fetch(t).then((e=>e.text()))}));return Promise.all(t).then((t=>{const n=t.join("\n");if("eval"in e&&"function"==typeof e.eval){if("safari"in e)try{e.eval("window.safari = window.safari || window.parent.safari;")}catch{}e.eval(n)}}))}if("css"===t&&n.css)return this.loadStylesheets(e,n.css)})),Promise.resolve()):Promise.reject()}loadStylesheets(e,t){const n=(Array.isArray(t)?t.map((e=>[null,e])):Object.entries(t)).map((([e,t])=>{const n=this.getURL(t);return fetch(n).then((e=>e.text())).then((t=>[e,t]))}));return Promise.all(n).then((t=>{t.forEach((([t,n])=>{const s=e.document.createElement("style");s.textContent=n,t&&s.setAttribute("id",t),(e.document.head||e.document.documentElement).appendChild(s)}))}))}injectShadowStyles(e){!function(e,t){const n=t||"content/styles/shadow.css",s=Ee().runtime.getURL(n);if(!e.querySelector(`[href="${s}"]`)){const t=document.createElement("link");t.href=s,t.rel="stylesheet",e.append(t)}}(e)}initializeLTAssistant(e,t={}){return Promise.resolve()}getPreferredLanguages(){return Ee().runtime.sendMessage({command:"GET_PREFERRED_LANGUAGES"})}startDictionarySync(){return Ee().runtime.sendMessage({command:"START_DICTIONARY_SYNC"})}updateDictionary(){return Ee().runtime.sendMessage({command:"UPDATE_DICTIONARY"})}addWordToDictionary(e){const t={command:"ADD_WORD_TO_DICTIONARY",word:e};return Ee().runtime.sendMessage(t)}addWordsToDictionary(e){const t={command:"BATCH_ADD_WORDS_TO_DICTIONARY",words:e};return Ee().runtime.sendMessage(t)}removeWordFromDictionary(e){const t={command:"REMOVE_WORD_FROM_DICTIONARY",word:e};return Ee().runtime.sendMessage(t)}clearDictionary(){return Ee().runtime.sendMessage({command:"CLEAR_DICTIONARY"})}loadSynonyms(e,t,n){const s={command:"LOAD_SYNONYMS",wordContext:e,language:t,motherTongue:n};return Ee().runtime.sendMessage(s)}abortSynonymsRequest(){return Ee().runtime.sendMessage({command:"ABORT_SYNONYMS_REQUEST"})}loadPhrases(e,t,n,s,r){const i={command:"LOAD_PHRASES",uuid:e,phrase:t,language:n,inhouseOnly:s,user:r};return Ee().runtime.sendMessage(i)}abortPhraseRequests(e){const t={command:"ABORT_PHRASE_REQUESTS",type:e};return Ee().runtime.sendMessage(t)}initializeUserActivity(e){const t={command:"INITIALIZE_USER_ACTIVITY",data:e};return Ee().runtime.sendMessage(t)}sendUserActivityPings(e){const t={command:"SEND_USER_ACTIVITY_PINGS",uuids:e};return Ee().runtime.sendMessage(t)}updateUserActivityTextStatistics(e,t){const n={command:"UPDATE_USER_ACTIVITY_TEXT_STATISTICS",uuid:e,stats:t};return Ee().runtime.sendMessage(n)}updateUserActivityAppliedSuggestions(e,t,n){const s={command:"UPDATE_USER_ACTIVITY_APPLIED_SUGGESTIONS",isPremium:n,type:t,uuid:e};return Ee().runtime.sendMessage(s)}updateUserActivityAppliedRewritings(e){const t={command:"UPDATE_USER_ACTIVITY_APPLIED_REWRITINGS",uuid:e};return Ee().runtime.sendMessage(t)}updateUserActivityMeta(e,t){const n={command:"UPDATE_USER_ACTIVITY_META",uuid:e,meta:t};return Ee().runtime.sendMessage(n)}sendUserActivity(e){const t={command:"SEND_USER_ACTIVITY",uuid:e};return Ee().runtime.sendMessage(t)}destroyUserActivity(e){const t={command:"DESTROY_USER_ACTIVITY",uuid:e};return Ee().runtime.sendMessage(t)}loadSplitSentence(e,t,n,s,r){const i={command:"LOAD_SPLIT_SENTENCE",uuid:e,phrase:t,language:n,inhouseOnly:s,user:r};return Ee().runtime.sendMessage(i)}trackEvent(e,t){const n={command:"TRACK_EVENT",action:e,label:t};return Ee().runtime.sendMessage(n)}pageLoaded(e,t,n,s,r){const i={command:"PAGE_LOADED",enabled:e,supported:t,beta:n,unsupportedMessage:s,isDarkMode:r};return Ee().runtime.sendMessage(i)}ltAssistantStatusChanged(e,t){const n={command:"LTASSISTANT_STATUS_CHANGED",tabId:"number"==typeof e?e:void 0,enabled:("object"==typeof e?e:t).enabled};return Ee().runtime.sendMessage(n)}check(e,t,n,s,r,i){const a={command:"CHECK_TEXT",text:t,changedParagraphs:n,language:e.language,forceLanguage:e.forceLanguage,hasUserChangedLanguage:i,metaData:s,options:r};return Ee().runtime.sendMessage(a)}fetchRecommendationForSentence(e){const t={command:"FETCH_SENTENCE_RECOMMENDATION",...e};return Ee().runtime.sendMessage(t)}isOptionsPageSupported(){return!0}openOptionsPage(e,t){const n={command:"OPEN_OPTIONS",target:e,ref:t};return Ee().runtime.sendMessage(n)}isFeedbackFormSupported(){return!0}openFeedbackForm(e,t="",n=""){const s={command:"OPEN_FEEDBACK_FORM",url:e,title:t,html:n};return Ee().runtime.sendMessage(s)}openPremiumPage(e,t=0,n=0,s=0,r="",i){const a={command:"OPEN_PREMIUM_PAGE",campaign:e,hiddenGrammarMatches:t,hiddenStyleMatches:n,hiddenPunctuationMatches:s,historicMatches:r,textLanguage:i||void 0};return Ee().runtime.sendMessage(a)}checkForPaidSubscription(){return Ee().runtime.sendMessage({command:"CHECK_FOR_PAID_SUBSCRIPTION"})}canUseShadowDom(){return!navigator.webdriver}toolboxNetworkInitiateRequest(e){const t=k(),n=this.toolboxNetworkGetRequestData(t,e);return{abort:()=>{this.toolboxNetworkAbortRequest(t)},getData:()=>n}}toolboxNetworkInitiateStream(e){const t=k(),n=this.toolboxNetworkGetStreamData(t,e);return{abort:()=>{this.toolboxNetworkAbortRequest(t)},getStream:()=>n}}toolboxNetworkGetRequestData(e,t){const{runtime:n}=Ee(),s={command:"TOOLBOX_NETWORK_GET_REQUEST_DATA",options:t,uuid:e};return n.sendMessage(s)}toolboxNetworkGetStreamData(e,t){const{runtime:n}=Ee(),s={command:"TOOLBOX_NETWORK_GET_STREAM_DATA",options:t,uuid:e},r=n.sendMessage(s);let i;const a=new ReadableStream({start(e){i=e}}),o=()=>{i.close(),n.onMessage.removeListener(c)},l=self.setTimeout((()=>{i.enqueue({status:"error",data:"timeout"}),o()}),1e4),c=t=>{if(!function(e){return"TOOLBOX_NETWORK_SEND_RESPONSE_CHUNK"===e.command}(t)||t.uuid!==e)return;clearTimeout(l);const{data:n,done:s,status:r}=t;i.enqueue({status:r,data:n}),s&&o()};return n.onMessage.addListener(c),r.catch((e=>{clearTimeout(l),i.enqueue({data:Object(e).message||String(e),status:"error"}),o()})),a}toolboxNetworkAbortRequest(e){const t={command:"TOOLBOX_NETWORK_ABORT_REQUEST",uuid:e};return Ee().runtime.sendMessage(t)}abortAllRequests(e){e.checkRequestController&&e.checkRequestController.abort();const t={command:"ABORT_ALL_REQUESTS",instanceId:e.id};return Ee().runtime.sendMessage(t)}getTermsOfServiceInfo(e){const t={command:"GET_TERMS_OF_SERVICE_INFO",version:e};return Ee().runtime.sendMessage(t)}acceptTermsOfService(e){const t={command:"ACCEPT_TERMS_OF_SERVICE",version:e};return Ee().runtime.sendMessage(t)}}),ke.init(new
/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
class{constructor(){this.TRACKING_BASE_URL="https://analytics.languagetoolplus.com/matomo/piwik.php",this.TRACKING_BASE_PAGE_URL="https://fake/",this.ACTIVITY_TRACK_INTERVAL=864e5,this.PING_TRACK_INTERVAL=6048e5,this.MAX_TIME=6e4,this.THROTTLE_REQUESTS=10,this._isInitialized=!1,this._isExtensionPinned=null,this._loggedErrors=null,this._errorCount=0}initialize(){if(this._isInitialized)return;this.TRACKING_SITE_ID=w.getTrackingId(),this.VERSION=w.getVersion(),this._storageController=ce.create();const e=w.getURL("/");self.addEventListener("error",(t=>{const n=t.message,s=t.filename,r=t.lineno,i=t.error;if(!s||!s.startsWith(e))return;if("string"!=typeof n)return;if(n.includes("ResizeObserver"))return;const a=i&&function(e){if(!e.stack)return;const t=[];if(e.stack.split(/\n/).forEach((e=>{const n=e.match(/([\w_<>]+)\s+\(.+?([\w_\-]+\.(js|html))/);n&&t.push(`${n[2]}:${n[1]}`)})),!t.length){const n=e.stack.match(/([\w_\-]+\.(js|html))/);n&&t.push(n[1])}return t.join(",").substr(0,140)}(i);a?this.trackError("js",n,a):this.trackError("js",n,`${s}:${r}`)})),this._isInitialized=!0,this.trackActiveAfterOneWeek(),w.getPinnedState().then((e=>{this._isExtensionPinned=e}))}getCustomDimensions(e){const t=this._storageController.getSettings(),n=this._storageController.getUIState(),s=this._storageController.getTestFlags(),r=this._storageController.getPrivacySettings(),i={dimension2:this.VERSION,dimension3:String(n.hasPaidSubscription),dimension4:String(Boolean(t.username&&(t.password||t.token))),dimension5:t.preferredLanguages.join(","),dimension6:String(t.hasPickyModeEnabledGlobally),dimension7:String(s.testGroups.qb),dimension13:n.showRuleId?"{}":JSON.stringify(s.testGroups),dimension14:"boolean"==typeof this._isExtensionPinned?String(this._isExtensionPinned):"unknown",dimension15:String(r.acceptedTermsOfServiceVersion||"none")};return e?.writingGoal&&(i.dimension8=e.writingGoal),e?.errorType&&(i.dimension9=e.errorType),i}_getTrackingUrlForPageView(e,t){return e=(e=e.replace(/^(chrome|moz|safari|edge)-extension:\/\/.+?\//i,"")).replace(/^[a-z0-9]{8}\//i,"/"),e=`${this.TRACKING_BASE_PAGE_URL}${e}`,new Promise(((n,s)=>{this._storageController.onReady((()=>{const{firstVisit:s,sessionCount:r}=this._storageController.getStatistics(),i=this._storageController.getUniqueId(),a=new URL(this.TRACKING_BASE_URL),o=[self.screen?.width??0,self.screen?.height??0],l={idsite:this.TRACKING_SITE_ID,rec:"1",url:e,rand:String(Date.now()),apiv:"1",res:o.join("x"),_id:String(i),_idts:String(s),_idvc:String(r),...this.getCustomDimensions(t)};for(const[e,t]of Object.entries(l))a.searchParams.append(e,t);n(a.toString())}))}))}_getTrackingUrlForEvent(e,t,n="",s,r){return s=s||this.TRACKING_BASE_PAGE_URL,new Promise(((i,a)=>{this._storageController.onReady((()=>{const{firstVisit:a,sessionCount:o}=this._storageController.getStatistics(),l=this._storageController.getUniqueId(),c=new URL(this.TRACKING_BASE_URL),d=[self.screen?.width??0,self.screen?.height??0],g={idsite:this.TRACKING_SITE_ID,rec:"1",url:s||"",action_name:t,rand:String(Date.now()),apiv:"1",res:d.join("x"),_id:l,_idts:String(a),_idvc:String(o),e_c:e,e_a:t,e_n:n??"",...this.getCustomDimensions(r)};for(const[e,t]of Object.entries(g))c.searchParams.append(e,t);i(c.toString())}))}))}_sendRequest(e){!w.shouldTrack()||this._storageController.hasCustomServer()||this._storageController.hasCustomLogin()||navigator.webdriver||x(e,{mode:"no-cors",referrerPolicy:"no-referrer",keepalive:"standalone"===w.getType()},1e4).catch((()=>null))}trackPageView(e,t){e=e||R(),this._getTrackingUrlForPageView(e,t).then((t=>{w.isProductionEnvironment()?this._sendRequest(t):console.log("LT_Tracking Page view tracking disabled in dev mode",{pageUrl:e,trackingUrl:t})})).catch((e=>{console.log("LT could not track because:",e&&e.message)}))}trackDisabledRule(e,t,n,s){if(!e.match(/^de|en|nl|es|fr|ca|pt/i))return;const r=s?q:j,i=e+":"+t,a=n,o=new URL(this.TRACKING_BASE_URL);o.searchParams.append("idsite","18"),o.searchParams.append("rec","1"),o.searchParams.append("url",this.TRACKING_BASE_PAGE_URL),o.searchParams.append("action_name",r),o.searchParams.append("rand",String(Date.now())),o.searchParams.append("apiv","1"),o.searchParams.append("_id",this._storageController.getUniqueId()),o.searchParams.append("e_c",r),o.searchParams.append("e_a",i),o.searchParams.append("e_n",n),w.isProductionEnvironment()?this._sendRequest(o.toString()):console.log("LT_Tracking Event tracking disabled in dev mode",{actionCategory:r,action:i,actionName:a,trackingUrl:o})}trackDictionaryEvent(e,t,n){if(!e.match(/^de|en|nl|es|fr|it|pt|ru|ca|pl/i))return;const s=n?"TemporaryIgnored":"PersistentlyIgnored",r=`${e}:add_word`,i=t,a=new URL(this.TRACKING_BASE_URL);a.searchParams.append("idsite","19"),a.searchParams.append("rec","1"),a.searchParams.append("url",this.TRACKING_BASE_PAGE_URL),a.searchParams.append("action_name",s),a.searchParams.append("rand",String(Date.now())),a.searchParams.append("apiv","1"),a.searchParams.append("_id",this._storageController.getUniqueId()),a.searchParams.append("e_c",s),a.searchParams.append("e_a",r),a.searchParams.append("e_n",t),w.isProductionEnvironment()?this._sendRequest(a.toString()):console.log("LT_Tracking Event tracking disabled in dev mode",{actionCategory:s,action:r,actionName:i,trackingUrl:a})}trackEvent(e,t,n,s,r){this._getTrackingUrlForEvent(e,t,n,s,r).then((s=>{w.isProductionEnvironment()?this._sendRequest(s):console.log("LT_Tracking Event tracking disabled in dev mode",{actionCategory:e,action:t,actionName:n,trackingUrl:s})})).catch((e=>{console.log("LT could not track because:",e&&e.message)}))}trackInstall(){this.trackEvent("Action","install",ae.getPrimaryLanguageCode(navigator.language)),this._storageController.updateUIState({isNewUser:!0})}trackActivity(){this._storageController.onReady((()=>{const e=Date.now(),{sessionCount:t,lastActivity:n,lastPing:s}=this._storageController.getStatistics();(!n||e-n>this.ACTIVITY_TRACK_INTERVAL)&&this._storageController.updateStatistics({sessionCount:t+1,lastActivity:e}).then((()=>{this.trackUserActivity()})),(!s||e-s>this.PING_TRACK_INTERVAL)&&this._storageController.updateStatistics({lastPing:e}).then((()=>{this.trackEvent("Stat","ping")}))}))}trackActiveAfterOneWeek(){this._storageController.onReady((()=>{const e=Date.now(),{firstVisit:t}=this._storageController.getStatistics(),{isNewUser:n}=this._storageController.getUIState();if(n&&t){const n=6048e5,s=e-1e3*t;s>n&&s<8*n&&this._storageController.updateUIState({isNewUser:!1}).then((()=>{this.trackEvent("Action","active_after_one_week",ae.getPrimaryLanguageCode(navigator.language))})).catch((()=>null))}}))}trackUserActivity(){this._storageController.onReady((()=>{const{username:t}=this._storageController.getSettings();if(!t||this._storageController.hasCustomServer())return;const n=new FormData;n.append("email",t),n.append("useragent",e.getUserAgentIdentifier()),x("https://languagetool.org/ping",{method:"POST",mode:"cors",credentials:"omit",body:n},1e4).catch((()=>null))}))}trackError(t,n,s=""){try{if(e.isUnsupportedBrowser())return;if(this._errorCount++,this._errorCount>6)return;if("string"!=typeof n)return;if(this._loggedErrors)if(this._loggedErrors.length<this.THROTTLE_REQUESTS)this._loggedErrors.push(Date.now());else{const e=Date.now();if(!(e-this._loggedErrors[0]>=this.MAX_TIME))return;this._loggedErrors.push(e),this._loggedErrors.splice(0,1)}else this._loggedErrors=[Date.now()];let r="JS-Error";"message"===t?r="Message-Error":"http"===t?r="HTTP-Error":"other"===t&&(r="Other-Error");let i=R();i=i.replace(/^moz-extension:\/\/[a-z0-9\-]+\//,"moz-extension://xxxx-xxxx-xxxx-xxxx/"),i.match(/(chrome|moz|safari)\-extension:/)||(i=void 0),this.trackEvent(r,n,s||i,i)}catch(e){console.error("Error while logging error from language tool",e)}}trackStat(e,t){0===Math.floor(10*Math.random())&&this.trackEvent("Stat",e,t)}trackPerformanceMetrics(){}});const Ge=document.getElementById("banner"),Be=document.getElementById("login"),Fe=document.getElementById("login-options"),We=document.getElementById("logout-button"),He=document.getElementById("manage-account-button"),Ve=document.getElementById("login-popup-button"),Xe=document.getElementById("lt-options__package-badge-container"),Ze=document.getElementById("managed-login"),Ye=document.getElementById("managed-login-options"),Ke=document.getElementById("managed-login-button"),$e=document.getElementById("managed-logout-button"),je=document.getElementById("lt-options-discount"),qe=document.getElementById("toggleSynonymsSwitch"),ze=document.getElementById("togglePickyModeSwitch"),Je=document.getElementById("toggleRephrasingSwitch"),Qe=document.getElementById("context-menu-toggle-wrapper"),et=document.getElementById("toggleContextMenuSwitch"),tt=document.getElementById("openCardHotkey"),nt=document.getElementById("personalDictionary"),st=document.getElementById("personalDictionary-options"),rt=document.getElementById("personalDictionaryList"),it=document.getElementById("personalDictionaryInput"),at=document.getElementById("addToPersonalDictionary"),ot=document.getElementById("personalDictionary-options__clearAll"),lt=document.getElementById("personalDictionary-options__copy"),ct=document.getElementById("ignoredRules"),dt=document.getElementById("ignoredRules-options"),gt=document.getElementById("ignoredRulesList"),ut=document.getElementById("ignoredRules-options__clearAll"),mt=document.getElementById("disabledDomains"),ht=document.getElementById("disabledDomains-options"),Et=document.getElementById("disabledDomainsList"),_t=document.getElementById("disabledDomainsInput"),pt=document.getElementById("addToDisabledDomains"),ft=document.getElementById("disabledDomains-options__clearAll"),At=document.getElementById("language"),St=document.getElementById("language-options"),Tt=document.getElementById("preferred-languages-count"),It=document.getElementById("preferred-languages"),yt=document.getElementById("new-preferred-languages"),Ct=document.getElementById("experimental"),Rt=document.getElementById("experimental-options"),Nt=document.getElementById("serverUrl"),Lt=document.getElementById("serverUrlFieldset"),Ot=document.getElementById("serverUrl-disabled"),Pt=document.getElementById("serverType-cloud"),bt=document.getElementById("serverType-local"),vt=document.getElementById("serverType-custom"),Dt=document.getElementById("localServerAvailabilityWarning"),xt=document.getElementById("retryLocalServer"),kt=document.getElementById("customServerUrl"),Ut=document.getElementById("motherTongue"),wt=document.getElementById("variant-en"),Mt=document.getElementById("variant-de"),Gt=document.getElementById("variant-pt"),Bt=document.getElementById("variant-ca"),Ft=document.getElementById("oxfordSpellingOption"),Wt=document.getElementById("force-preferred-languages"),Ht=document.getElementById("autoCheckAllDomains"),Vt=document.getElementById("autoCheckDomains-options"),Xt=document.getElementById("autoCheckDomains"),Zt=document.getElementById("autoCheckDomainInput"),Yt=document.getElementById("auto-check-domains-wrapper"),Kt=document.getElementById("auto-check-domains-options-wrapper"),$t=document.getElementById("addToAutoCheckDomains"),jt=document.getElementById("autoCheckDomains-options__clearAll"),qt=document.getElementById("ignoredDomains-options"),zt=document.getElementById("ignoredDomains"),Jt=document.getElementById("ignoredDomainInput"),Qt=document.getElementById("addToIgnoredDomains"),en=document.getElementById("ignoredDomains-options__clearAll"),tn=document.getElementById("copyright-link"),nn=document.getElementById("synonyms-toggle-wrapper"),sn=document.getElementById("rephrasing-toggle-wrapper"),rn=document.getElementById("current-year"),an=document.querySelectorAll("[data-lt-nice-select]"),on=ce.create();function ln(){const{hasPaidSubscription:e}=on.getUIState();document.body.classList.toggle("lt-options--plus",e),Xe.innerHTML="",new Me(null,e?"premium":"basic","default",Xe),function(){const{username:e,token:t,password:n}=on.getSettings(),s=document.getElementById("lt-login"),r=document.getElementById("lt-account");e&&(n||t)?(s.style.display="none",r.style.display="block",Ot.style.display="block",Lt.setAttribute("disabled",""),fe("#account-text",{key:"settingsLoggedInAs",isHTML:!0,interpolations:[`<strong>${e}</strong>`]})):(s.style.display="block",r.style.display="none",Ot.style.display="none",Lt.removeAttribute("disabled"))}(),cn()}function cn(){const{apiServerUrl:e,disablePersonalDictionary:t,disableIgnoredRules:n,loginUrl:s,disableOpenInEditor:r,allowedURLs:i}=on.getManagedSettings(),{username:a,token:o,password:l}=on.getSettings();t&&(nt.style.display="none",st.style.display="none"),n&&(ct.style.display="none",dt.style.display="none"),e&&(Nt.style.display="none",Ge.style.display="none",Be.style.display="none",Fe.style.display="none",nn.style.display="none",sn.style.display="none"),s&&(Ge.style.display="none",Be.style.display="none",Fe.style.display="none",He.style.display="none",Ct.style.display="none",Rt.style.display="none",Ze.style.display="",Ye.style.display=""),r&&(Qe.style.display="none");const c=ve(i);c&&(Yt.style.display="none",Kt.style.display="none",mt.style.display="none",ht.style.display="none"),c&&e&&(Rt.style.display="none",Ct.style.display="none");const d=document.getElementById("managed-login-box"),g=document.getElementById("managed-logout-box");a&&(l||o)?(d.style.display="none",g.style.display="block",fe("#managed-account-text",{key:"settingsLoggedInAs",isHTML:!0,interpolations:[`<strong>${a}</strong>`]})):(d.style.display="block",g.style.display="none")}function dn(e){if(!(e.target instanceof HTMLButtonElement))return;const t=e.target.closest("[data-preferred-language]");if(!t||"string"!=typeof t.dataset.preferredLanguage)return;const{preferredLanguages:n}=on.getSettings(),s=n.indexOf(t.dataset.preferredLanguage);-1!==s&&(on.updateSettings({preferredLanguages:n.slice(0,s).concat(n.slice(s+1))}),un())}function gn(e){if(!(e.target instanceof HTMLSelectElement))return;const{preferredLanguages:t}=on.getSettings();on.updateSettings({preferredLanguages:A(t.concat([e.target.value]))}),un()}function un(){const{preferredLanguages:e}=on.getSettings(),t=Array.from(document.querySelectorAll("[data-preferred-language]")),n=Array.from(yt.querySelectorAll("optgroup"));t.concat(n).forEach((e=>{e.remove()})),e.forEach((e=>{const t=ae.ALL_LANGUAGES.find((({code:t})=>t===e));if(!t)return;const n=Object.assign(document.createElement("span"),{textContent:t.name,className:"lt-pill-box__item__text"}),s=Object.assign(document.createElement("button"),{className:"lt-pill-box__item__delete lt-icon lt-icon__close_small",type:"button"}),r=Object.assign(document.createElement("div"),{className:"lt-pill-box__item lt-pill-box__item--option"});r.dataset.preferredLanguage=e,r.appendChild(n),r.appendChild(s),It.insertBefore(r,yt.parentNode)}));const s=document.createElement("optgroup"),r=document.createElement("optgroup");ae.ALL_LANGUAGES.forEach((t=>{if(e.includes(t.code))return;const n=Object.assign(document.createElement("option"),{value:t.code,textContent:t.name});ae.POPULAR_LANGUAGES.includes(t.code)&&s.appendChild(n.cloneNode(!0)),r.appendChild(n)})),s.setAttribute("data-t-attr",JSON.stringify(["label","settingsPreferredLanguagesPopularList"])),r.setAttribute("data-t-attr",JSON.stringify(["label","settingsPreferredLanguagesCompleteList"])),yt.appendChild(s),yt.appendChild(r),Tt.textContent=e.length?`(${e.length})`:"",Ae(yt);const i=document.createElement("span");i.classList.add("lt-icon__info"),i.addEventListener("click",wn),Ft.parentElement?.appendChild(i)}function mn(e,t){e.value=t,e.dispatchEvent(new Event("change",{bubbles:!0}))}function hn(){on&&(qe.classList.add("lt-toggle--checked"),on.updateSettings({hasSynonymsEnabled:!0}))}function En(){on&&(qe.classList.remove("lt-toggle--checked"),on.updateSettings({hasSynonymsEnabled:!1}))}function _n(){on&&(ze.classList.add("lt-toggle--checked"),on.updateSettings({hasPickyModeEnabledGlobally:!0}))}function pn(){on&&(ze.classList.remove("lt-toggle--checked"),on.updateSettings({hasPickyModeEnabledGlobally:!1}))}function fn(){on&&(Je.classList.add("lt-toggle--checked"),on.updateSettings({hasRephrasingEnabled:!0}))}function An(){on&&(Je.classList.remove("lt-toggle--checked"),on.updateSettings({hasRephrasingEnabled:!1}))}function Sn(){on&&(et.classList.add("lt-toggle--checked"),on.updateSettings({hasContextMenuOptionEnabled:!0}),Ee().runtime.sendMessage({command:"UPDATE_CONTEXT_MENU"}))}function Tn(){on&&(et.classList.remove("lt-toggle--checked"),on.updateSettings({hasContextMenuOptionEnabled:!1}),Ee().runtime.sendMessage({command:"UPDATE_CONTEXT_MENU"}))}function In(e=de.getSorted(),t=0===de.get().length){rt.innerHTML="";for(const t of e){const e=document.createElement("li");e.className="lt-personal-dictionary__item";const n=document.createElement("span");n.className="lt-personal-dictionary__title",n.textContent=t,n.title=t,e.appendChild(n);const s=document.createElement("span");s.className="lt-personal-dictionary__delete-button",s.dataset.word=t,s.addEventListener("click",Rn),e.appendChild(s),rt.appendChild(e)}const n=document.getElementById("personalDictionary-optionsInside"),s=document.getElementById("personalDictionary-options__emptyState"),r=document.getElementById("personalDictionary-options__emptySearch");e.length>0?(n.style.display="block",s.style.display="none",r.style.display="none"):t?(n.style.display="none",s.style.display="block",r.style.display="none"):(n.style.display="none",s.style.display="none",r.style.display="block")}function yn(){const e=it.value;at.disabled=""===e.trim();const t=de.getSorted(),n=[];for(const s of t)s.includes(e)&&n.push(s);In(n,0===t.length)}function Cn(){const{username:e,password:t,token:n}=on.getSettings(),s=e&&(t||n),r=document.getElementById("personalDictionary-error"),i=it.value.trim(),a=Boolean(i.match(/\s+/));i&&(s||!a?(de.add(i).then((()=>In())),it.value="",at.disabled=!0):(fe(r,"personalDictionaryMultipleWordError"),r.style.display="block",_e(3e3).then((()=>Se(r,(()=>{r.style.display="",r.style.opacity=""}))))))}function Rn(e){const t=e.currentTarget.dataset.word;t&&de.remove(t).then(yn)}function Nn(){gt.innerHTML="";const e=on.getSettings().ignoredRules.filter((e=>"OXFORD_SPELLING_Z_NOT_S"!==e.id)),t=ie.getMessage("enableRuleTooltip");for(const n of e){if(n.language){const e=ae.getUserLanguageCodes().some((e=>n.language.toLowerCase().startsWith(e)||"*"===n.language));if(le.getDefaultSettings().ignoredRules.some((e=>e.id===n.id))&&!e)continue}const e=document.createElement("li");e.className="lt-options__rules__item";const s=document.createElement("span");s.className="lt-options__rules__title",s.textContent="- "+(n.description||n.id),e.appendChild(s);const r=document.createElement("span");r.className="lt-options__rules__enable-button",r.setAttribute("title",t),r.dataset.ruleId=n.id,r.textContent=t,r.addEventListener("click",Ln),e.appendChild(r),gt.appendChild(e)}const n=document.getElementById("ignoredRules-optionsInside"),s=document.getElementById("ignoredRules-options__emptyState");e.length>0?(n.style.display="block",s.style.display="none"):(n.style.display="none",s.style.display="block")}function Ln(e){const t=e.currentTarget.dataset.ruleId;t&&on.removeIgnoredRule(t).then(Nn)}function On(e=on.getSettings().disabledDomains,t=on.getSettings().disabledDomains.length>0){Et.innerHTML="";const n=ie.getMessage("settingsEnableDomain");for(const t of e){const e=document.createElement("li");e.className="lt-options__rules__item";const s=document.createElement("span");s.className="lt-options__rules__title",s.textContent="● "+t,e.appendChild(s);const r=document.createElement("span");r.className="lt-options__rules__enable-button",r.setAttribute("title",n),r.dataset.domain=t,r.textContent=n,r.addEventListener("click",Dn),e.appendChild(r),Et.appendChild(e)}const s=document.getElementById("disabledDomains-optionsInside"),r=document.getElementById("disabledDomains-options__emptyState"),i=document.getElementById("disabledDomains-options__emptySearch");e.length>0?(s.style.display="block",r.style.display="none",i.style.display="none"):t?(s.style.display="none",r.style.display="block",i.style.display="none"):(s.style.display="none",r.style.display="none",i.style.display="block")}function Pn(){const e=_t.value;pt.disabled=""===e.trim();const t=on.getSettings().disabledDomains.sort(((e,t)=>e.toLowerCase().localeCompare(t.toLowerCase()))),n=[];for(const s of t)s.includes(e)&&n.push(s);On(n,0===t.length)}function bn(e){if(_t.value)return;if(!e.clipboardData)return;const t=e.clipboardData.getData("text/plain");if(!t)return;const n=t.split(/\s+/);if(n.length<=1)return;e.preventDefault();const s=on.getSettings().disabledDomains;n.forEach((e=>{const t=N(e,"");t.trim()&&be(e)&&!s.includes(t)&&s.push(t)})),on.updateSettings({disabledDomains:s}).then(Pn)}function vn(){const e=_t.value.trim(),t=N(e,"");if(""===t.trim()||!be(e))return void alert(ie.getMessage("settingsDomainInvalid"));_t.value="",pt.disabled=!0;const n=on.getSettings().disabledDomains;n.includes(t)?On(n,!1):(n.push(t),on.updateSettings({disabledDomains:n}).then((()=>On(n,!1))))}function Dn(e){const t=e.currentTarget.dataset.domain;if(t){const e=on.getSettings().disabledDomains.filter((e=>e!==t));on.updateSettings({disabledDomains:e}).then(Pn)}}function xn(){kn(vt.checked),bt.checked?Un():Dt.style.display="none"}function kn(e=!1){kt.style.display=e?"block":"none",kt.required=e,e?kt.value=kt.dataset.prevValue||"":(kt.dataset.prevValue=kt.value,kt.value="")}function Un(){fetch(V+"/languages",{method:"GET",mode:"cors"}).then((()=>{Dt.style.display="none"})).catch((()=>{Dt.style.display="block"}))}function wn(){w.openWindow("https://languagetool.org/insights/post/ise-ize/")}function Mn(e=!1){Vt.style.display=e?"none":"",qt.style.display=e?"":"none"}function Gn(e=on.getSettings().autoCheckOnDomains,t=0===on.getSettings().autoCheckOnDomains.length){Xt.innerHTML="";const n=ie.getMessage("settingsDeleteAutoCheckDomain");for(const t of e){const e=document.createElement("li");e.className="lt-options__rules__item";const s=document.createElement("span");s.className="lt-options__rules__title",s.textContent="● "+t,e.appendChild(s);const r=document.createElement("span");r.className="lt-options__rules__enable-button",r.setAttribute("title",n),r.dataset.domain=t,r.textContent=n,r.addEventListener("click",Wn),e.appendChild(r),Xt.appendChild(e)}const s=document.getElementById("autoCheckDomains-optionsInside"),r=document.getElementById("autoCheckDomains-options__emptyState"),i=document.getElementById("autoCheckDomains-options__emptySearch");e.length>0?(s.style.display="block",r.style.display="none",i.style.display="none"):t?(s.style.display="none",r.style.display="block",i.style.display="none"):(s.style.display="none",r.style.display="none",i.style.display="block")}function Bn(){const e=Zt.value;$t.disabled=""===e.trim();const t=on.getSettings().autoCheckOnDomains.sort(((e,t)=>e.toLowerCase().localeCompare(t.toLowerCase()))),n=[];for(const s of t)s.includes(e)&&n.push(s);Gn(n,0===t.length)}function Fn(){const e=Zt.value.trim(),t=N(e,"");if(""===t.trim()||!be(e))return void alert(ie.getMessage("settingsDomainInvalid"));Zt.value="",$t.disabled=!0;const n=on.getSettings().autoCheckOnDomains;n.includes(t)?Gn(n,!1):(n.push(t),on.updateSettings({autoCheckOnDomains:n}).then((()=>Gn(n,!1))))}function Wn(e){const t=e.currentTarget.dataset.domain;if(t){const e=on.getSettings().autoCheckOnDomains.filter((e=>e!==t));on.updateSettings({autoCheckOnDomains:e}).then((()=>Gn(e,0===e.length)))}}function Hn(e=on.getSettings().ignoreCheckOnDomains,t=0===on.getSettings().ignoreCheckOnDomains.length){zt.innerHTML="";const n=ie.getMessage("settingsDeleteIgnoredDomain");for(const t of e){const e=document.createElement("li");e.className="lt-options__rules__item";const s=document.createElement("span");s.className="lt-options__rules__title",s.textContent="● "+t,e.appendChild(s);const r=document.createElement("span");r.className="lt-options__rules__enable-button",r.setAttribute("title",n),r.dataset.domain=t,r.textContent=n,r.addEventListener("click",Zn),e.appendChild(r),zt.appendChild(e)}const s=document.getElementById("ignoredDomains-optionsInside"),r=document.getElementById("ignoredDomains-options__emptyState"),i=document.getElementById("ignoredDomains-options__emptySearch");e.length>0?(s.style.display="block",r.style.display="none",i.style.display="none"):t?(s.style.display="none",r.style.display="block",i.style.display="none"):(s.style.display="none",r.style.display="none",i.style.display="block")}function Vn(){const e=Jt.value;Qt.disabled=""===e.trim();const t=on.getSettings().ignoreCheckOnDomains.sort(((e,t)=>e.toLowerCase().localeCompare(t.toLowerCase()))),n=[];for(const s of t)s.includes(e)&&n.push(s);Hn(n,0===t.length)}function Xn(){const e=Jt.value.trim(),t=N(e);if(""===t.trim()||!be(e))return void alert(ie.getMessage("settingsDomainInvalid"));Jt.value="",Qt.disabled=!0;const n=on.getSettings().ignoreCheckOnDomains;n.includes(t)?Hn(n,!1):(n.push(t),on.updateSettings({ignoreCheckOnDomains:n}).then((()=>Hn(n,!1))))}function Zn(e){const t=e.currentTarget.dataset.domain;if(t){const e=on.getSettings().ignoreCheckOnDomains.filter((e=>e!==t));on.updateSettings({ignoreCheckOnDomains:e}).then((()=>Hn(e,0===e.length)))}}self.__ltStorageController=on,Ae(document.documentElement),document.documentElement.lang=navigator.language,e.isSafari()?document.getElementById("haveAccountDesc").style.display="none":document.getElementById("haveAccountDesc").innerHTML=ie.getMessage("haveAccountDesc")+" <a target='_blank' href='https://languagetool.org'>LanguageTool.org</a>",document.getElementById("privacyPolicy").innerHTML="<a target='_blank' href='https://languagetool.org/privacy/'>"+ie.getMessage("privacyPolicy")+"</a>",Array.from(document.querySelectorAll("[data-premium-link]")).forEach((e=>{e.addEventListener("click",(e=>{Ee().runtime.sendMessage({command:"OPEN_PREMIUM_PAGE",campaign:"addon2-options"}),e.preventDefault()}))}));const Yn=location.hash.replace(/\?.*$/,""),Kn=document.querySelector(Yn||"#login");Kn&&Kn.nextElementSibling&&Kn.nextElementSibling.classList.contains("lt-toggle-box")&&(Kn.classList.add("lt-options-toggle--visible"),Kn.nextElementSibling.classList.add("lt-toggle-box--visible"),Yn&&document.documentElement.scrollTo(0,Kn.offsetTop-75));let $n;ae.getUserLanguageCodes().some((e=>e.startsWith("de")||e.startsWith("fr")||e.startsWith("nl")))&&(document.getElementById("made-in-potsdam").style.display="inline"),on.onReady((function(){ln(),In(),Nn(),On(),function(){const e=on.getSettings();e.apiServerUrl===W?(Pt.checked=!0,nn.style.display="",sn.style.display=""):e.apiServerUrl===V?(bt.checked=!0,nn.style.display="none",sn.style.display="none"):(kn(!0),vt.checked=!0,kt.value=e.apiServerUrl,nn.style.display="none",sn.style.display="none")}(),cn(),Array.from(an).forEach((e=>{const t=e.querySelector("select");t?.addEventListener("change",(()=>{const n=e.querySelector("span")||document.createElement("span"),s=Array.from(t.children).filter((e=>e instanceof HTMLOptionElement)).find((e=>e.value===t.value));n.parentNode&&n.parentNode.removeChild(n),n.textContent=s?.textContent||"",e.insertBefore(n,t),e.dataset.ltNiceSelect=t.value}))})),function(){const e=0===Date.now(),t=document.getElementById("desktop-app-teaser-container"),{hasSeenDesktopAppTeaser:n}=on.getUIState();if(e&&t&&!n){const e="options:desktop_app_teaser",n=ie.getMessage("desktopAppHeadlineMac"),s=ie.getMessage("desktopAppTextMac"),r=ie.getMessage("desktopAppAction");new we(t,e,n,s,r)}}(),It.addEventListener("click",dn),yt.addEventListener("change",gn),un();const e=on.getSettings();var t;mn(tt,e.openCardHotkey),mn(Ut,e.motherTongue),mn(wt,e.enVariant),mn(Mt,e.deVariant),mn(Gt,e.ptVariant),mn(Bt,e.caVariant),Ft.checked=!on.hasIgnoredRule("OXFORD_SPELLING_Z_NOT_S"),Wt.checked=on.getSettings().forcePreferredLanguages,t={isChecked:e.autoCheck},Ht.checked=t.isChecked,Ht.addEventListener("input",(()=>{on.updateSettings({autoCheck:Ht.checked}),Mn(Ht.checked)})),_t.addEventListener("keydown",(e=>{"Enter"===e.key&&vn()})),_t.addEventListener("input",(()=>{setTimeout(Pn,0)})),_t.addEventListener("paste",bn),Mn(e.autoCheck),e.hasSynonymsEnabled?hn():En(),function(e){e?_n():pn()}(e.hasPickyModeEnabledGlobally),function(e){e?fn():An()}(e.hasRephrasingEnabled),Gn(),Hn(),function(e){e?Sn():Tn()}(e.hasContextMenuOptionEnabled),on.addEventListener(le.eventNames.uiStateChanged,(e=>{"boolean"==typeof e.hasPaidSubscription?.newValue&&ln()}))})),on.onReady((()=>{on.startChangelogCoupon();const e=on.getActiveCoupon();e&&(clearInterval($n),$n=self.setInterval((()=>{je.querySelector("#lt-options-dicount-percent").textContent=ie.getMessage("upgradeTeaserDiscount",[e.percent]),je.querySelector("#lt-options-discount-expires").textContent=` – ${ie.getMessage("changelogDiscountExpires")} ${function(e){let t=e-Date.now();t<0&&(t=0);const n=Math.floor(t/1e3%60),s=Math.floor(t/1e3/60%60);return`${I(Math.floor(t/1e3/60/60))}:${I(s)}:${I(n)}`}(e.expires||0)}`,je.classList.add("lt-options__discount--visible")}),1e3))})),de.init(on),ke.trackPageView(),We.addEventListener("click",(e=>{e.preventDefault(),function(){const e=document.getElementById("login-success"),t=document.getElementById("login-error");on.updateSettings({username:"",password:"",userId:null,token:"",isDictionarySynced:!1}).then((()=>{ke.trackEvent("Action","logout"),e.style.display="block",fe(e,"settingsLogoutSuccess")})).catch((()=>{t.style.display="block",fe(t,"settingsUnknownError")})).then((()=>{on.checkForPaidSubscription().then(ln),Ee().runtime.sendMessage({command:"LOGOUT"})}))}()})),He.addEventListener("click",(e=>{e.preventDefault(),self.open("https://languagetool.org/editor/settings/account","_blank")})),Ke.addEventListener("click",(e=>{e.preventDefault(),function(){const{loginUrl:e}=on.getManagedSettings();Re(e,((e,t)=>(on.updatePrivacySettings({allowRemoteCheck:!0}),on.updateSettings({username:e,password:"",token:t,knownEmail:e}).then((()=>(cn(),on.checkForPaidSubscription()))).then((()=>{ln(),Ee().runtime.sendMessage({command:"START_DICTIONARY_SYNC"}),Ee().runtime.sendMessage({command:"LOGIN"})})))))}()})),$e.addEventListener("click",(e=>{e.preventDefault(),on.updateSettings({username:"",password:"",userId:null,token:"",isDictionarySynced:!1}).then((()=>{cn(),on.checkForPaidSubscription().then(ln),Ee().runtime.sendMessage({command:"LOGOUT"})}))})),Ve.addEventListener("click",(e=>{e.preventDefault(),function(){const e=document.getElementById("login-error"),t=document.getElementById("login-success");Ne("https://languagetool.org/client-login",((n,s)=>(on.updatePrivacySettings({allowRemoteCheck:!0}),on.updateSettings({username:n,password:"",token:s,knownEmail:n,apiServerUrl:W}).then((()=>{ke.trackEvent("Action","login",n),t.style.display="block",fe(t,"settingsLoginSuccess"),cn()})).catch((()=>(ke.trackEvent("Action","login_error",n),e.style.display="block",fe(e,"settingsLoginError"),!1))).then((e=>{if(!1!==e)return on.checkForPaidSubscription()})).catch((()=>{ke.trackEvent("Action","check_for_subscription_error",n),e.style.display="block",fe(e,"settingsCheckForPaidSubscriptionError")})).then((()=>{ln(),w.startDictionarySync()})).then((()=>{Ee().runtime.sendMessage({command:"LOGIN"})})))))}()})),qe.addEventListener("click",(()=>{qe.classList.contains("lt-toggle--checked")?(En(),ke.trackEvent("Action","disable_synonyms",ae.getUserLanguageCodes()[0])):(hn(),ke.trackEvent("Action","enable_synonyms",ae.getUserLanguageCodes()[0]))})),ze.addEventListener("click",(()=>{ze.classList.contains("lt-toggle--checked")?(pn(),ke.trackEvent("Action","disable_picky_mode",ae.getUserLanguageCodes()[0])):(_n(),ke.trackEvent("Action","enable_picky_mode",ae.getUserLanguageCodes()[0]))})),Je.addEventListener("click",(()=>{Je.classList.contains("lt-toggle--checked")?(An(),ke.trackEvent("Action","disable_rephrasing",ae.getUserLanguageCodes()[0])):(fn(),ke.trackEvent("Action","enable_rephrasing",ae.getUserLanguageCodes()[0]))})),et.addEventListener("click",(()=>{et.classList.contains("lt-toggle--checked")?(Tn(),ke.trackEvent("Action","disable_context_menu",ae.getUserLanguageCodes()[0])):(Sn(),ke.trackEvent("Action","disable_context_menu",ae.getUserLanguageCodes()[0]))})),tt.addEventListener("change",(function(t){const n=tt.value;on.updateSettings({openCardHotkey:n}),t.isTrusted&&ke.trackEvent("Action","set_shortcut",e.getOS()+":"+(n||"off"))})),"Windows"===e.getOS()&&tt.querySelector("[value='Alt']")?.remove(),nt.addEventListener("click",(()=>{st.classList.toggle("lt-toggle-box--visible"),nt.classList.toggle("lt-options-toggle--visible")&&it.focus()})),it.addEventListener("keydown",(e=>{"Enter"===e.key&&Cn()})),it.addEventListener("input",(()=>{setTimeout(yn,0)})),it.addEventListener("paste",(function(e){if(it.value)return;if(!e.clipboardData)return;const t=e.clipboardData.getData("text/plain");if(!t)return;const n=t.split(/\n+/);n.length<=1||(e.preventDefault(),de.addBatch(n).then((()=>In())))})),at.addEventListener("click",Cn),ot.addEventListener("click",(function(){confirm(ie.getMessage("settingsAreYouSure"))&&de.clear().then((()=>In([],!0)))})),lt.addEventListener("click",(function(){const e=de.getSorted(),t=document.createElement("textarea");t.value=e.join("\n"),document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t);const n=document.getElementById("personalDictionary-options__copyMessage");n.style.display="block",_e(3e3).then((()=>Se(n,(()=>{n.style.display="none",n.style.opacity="1"}))))})),ct.addEventListener("click",(()=>{ct.classList.toggle("lt-options-toggle--visible"),dt.classList.toggle("lt-toggle-box--visible")})),ut.addEventListener("click",(function(){on.updateSettings({ignoredRules:[]}).then(Nn)})),e.isThunderbird()?(mt.hidden=!0,document.body.setAttribute("data-is-thunderbird","true")):mt.addEventListener("click",(()=>{ht.classList.toggle("lt-toggle-box--visible"),mt.classList.toggle("lt-options-toggle--visible")&&_t.focus()})),pt.addEventListener("click",vn),ft.addEventListener("click",(function(){confirm(ie.getMessage("settingsAreYouSure"))&&on.updateSettings({disabledDomains:[]}).then((()=>On([],!0)))})),At.addEventListener("click",(()=>{At.classList.toggle("lt-options-toggle--visible"),St.classList.toggle("lt-toggle-box--visible")})),Ct.addEventListener("click",(()=>{Ct.classList.toggle("lt-options-toggle--visible"),Rt.classList.toggle("lt-toggle-box--visible")})),Pt.addEventListener("click",xn),bt.addEventListener("click",xn),vt.addEventListener("click",xn),xt.addEventListener("click",(e=>{e.preventDefault(),Un()})),Nt.addEventListener("submit",(e=>{e.preventDefault(),function(){let e="";e=Pt.checked?W:bt.checked?V:kt.value.trim();const t=document.getElementById("serverUrl-success"),n=document.getElementById("serverUrl-error");on.updateSettings({apiServerUrl:e}).then((()=>{on.checkForPaidSubscription().then((()=>{ln()})),t.style.display="block",_e(3e3).then((()=>Se(t,(()=>{t.style.display="none",t.style.opacity="1"}))))})).catch((()=>{n.style.display="block",_e(3e3).then((()=>Se(n,(()=>{n.style.display="none",n.style.opacity="1"}))))}))}()})),Ut.addEventListener("change",(function(){on.updateSettings({motherTongue:Ut.value})})),wt.addEventListener("change",(function(){on.updateSettings({enVariant:wt.value}),function(e=!1){Ft.parentElement.classList.toggle("lt-language-variant__checkbox--visible",e)}("en-GB"===wt.value)})),Mt.addEventListener("change",(function(){on.updateSettings({deVariant:Mt.value})})),Gt.addEventListener("change",(function(){on.updateSettings({ptVariant:Gt.value})})),Bt.addEventListener("change",(function(){on.updateSettings({caVariant:Bt.value})})),Ft.addEventListener("change",(function(){const e=Ft.checked,t={id:"OXFORD_SPELLING_Z_NOT_S",language:"en",turnOffDate:new Date};e?on.removeIgnoredRule(t.id):on.addIgnoredRule(t)})),Wt.addEventListener("change",(function(){on.updateSettings({forcePreferredLanguages:Wt.checked})})),Zt.addEventListener("keydown",(e=>{"Enter"===e.key&&Fn()})),Zt.addEventListener("input",(()=>{setTimeout(Bn,0)})),Zt.addEventListener("paste",(function(e){if(Zt.value)return;if(!e.clipboardData)return;const t=e.clipboardData.getData("text/plain");if(!t)return;const n=t.split(/\s+/);if(n.length<=1)return;e.preventDefault();const s=on.getSettings().autoCheckOnDomains;n.forEach((e=>{const t=N(e,"");t.trim()&&be(e)&&!s.includes(t)&&s.push(t)})),on.updateSettings({autoCheckOnDomains:s}).then(Bn)})),$t.addEventListener("click",Fn),jt.addEventListener("click",(function(){confirm(ie.getMessage("settingsAreYouSure"))&&on.updateSettings({autoCheckOnDomains:[]}).then((()=>Gn([],!0)))})),Jt.addEventListener("keydown",(e=>{"Enter"===e.key&&Xn()})),Jt.addEventListener("input",(()=>{setTimeout(Vn,0)})),Jt.addEventListener("paste",(function(e){if(Jt.value)return;if(!e.clipboardData)return;const t=e.clipboardData.getData("text/plain");if(!t)return;const n=t.split(/\s+/);if(n.length<=1)return;e.preventDefault();const s=on.getSettings().ignoreCheckOnDomains;n.forEach((e=>{const t=N(e);t.trim()&&be(e)&&!s.includes(t)&&s.push(t)})),on.updateSettings({ignoreCheckOnDomains:s}).then(Vn)})),Qt.addEventListener("click",Xn),en.addEventListener("click",(function(){confirm(ie.getMessage("settingsAreYouSure"))&&on.updateSettings({ignoreCheckOnDomains:[]}).then((()=>Hn([],!0)))})),rn.textContent=(new Date).getFullYear().toString(),e.isSafari()&&tn instanceof HTMLAnchorElement&&(tn.href+=tn.href.includes("?")?"&hidePremium=true":"?hidePremium=true"),on.onReady((()=>{const e=document.querySelector("#heart");if(e){const{showRuleId:t}=on.getUIState();let n=0;e.style.cursor="default",e.style.userSelect="none",t&&(e.style.color="blue"),e.addEventListener("click",(s=>{4==++n&&(t?(e.style.color="",on.updateUIState({showRuleId:!1})):(e.style.color="blue",on.updateUIState({showRuleId:!0}))),s.preventDefault()}))}}))})()})();