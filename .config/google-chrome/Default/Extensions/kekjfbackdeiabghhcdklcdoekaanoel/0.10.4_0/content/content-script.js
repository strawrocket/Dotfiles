/*! For license information please see content-script.js.LICENSE.txt */
(()=>{var e={50953:(e,t,n)=>{"use strict";n.d(t,{C4:()=>f,EW:()=>ke,Gc:()=>pe,IG:()=>_e,KR:()=>$e,Kh:()=>he,Pr:()=>Oe,X2:()=>l,bl:()=>y,fE:()=>ye,g8:()=>ge,hZ:()=>$,i9:()=>Te,ju:()=>ve,o5:()=>o,u4:()=>T,ux:()=>be,yC:()=>r});var s=n(90033);let i,a;class r{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this.parent=i,!e&&i&&(this.index=(i.scopes||(i.scopes=[])).push(this)-1)}get active(){return this._active}run(e){if(this._active){const t=i;try{return i=this,e()}finally{i=t}}}on(){i=this}off(){i=this.parent}stop(e){if(this._active){let t,n;for(t=0,n=this.effects.length;t<n;t++)this.effects[t].stop();for(t=0,n=this.cleanups.length;t<n;t++)this.cleanups[t]();if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].stop(!0);if(!this.detached&&this.parent&&!e){const e=this.parent.scopes.pop();e&&e!==this&&(this.parent.scopes[this.index]=e,e.index=this.index)}this.parent=void 0,this._active=!1}}}function o(){return i}class l{constructor(e,t,n,s){this.fn=e,this.trigger=t,this.scheduler=n,this.active=!0,this.deps=[],this._dirtyLevel=5,this._trackId=0,this._runnings=0,this._shouldSchedule=!1,this._depsLength=0,function(e,t=i){t&&t.active&&t.effects.push(e)}(this,s)}get dirty(){if(2===this._dirtyLevel)return!1;if(3===this._dirtyLevel||4===this._dirtyLevel){this._dirtyLevel=1,f();for(let e=0;e<this._depsLength;e++){const t=this.deps[e];if(t.computed){if(2===t.computed.effect._dirtyLevel)return y(),!0;if(c(t.computed),this._dirtyLevel>=5)break}}1===this._dirtyLevel&&(this._dirtyLevel=0),y()}return this._dirtyLevel>=5}set dirty(e){this._dirtyLevel=e?5:0}run(){if(this._dirtyLevel=0,!this.active)return this.fn();let e=m,t=a;try{return m=!0,a=this,this._runnings++,u(this),this.fn()}finally{h(this),this._runnings--,a=t,m=e}}stop(){this.active&&(u(this),h(this),this.onStop&&this.onStop(),this.active=!1)}}function c(e){return e.value}function u(e){e._trackId++,e._depsLength=0}function h(e){if(e.deps.length>e._depsLength){for(let t=e._depsLength;t<e.deps.length;t++)p(e.deps[t],e);e.deps.length=e._depsLength}}function p(e,t){const n=e.get(t);void 0!==n&&t._trackId!==n&&(e.delete(t),0===e.size&&e.cleanup())}let m=!0,d=0;const g=[];function f(){g.push(m),m=!1}function y(){const e=g.pop();m=void 0===e||e}function v(){d++}function b(){for(d--;!d&&w.length;)w.shift()()}function _(e,t,n){if(t.get(e)!==e._trackId){t.set(e,e._trackId);const n=e.deps[e._depsLength];n!==t?(n&&p(n,e),e.deps[e._depsLength++]=t):e._depsLength++}}const w=[];function E(e,t,n){v();for(const n of e.keys()){let s;!e.computed&&n.computed&&n._runnings>0&&(null!=s?s:s=e.get(n)===n._trackId)?n._dirtyLevel=2:(n._dirtyLevel<t&&(null!=s?s:s=e.get(n)===n._trackId)&&(n._shouldSchedule||(n._shouldSchedule=0===n._dirtyLevel),n.computed&&2===n._dirtyLevel&&(n._shouldSchedule=!0),n._dirtyLevel=t),n._shouldSchedule&&(null!=s?s:s=e.get(n)===n._trackId)&&(n.trigger(),n._runnings&&!n.allowRecurse||3===n._dirtyLevel||(n._shouldSchedule=!1,n.scheduler&&w.push(n.scheduler))))}b()}const S=(e,t)=>{const n=new Map;return n.cleanup=e,n.computed=t,n},k=new WeakMap,I=Symbol(""),x=Symbol("");function T(e,t,n){if(m&&a){let t=k.get(e);t||k.set(e,t=new Map);let s=t.get(n);s||t.set(n,s=S((()=>t.delete(n)))),_(a,s)}}function $(e,t,n,i,a,r){const o=k.get(e);if(!o)return;let l=[];if("clear"===t)l=[...o.values()];else if("length"===n&&(0,s.cy)(e)){const e=Number(i);o.forEach(((t,n)=>{("length"===n||!(0,s.Bm)(n)&&n>=e)&&l.push(t)}))}else switch(void 0!==n&&l.push(o.get(n)),t){case"add":(0,s.cy)(e)?(0,s.yI)(n)&&l.push(o.get("length")):(l.push(o.get(I)),(0,s.CE)(e)&&l.push(o.get(x)));break;case"delete":(0,s.cy)(e)||(l.push(o.get(I)),(0,s.CE)(e)&&l.push(o.get(x)));break;case"set":(0,s.CE)(e)&&l.push(o.get(I))}v();for(const e of l)e&&E(e,5);b()}const L=(0,s.pD)("__proto__,__v_isRef,__isVue"),N=new Set(Object.getOwnPropertyNames(Symbol).filter((e=>"arguments"!==e&&"caller"!==e)).map((e=>Symbol[e])).filter(s.Bm)),O=C();function C(){const e={};return["includes","indexOf","lastIndexOf"].forEach((t=>{e[t]=function(...e){const n=be(this);for(let e=0,t=this.length;e<t;e++)T(n,0,e+"");const s=n[t](...e);return-1===s||!1===s?n[t](...e.map(be)):s}})),["push","pop","shift","unshift","splice"].forEach((t=>{e[t]=function(...e){f(),v();const n=be(this)[t].apply(this,e);return b(),y(),n}})),e}function A(e){(0,s.Bm)(e)||(e=String(e));const t=be(this);return T(t,0,e),t.hasOwnProperty(e)}class P{constructor(e=!1,t=!1){this._isReadonly=e,this._isShallow=t}get(e,t,n){const i=this._isReadonly,a=this._isShallow;if("__v_isReactive"===t)return!i;if("__v_isReadonly"===t)return i;if("__v_isShallow"===t)return a;if("__v_raw"===t)return n===(i?a?ue:ce:a?le:oe).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(n)?e:void 0;const r=(0,s.cy)(e);if(!i){if(r&&(0,s.$3)(O,t))return Reflect.get(O,t,n);if("hasOwnProperty"===t)return A}const o=Reflect.get(e,t,n);return((0,s.Bm)(t)?N.has(t):L(t))?o:(i||T(e,0,t),a?o:Te(o)?r&&(0,s.yI)(t)?o:o.value:(0,s.Gv)(o)?i?me(o):he(o):o)}}class R extends P{constructor(e=!1){super(!1,e)}set(e,t,n,i){let a=e[t];if(!this._isShallow){const t=fe(a);if(ye(n)||fe(n)||(a=be(a),n=be(n)),!(0,s.cy)(e)&&Te(a)&&!Te(n))return!t&&(a.value=n,!0)}const r=(0,s.cy)(e)&&(0,s.yI)(t)?Number(t)<e.length:(0,s.$3)(e,t),o=Reflect.set(e,t,n,i);return e===be(i)&&(r?(0,s.$H)(n,a)&&$(e,"set",t,n):$(e,"add",t,n)),o}deleteProperty(e,t){const n=(0,s.$3)(e,t),i=(e[t],Reflect.deleteProperty(e,t));return i&&n&&$(e,"delete",t,void 0),i}has(e,t){const n=Reflect.has(e,t);return(0,s.Bm)(t)&&N.has(t)||T(e,0,t),n}ownKeys(e){return T(e,0,(0,s.cy)(e)?"length":I),Reflect.ownKeys(e)}}class M extends P{constructor(e=!1){super(!0,e)}set(e,t){return!0}deleteProperty(e,t){return!0}}const U=new R,j=new M,D=new R(!0),F=e=>e,V=e=>Reflect.getPrototypeOf(e);function B(e,t,n=!1,i=!1){const a=be(e=e.__v_raw),r=be(t);n||((0,s.$H)(t,r)&&T(a,0,t),T(a,0,r));const{has:o}=V(a),l=i?F:n?Ee:we;return o.call(a,t)?l(e.get(t)):o.call(a,r)?l(e.get(r)):void(e!==a&&e.get(t))}function H(e,t=!1){const n=this.__v_raw,i=be(n),a=be(e);return t||((0,s.$H)(e,a)&&T(i,0,e),T(i,0,a)),e===a?n.has(e):n.has(e)||n.has(a)}function z(e,t=!1){return e=e.__v_raw,!t&&T(be(e),0,I),Reflect.get(e,"size",e)}function G(e){e=be(e);const t=be(this);return V(t).has.call(t,e)||(t.add(e),$(t,"add",e,e)),this}function W(e,t){t=be(t);const n=be(this),{has:i,get:a}=V(n);let r=i.call(n,e);r||(e=be(e),r=i.call(n,e));const o=a.call(n,e);return n.set(e,t),r?(0,s.$H)(t,o)&&$(n,"set",e,t):$(n,"add",e,t),this}function K(e){const t=be(this),{has:n,get:s}=V(t);let i=n.call(t,e);i||(e=be(e),i=n.call(t,e)),s&&s.call(t,e);const a=t.delete(e);return i&&$(t,"delete",e,void 0),a}function q(){const e=be(this),t=0!==e.size,n=e.clear();return t&&$(e,"clear",void 0,void 0),n}function X(e,t){return function(n,s){const i=this,a=i.__v_raw,r=be(a),o=t?F:e?Ee:we;return!e&&T(r,0,I),a.forEach(((e,t)=>n.call(s,o(e),o(t),i)))}}function Y(e,t,n){return function(...i){const a=this.__v_raw,r=be(a),o=(0,s.CE)(r),l="entries"===e||e===Symbol.iterator&&o,c="keys"===e&&o,u=a[e](...i),h=n?F:t?Ee:we;return!t&&T(r,0,c?x:I),{next(){const{value:e,done:t}=u.next();return t?{value:e,done:t}:{value:l?[h(e[0]),h(e[1])]:h(e),done:t}},[Symbol.iterator](){return this}}}}function J(e){return function(...t){return"delete"!==e&&("clear"===e?void 0:this)}}function Z(){const e={get(e){return B(this,e)},get size(){return z(this)},has:H,add:G,set:W,delete:K,clear:q,forEach:X(!1,!1)},t={get(e){return B(this,e,!1,!0)},get size(){return z(this)},has:H,add:G,set:W,delete:K,clear:q,forEach:X(!1,!0)},n={get(e){return B(this,e,!0)},get size(){return z(this,!0)},has(e){return H.call(this,e,!0)},add:J("add"),set:J("set"),delete:J("delete"),clear:J("clear"),forEach:X(!0,!1)},s={get(e){return B(this,e,!0,!0)},get size(){return z(this,!0)},has(e){return H.call(this,e,!0)},add:J("add"),set:J("set"),delete:J("delete"),clear:J("clear"),forEach:X(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach((i=>{e[i]=Y(i,!1,!1),n[i]=Y(i,!0,!1),t[i]=Y(i,!1,!0),s[i]=Y(i,!0,!0)})),[e,n,t,s]}const[Q,ee,te,ne]=Z();function se(e,t){const n=t?e?ne:te:e?ee:Q;return(t,i,a)=>"__v_isReactive"===i?!e:"__v_isReadonly"===i?e:"__v_raw"===i?t:Reflect.get((0,s.$3)(n,i)&&i in t?n:t,i,a)}const ie={get:se(!1,!1)},ae={get:se(!1,!0)},re={get:se(!0,!1)},oe=new WeakMap,le=new WeakMap,ce=new WeakMap,ue=new WeakMap;function he(e){return fe(e)?e:de(e,!1,U,ie,oe)}function pe(e){return de(e,!1,D,ae,le)}function me(e){return de(e,!0,j,re,ce)}function de(e,t,n,i,a){if(!(0,s.Gv)(e))return e;if(e.__v_raw&&(!t||!e.__v_isReactive))return e;const r=a.get(e);if(r)return r;const o=function(e){return e.__v_skip||!Object.isExtensible(e)?0:function(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}((0,s.Zf)(e))}(e);if(0===o)return e;const l=new Proxy(e,2===o?i:n);return a.set(e,l),l}function ge(e){return fe(e)?ge(e.__v_raw):!(!e||!e.__v_isReactive)}function fe(e){return!(!e||!e.__v_isReadonly)}function ye(e){return!(!e||!e.__v_isShallow)}function ve(e){return!!e&&!!e.__v_raw}function be(e){const t=e&&e.__v_raw;return t?be(t):e}function _e(e){return Object.isExtensible(e)&&(0,s.yQ)(e,"__v_skip",!0),e}const we=e=>(0,s.Gv)(e)?he(e):e,Ee=e=>(0,s.Gv)(e)?me(e):e;class Se{constructor(e,t,n,s){this.getter=e,this._setter=t,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this.effect=new l((()=>e(this._value)),(()=>xe(this,3===this.effect._dirtyLevel?3:4))),this.effect.computed=this,this.effect.active=this._cacheable=!s,this.__v_isReadonly=n}get value(){const e=be(this),t=e.effect._dirtyLevel;return e._cacheable&&!e.effect.dirty||!(0,s.$H)(e._value,e._value=e.effect.run())||3!==t&&xe(e,5),Ie(e),e.effect._dirtyLevel>=2&&xe(e,3),e._value}set value(e){this._setter(e)}get _dirty(){return this.effect.dirty}set _dirty(e){this.effect.dirty=e}}function ke(e,t,n=!1){let i,a;const r=(0,s.Tn)(e);return r?(i=e,a=s.tE):(i=e.get,a=e.set),new Se(i,a,r||!a,n)}function Ie(e){var t;m&&a&&(e=be(e),_(a,null!=(t=e.dep)?t:e.dep=S((()=>e.dep=void 0),e instanceof Se?e:void 0)))}function xe(e,t=5,n,s){const i=(e=be(e)).dep;i&&E(i,t)}function Te(e){return!(!e||!0!==e.__v_isRef)}function $e(e){return n=!1,Te(t=e)?t:new Le(t,n);var t,n}class Le{constructor(e,t){this.__v_isShallow=t,this.dep=void 0,this.__v_isRef=!0,this._rawValue=t?e:be(e),this._value=t?e:we(e)}get value(){return Ie(this),this._value}set value(e){const t=this.__v_isShallow||ye(e)||fe(e);e=t?e:be(e),(0,s.$H)(e,this._rawValue)&&(this._rawValue,this._rawValue=e,this._value=t?e:we(e),xe(this,5))}}const Ne={get:(e,t,n)=>{return Te(s=Reflect.get(e,t,n))?s.value:s;var s},set:(e,t,n,s)=>{const i=e[t];return Te(i)&&!Te(n)?(i.value=n,!0):Reflect.set(e,t,n,s)}};function Oe(e){return ge(e)?e:new Proxy(e,Ne)}},90033:(e,t,n)=>{"use strict";function s(e,t){const n=new Set(e.split(","));return t?e=>n.has(e.toLowerCase()):e=>n.has(e)}n.d(t,{$3:()=>m,$H:()=>U,BH:()=>z,BX:()=>Q,Bm:()=>w,C4:()=>Y,CE:()=>g,CP:()=>c,DY:()=>j,Gv:()=>E,J$:()=>J,Kg:()=>_,MZ:()=>i,Mp:()=>l,NO:()=>o,Oj:()=>a,PT:()=>C,Qd:()=>T,Ro:()=>V,SU:()=>L,TF:()=>h,Tg:()=>P,Tn:()=>b,Tr:()=>G,We:()=>H,X$:()=>u,Y2:()=>Z,ZH:()=>R,Zf:()=>x,bB:()=>F,cy:()=>d,gd:()=>v,pD:()=>s,rU:()=>M,tE:()=>r,u3:()=>ee,vM:()=>f,v_:()=>te,yI:()=>$,yL:()=>S,yQ:()=>D});const i={},a=[],r=()=>{},o=()=>!1,l=e=>111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),c=e=>e.startsWith("onUpdate:"),u=Object.assign,h=(e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)},p=Object.prototype.hasOwnProperty,m=(e,t)=>p.call(e,t),d=Array.isArray,g=e=>"[object Map]"===I(e),f=e=>"[object Set]"===I(e),y=e=>"[object Date]"===I(e),v=e=>"[object RegExp]"===I(e),b=e=>"function"==typeof e,_=e=>"string"==typeof e,w=e=>"symbol"==typeof e,E=e=>null!==e&&"object"==typeof e,S=e=>(E(e)||b(e))&&b(e.then)&&b(e.catch),k=Object.prototype.toString,I=e=>k.call(e),x=e=>I(e).slice(8,-1),T=e=>"[object Object]"===I(e),$=e=>_(e)&&"NaN"!==e&&"-"!==e[0]&&""+parseInt(e,10)===e,L=s(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),N=e=>{const t=Object.create(null);return n=>t[n]||(t[n]=e(n))},O=/-(\w)/g,C=N((e=>e.replace(O,((e,t)=>t?t.toUpperCase():"")))),A=/\B([A-Z])/g,P=N((e=>e.replace(A,"-$1").toLowerCase())),R=N((e=>e.charAt(0).toUpperCase()+e.slice(1))),M=N((e=>e?`on${R(e)}`:"")),U=(e,t)=>!Object.is(e,t),j=(e,...t)=>{for(let n=0;n<e.length;n++)e[n](...t)},D=(e,t,n,s=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:s,value:n})},F=e=>{const t=parseFloat(e);return isNaN(t)?e:t},V=e=>{const t=_(e)?Number(e):NaN;return isNaN(t)?e:t};let B;const H=()=>B||(B="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n.g?n.g:{}),z=s("Infinity,undefined,NaN,isFinite,isNaN,parseFloat,parseInt,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,Math,Number,Date,Array,Object,Boolean,String,RegExp,Map,Set,JSON,Intl,BigInt,console,Error");function G(e){if(d(e)){const t={};for(let n=0;n<e.length;n++){const s=e[n],i=_(s)?X(s):G(s);if(i)for(const e in i)t[e]=i[e]}return t}if(_(e)||E(e))return e}const W=/;(?![^(]*\))/g,K=/:([^]+)/,q=/\/\*[^]*?\*\//g;function X(e){const t={};return e.replace(q,"").split(W).forEach((e=>{if(e){const n=e.split(K);n.length>1&&(t[n[0].trim()]=n[1].trim())}})),t}function Y(e){let t="";if(_(e))t=e;else if(d(e))for(let n=0;n<e.length;n++){const s=Y(e[n]);s&&(t+=s+" ")}else if(E(e))for(const n in e)e[n]&&(t+=n+" ");return t.trim()}const J=s("itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly");function Z(e){return!!e||""===e}function Q(e,t){if(e===t)return!0;let n=y(e),s=y(t);if(n||s)return!(!n||!s)&&e.getTime()===t.getTime();if(n=w(e),s=w(t),n||s)return e===t;if(n=d(e),s=d(t),n||s)return!(!n||!s)&&function(e,t){if(e.length!==t.length)return!1;let n=!0;for(let s=0;n&&s<e.length;s++)n=Q(e[s],t[s]);return n}(e,t);if(n=E(e),s=E(t),n||s){if(!n||!s)return!1;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e){const s=e.hasOwnProperty(n),i=t.hasOwnProperty(n);if(s&&!i||!s&&i||!Q(e[n],t[n]))return!1}}return String(e)===String(t)}function ee(e,t){return e.findIndex((e=>Q(e,t)))}const te=e=>_(e)?e:null==e?"":d(e)||E(e)&&(e.toString===k||!b(e.toString))?JSON.stringify(e,ne,2):String(e),ne=(e,t)=>t&&t.__v_isRef?ne(e,t.value):g(t)?{[`Map(${t.size})`]:[...t.entries()].reduce(((e,[t,n],s)=>(e[se(t,s)+" =>"]=n,e)),{})}:f(t)?{[`Set(${t.size})`]:[...t.values()].map((e=>se(e)))}:w(t)?se(t):!E(t)||d(t)||T(t)?t:String(t),se=(e,t="")=>{var n;return w(e)?`Symbol(${null!=(n=e.description)?n:t})`:e}},42838:function(e){e.exports=function(){"use strict";const{entries:e,setPrototypeOf:t,isFrozen:n,getPrototypeOf:s,getOwnPropertyDescriptor:i}=Object;let{freeze:a,seal:r,create:o}=Object,{apply:l,construct:c}="undefined"!=typeof Reflect&&Reflect;a||(a=function(e){return e}),r||(r=function(e){return e}),l||(l=function(e,t,n){return e.apply(t,n)}),c||(c=function(e,t){return new e(...t)});const u=S(Array.prototype.forEach),h=S(Array.prototype.pop),p=S(Array.prototype.push),m=S(String.prototype.toLowerCase),d=S(String.prototype.toString),g=S(String.prototype.match),f=S(String.prototype.replace),y=S(String.prototype.indexOf),v=S(String.prototype.trim),b=S(Object.prototype.hasOwnProperty),_=S(RegExp.prototype.test),w=(E=TypeError,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return c(E,t)});var E;function S(e){return function(t){for(var n=arguments.length,s=new Array(n>1?n-1:0),i=1;i<n;i++)s[i-1]=arguments[i];return l(e,t,s)}}function k(e,s){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:m;t&&t(e,null);let a=s.length;for(;a--;){let t=s[a];if("string"==typeof t){const e=i(t);e!==t&&(n(s)||(s[a]=e),t=e)}e[t]=!0}return e}function I(e){for(let t=0;t<e.length;t++)b(e,t)||(e[t]=null);return e}function x(t){const n=o(null);for(const[s,i]of e(t))b(t,s)&&(Array.isArray(i)?n[s]=I(i):i&&"object"==typeof i&&i.constructor===Object?n[s]=x(i):n[s]=i);return n}function T(e,t){for(;null!==e;){const n=i(e,t);if(n){if(n.get)return S(n.get);if("function"==typeof n.value)return S(n.value)}e=s(e)}return function(){return null}}const $=a(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),L=a(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),N=a(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),O=a(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),C=a(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),A=a(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),P=a(["#text"]),R=a(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),M=a(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),U=a(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),j=a(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),D=r(/\{\{[\w\W]*|[\w\W]*\}\}/gm),F=r(/<%[\w\W]*|[\w\W]*%>/gm),V=r(/\${[\w\W]*}/gm),B=r(/^data-[\-\w.\u00B7-\uFFFF]/),H=r(/^aria-[\-\w]+$/),z=r(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),G=r(/^(?:\w+script|data):/i),W=r(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),K=r(/^html$/i),q=r(/^[a-z][.\w]*(-[.\w]+)+$/i);var X=Object.freeze({__proto__:null,MUSTACHE_EXPR:D,ERB_EXPR:F,TMPLIT_EXPR:V,DATA_ATTR:B,ARIA_ATTR:H,IS_ALLOWED_URI:z,IS_SCRIPT_OR_DATA:G,ATTR_WHITESPACE:W,DOCTYPE_NAME:K,CUSTOM_ELEMENT:q});const Y=1,J=3,Z=7,Q=8,ee=9,te=function(){return"undefined"==typeof window?null:window};return function t(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:te();const s=e=>t(e);if(s.version="3.1.6",s.removed=[],!n||!n.document||n.document.nodeType!==ee)return s.isSupported=!1,s;let{document:i}=n;const r=i,l=r.currentScript,{DocumentFragment:c,HTMLTemplateElement:E,Node:S,Element:I,NodeFilter:D,NamedNodeMap:F=n.NamedNodeMap||n.MozNamedAttrMap,HTMLFormElement:V,DOMParser:B,trustedTypes:H}=n,G=I.prototype,W=T(G,"cloneNode"),q=T(G,"remove"),ne=T(G,"nextSibling"),se=T(G,"childNodes"),ie=T(G,"parentNode");if("function"==typeof E){const e=i.createElement("template");e.content&&e.content.ownerDocument&&(i=e.content.ownerDocument)}let ae,re="";const{implementation:oe,createNodeIterator:le,createDocumentFragment:ce,getElementsByTagName:ue}=i,{importNode:he}=r;let pe={};s.isSupported="function"==typeof e&&"function"==typeof ie&&oe&&void 0!==oe.createHTMLDocument;const{MUSTACHE_EXPR:me,ERB_EXPR:de,TMPLIT_EXPR:ge,DATA_ATTR:fe,ARIA_ATTR:ye,IS_SCRIPT_OR_DATA:ve,ATTR_WHITESPACE:be,CUSTOM_ELEMENT:_e}=X;let{IS_ALLOWED_URI:we}=X,Ee=null;const Se=k({},[...$,...L,...N,...C,...P]);let ke=null;const Ie=k({},[...R,...M,...U,...j]);let xe=Object.seal(o(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Te=null,$e=null,Le=!0,Ne=!0,Oe=!1,Ce=!0,Ae=!1,Pe=!0,Re=!1,Me=!1,Ue=!1,je=!1,De=!1,Fe=!1,Ve=!0,Be=!1,He=!0,ze=!1,Ge={},We=null;const Ke=k({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let qe=null;const Xe=k({},["audio","video","img","source","image","track"]);let Ye=null;const Je=k({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Ze="http://www.w3.org/1998/Math/MathML",Qe="http://www.w3.org/2000/svg",et="http://www.w3.org/1999/xhtml";let tt=et,nt=!1,st=null;const it=k({},[Ze,Qe,et],d);let at=null;const rt=["application/xhtml+xml","text/html"];let ot=null,lt=null;const ct=i.createElement("form"),ut=function(e){return e instanceof RegExp||e instanceof Function},ht=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!lt||lt!==e){if(e&&"object"==typeof e||(e={}),e=x(e),at=-1===rt.indexOf(e.PARSER_MEDIA_TYPE)?"text/html":e.PARSER_MEDIA_TYPE,ot="application/xhtml+xml"===at?d:m,Ee=b(e,"ALLOWED_TAGS")?k({},e.ALLOWED_TAGS,ot):Se,ke=b(e,"ALLOWED_ATTR")?k({},e.ALLOWED_ATTR,ot):Ie,st=b(e,"ALLOWED_NAMESPACES")?k({},e.ALLOWED_NAMESPACES,d):it,Ye=b(e,"ADD_URI_SAFE_ATTR")?k(x(Je),e.ADD_URI_SAFE_ATTR,ot):Je,qe=b(e,"ADD_DATA_URI_TAGS")?k(x(Xe),e.ADD_DATA_URI_TAGS,ot):Xe,We=b(e,"FORBID_CONTENTS")?k({},e.FORBID_CONTENTS,ot):Ke,Te=b(e,"FORBID_TAGS")?k({},e.FORBID_TAGS,ot):{},$e=b(e,"FORBID_ATTR")?k({},e.FORBID_ATTR,ot):{},Ge=!!b(e,"USE_PROFILES")&&e.USE_PROFILES,Le=!1!==e.ALLOW_ARIA_ATTR,Ne=!1!==e.ALLOW_DATA_ATTR,Oe=e.ALLOW_UNKNOWN_PROTOCOLS||!1,Ce=!1!==e.ALLOW_SELF_CLOSE_IN_ATTR,Ae=e.SAFE_FOR_TEMPLATES||!1,Pe=!1!==e.SAFE_FOR_XML,Re=e.WHOLE_DOCUMENT||!1,je=e.RETURN_DOM||!1,De=e.RETURN_DOM_FRAGMENT||!1,Fe=e.RETURN_TRUSTED_TYPE||!1,Ue=e.FORCE_BODY||!1,Ve=!1!==e.SANITIZE_DOM,Be=e.SANITIZE_NAMED_PROPS||!1,He=!1!==e.KEEP_CONTENT,ze=e.IN_PLACE||!1,we=e.ALLOWED_URI_REGEXP||z,tt=e.NAMESPACE||et,xe=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&ut(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(xe.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&ut(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(xe.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(xe.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Ae&&(Ne=!1),De&&(je=!0),Ge&&(Ee=k({},P),ke=[],!0===Ge.html&&(k(Ee,$),k(ke,R)),!0===Ge.svg&&(k(Ee,L),k(ke,M),k(ke,j)),!0===Ge.svgFilters&&(k(Ee,N),k(ke,M),k(ke,j)),!0===Ge.mathMl&&(k(Ee,C),k(ke,U),k(ke,j))),e.ADD_TAGS&&(Ee===Se&&(Ee=x(Ee)),k(Ee,e.ADD_TAGS,ot)),e.ADD_ATTR&&(ke===Ie&&(ke=x(ke)),k(ke,e.ADD_ATTR,ot)),e.ADD_URI_SAFE_ATTR&&k(Ye,e.ADD_URI_SAFE_ATTR,ot),e.FORBID_CONTENTS&&(We===Ke&&(We=x(We)),k(We,e.FORBID_CONTENTS,ot)),He&&(Ee["#text"]=!0),Re&&k(Ee,["html","head","body"]),Ee.table&&(k(Ee,["tbody"]),delete Te.tbody),e.TRUSTED_TYPES_POLICY){if("function"!=typeof e.TRUSTED_TYPES_POLICY.createHTML)throw w('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if("function"!=typeof e.TRUSTED_TYPES_POLICY.createScriptURL)throw w('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');ae=e.TRUSTED_TYPES_POLICY,re=ae.createHTML("")}else void 0===ae&&(ae=function(e,t){if("object"!=typeof e||"function"!=typeof e.createPolicy)return null;let n=null;const s="data-tt-policy-suffix";t&&t.hasAttribute(s)&&(n=t.getAttribute(s));const i="dompurify"+(n?"#"+n:"");try{return e.createPolicy(i,{createHTML:e=>e,createScriptURL:e=>e})}catch(e){return console.warn("TrustedTypes policy "+i+" could not be created."),null}}(H,l)),null!==ae&&"string"==typeof re&&(re=ae.createHTML(""));a&&a(e),lt=e}},pt=k({},["mi","mo","mn","ms","mtext"]),mt=k({},["foreignobject","annotation-xml"]),dt=k({},["title","style","font","a","script"]),gt=k({},[...L,...N,...O]),ft=k({},[...C,...A]),yt=function(e){p(s.removed,{element:e});try{ie(e).removeChild(e)}catch(t){q(e)}},vt=function(e,t){try{p(s.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){p(s.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!ke[e])if(je||De)try{yt(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},bt=function(e){let t=null,n=null;if(Ue)e="<remove></remove>"+e;else{const t=g(e,/^[\r\n\t ]+/);n=t&&t[0]}"application/xhtml+xml"===at&&tt===et&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");const s=ae?ae.createHTML(e):e;if(tt===et)try{t=(new B).parseFromString(s,at)}catch(e){}if(!t||!t.documentElement){t=oe.createDocument(tt,"template",null);try{t.documentElement.innerHTML=nt?re:s}catch(e){}}const a=t.body||t.documentElement;return e&&n&&a.insertBefore(i.createTextNode(n),a.childNodes[0]||null),tt===et?ue.call(t,Re?"html":"body")[0]:Re?t.documentElement:a},_t=function(e){return le.call(e.ownerDocument||e,e,D.SHOW_ELEMENT|D.SHOW_COMMENT|D.SHOW_TEXT|D.SHOW_PROCESSING_INSTRUCTION|D.SHOW_CDATA_SECTION,null)},wt=function(e){return e instanceof V&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof F)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore||"function"!=typeof e.hasChildNodes)},Et=function(e){return"function"==typeof S&&e instanceof S},St=function(e,t,n){pe[e]&&u(pe[e],(e=>{e.call(s,t,n,lt)}))},kt=function(e){let t=null;if(St("beforeSanitizeElements",e,null),wt(e))return yt(e),!0;const n=ot(e.nodeName);if(St("uponSanitizeElement",e,{tagName:n,allowedTags:Ee}),e.hasChildNodes()&&!Et(e.firstElementChild)&&_(/<[/\w]/g,e.innerHTML)&&_(/<[/\w]/g,e.textContent))return yt(e),!0;if(e.nodeType===Z)return yt(e),!0;if(Pe&&e.nodeType===Q&&_(/<[/\w]/g,e.data))return yt(e),!0;if(!Ee[n]||Te[n]){if(!Te[n]&&xt(n)){if(xe.tagNameCheck instanceof RegExp&&_(xe.tagNameCheck,n))return!1;if(xe.tagNameCheck instanceof Function&&xe.tagNameCheck(n))return!1}if(He&&!We[n]){const t=ie(e)||e.parentNode,n=se(e)||e.childNodes;if(n&&t)for(let s=n.length-1;s>=0;--s){const i=W(n[s],!0);i.__removalCount=(e.__removalCount||0)+1,t.insertBefore(i,ne(e))}}return yt(e),!0}return e instanceof I&&!function(e){let t=ie(e);t&&t.tagName||(t={namespaceURI:tt,tagName:"template"});const n=m(e.tagName),s=m(t.tagName);return!!st[e.namespaceURI]&&(e.namespaceURI===Qe?t.namespaceURI===et?"svg"===n:t.namespaceURI===Ze?"svg"===n&&("annotation-xml"===s||pt[s]):Boolean(gt[n]):e.namespaceURI===Ze?t.namespaceURI===et?"math"===n:t.namespaceURI===Qe?"math"===n&&mt[s]:Boolean(ft[n]):e.namespaceURI===et?!(t.namespaceURI===Qe&&!mt[s])&&!(t.namespaceURI===Ze&&!pt[s])&&!ft[n]&&(dt[n]||!gt[n]):!("application/xhtml+xml"!==at||!st[e.namespaceURI]))}(e)?(yt(e),!0):"noscript"!==n&&"noembed"!==n&&"noframes"!==n||!_(/<\/no(script|embed|frames)/i,e.innerHTML)?(Ae&&e.nodeType===J&&(t=e.textContent,u([me,de,ge],(e=>{t=f(t,e," ")})),e.textContent!==t&&(p(s.removed,{element:e.cloneNode()}),e.textContent=t)),St("afterSanitizeElements",e,null),!1):(yt(e),!0)},It=function(e,t,n){if(Ve&&("id"===t||"name"===t)&&(n in i||n in ct))return!1;if(Ne&&!$e[t]&&_(fe,t));else if(Le&&_(ye,t));else if(!ke[t]||$e[t]){if(!(xt(e)&&(xe.tagNameCheck instanceof RegExp&&_(xe.tagNameCheck,e)||xe.tagNameCheck instanceof Function&&xe.tagNameCheck(e))&&(xe.attributeNameCheck instanceof RegExp&&_(xe.attributeNameCheck,t)||xe.attributeNameCheck instanceof Function&&xe.attributeNameCheck(t))||"is"===t&&xe.allowCustomizedBuiltInElements&&(xe.tagNameCheck instanceof RegExp&&_(xe.tagNameCheck,n)||xe.tagNameCheck instanceof Function&&xe.tagNameCheck(n))))return!1}else if(Ye[t]);else if(_(we,f(n,be,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==y(n,"data:")||!qe[e])if(Oe&&!_(ve,f(n,be,"")));else if(n)return!1;return!0},xt=function(e){return"annotation-xml"!==e&&g(e,_e)},Tt=function(e){St("beforeSanitizeAttributes",e,null);const{attributes:t}=e;if(!t)return;const n={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ke};let i=t.length;for(;i--;){const a=t[i],{name:r,namespaceURI:o,value:l}=a,c=ot(r);let p="value"===r?l:v(l);if(n.attrName=c,n.attrValue=p,n.keepAttr=!0,n.forceKeepAttr=void 0,St("uponSanitizeAttribute",e,n),p=n.attrValue,Pe&&_(/((--!?|])>)|<\/(style|title)/i,p)){vt(r,e);continue}if(n.forceKeepAttr)continue;if(vt(r,e),!n.keepAttr)continue;if(!Ce&&_(/\/>/i,p)){vt(r,e);continue}Ae&&u([me,de,ge],(e=>{p=f(p,e," ")}));const m=ot(e.nodeName);if(It(m,c,p)){if(!Be||"id"!==c&&"name"!==c||(vt(r,e),p="user-content-"+p),ae&&"object"==typeof H&&"function"==typeof H.getAttributeType)if(o);else switch(H.getAttributeType(m,c)){case"TrustedHTML":p=ae.createHTML(p);break;case"TrustedScriptURL":p=ae.createScriptURL(p)}try{o?e.setAttributeNS(o,r,p):e.setAttribute(r,p),wt(e)?yt(e):h(s.removed)}catch(e){}}}St("afterSanitizeAttributes",e,null)},$t=function e(t){let n=null;const s=_t(t);for(St("beforeSanitizeShadowDOM",t,null);n=s.nextNode();)St("uponSanitizeShadowNode",n,null),kt(n)||(n.content instanceof c&&e(n.content),Tt(n));St("afterSanitizeShadowDOM",t,null)};return s.sanitize=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=null,i=null,a=null,o=null;if(nt=!e,nt&&(e="\x3c!--\x3e"),"string"!=typeof e&&!Et(e)){if("function"!=typeof e.toString)throw w("toString is not a function");if("string"!=typeof(e=e.toString()))throw w("dirty is not a string, aborting")}if(!s.isSupported)return e;if(Me||ht(t),s.removed=[],"string"==typeof e&&(ze=!1),ze){if(e.nodeName){const t=ot(e.nodeName);if(!Ee[t]||Te[t])throw w("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof S)n=bt("\x3c!----\x3e"),i=n.ownerDocument.importNode(e,!0),i.nodeType===Y&&"BODY"===i.nodeName||"HTML"===i.nodeName?n=i:n.appendChild(i);else{if(!je&&!Ae&&!Re&&-1===e.indexOf("<"))return ae&&Fe?ae.createHTML(e):e;if(n=bt(e),!n)return je?null:Fe?re:""}n&&Ue&&yt(n.firstChild);const l=_t(ze?e:n);for(;a=l.nextNode();)kt(a)||(a.content instanceof c&&$t(a.content),Tt(a));if(ze)return e;if(je){if(De)for(o=ce.call(n.ownerDocument);n.firstChild;)o.appendChild(n.firstChild);else o=n;return(ke.shadowroot||ke.shadowrootmode)&&(o=he.call(r,o,!0)),o}let h=Re?n.outerHTML:n.innerHTML;return Re&&Ee["!doctype"]&&n.ownerDocument&&n.ownerDocument.doctype&&n.ownerDocument.doctype.name&&_(K,n.ownerDocument.doctype.name)&&(h="<!DOCTYPE "+n.ownerDocument.doctype.name+">\n"+h),Ae&&u([me,de,ge],(e=>{h=f(h,e," ")})),ae&&Fe?ae.createHTML(h):h},s.setConfig=function(){ht(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),Me=!0},s.clearConfig=function(){lt=null,Me=!1},s.isValidAttribute=function(e,t,n){lt||ht({});const s=ot(e),i=ot(t);return It(s,i,n)},s.addHook=function(e,t){"function"==typeof t&&(pe[e]=pe[e]||[],p(pe[e],t))},s.removeHook=function(e){if(pe[e])return h(pe[e])},s.removeHooks=function(e){pe[e]&&(pe[e]=[])},s.removeAllHooks=function(){pe={}},s}()}()},53011:(e,t,n)=>{var s;!function(i){var a=Object.hasOwnProperty,r=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},o="object"==typeof process&&"function"==typeof process.nextTick,l="function"==typeof Symbol,c="object"==typeof Reflect,u="function"==typeof setImmediate?setImmediate:setTimeout,h=l?c&&"function"==typeof Reflect.ownKeys?Reflect.ownKeys:function(e){var t=Object.getOwnPropertyNames(e);return t.push.apply(t,Object.getOwnPropertySymbols(e)),t}:Object.keys;function p(){this._events={},this._conf&&m.call(this,this._conf)}function m(e){e&&(this._conf=e,e.delimiter&&(this.delimiter=e.delimiter),e.maxListeners!==i&&(this._maxListeners=e.maxListeners),e.wildcard&&(this.wildcard=e.wildcard),e.newListener&&(this._newListener=e.newListener),e.removeListener&&(this._removeListener=e.removeListener),e.verboseMemoryLeak&&(this.verboseMemoryLeak=e.verboseMemoryLeak),e.ignoreErrors&&(this.ignoreErrors=e.ignoreErrors),this.wildcard&&(this.listenerTree={}))}function d(e,t){var n="(node) warning: possible EventEmitter memory leak detected. "+e+" listeners added. Use emitter.setMaxListeners() to increase limit.";if(this.verboseMemoryLeak&&(n+=" Event name: "+t+"."),"undefined"!=typeof process&&process.emitWarning){var s=new Error(n);s.name="MaxListenersExceededWarning",s.emitter=this,s.count=e,process.emitWarning(s)}else console.error(n),console.trace&&console.trace()}var g=function(e,t,n){var s=arguments.length;switch(s){case 0:return[];case 1:return[e];case 2:return[e,t];case 3:return[e,t,n];default:for(var i=new Array(s);s--;)i[s]=arguments[s];return i}};function f(e,t){for(var n={},s=e.length,a=t?value.length:0,r=0;r<s;r++)n[e[r]]=r<a?t[r]:i;return n}function y(e,t,n){var s,i;if(this._emitter=e,this._target=t,this._listeners={},this._listenersCount=0,(n.on||n.off)&&(s=n.on,i=n.off),t.addEventListener?(s=t.addEventListener,i=t.removeEventListener):t.addListener?(s=t.addListener,i=t.removeListener):t.on&&(s=t.on,i=t.off),!s&&!i)throw Error("target does not implement any known event API");if("function"!=typeof s)throw TypeError("on method must be a function");if("function"!=typeof i)throw TypeError("off method must be a function");this._on=s,this._off=i;var a=e._observers;a?a.push(this):e._observers=[this]}function v(e,t,n,s){var r=Object.assign({},t);if(!e)return r;if("object"!=typeof e)throw TypeError("options must be an object");var o,l,c,u=Object.keys(e),h=u.length;function p(e){throw Error('Invalid "'+o+'" option value'+(e?". Reason: "+e:""))}for(var m=0;m<h;m++){if(o=u[m],!s&&!a.call(t,o))throw Error('Unknown "'+o+'" option');(l=e[o])!==i&&(c=n[o],r[o]=c?c(l,p):l)}return r}function b(e,t){return"function"==typeof e&&e.hasOwnProperty("prototype")||t("value must be a constructor"),e}function _(e){var t="value must be type of "+e.join("|"),n=e.length,s=e[0],i=e[1];return 1===n?function(e,n){if(typeof e===s)return e;n(t)}:2===n?function(e,n){var a=typeof e;if(a===s||a===i)return e;n(t)}:function(s,i){for(var a=typeof s,r=n;r-- >0;)if(a===e[r])return s;i(t)}}Object.assign(y.prototype,{subscribe:function(e,t,n){var s=this,i=this._target,a=this._emitter,r=this._listeners,o=function(){var s=g.apply(null,arguments),r={data:s,name:t,original:e};n?!1!==n.call(i,r)&&a.emit.apply(a,[r.name].concat(s)):a.emit.apply(a,[t].concat(s))};if(r[e])throw Error("Event '"+e+"' is already listening");this._listenersCount++,a._newListener&&a._removeListener&&!s._onNewListener?(this._onNewListener=function(n){n===t&&null===r[e]&&(r[e]=o,s._on.call(i,e,o))},a.on("newListener",this._onNewListener),this._onRemoveListener=function(n){n===t&&!a.hasListeners(n)&&r[e]&&(r[e]=null,s._off.call(i,e,o))},r[e]=null,a.on("removeListener",this._onRemoveListener)):(r[e]=o,s._on.call(i,e,o))},unsubscribe:function(e){var t,n,s,i=this,a=this._listeners,r=this._emitter,o=this._off,l=this._target;if(e&&"string"!=typeof e)throw TypeError("event must be a string");function c(){i._onNewListener&&(r.off("newListener",i._onNewListener),r.off("removeListener",i._onRemoveListener),i._onNewListener=null,i._onRemoveListener=null);var e=k.call(r,i);r._observers.splice(e,1)}if(e){if(!(t=a[e]))return;o.call(l,e,t),delete a[e],--this._listenersCount||c()}else{for(s=(n=h(a)).length;s-- >0;)e=n[s],o.call(l,e,a[e]);this._listeners={},this._listenersCount=0,c()}}});var w=_(["function"]),E=_(["object","function"]);function S(e,t,n){var s,i,a,r=0,o=new e((function(l,c,u){function h(){i&&(i=null),r&&(clearTimeout(r),r=0)}n=v(n,{timeout:0,overload:!1},{timeout:function(e,t){return("number"!=typeof(e*=1)||e<0||!Number.isFinite(e))&&t("timeout must be a positive number"),e}}),s=!n.overload&&"function"==typeof e.prototype.cancel&&"function"==typeof u;var p=function(e){h(),l(e)},m=function(e){h(),c(e)};s?t(p,m,u):(i=[function(e){m(e||Error("canceled"))}],t(p,m,(function(e){if(a)throw Error("Unable to subscribe on cancel event asynchronously");if("function"!=typeof e)throw TypeError("onCancel callback must be a function");i.push(e)})),a=!0),n.timeout>0&&(r=setTimeout((function(){var e=Error("timeout");e.code="ETIMEDOUT",r=0,o.cancel(e),c(e)}),n.timeout))}));return s||(o.cancel=function(e){if(i){for(var t=i.length,n=1;n<t;n++)i[n](e);i[0](e),i=null}}),o}function k(e){var t=this._observers;if(!t)return-1;for(var n=t.length,s=0;s<n;s++)if(t[s]._target===e)return s;return-1}function I(e,t,n,s,i){if(!n)return null;if(0===s){var a=typeof t;if("string"===a){var r,o,l=0,c=0,u=this.delimiter,p=u.length;if(-1!==(o=t.indexOf(u))){r=new Array(5);do{r[l++]=t.slice(c,o),c=o+p}while(-1!==(o=t.indexOf(u,c)));r[l++]=t.slice(c),t=r,i=l}else t=[t],i=1}else"object"===a?i=t.length:(t=[t],i=1)}var m,d,g,f,y,v,b,_=null,w=t[s],E=t[s+1];if(s===i)n._listeners&&("function"==typeof n._listeners?(e&&e.push(n._listeners),_=[n]):(e&&e.push.apply(e,n._listeners),_=[n]));else{if("*"===w){for(o=(v=h(n)).length;o-- >0;)"_listeners"!==(m=v[o])&&(b=I(e,t,n[m],s+1,i))&&(_?_.push.apply(_,b):_=b);return _}if("**"===w){for((y=s+1===i||s+2===i&&"*"===E)&&n._listeners&&(_=I(e,t,n,i,i)),o=(v=h(n)).length;o-- >0;)"_listeners"!==(m=v[o])&&("*"===m||"**"===m?(n[m]._listeners&&!y&&(b=I(e,t,n[m],i,i))&&(_?_.push.apply(_,b):_=b),b=I(e,t,n[m],s,i)):b=I(e,t,n[m],m===E?s+2:s,i),b&&(_?_.push.apply(_,b):_=b));return _}n[w]&&(_=I(e,t,n[w],s+1,i))}if((d=n["*"])&&I(e,t,d,s+1,i),g=n["**"])if(s<i)for(g._listeners&&I(e,t,g,i,i),o=(v=h(g)).length;o-- >0;)"_listeners"!==(m=v[o])&&(m===E?I(e,t,g[m],s+2,i):m===w?I(e,t,g[m],s+1,i):((f={})[m]=g[m],I(e,t,{"**":f},s+1,i)));else g._listeners?I(e,t,g,i,i):g["*"]&&g["*"]._listeners&&I(e,t,g["*"],i,i);return _}function x(e,t,n){var s,i,a=0,r=0,o=this.delimiter,l=o.length;if("string"==typeof e)if(-1!==(s=e.indexOf(o))){i=new Array(5);do{i[a++]=e.slice(r,s),r=s+l}while(-1!==(s=e.indexOf(o,r)));i[a++]=e.slice(r)}else i=[e],a=1;else i=e,a=e.length;if(a>1)for(s=0;s+1<a;s++)if("**"===i[s]&&"**"===i[s+1])return;var c,u=this.listenerTree;for(s=0;s<a;s++)if(u=u[c=i[s]]||(u[c]={}),s===a-1)return u._listeners?("function"==typeof u._listeners&&(u._listeners=[u._listeners]),n?u._listeners.unshift(t):u._listeners.push(t),!u._listeners.warned&&this._maxListeners>0&&u._listeners.length>this._maxListeners&&(u._listeners.warned=!0,d.call(this,u._listeners.length,c))):u._listeners=t,!0;return!0}function T(e,t,n,s){for(var i,a,r,o,l=h(e),c=l.length,u=e._listeners;c-- >0;)i=e[a=l[c]],r="_listeners"===a?n:n?n.concat(a):[a],o=s||"symbol"==typeof a,u&&t.push(o?r:r.join(this.delimiter)),"object"==typeof i&&T.call(this,i,t,r,o);return t}function $(e){for(var t,n,s,i=h(e),a=i.length;a-- >0;)(t=e[n=i[a]])&&(s=!0,"_listeners"===n||$(t)||delete e[n]);return s}function L(e,t,n){this.emitter=e,this.event=t,this.listener=n}function N(e,t,n){if(!0===n)a=!0;else if(!1===n)s=!0;else{if(!n||"object"!=typeof n)throw TypeError("options should be an object or true");var s=n.async,a=n.promisify,r=n.nextTick,l=n.objectify}if(s||r||a){var c=t,h=t._origin||t;if(r&&!o)throw Error("process.nextTick is not supported");a===i&&(a="AsyncFunction"===t.constructor.name),t=function(){var e=arguments,t=this,n=this.event;return a?r?Promise.resolve():new Promise((function(e){u(e)})).then((function(){return t.event=n,c.apply(t,e)})):(r?process.nextTick:u)((function(){t.event=n,c.apply(t,e)}))},t._async=!0,t._origin=h}return[t,l?new L(this,e,t):this]}function O(e){this._events={},this._newListener=!1,this._removeListener=!1,this.verboseMemoryLeak=!1,m.call(this,e)}L.prototype.off=function(){return this.emitter.off(this.event,this.listener),this},O.EventEmitter2=O,O.prototype.listenTo=function(e,t,n){if("object"!=typeof e)throw TypeError("target musts be an object");var s=this;function a(t){if("object"!=typeof t)throw TypeError("events must be an object");var i,a=n.reducers,r=k.call(s,e);i=-1===r?new y(s,e,n):s._observers[r];for(var o,l=h(t),c=l.length,u="function"==typeof a,p=0;p<c;p++)o=l[p],i.subscribe(o,t[o]||o,u?a:a&&a[o])}return n=v(n,{on:i,off:i,reducers:i},{on:w,off:w,reducers:E}),r(t)?a(f(t)):a("string"==typeof t?f(t.split(/\s+/)):t),this},O.prototype.stopListeningTo=function(e,t){var n=this._observers;if(!n)return!1;var s,i=n.length,a=!1;if(e&&"object"!=typeof e)throw TypeError("target should be an object");for(;i-- >0;)s=n[i],e&&s._target!==e||(s.unsubscribe(t),a=!0);return a},O.prototype.delimiter=".",O.prototype.setMaxListeners=function(e){e!==i&&(this._maxListeners=e,this._conf||(this._conf={}),this._conf.maxListeners=e)},O.prototype.getMaxListeners=function(){return this._maxListeners},O.prototype.event="",O.prototype.once=function(e,t,n){return this._once(e,t,!1,n)},O.prototype.prependOnceListener=function(e,t,n){return this._once(e,t,!0,n)},O.prototype._once=function(e,t,n,s){return this._many(e,1,t,n,s)},O.prototype.many=function(e,t,n,s){return this._many(e,t,n,!1,s)},O.prototype.prependMany=function(e,t,n,s){return this._many(e,t,n,!0,s)},O.prototype._many=function(e,t,n,s,i){var a=this;if("function"!=typeof n)throw new Error("many only accepts instances of Function");function r(){return 0==--t&&a.off(e,r),n.apply(this,arguments)}return r._origin=n,this._on(e,r,s,i)},O.prototype.emit=function(){if(!this._events&&!this._all)return!1;this._events||p.call(this);var e,t,n,s,i,a,r=arguments[0],o=this.wildcard;if("newListener"===r&&!this._newListener&&!this._events.newListener)return!1;if(o&&(e=r,"newListener"!==r&&"removeListener"!==r&&"object"==typeof r)){if(n=r.length,l)for(s=0;s<n;s++)if("symbol"==typeof r[s]){a=!0;break}a||(r=r.join(this.delimiter))}var c,u=arguments.length;if(this._all&&this._all.length)for(s=0,n=(c=this._all.slice()).length;s<n;s++)switch(this.event=r,u){case 1:c[s].call(this,r);break;case 2:c[s].call(this,r,arguments[1]);break;case 3:c[s].call(this,r,arguments[1],arguments[2]);break;default:c[s].apply(this,arguments)}if(o)c=[],I.call(this,c,e,this.listenerTree,0,n);else{if("function"==typeof(c=this._events[r])){switch(this.event=r,u){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:for(t=new Array(u-1),i=1;i<u;i++)t[i-1]=arguments[i];c.apply(this,t)}return!0}c&&(c=c.slice())}if(c&&c.length){if(u>3)for(t=new Array(u-1),i=1;i<u;i++)t[i-1]=arguments[i];for(s=0,n=c.length;s<n;s++)switch(this.event=r,u){case 1:c[s].call(this);break;case 2:c[s].call(this,arguments[1]);break;case 3:c[s].call(this,arguments[1],arguments[2]);break;default:c[s].apply(this,t)}return!0}if(!this.ignoreErrors&&!this._all&&"error"===r)throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");return!!this._all},O.prototype.emitAsync=function(){if(!this._events&&!this._all)return!1;this._events||p.call(this);var e,t,n,s,i,a,r=arguments[0],o=this.wildcard;if("newListener"===r&&!this._newListener&&!this._events.newListener)return Promise.resolve([!1]);if(o&&(e=r,"newListener"!==r&&"removeListener"!==r&&"object"==typeof r)){if(s=r.length,l)for(i=0;i<s;i++)if("symbol"==typeof r[i]){t=!0;break}t||(r=r.join(this.delimiter))}var c,u=[],h=arguments.length;if(this._all)for(i=0,s=this._all.length;i<s;i++)switch(this.event=r,h){case 1:u.push(this._all[i].call(this,r));break;case 2:u.push(this._all[i].call(this,r,arguments[1]));break;case 3:u.push(this._all[i].call(this,r,arguments[1],arguments[2]));break;default:u.push(this._all[i].apply(this,arguments))}if(o?(c=[],I.call(this,c,e,this.listenerTree,0)):c=this._events[r],"function"==typeof c)switch(this.event=r,h){case 1:u.push(c.call(this));break;case 2:u.push(c.call(this,arguments[1]));break;case 3:u.push(c.call(this,arguments[1],arguments[2]));break;default:for(n=new Array(h-1),a=1;a<h;a++)n[a-1]=arguments[a];u.push(c.apply(this,n))}else if(c&&c.length){if(c=c.slice(),h>3)for(n=new Array(h-1),a=1;a<h;a++)n[a-1]=arguments[a];for(i=0,s=c.length;i<s;i++)switch(this.event=r,h){case 1:u.push(c[i].call(this));break;case 2:u.push(c[i].call(this,arguments[1]));break;case 3:u.push(c[i].call(this,arguments[1],arguments[2]));break;default:u.push(c[i].apply(this,n))}}else if(!this.ignoreErrors&&!this._all&&"error"===r)return arguments[1]instanceof Error?Promise.reject(arguments[1]):Promise.reject("Uncaught, unspecified 'error' event.");return Promise.all(u)},O.prototype.on=function(e,t,n){return this._on(e,t,!1,n)},O.prototype.prependListener=function(e,t,n){return this._on(e,t,!0,n)},O.prototype.onAny=function(e){return this._onAny(e,!1)},O.prototype.prependAny=function(e){return this._onAny(e,!0)},O.prototype.addListener=O.prototype.on,O.prototype._onAny=function(e,t){if("function"!=typeof e)throw new Error("onAny only accepts instances of Function");return this._all||(this._all=[]),t?this._all.unshift(e):this._all.push(e),this},O.prototype._on=function(e,t,n,s){if("function"==typeof e)return this._onAny(e,t),this;if("function"!=typeof t)throw new Error("on only accepts instances of Function");this._events||p.call(this);var a,r=this;return s!==i&&(t=(a=N.call(this,e,t,s))[0],r=a[1]),this._newListener&&this.emit("newListener",e,t),this.wildcard?(x.call(this,e,t,n),r):(this._events[e]?("function"==typeof this._events[e]&&(this._events[e]=[this._events[e]]),n?this._events[e].unshift(t):this._events[e].push(t),!this._events[e].warned&&this._maxListeners>0&&this._events[e].length>this._maxListeners&&(this._events[e].warned=!0,d.call(this,this._events[e].length,e))):this._events[e]=t,r)},O.prototype.off=function(e,t){if("function"!=typeof t)throw new Error("removeListener only takes instances of Function");var n,s=[];if(this.wildcard){var i="string"==typeof e?e.split(this.delimiter):e.slice();if(!(s=I.call(this,null,i,this.listenerTree,0)))return this}else{if(!this._events[e])return this;n=this._events[e],s.push({_listeners:n})}for(var a=0;a<s.length;a++){var o=s[a];if(n=o._listeners,r(n)){for(var l=-1,c=0,u=n.length;c<u;c++)if(n[c]===t||n[c].listener&&n[c].listener===t||n[c]._origin&&n[c]._origin===t){l=c;break}if(l<0)continue;return this.wildcard?o._listeners.splice(l,1):this._events[e].splice(l,1),0===n.length&&(this.wildcard?delete o._listeners:delete this._events[e]),this._removeListener&&this.emit("removeListener",e,t),this}(n===t||n.listener&&n.listener===t||n._origin&&n._origin===t)&&(this.wildcard?delete o._listeners:delete this._events[e],this._removeListener&&this.emit("removeListener",e,t))}return this.listenerTree&&$(this.listenerTree),this},O.prototype.offAny=function(e){var t,n=0,s=0;if(e&&this._all&&this._all.length>0){for(n=0,s=(t=this._all).length;n<s;n++)if(e===t[n])return t.splice(n,1),this._removeListener&&this.emit("removeListenerAny",e),this}else{if(t=this._all,this._removeListener)for(n=0,s=t.length;n<s;n++)this.emit("removeListenerAny",t[n]);this._all=[]}return this},O.prototype.removeListener=O.prototype.off,O.prototype.removeAllListeners=function(e){if(e===i)return!this._events||p.call(this),this;if(this.wildcard){var t,n=I.call(this,null,e,this.listenerTree,0);if(!n)return this;for(t=0;t<n.length;t++)n[t]._listeners=null;this.listenerTree&&$(this.listenerTree)}else this._events&&(this._events[e]=null);return this},O.prototype.listeners=function(e){var t,n,s,a,r,o=this._events;if(e===i){if(this.wildcard)throw Error("event name required for wildcard emitter");if(!o)return[];for(a=(t=h(o)).length,s=[];a-- >0;)"function"==typeof(n=o[t[a]])?s.push(n):s.push.apply(s,n);return s}if(this.wildcard){if(!(r=this.listenerTree))return[];var l=[],c="string"==typeof e?e.split(this.delimiter):e.slice();return I.call(this,l,c,r,0),l}return o&&(n=o[e])?"function"==typeof n?[n]:n:[]},O.prototype.eventNames=function(e){var t=this._events;return this.wildcard?T.call(this,this.listenerTree,[],null,e):t?h(t):[]},O.prototype.listenerCount=function(e){return this.listeners(e).length},O.prototype.hasListeners=function(e){if(this.wildcard){var t=[],n="string"==typeof e?e.split(this.delimiter):e.slice();return I.call(this,t,n,this.listenerTree,0),t.length>0}var s=this._events,a=this._all;return!!(a&&a.length||s&&(e===i?h(s).length:s[e]))},O.prototype.listenersAny=function(){return this._all?this._all:[]},O.prototype.waitFor=function(e,t){var n=this,s=typeof t;return"number"===s?t={timeout:t}:"function"===s&&(t={filter:t}),S((t=v(t,{timeout:0,filter:i,handleError:!1,Promise,overload:!1},{filter:w,Promise:b})).Promise,(function(s,i,a){function r(){var a=t.filter;if(!a||a.apply(n,arguments))if(n.off(e,r),t.handleError){var o=arguments[0];o?i(o):s(g.apply(null,arguments).slice(1))}else s(g.apply(null,arguments))}a((function(){n.off(e,r)})),n._on(e,r,!1)}),{timeout:t.timeout,overload:t.overload})};var C=O.prototype;Object.defineProperties(O,{defaultMaxListeners:{get:function(){return C._maxListeners},set:function(e){if("number"!=typeof e||e<0||Number.isNaN(e))throw TypeError("n must be a non-negative number");C._maxListeners=e},enumerable:!0},once:{value:function(e,t,n){return S((n=v(n,{Promise,timeout:0,overload:!1},{Promise:b})).Promise,(function(n,s,i){var a;if("function"==typeof e.addEventListener)return a=function(){n(g.apply(null,arguments))},i((function(){e.removeEventListener(t,a)})),void e.addEventListener(t,a,{once:!0});var r,o=function(){r&&e.removeListener("error",r),n(g.apply(null,arguments))};"error"!==t&&(r=function(n){e.removeListener(t,o),s(n)},e.once("error",r)),i((function(){r&&e.removeListener("error",r),e.removeListener(t,o)})),e.once(t,o)}),{timeout:n.timeout,overload:n.overload})},writable:!0,configurable:!0}}),Object.defineProperties(C,{_maxListeners:{value:10,writable:!0,configurable:!0},_observers:{value:null,writable:!0,configurable:!0}}),(s=function(){return O}.call(t,n,t,e))===i||(e.exports=s)}()},53908:(e,t,n)=>{const s=n(57272),{MAX_LENGTH:i,MAX_SAFE_INTEGER:a}=n(16874),{safeRe:r,t:o}=n(99718),l=n(98587),{compareIdentifiers:c}=n(61123);class u{constructor(e,t){if(t=l(t),e instanceof u){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>i)throw new TypeError(`version is longer than ${i} characters`);s("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const n=e.trim().match(t.loose?r[o.LOOSE]:r[o.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>a||this.major<0)throw new TypeError("Invalid major version");if(this.minor>a||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>a||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map((e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<a)return t}return e})):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(s("SemVer.compare",this.version,this.options,e),!(e instanceof u)){if("string"==typeof e&&e===this.version)return 0;e=new u(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof u||(e=new u(e,this.options)),c(this.major,e.major)||c(this.minor,e.minor)||c(this.patch,e.patch)}comparePre(e){if(e instanceof u||(e=new u(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const n=this.prerelease[t],i=e.prerelease[t];if(s("prerelease compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return c(n,i)}while(++t)}compareBuild(e){e instanceof u||(e=new u(e,this.options));let t=0;do{const n=this.build[t],i=e.build[t];if(s("build compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return c(n,i)}while(++t)}inc(e,t,n){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,n),this.inc("pre",t,n);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t,n),this.inc("pre",t,n);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{const e=Number(n)?1:0;if(!t&&!1===n)throw new Error("invalid increment argument: identifier is empty");if(0===this.prerelease.length)this.prerelease=[e];else{let s=this.prerelease.length;for(;--s>=0;)"number"==typeof this.prerelease[s]&&(this.prerelease[s]++,s=-2);if(-1===s){if(t===this.prerelease.join(".")&&!1===n)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(e)}}if(t){let s=[t,e];!1===n&&(s=[t]),0===c(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=s):this.prerelease=s}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}e.exports=u},50560:(e,t,n)=>{const s=n(53908);e.exports=(e,t,n)=>new s(e,n).compare(new s(t,n))},54089:(e,t,n)=>{const s=n(50560);e.exports=(e,t,n)=>s(e,t,n)>=0},16874:e=>{const t=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:t,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}},57272:e=>{const t="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=t},61123:e=>{const t=/^[0-9]+$/,n=(e,n)=>{const s=t.test(e),i=t.test(n);return s&&i&&(e=+e,n=+n),e===n?0:s&&!i?-1:i&&!s?1:e<n?-1:1};e.exports={compareIdentifiers:n,rcompareIdentifiers:(e,t)=>n(t,e)}},98587:e=>{const t=Object.freeze({loose:!0}),n=Object.freeze({});e.exports=e=>e?"object"!=typeof e?t:e:n},99718:(e,t,n)=>{const{MAX_SAFE_COMPONENT_LENGTH:s,MAX_SAFE_BUILD_LENGTH:i,MAX_LENGTH:a}=n(16874),r=n(57272),o=(t=e.exports={}).re=[],l=t.safeRe=[],c=t.src=[],u=t.t={};let h=0;const p="[a-zA-Z0-9-]",m=[["\\s",1],["\\d",a],[p,i]],d=(e,t,n)=>{const s=(e=>{for(const[t,n]of m)e=e.split(`${t}*`).join(`${t}{0,${n}}`).split(`${t}+`).join(`${t}{1,${n}}`);return e})(t),i=h++;r(e,i,t),u[e]=i,c[i]=t,o[i]=new RegExp(t,n?"g":void 0),l[i]=new RegExp(s,n?"g":void 0)};d("NUMERICIDENTIFIER","0|[1-9]\\d*"),d("NUMERICIDENTIFIERLOOSE","\\d+"),d("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${p}*`),d("MAINVERSION",`(${c[u.NUMERICIDENTIFIER]})\\.(${c[u.NUMERICIDENTIFIER]})\\.(${c[u.NUMERICIDENTIFIER]})`),d("MAINVERSIONLOOSE",`(${c[u.NUMERICIDENTIFIERLOOSE]})\\.(${c[u.NUMERICIDENTIFIERLOOSE]})\\.(${c[u.NUMERICIDENTIFIERLOOSE]})`),d("PRERELEASEIDENTIFIER",`(?:${c[u.NUMERICIDENTIFIER]}|${c[u.NONNUMERICIDENTIFIER]})`),d("PRERELEASEIDENTIFIERLOOSE",`(?:${c[u.NUMERICIDENTIFIERLOOSE]}|${c[u.NONNUMERICIDENTIFIER]})`),d("PRERELEASE",`(?:-(${c[u.PRERELEASEIDENTIFIER]}(?:\\.${c[u.PRERELEASEIDENTIFIER]})*))`),d("PRERELEASELOOSE",`(?:-?(${c[u.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${c[u.PRERELEASEIDENTIFIERLOOSE]})*))`),d("BUILDIDENTIFIER",`${p}+`),d("BUILD",`(?:\\+(${c[u.BUILDIDENTIFIER]}(?:\\.${c[u.BUILDIDENTIFIER]})*))`),d("FULLPLAIN",`v?${c[u.MAINVERSION]}${c[u.PRERELEASE]}?${c[u.BUILD]}?`),d("FULL",`^${c[u.FULLPLAIN]}$`),d("LOOSEPLAIN",`[v=\\s]*${c[u.MAINVERSIONLOOSE]}${c[u.PRERELEASELOOSE]}?${c[u.BUILD]}?`),d("LOOSE",`^${c[u.LOOSEPLAIN]}$`),d("GTLT","((?:<|>)?=?)"),d("XRANGEIDENTIFIERLOOSE",`${c[u.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),d("XRANGEIDENTIFIER",`${c[u.NUMERICIDENTIFIER]}|x|X|\\*`),d("XRANGEPLAIN",`[v=\\s]*(${c[u.XRANGEIDENTIFIER]})(?:\\.(${c[u.XRANGEIDENTIFIER]})(?:\\.(${c[u.XRANGEIDENTIFIER]})(?:${c[u.PRERELEASE]})?${c[u.BUILD]}?)?)?`),d("XRANGEPLAINLOOSE",`[v=\\s]*(${c[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${c[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${c[u.XRANGEIDENTIFIERLOOSE]})(?:${c[u.PRERELEASELOOSE]})?${c[u.BUILD]}?)?)?`),d("XRANGE",`^${c[u.GTLT]}\\s*${c[u.XRANGEPLAIN]}$`),d("XRANGELOOSE",`^${c[u.GTLT]}\\s*${c[u.XRANGEPLAINLOOSE]}$`),d("COERCEPLAIN",`(^|[^\\d])(\\d{1,${s}})(?:\\.(\\d{1,${s}}))?(?:\\.(\\d{1,${s}}))?`),d("COERCE",`${c[u.COERCEPLAIN]}(?:$|[^\\d])`),d("COERCEFULL",c[u.COERCEPLAIN]+`(?:${c[u.PRERELEASE]})?`+`(?:${c[u.BUILD]})?(?:$|[^\\d])`),d("COERCERTL",c[u.COERCE],!0),d("COERCERTLFULL",c[u.COERCEFULL],!0),d("LONETILDE","(?:~>?)"),d("TILDETRIM",`(\\s*)${c[u.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",d("TILDE",`^${c[u.LONETILDE]}${c[u.XRANGEPLAIN]}$`),d("TILDELOOSE",`^${c[u.LONETILDE]}${c[u.XRANGEPLAINLOOSE]}$`),d("LONECARET","(?:\\^)"),d("CARETTRIM",`(\\s*)${c[u.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",d("CARET",`^${c[u.LONECARET]}${c[u.XRANGEPLAIN]}$`),d("CARETLOOSE",`^${c[u.LONECARET]}${c[u.XRANGEPLAINLOOSE]}$`),d("COMPARATORLOOSE",`^${c[u.GTLT]}\\s*(${c[u.LOOSEPLAIN]})$|^$`),d("COMPARATOR",`^${c[u.GTLT]}\\s*(${c[u.FULLPLAIN]})$|^$`),d("COMPARATORTRIM",`(\\s*)${c[u.GTLT]}\\s*(${c[u.LOOSEPLAIN]}|${c[u.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",d("HYPHENRANGE",`^\\s*(${c[u.XRANGEPLAIN]})\\s+-\\s+(${c[u.XRANGEPLAIN]})\\s*$`),d("HYPHENRANGELOOSE",`^\\s*(${c[u.XRANGEPLAINLOOSE]})\\s+-\\s+(${c[u.XRANGEPLAINLOOSE]})\\s*$`),d("STAR","(<|>)?=?\\s*\\*"),d("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),d("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},25721:e=>{function t(e,t){if((e=e.replace(/\s+/g,""))===(t=t.replace(/\s+/g,"")))return 1;if(e.length<2||t.length<2)return 0;let n=new Map;for(let t=0;t<e.length-1;t++){const s=e.substring(t,t+2),i=n.has(s)?n.get(s)+1:1;n.set(s,i)}let s=0;for(let e=0;e<t.length-1;e++){const i=t.substring(e,e+2),a=n.has(i)?n.get(i):0;a>0&&(n.set(i,a-1),s++)}return 2*s/(e.length+t.length-2)}e.exports={compareTwoStrings:t,findBestMatch:function(e,n){if(!function(e,t){return"string"==typeof e&&!!Array.isArray(t)&&!!t.length&&!t.find((function(e){return"string"!=typeof e}))}(e,n))throw new Error("Bad arguments: First argument should be a string, second should be an array of strings");const s=[];let i=0;for(let a=0;a<n.length;a++){const r=n[a],o=t(e,r);s.push({target:r,rating:o}),o>s[i].rating&&(i=a)}return{ratings:s,bestMatch:s[i],bestMatchIndex:i}}}},13647:(e,t,n)=>{"use strict";n.r(t),n.d(t,{request:()=>g,settings:()=>f,storage:()=>d,type:()=>y});var s=n(13647),i=n(78584),a=n(26017);const r={async set(e,t){const n={};return n[e]=t,new Promise(((t,s)=>{o(e).set(n,(function(){chrome.runtime.lastError?s(chrome.runtime.lastError):t()}))}))},get:async e=>new Promise(((t,n)=>{o(e).get(e,(function(s){chrome.runtime.lastError?n(chrome.runtime.lastError):t(s[e])}))})),remove:async e=>new Promise(((t,n)=>{o(e).remove(e,(function(){chrome.runtime.lastError?n(chrome.runtime.lastError):t()}))})),list:async(e="local")=>new Promise(((t,n)=>{"local"===e?chrome.storage.local.get(null,(function(e){t(e)})):chrome.storage.sync.get(null,(function(e){t(e)}))})),async addStyle(e){try{const t=document.createElement("style");t.textContent=e,(document.head||document.body||document.documentElement||document).appendChild(t)}catch(e){console.log(`Could not add css:${e}`)}},version:()=>chrome.runtime.getManifest().version,lang(e,t){if(s.settings.get("forceEn")&&"undefined"!=typeof i18n){let n=i18n[e];if(void 0!==t)for(let e=0;e<t.length;e++)n=n.replace(`$${e+1}`,t[e]);return n}return chrome.i18n.getMessage(e,t)},langDirection(){try{const e=chrome.i18n.getUILanguage();if(/^(ar)(-|$)/i.test(e)&&!s.settings.get("forceEn"))return"rtl"}catch(e){i.error(e)}return"ltr"},assetUrl:e=>chrome.runtime.getURL(`assets/${e}`),injectCssResource(e,t){alert("injectCssResource not supported in webextension")},injectjsResource(e,t){const n=document.createElement("script");n.src=chrome.runtime.getURL(`vendor/${e}`),n.onload=function(){this.remove()},t.get(0).appendChild(n)},addProxyScriptToTag:(e,t)=>(e.src=chrome.runtime.getURL(`/content/proxy/proxy_${t}.js`),e),updateDom(e){const t=document.createElement("script");t.text="\n        document.getElementsByTagName('head')[0].onclick = function(e){\n          try{\n            componentHandler.upgradeDom();\n          }catch(e){\n            console.log(e);\n            setTimeout(function(){\n              componentHandler.upgradeDom();\n            },500);\n          }\n        }",t.onload=function(){this.remove()},e.get(0).appendChild(t)},storageOnChanged(e){chrome.storage.onChanged.addListener(e)}};function o(e){return a.syncRegex.test(e)?chrome.storage.sync:chrome.storage.local}const l={async xhr(e,t){if(void 0!==l.sendMessage)return l.sendMessage({name:"xhr",method:e,url:t}).then((e=>{if(429===e.status)throw"Rate limit Timeout";if(0===e.status)throw e.responseText;return e}));throw"Could not send xhr"},sendMessage:async e=>new Promise(((t,n)=>{chrome.runtime.sendMessage(e,(function(e){t(e)}))})),notification(e){this.sendMessage({name:"notification",options:e})},database(e,t){return this.sendMessage({name:"database",options:{call:e,param:t}})}};var c=n(50953),u=n(13647),h=n(78584),p=n(26017);const m={options:(0,c.Kh)({autoTrackingModeanime:"video",readerTracking:!0,askBefore:!0,autoTrackingModemanga:"instant",enablePages:{},forceEn:!1,rpc:!0,presenceLargeImage:"cover",presenceShowButtons:!0,presenceShowMalsync:!1,userscriptModeButton:!1,syncMode:"MAL",syncModeSimkl:"MAL",localSync:!0,delay:0,videoDuration:85,malTags:!1,malContinue:!0,malResume:!0,usedPage:!0,epPredictions:!0,theme:"auto",themeSidebars:!0,themeColor:"#000000",themeOpacity:100,themeImage:"",minimalWindow:!1,posLeft:"left",miniMALonMal:!1,floatButtonStealth:!1,minimizeBigPopup:!1,floatButtonCorrection:!0,floatButtonHide:!1,autoCloseMinimal:!1,outWay:!0,miniMalWidth:"550px",miniMalHeight:"90%",malThumbnail:100,friendScore:!0,loadPTWForProgress:!1,quicklinks:["Aniwave","Crunchyroll","Gogoanime","Mangadex","MangaNato","MangaFox","MangaSee","MangaFire","YugenAnime","HiAnime","Hulu","Netflix","Hidive","VIZ","MangaPlus","MangaReader","ComicK"],quicklinksPosition:"default",autofull:!1,autoresume:!1,autoNextEp:!1,highlightAllEp:!1,checkForFiller:!0,crashReport:!0,introSkip:85,introSkipFwd:[17,39],introSkipBwd:[17,37],nextEpShort:[],correctionShort:[67],syncShort:[],progressInterval:120,progressIntervalDefaultAnime:"en/sub",progressIntervalDefaultManga:"en/sub",progressNotificationsAnime:!0,progressNotificationsManga:!0,notificationsSticky:!0,bookMarksList:!1,customDomains:[],anilistUpdateUi:!0,anilistToken:"",anilistOptions:{displayAdultContent:!0,scoreFormat:"POINT_10"},kitsuToken:"",kitsuOptions:{titleLanguagePreference:"canonical",sfwFilter:!1,ratingSystem:"regular"},simklToken:"",malToken:"",malRefresh:"",shikiToken:"",shikiOptions:{locale:"ru"}}),debounceArray:{},isInit:(0,c.KR)(!1),async init(){const e=[];for(const t in this.options){const n=await u.storage.get(`settings/${t}`);void 0!==n&&(this.options[t]=n,e[t]=/(token|refresh)/i.test(t)&&n?"********":n)}let t;return h.log("Settings",e),u.storage.storageOnChanged(((e,n)=>{if("sync"===n)for(const t in e){const n=e[t];/^settings\//i.test(t)&&(this.options[t.replace("settings/","")]=n.newValue,h.info(`Update ${t} option to ${JSON.stringify(n.newValue,null,2)}`))}if("local"===n&&e.rateLimit)try{clearTimeout(t),e.rateLimit.newValue?(h.log("Rate limited"),$(".type-rate").length||p.flashm("Rate limited. Retrying in a moment",{error:!0,type:"rate",permanent:!0})):t=setTimeout((()=>{h.log("No Rate limited"),$(".type-rate").remove()}),5e3)}catch(e){h.error(e)}})),this.isInit.value=!0,this},get(e){if(!this.isInit.value)throw"Settings not initialized";return this.options[e]},set(e,t){if(!Object.prototype.hasOwnProperty.call(this.options,e)){const t=Error(`${e} is not a defined option`);throw h.error(t),t}return this.options[e]=t,u.storage.set(`settings/${e}`,t)},setDebounce(e,t){this.options[e]=t,clearTimeout(this.debounceArray[e]),this.debounceArray[e]=setTimeout((()=>{this.set(e,t),delete this.debounceArray[e]}),1e3)},async getAsync(e){const t=await u.storage.get(`settings/${e}`);return void 0===t&&void 0!==this.options[e]?this.options[e]:t}},d=r,g=l,f=m,y="webextension"},78584:(e,t,n)=>{"use strict";n.r(t),n.d(t,{debug:()=>r,error:()=>i,info:()=>a,log:()=>s,m:()=>o});const s=Function.prototype.bind.call(console.log,console,"%cMAL-Sync","background-color: #2e51a2; color: white; padding: 2px 10px; border-radius: 3px;"),i=Function.prototype.bind.call(console.error,console,"%cMAL-Sync","background-color: #8f0000; color: white; padding: 2px 10px; border-radius: 3px;"),a=Function.prototype.bind.call(console.info,console,"%cMAL-Sync","background-color: wheat; color: black; padding: 2px 10px; border-radius: 3px;"),r=Function.prototype.bind.call(console.debug,console,"%cMAL-Sync","background-color: steelblue; color: black; padding: 2px 10px; border-radius: 3px;"),o=(e,t="",n=[])=>{let s="white";t||(t=function(e){if(!e)return"#ffffff";e=String(e);let t=0;for(let n=0;n<e.length;n++)t=e.charCodeAt(n)+((t<<5)-t);let n="#";for(let e=0;e<3;e++)n+=`00${(t>>8*e&255).toString(16)}`.substr(-2);return n}(e)),"#"===t[0]&&(s=parseInt(t.replace("#",""),16)>8388607.5?"#000":"#fff");const i=`background-color: ${t}; color: ${s}; padding: 2px 10px; border-radius: 3px; margin-left: -5px; border-left: 1px solid white;`;n.push({name:e,style:i});const a={m:(e,t="")=>o(e,t,[...n])},r=n.reduce(((e,t)=>`${e}%c${t.name}`),""),l=n.map((e=>e.style));return a.log=Function.prototype.bind.call(console.log,console,`%cM ${r}`,"background-color: #2e51a2; color: white; padding: 2px 10px; border-radius: 3px;",...l),a.error=Function.prototype.bind.call(console.error,console,`%cM ${r}`,"background-color: #8f0000; color: white; padding: 2px 10px; border-radius: 3px;",...l),a.info=Function.prototype.bind.call(console.info,console,`%cM ${r}`,"background-color: wheat; color: black; padding: 2px 10px; border-radius: 3px;",...l),a.debug=Function.prototype.bind.call(console.debug,console,`%cM ${r}`,"background-color: steelblue; color: black; padding: 2px 10px; border-radius: 3px;",...l),a}},26017:(e,t,n)=>{"use strict";n.r(t),n.d(t,{absoluteLink:()=>b,canHideTabs:()=>F,changeDetect:()=>S,checkDoubleExecution:()=>T,clearCache:()=>se,elementInViewport:()=>Y,episode:()=>d,favicon:()=>h,flashConfirm:()=>W,flashm:()=>G,fullUrlChangeDetect:()=>E,getAsyncWaitUntilTrue:()=>I,getBaseText:()=>u,getContinueWaching:()=>P,getEntrySettings:()=>M,getResumeWaching:()=>C,getStatusText:()=>B,getTooltip:()=>j,getUrlFromTags:()=>L,getselect:()=>v,handleMalImages:()=>U,htmlDecode:()=>ee,isDomainMatching:()=>ae,isFirefox:()=>te,lazyload:()=>X,notifications:()=>H,pageUrl:()=>Z,parseHtml:()=>_,planTo:()=>m,rateLimitExclude:()=>f,returnYYYYMMDD:()=>Q,setContinueWaching:()=>A,setEntrySettings:()=>R,setResumeWaching:()=>O,setUrlInTags:()=>N,sortAlphabetically:()=>ie,status:()=>y,statusTag:()=>V,syncRegex:()=>g,timeCache:()=>z,timeDiffToText:()=>D,upperCaseFirstLetter:()=>re,urlChangeDetect:()=>w,urlParam:()=>c,urlPart:()=>o,urlStrip:()=>l,wait:()=>J,waitForPageToBeVisible:()=>ne,waitUntilTrue:()=>k,watching:()=>p});var s=n(7263),i=n(13647),a=n(78584),r=n(26017);function o(e,t){if(!e)return"";const n=e.split("/");return n[t]?n[t].replace(/[#?].*/,""):""}function l(e){return e.replace(/[#?].*/,"")}function c(e,t){const n=new RegExp(`[?&]${t}=([^&#]*)`).exec(e);return null===n?null:decodeURI(n[1])||0}function u(e){let t=e.text();return e.children().each((function(){t=t.replace(s.$(this).text(),"")})),t}function h(e){if(!e)return"";const t=e.match(/^(https?:\/\/)?[^/]+/);return t&&(e=t[0]),`https://favicon.malsync.moe/?domain=${e}`}function p(e){return"manga"===e?"Reading":"Watching"}function m(e){return"manga"===e?"Plan to Read":"Plan to Watch"}function d(e){return"manga"===e?i.storage.lang("UI_Chapter"):i.storage.lang("UI_Episode")}const g=/(^settings\/.*|^updateCheckTime$|^tempVersion$|^local:\/\/|^list-tagSettings$)/,f=/^https:\/\/api.malsync.moe\/(shark|mal\/|nc\/mal\/.*\/progress$)/i;var y;function v(e,t){let n=e.split(`name="${t}"`)[1].split("</select>")[0];if(n.indexOf('selected="selected"')>-1){n=n.split("<option");for(let e=0;e<n.length;++e)if(n[e].indexOf('selected="selected"')>-1)return n[e].split('value="')[1].split('"')[0]}return""}function b(e,t){return void 0===e||e.startsWith("http")||("/"!==e.charAt(0)&&(e=`/${e}`),e=t+e),e}function _(e){return(new DOMParser).parseFromString(`<!doctype html><body>${e}`,"text/html").body.textContent}function w(e){let t=window.location.href;return setInterval((function(){t!==window.location.href&&(t=window.location.href,e())}),100)}function E(e,t=!1){let n="";const s=setInterval((function(){const s=t?l(window.location.href):window.location.href;n!==s&&(n=s,e())}),100);return Number(s)}function S(e,t,n=!1){let s=t();const i=setInterval((function(){const n=t();void 0!==n&&s!==n&&(s=t(),e())}),500);return n&&e(),Number(i)}function k(e,t,n=100){const s=setInterval((function(){e()&&(clearInterval(s),t())}),n);return s}function I(e,t=100){let n,s;const i=()=>{clearTimeout(n),s&&s("AsyncWait stopped")};return{asyncWaitUntilTrue:()=>(i(),new Promise(((i,a)=>{s=a,n=k(e,(()=>i()),t)}))),reset:i}}!function(e){e[e.watching=1]="watching",e[e.completed=2]="completed",e[e.onhold=3]="onhold",e[e.dropped=4]="dropped",e[e.planToWatch=6]="planToWatch"}(y||(y={}));const x=Math.random();function T(){$(".mal-sync-double-detect").length&&$(".mal-sync-double-detect").each((function(e){$(this).text()!==x.toString()&&alert("Double execution detected! Please run MAL-Sync once only.")})),$("body").after(s.html(`<div class="mal-sync-double-detect" style="display: none;">${x.toString()}</div>`))}function L(e){return/malSync::[\d\D]+::/.test(e)?t(e.split("malSync::")[1].split("::")[0]):/last::[\d\D]+::/.test(e)?t(e.split("last::")[1].split("::")[0]):void 0;function t(e){try{return atob(e)}catch(t){return e}}}function N(e,t){if(""===e)return t.replace(/,?(malSync|last)::[^ \n]+?::/,"");if(!i.settings.get("malTags"))return t;const n=`malSync::${btoa(e)}::`;return/(last|malSync)::[\d\D]+::/.test(t)?t.replace(/(last|malSync)::[^^]*?::/,n):`${t},${n}`}async function O(e,t,n,s){return i.storage.set(`resume/${n}/${s}`,{url:e,ep:t})}async function C(e,t){if(i.settings.get("malResume"))return i.storage.get(`resume/${e}/${t}`)}async function A(e,t,n,s){return i.storage.set(`continue/${n}/${s}`,{url:e,ep:t})}async function P(e,t){if(i.settings.get("malContinue"))return i.storage.get(`continue/${e}/${t}`)}async function R(e,t,n,s=""){const a={};if(n){for(const e in n)switch(e){case"u":case"p":a[e]=n[e]}i.settings.get("malTags")?s=N(JSON.stringify(a),s):await i.storage.set(`tagSettings/${e}/${t}`,JSON.stringify(a))}return Object.values(a).find((e=>Boolean(e)))||(s=N("",s),i.settings.get("malTags")||await i.storage.remove(`tagSettings/${e}/${t}`)),s}async function M(e,t,n=""){const s={u:null,c:null,r:null,p:""};if(i.settings.get("malTags")){const e=L(n);if(e)if("{"===e[0])try{const t=JSON.parse(e);for(const e in s)t[e]&&(s[e]=t[e])}catch(e){a.error(e)}else s.u=e}else{let n=await i.storage.get(`tagSettings/${e}/${t}`);if(n){n=JSON.parse(n);for(const e in s)n[e]&&(s[e]=n[e])}}const r=await P(e,t);r&&(s.c=r);const o=await C(e,t);return o&&(s.r=o),i.settings.get("usedPage")||(s.u=null),s}function U(e){return-1!==e.indexOf("questionmark")?i.storage.assetUrl("questionmark.gif"):e}function j(e,t="",n="top"){const s=Math.floor(1e3*Math.random()+1);return`<div id="tt${s}" class="icon material-icons" style="font-size:16px; line-height: 0; color: #7f7f7f; padding-bottom: 20px; padding-left: 3px; ${t}">contact_support</div>  <div class="mdl-tooltip mdl-tooltip--${n} mdl-tooltip--large" for="tt${s}">${e}</div>`}function D(e){let t="";e/=1e3;const n=Math.floor(e/31536e3);e-=31536e3*n,n&&(t+=`${n}y `);const s=Math.floor(e/86400);e-=86400*s,s&&(t+=`${s}d `);const i=Math.floor(e/3600)%24;e-=3600*i,i&&s<2&&(t+=`${i}h `);const a=Math.floor(e/60)%60;return e-=60*a,a&&!s&&i<3&&(t+=`${a}min `),t}function F(){return"undefined"!=typeof browser&&void 0!==browser.tabs.hide}function V(e,t,n){const s={anime:{1:{class:"watching",text:"CW",title:i.storage.lang(`UI_Status_watching_${t}`)},2:{class:"completed",text:"CMPL",title:i.storage.lang("UI_Status_Completed")},3:{class:"on-hold",text:"HOLD",title:i.storage.lang("UI_Status_OnHold")},4:{class:"dropped",text:"DROP",title:i.storage.lang("UI_Status_Dropped")},6:{class:"plantowatch",text:"PTW",title:i.storage.lang(`UI_Status_planTo_${t}`)},23:{class:"rewatching",text:"RE",title:i.storage.lang(`UI_Status_Rewatching_${t}`)}},manga:{1:{class:"reading",text:"CR",title:i.storage.lang(`UI_Status_watching_${t}`)},2:{class:"completed",text:"CMPL",title:i.storage.lang("UI_Status_Completed")},3:{class:"on-hold",text:"HOLD",title:i.storage.lang("UI_Status_OnHold")},4:{class:"dropped",text:"DROP",title:i.storage.lang("UI_Status_Dropped")},6:{class:"plantoread",text:"PTR",title:i.storage.lang(`UI_Status_planTo_${t}`)},23:{class:"rewatching",text:"RE",title:i.storage.lang(`UI_Status_Rewatching_${t}`)}}};if($.each([1,2,3,4,6,23],(function(e,t){s.anime[s.anime[t].title]=s.anime[t],s.manga[s.manga[t].title]=s.manga[t]})),e&&s[t][e]){const i=s[t][e];return` <a href="https://myanimelist.net/ownlist/${t}/${n}/edit?hideLayout=1" title="${i.title}" class="Lightbox_AddEdit button_edit ${i.class}">${i.text}</a>`}return!1}function B(e,t){switch(t){case 1:return i.storage.lang(`UI_Status_watching_${e}`);case 2:return i.storage.lang("UI_Status_Completed");case 3:return i.storage.lang("UI_Status_OnHold");case 4:return i.storage.lang("UI_Status_Dropped");case 6:return i.storage.lang(`UI_Status_planTo_${e}`);case 7:return i.storage.lang("UI_Status_All");case 23:return i.storage.lang(`UI_Status_Rewatching_${e}`);default:return""}}function H(e,t,n,s=""){const r={type:"basic",title:t,message:n,iconUrl:s};a.log("Notification",e,r),i.storage.get("notificationHistory").then((t=>{void 0===t&&(t=[]),"object"==typeof t&&(t.length>=10&&t.shift(),t.push({url:e,title:r.title,message:r.message,iconUrl:r.iconUrl,timestamp:Date.now()}),i.storage.set("notificationHistory",t))}));try{return chrome.notifications.create(e,r)}catch(e){a.error(e)}}async function z(e,t,n){const s=await i.storage.get(e);if("object"==typeof s&&(new Date).getTime()<s.timestamp)return s.data;const a=await t();return i.storage.set(e,{data:a,timestamp:(new Date).getTime()+n}).then((()=>a))}function G(e,t){s.$("#flash-div-top").length||function(){i.storage.addStyle('.flashinfo{\n                    transition: max-height 2s, opacity 2s 2s;\n                 }\n                 .mini-stealth .flashinfo{\n                    opacity: 0;\n                 }\n                  #flashinfo-div.hover.mini-stealth .flashinfo.type-update{\n                    opacity: 0.7;\n                 }\n                 #flashinfo-div.hover .flashinfo{\n                    opacity: 1;\n                 }\n                 .flashinfo:hover{\n                    max-height:5000px !important;\n                    z-index: 2147483647;\n                    opacity: 1;\n                    transition: max-height 2s;\n                 }\n                 .flashinfo .synopsis{\n                    transition: max-height 2s, max-width 2s ease 2s;\n                 }\n                 .flashinfo:hover .synopsis{\n                    max-height:9999px !important;\n                    max-width: 500px !important;\n                    transition: max-height 2s;\n                 }\n                 #flashinfo-div{\n                  z-index: 2;\n                  transition: 2s;\n                 }\n                 #flashinfo-div:hover, #flashinfo-div.hover{\n                  z-index: 2147483647;\n                 }\n                 #flashinfo-div.player-error {\n                   z-index: 2147483647;\n                 }\n                 #flashinfo-div.player-error .type-update{\n                  overflow: visible !important;\n                  opacity: 1 !important;\n                 }\n                 #flashinfo-div.player-error .player-error{\n                  display: block !important\n                 }\n                 #flashinfo-div.player-error-missing-permissions .player-error-missing-permissions{\n                  display: block !important\n                 }\n                 #flashinfo-div.player-error-missing-permissions .player-error-default{\n                  display: none !important\n                 }\n\n                 #flash-div-top, #flash-div-bottom, #flashinfo-div{\n                    font-family: "Helvetica","Arial",sans-serif;\n                    color: white;\n                    font-size: 14px;\n                    font-weight: 400;\n                    line-height: 17px;\n                 }\n                 #flash-div-top h2, #flash-div-bottom h2, #flashinfo-div h2{\n                    font-family: "Helvetica","Arial",sans-serif;\n                    color: white;\n                    font-size: 14px;\n                    font-weight: 700;\n                    line-height: 17px;\n                    padding: 0;\n                    margin: 0;\n                 }\n                 #flash-div-top a, #flash-div-bottom a, #flashinfo-div a{\n                    color: #DF6300;\n                 }');let e="";i.settings.get("floatButtonStealth")&&(e="mini-stealth"),s.$("body").after(s.html(`<div id="flash-div-top" dir="${i.storage.langDirection()}" style="text-align: center;pointer-events: none;position: fixed;top:-5px;width:100%;z-index: 2147483647;left: 0;"></div>        <div id="flash-div-bottom" dir="${i.storage.langDirection()}" style="text-align: center;pointer-events: none;position: fixed;bottom:0px;width:100%;z-index: 2147483647;left: 0;"><div id="flash" style="display:none;  background-color: red;padding: 20px; margin: 0 auto;max-width: 60%;          -webkit-border-radius: 20px;-moz-border-radius: 20px;border-radius: 20px;background:rgba(227,0,0,0.6);"></div></div>        <div id="flashinfo-div" dir="${i.storage.langDirection()}" class="${e}" style="text-align: center;pointer-events: none;position: fixed;bottom:0px;width:100%;left: 0;">`))}(),a.log("[Flash] Message:",e);let n="#323232";void 0!==t&&void 0!==t.error&&t.error&&(n="#3e0808");let r="#flash-div-bottom";void 0!==t&&void 0!==t.position&&t.position&&(r=`#flash-div-${t.position}`);let o="flash";if(void 0!==t&&void 0!==t.type&&t.type){const e=`type-${t.type}`;s.$(`${r} .${e}, #flashinfo-div .${e}`).removeClass(e).fadeOut({duration:1e3,queue:!1,complete(){s.$(this).remove()}}),o+=` ${e}`}let l,c=`<div class="${o}" style="display:none;">        <div style="display:table; pointer-events: all; padding: 14px 24px 14px 24px; margin: 0 auto; margin-top: 5px; max-width: 60%; -webkit-border-radius: 20px;-moz-border-radius: 20px;border-radius: 2px;color: white;background:${n}; ">          ${e}        </div>      </div>`;return void 0!==t&&void 0!==t.hoverInfo&&t.hoverInfo?(o+=" flashinfo",c=`<div class="${o}" style="display:none; max-height: 5000px; overflow: hidden;"><div style="display:table; pointer-events: all; margin: 0 auto; margin-top: -2px; max-width: 60%; -webkit-border-radius: 20px;-moz-border-radius: 20px;border-radius: 2px;color: white;background:${n}; position: relative;"><div style="max-height: 60vh; overflow-y: auto; padding: 14px 24px 14px 24px;">${e}</div></div></div>`,s.$("#flashinfo-div").addClass("hover"),l=s.$(s.html(c)).appendTo("#flashinfo-div"),void 0!==t&&void 0!==t.minimized&&t.minimized&&l.css("max-height","8px")):l=s.$(s.html(c)).appendTo(r),void 0!==t&&void 0!==t.permanent&&t.permanent?l.slideDown(800):void 0!==t&&void 0!==t.hoverInfo&&t.hoverInfo?l.slideDown(800).delay(4e3).queue((function(){s.$("#flashinfo-div").removeClass("hover"),l.css("max-height","8px")})):l.slideDown(800).delay(4e3).slideUp(800,(()=>{s.$(this).remove()})),l}async function W(e,t,n=(()=>{}),a=(()=>{}),r=!1){return new Promise((function(o,l){let c=i.storage.lang("Ok"),u=i.storage.lang("Cancel");r&&(c=i.storage.lang("Yes"),u=i.storage.lang("No"));const h=G(e=`<div style="text-align: center;">${e}</div><div style="display: flex; justify-content: space-around;"><button class="Yes" style="background-color: transparent; border: none; color: rgb(255,64,129);margin-top: 10px; cursor:pointer;">${c}</button><button class="Cancel" style="background-color: transparent; border: none; color: rgb(255,64,129);margin-top: 10px; cursor:pointer;">${u}</button></div>`,{permanent:!0,position:"top",type:t});h.find(".Yes").click((function(e){o(!0),s.$(e.target).parentsUntil(".flash").fadeOut(300,(function(){s.$(this).remove()})),n()})),h.find(".Cancel").click((function(e){o(!1),s.$(e.target).parentsUntil(".flash").fadeOut(300,(function(){s.$(this).remove()})),a()}))}))}let K=!1,q=[];function X(e,t=".mdl-layout__content"){function n(e,t){if(!s.$(e).is(":visible"))return!1;if(s.$(e).hasClass("lazyBack"))s.$(e).css("background-image",`url(${e.getAttribute("data-src")})`).removeClass("lazyBack");else{const n=new Image,s=e.getAttribute("data-src");n.onload=function(){e.parent?e.parent.replaceChild(n,e):e.src=s,t&&t()},n.src=s}}for(let e=0;e<q.length;e++)$(q[e]).addClass("init");q=[];const i=e.find("img.lazy.init, .lazyBack.init"),a=function(){for(let e=0;e<q.length;e++)r.elementInViewport(q[e],600)&&n(q[e],(function(){q.splice(e,e)})),$(q[e]).length||q.splice(e,e)};for(let e=0;e<i.length;e++)q.push(i[e]),$(i[e]).removeClass("init");a(),K||(K=!0,e.find(t).scroll((function(){a()})))}function Y(e,t=0){const n=e.getBoundingClientRect();return n.top>=0&&n.left>=0&&n.top-t<=(window.innerHeight||document.documentElement.clientHeight)}function J(e){return new Promise((t=>{setTimeout(t,e)}))}function Z(e,t,n){switch(e){case"mal":return`https://myanimelist.net/${t}/${n}`;case"anilist":return`https://anilist.co/${t}/${n}`;case"kitsu":return`https://kitsu.app/${t}/${n}`;case"simkl":return`https://simkl.com/${t}/${n}`;default:throw`${e} not a valid page`}}function Q(e=0){const t=new Date;t.setDate(t.getDate()+e);const n=t.getMonth()<9?`0${t.getMonth()+1}`:t.getMonth()+1,s=t.getDate()<10?`0${t.getDate()}`:t.getDate();return`${t.getFullYear()}-${n}-${s}`}function ee(e){return $("<textarea/>").html(s.html(e)).text()}function te(){return Boolean("undefined"!=typeof browser&&"undefined"!=typeof chrome)}function ne(){const e=()=>Boolean(!document.visibilityState||"visible"===document.visibilityState);if(e())return Promise.resolve();a.log("Page in background");const{asyncWaitUntilTrue:t}=I((()=>e()));return t().then((()=>{a.log("Page is visible")}))}async function se(){const e=await i.storage.list();let t=0;s.$.each(e,(function(e,n){r.syncRegex.test(String(e))||/(^tagSettings\/.*)/.test(String(e))||(i.storage.remove(String(e)),t++)})),r.flashm(`Cache Cleared [${t}]`)}function ie(e,t){return e.toLowerCase()<t.toLowerCase()?-1:e.toLowerCase()>t.toLowerCase()?1:0}function ae(e,t){const n=new URL(e),{host:s}=n;return s===t||s.endsWith(`.${t}`)}function re(e){return!e||e.length<2?e:e.charAt(0).toUpperCase()+e.slice(1)}},7263:(e,t,n)=>{"use strict";n.r(t),n.d(t,{$:()=>i,html:()=>a});var s=n(42838);const i=jQuery;function a(e){return s.sanitize(e,{SAFE_FOR_JQUERY:!0,ALLOW_UNKNOWN_PROTOCOLS:!0,ADD_ATTR:["target"]})}},66262:(e,t)=>{"use strict";t.A=(e,t)=>{const n=e.__vccOpts||e;for(const[e,s]of t)n[e]=s;return n}},52163:e=>{"use strict";e.exports=JSON.parse('[{"key":"nineAnime","name":"Aniwave","domain":"https://aniwave.to","database":"9anime","search":{"anime":"https://aniwave.to/filter?keyword={searchtermPlus}","manga":null}},{"key":"Crunchyroll","name":"Crunchyroll","domain":"https://www.crunchyroll.com","database":"Crunchyroll","search":{"anime":"https://www.crunchyroll.com/search?q={searchtermPlus}","manga":null}},{"key":"Mangadex","name":"Mangadex","domain":"https://www.mangadex.org","database":"Mangadex","search":{"anime":null,"manga":"https://mangadex.org/titles?q={searchterm}"}},{"key":"Gogoanime","name":"Gogoanime","domain":"https://gogoanime.tv","database":"Gogoanime","search":{"anime":"https://anitaku.pe/search.html?keyword={searchterm}","manga":null}},{"key":"TurkAnime","name":"TurkAnime","domain":"https://www.turkanime.co","database":null,"search":{"anime":"home","manga":null}},{"key":"animepahe","name":"animepahe","domain":"https://animepahe.com","database":"animepahe","search":{"anime":"home","manga":null}},{"key":"Netflix","name":"Netflix","domain":"https://www.netflix.com","database":"Netflix","search":{"anime":"https://www.netflix.com/search?q={searchterm}","manga":null}},{"key":"Animeflv","name":"Animeflv","domain":"https://animeflv.net","database":null,"search":{"anime":"https://www3.animeflv.net/browse?q={searchtermPlus}","manga":null}},{"key":"Jkanime","name":"Jkanime","domain":"https://jkanime.net","database":null,"search":{"anime":"https://jkanime.net/buscar/{searchterm}","manga":null}},{"key":"Proxer","name":"Proxer","domain":"https://proxer.me","database":null,"search":{"anime":"https://proxer.me/search?s=search&name={searchterm}&typ=all-anime&tags=&notags=#top","manga":"https://proxer.me/search?s=search&name={searchterm}&typ=all-manga&tags=&notags=#top"}},{"key":"Emby","name":"Emby","domain":"http://app.emby.media","database":null,"search":{"anime":"home","manga":null}},{"key":"Plex","name":"Plex","domain":"http://app.plex.tv","database":null,"search":{"anime":"home","manga":null}},{"key":"Aniflix","name":"Aniflix","domain":"https://aniflix.cc","database":null,"search":{"anime":"home","manga":null}},{"key":"KickAssAnime","name":"KickAssAnime","domain":"https://kickassanime.am","database":null,"search":{"anime":"home","manga":null}},{"key":"Shinden","name":"Shinden","domain":"https://shinden.pl","database":null,"search":{"anime":"https://shinden.pl/series?search={searchtermPlus}","manga":null}},{"key":"Voiranime","name":"Voiranime","domain":"https://voiranime.com","database":null,"search":{"anime":"https://voiranime.com/?s={searchtermPlus}","manga":null}},{"key":"MangaNato","name":"MangaNato","domain":"https://chapmanganato.com","database":"MangaNato","search":{"anime":null,"manga":"https://manganato.com/search/story/{searchterm(_)[noSpecial]}"}},{"key":"VIZ","name":"VIZ","domain":"https://www.viz.com","database":"VIZ","search":{"anime":null,"manga":"https://www.viz.com/search?search={searchtermPlus}"}},{"key":"NekoSama","name":"NekoSama","domain":"https://animecat.net","database":null,"search":{"anime":"home","manga":null}},{"key":"AnimeOdcinki","name":"AnimeOdcinki","domain":"https://anime-odcinki.pl","database":null,"search":{"anime":"https://anime-odcinki.pl/szukaj/{searchtermPlus}","manga":null}},{"key":"AnimeZone","name":"AnimeZone","domain":"https://www.animezone.pl","database":null,"search":{"anime":"home","manga":null}},{"key":"serimanga","name":"serimanga","domain":"https://serimanga.com","database":null,"search":{"anime":null,"manga":"https://serimanga.com/mangalar?search={searchtermPlus}"}},{"key":"mangadenizi","name":"mangadenizi","domain":"https://www.mangadenizi.net","database":null,"search":{"anime":null,"manga":"home"}},{"key":"moeclip","name":"moeclip","domain":"https://moeclip.com","database":null,"search":{"anime":"https://moeclip.com/search/{searchtermPlus}","manga":null}},{"key":"mangalivre","name":"Mang Livre","domain":"https://mangalivre.net","database":null,"search":{"anime":null,"manga":"home"}},{"key":"tmofans","name":"tmofans","domain":"https://visortmo.com","database":null,"search":{"anime":null,"manga":"https://lectortmo.com/library?_pg=1&title={searchtermPlus}"}},{"key":"MangaPlus","name":"MangaPlus","domain":"https://mangaplus.shueisha.co.jp","database":"MangaPlus","search":{"anime":null,"manga":"https://mangaplus.shueisha.co.jp/search_result?keyword={searchterm}"}},{"key":"JapScan","name":"JapScan","domain":"https://www.japscan.ws","database":null,"search":{"anime":null,"manga":"home"}},{"key":"AnimesVision","name":"AnimesVision","domain":"https://animes.vision","database":null,"search":{"anime":"home","manga":null}},{"key":"Hulu","name":"Hulu","domain":"https://www.hulu.com","database":"Hulu","search":{"anime":"home","manga":null}},{"key":"Hidive","name":"Hidive","domain":"https://www.hidive.com","database":"Hidive","search":{"anime":"https://www.hidive.com/search?q={searchtermPlus}","manga":null}},{"key":"PrimeVideo","name":"Amazon Prime Video","domain":"https://www.primevideo.com","database":null,"search":{"anime":"home","manga":null}},{"key":"MangaKatana","name":"MangaKatana","domain":"http://mangakatana.com","database":null,"search":{"anime":null,"manga":"http://mangakatana.com/?search={searchtermPlus}&search_by=book_name"}},{"key":"manga4life","name":"manga4life","domain":"https://manga4life.com","database":null,"search":{"anime":null,"manga":"https://manga4life.com/search/?name={searchterm}"}},{"key":"bato","name":"bato","domain":"https://bato.to","database":null,"search":{"anime":null,"manga":"https://bato.to/search?word={searchtermPlus}"}},{"key":"MangaPark","name":"MangaPark","domain":"https://mangapark.net","database":null,"search":{"anime":null,"manga":"https://mangapark.net/search?word={searchterm}"}},{"key":"AnimesHouse","name":"AnimesHouse","domain":"https://animeshouse.net","database":null,"search":{"anime":"home","manga":null}},{"key":"AnimeXin","name":"AnimeXin","domain":"https://animexin.vip","database":null,"search":{"anime":"https://animexin.vip/?s={searchtermPlus}","manga":null}},{"key":"MonosChinos","name":"MonosChinos","domain":"https://monoschinos2.com","database":null,"search":{"anime":"https://monoschinos2.com/buscar?q={searchtermPlus}","manga":null}},{"key":"Anime365","name":"Anime365","domain":"https://smotret-anime.net","database":null,"search":{"anime":"https://smotret-anime.net/catalog/search?q={searchtermPlus}","manga":null}},{"key":"AnimeFire","name":"AnimeFire","domain":"https://animefire.net","database":null,"search":{"anime":"home","manga":null}},{"key":"OtakuFR","name":"OtakuFR","domain":"https://otakufr.cc","database":null,"search":{"anime":"https://otakufr.cc/toute-la-liste-affiches/?q={searchtermPlus}","manga":null}},{"key":"mangatx","name":"mangatx","domain":"https://mangatx.com","database":null,"search":{"anime":null,"manga":"https://mangatx.com/?s={searchtermPlus}&post_type=wp-manga&post_type=wp-manga"}},{"key":"manhuafast","name":"manhuafast","domain":"https://manhuafast.com","database":null,"search":{"anime":null,"manga":"https://manhuafast.com/?s={searchtermPlus}&post_type=wp-manga&post_type=wp-manga"}},{"key":"TRanimeizle","name":"TRanimeizle","domain":"https://www.tranimeizle.net/","database":null,"search":{"anime":"home","manga":null}},{"key":"AnimeStreamingFR","name":"AnimeStreamingFR","domain":"https://beta.animestreamingfr.fr","database":null,"search":{"anime":"https://beta.animestreamingfr.fr/catalogue/search?query={searchtermPlus}","manga":null}},{"key":"Furyosociety","name":"Furyosociety","domain":"https://furyosociety.com/","database":null,"search":{"anime":null,"manga":"home"}},{"key":"AnimeId","name":"AnimeId","domain":"https://www.animeid.tv","database":null,"search":{"anime":"home","manga":null}},{"key":"MyAnimeListVideo","name":"MyAnimeList","domain":"https://myanimelist.net","database":null,"search":{"anime":"https://myanimelist.net/anime.php?q={searchterm}","manga":"https://myanimelist.net/manga.php?q={searchterm}"}},{"key":"AnimeUnity","name":"AnimeUnity","domain":"https://animeunity.it","database":null,"search":{"anime":"home","manga":null}},{"key":"MangaHere","name":"MangaHere","domain":"http://www.mangahere.cc","database":null,"search":{"anime":null,"manga":"http://www.mangahere.cc/search?title={searchtermPlus}"}},{"key":"MangaFox","name":"MangaFox","domain":"https://fanfox.net","database":"MangaFox","search":{"anime":null,"manga":"http://fanfox.net/search?title={searchtermPlus}"}},{"key":"DesuOnline","name":"DesuOnline","domain":"https://desu-online.pl","database":null,"search":{"anime":"https://desu-online.pl/?s={searchtermPlus}","manga":null}},{"key":"WuxiaWorld","name":"WuxiaWorld","domain":"https://wuxiaworld.site","database":null,"search":{"anime":null,"manga":"https://wuxiaworld.site/?s={searchtermPlus}&post_type=wp-manga"}},{"key":"LeviatanScans","name":"LeviatanScans","domain":"https://lscomic.com","database":null,"search":{"anime":null,"manga":"https://lscomic.com/?s={searchtermPlus}"}},{"key":"ReaperScans","name":"ReaperScans","domain":"https://reaperscans.com","database":null,"search":{"anime":null,"manga":"home"}},{"key":"LynxScans","name":"LynxScans","domain":"https://lynxscans.com","database":null,"search":{"anime":null,"manga":"https://lynxscans.com/comics?query={searchtermPlus}"}},{"key":"ZeroScans","name":"ZeroScans","domain":"https://zeroscans.com","database":null,"search":{"anime":null,"manga":"home"}},{"key":"DeathTollScans","name":"DeathTollScans","domain":"https://reader.deathtollscans.net","database":null,"search":{"anime":null,"manga":"home"}},{"key":"ManhuaPlus","name":"ManhuaPlus","domain":"https://manhuaplus.com","database":null,"search":{"anime":null,"manga":"https://manhuaplus.com/?s={searchtermPlus}&post_type=wp-manga"}},{"key":"Readm","name":"Readm","domain":"https://readm.today","database":null,"search":{"anime":null,"manga":"home"}},{"key":"tioanime","name":"tioanime","domain":"https://tioanime.com","database":null,"search":{"anime":"https://tioanime.com/directorio?q={searchtermPlus}","manga":null}},{"key":"YugenAnime","name":"YugenAnime","domain":"https://yugenanime.tv","database":"YugenAnime","search":{"anime":"https://yugenanime.tv/discover/?q={searchtermPlus}","manga":null}},{"key":"MangaSee","name":"MangaSee","domain":"https://mangasee123.com","database":"MangaSee","search":{"anime":null,"manga":"https://mangasee123.com/search/?name={searchterm}"}},{"key":"Okanime","name":"Okanime","domain":"https://okanime.tv","database":null,"search":{"anime":"https://okanime.tv/search?search={searchtermPlus}","manga":null}},{"key":"BSTO","name":"bs.to","domain":"https://bs.to","database":null,"search":{"anime":"home","manga":null}},{"key":"AsuraScans","name":"AsuraScans","domain":"https://asuratoon.com","database":null,"search":{"anime":null,"manga":"https://asuracomics.com/?s={searchtermPlus}"}},{"key":"Jellyfin","name":"Jellyfin","domain":"https://jellyfin.org/","database":null,"search":{"anime":"home","manga":null}},{"key":"An1me","name":"An1me","domain":"https://an1me.to","database":null,"search":{"anime":"https://an1me.to/?s={searchtermPlus}&post_type=wp-manga","manga":null}},{"key":"MangaJar","name":"MangaJar","domain":"https://mangajar.pro","database":null,"search":{"anime":null,"manga":"https://mangajar.pro/search?q={searchtermPlus}"}},{"key":"Otakustv","name":"Otakustv","domain":"https://www.otakustv.com","database":null,"search":{"anime":"https://www.otakustv.com/buscador.php?buscador={searchterm}","manga":null}},{"key":"Komga","name":"Komga","domain":"https://komga.org","database":null,"search":{"anime":null,"manga":"home"}},{"key":"AnimeWho","name":"AnimeWho","domain":"https://animewho.com","database":null,"search":{"anime":"home","manga":null}},{"key":"AnimeSuge","name":"AnimeSuge","domain":"https://animesuge.to","database":null,"search":{"anime":"home","manga":null}},{"key":"Toonily","name":"Toonily","domain":"https://toonily.com","database":null,"search":{"anime":null,"manga":"https://toonily.com/?s={searchtermPlus}&post_type=wp-manga"}},{"key":"Fumetsu","name":"Fumetsu","domain":"https://fumetsu.pl","database":null,"search":{"anime":"home","manga":null}},{"key":"FrixySubs","name":"FrixySubs","domain":"https://frixysubs.pl","database":null,"search":{"anime":"https://frixysubs.pl/anime-list?search={searchtermPlus}","manga":null}},{"key":"Guya","name":"Guya & Cubari","domain":"https://guya.moe","database":null,"search":{"anime":null,"manga":"home"}},{"key":"MangaHub","name":"MangaHub","domain":"https://mangahub.io","database":null,"search":{"anime":null,"manga":"https://mangahub.io/search?q={searchterm}"}},{"key":"ComicK","name":"ComicK","domain":"https://comick.io","database":"Comick","search":{"anime":null,"manga":"https://comick.io/search?q={searchterm}"}},{"key":"Bentomanga","name":"Bentomanga","domain":"https://bentomanga.com","database":null,"search":{"anime":null,"manga":"https://www.bentomanga.com/manga_list?search={searchterm}"}},{"key":"MangaSushi","name":"MangaSushi","domain":"https://mangasushi.net","database":null,"search":{"anime":null,"manga":"https://mangasushi.net/?s={searchtermPlus}&post_type=wp-manga"}},{"key":"TritiniaScans","name":"TritiniaScans","domain":"https://tritinia.com","database":null,"search":{"anime":null,"manga":"https://tritinia.com/?s={searchtermPlus}&post_type=wp-manga"}},{"key":"ReadManhua","name":"ReadManhua","domain":"https://readmanhua.net","database":null,"search":{"anime":null,"manga":"https://readmanhua.net/?s={searchtermPlus}&post_type=wp-manga"}},{"key":"FlameScans","name":"FlameScans","domain":"https://flamecomics.com","database":null,"search":{"anime":null,"manga":"https://flamecomics.com/?s={searchtermPlus}"}},{"key":"ImmortalUpdates","name":"ImmortalUpdates","domain":"https://immortalupdates.com","database":null,"search":{"anime":null,"manga":"https://immortalupdates.com/?s={searchtermPlus}&post_type=wp-manga"}},{"key":"Zoro","name":"HiAnime","domain":"https://hianime.to","database":"Zoro","search":{"anime":"https://hianime.to/search?keyword={searchtermPlus}","manga":null}},{"key":"Kitsune","name":"Kitsune","domain":"https://beta.kitsune.tv","database":null,"search":{"anime":"https://kitsune.tv/shows?q={searchterm}","manga":null}},{"key":"LHTranslation","name":"LHTranslation","domain":"https://lhtranslation.net","database":null,"search":{"anime":null,"manga":"https://lhtranslation.net/?s={searchtermPlus}&post_type=wp-manga"}},{"key":"MangasOrigines","name":"MangasOrigines","domain":"https://mangas-origines.fr/","database":null,"search":{"anime":null,"manga":"https://mangas-origines.fr/?s={searchtermPlus}&post_type=wp-manga"}},{"key":"BlueSolo","name":"BlueSolo","domain":"https://www.bluesolo.org","database":null,"search":{"anime":null,"manga":"home"}},{"key":"DisasterScans","name":"DisasterScans","domain":"https://disasterscans.com","database":null,"search":{"anime":null,"manga":"https://disasterscans.com/?s={searchtermPlus}&post_type=wp-manga"}},{"key":"DynastyScans","name":"DynastyScans","domain":"https://dynasty-scans.com","database":null,"search":{"anime":null,"manga":"https://dynasty-scans.com/search?q={searchtermPlus}"}},{"key":"Aniworld","name":"Aniworld","domain":"https://aniworld.to","database":null,"search":{"anime":"https://aniworld.to/search?q={searchterm}","manga":null}},{"key":"BetterAnime","name":"BetterAnime","domain":"https://betteranime.net","database":null,"search":{"anime":"https://betteranime.net/pesquisa?titulo={searchtermPlus}","manga":null}},{"key":"BilibiliComics","name":"BilibiliComics","domain":"https://manga.bilibili.com","database":null,"search":{"anime":null,"manga":"https://manga.bilibili.com/search?keyword={searchterm( )[noLowercase]}"}},{"key":"MangaReader","name":"MangaReader","domain":"https://mangareader.to","database":"MangaReader","search":{"anime":null,"manga":"https://mangareader.to/search?keyword={searchtermPlus}"}},{"key":"AnimeOnsen","name":"AnimeOnsen","domain":"https://animeonsen.xyz","database":null,"search":{"anime":"https://www.animeonsen.xyz/search/{searchterm}","manga":null}},{"key":"Animetoast","name":"Animetoast","domain":"https://www.animetoast.cc","database":null,"search":{"anime":"https://www.animetoast.cc/?s={searchterm}","manga":null}},{"key":"LuminousScans","name":"LuminousScans","domain":"https://luminous-scans.com","database":null,"search":{"anime":null,"manga":"https://luminous-scans.com/?s={searchtermPlus}"}},{"key":"Animeworld","name":"Animeworld","domain":"https://www.animeworld.tv","database":null,"search":{"anime":"home","manga":null}},{"key":"MangaBuddy","name":"MangaBuddy","domain":"https://mangabuddy.com","database":null,"search":{"anime":null,"manga":"https://mangabuddy.com/search?q={searchtermPlus}"}},{"key":"VoidScans","name":"VoidScans","domain":"https://hivetoon.com/","database":null,"search":{"anime":null,"manga":"https://hivetoon.com/?s={searchtermPlus}"}},{"key":"ToonAnime","name":"ToonAnime","domain":"https://vvww.toonanime.cc","database":null,"search":{"anime":"https://vvww.toonanime.cc/?story={searchtermPlus}&do=search&subaction=search","manga":null}},{"key":"ADKami","name":"ADKami","domain":"https://www.adkami.com/","database":null,"search":{"anime":"https://www.adkami.com/video?search={searchtermPlus}","manga":null}},{"key":"Kaguya","name":"Kaguya","domain":"https://kaguya.app","database":null,"search":{"anime":"https://kaguya.app/browse?keyword={searchtermPlus}","manga":null}},{"key":"Hdrezka","name":"Hdrezka","domain":"https://hdrezka.ag","database":null,"search":{"anime":"https://hdrezka.ag/search/?do=search&subaction=search&q={searchterm}","manga":null}},{"key":"SovetRomantica","name":"SovetRomantica","domain":"https://sovetromantica.com","database":null,"search":{"anime":"https://sovetromantica.com/anime?query={searchterm}","manga":null}},{"key":"ADN","name":"ADN","domain":"https://animationdigitalnetwork.com","database":null,"search":{"anime":"https://animationdigitalnetwork.fr/video?search={searchterm}","manga":null}},{"key":"Aniyan","name":"Aniyan","domain":"https://aniyan.net","database":"Aniyan","search":{"anime":"https://aniyan.net/?s={searchtermPlus}","manga":null}},{"key":"Docchi","name":"Docchi","domain":"https://docchi.pl","database":null,"search":{"anime":"home","manga":null}},{"key":"FRAnime","name":"FRAnime","domain":"https://franime.fr","database":null,"search":{"anime":"https://franime.fr/recherche?search={searchtermPlus}","manga":null}},{"key":"FMTeam","name":"FMTeam","domain":"https://fmteam.fr","database":null,"search":{"anime":null,"manga":"home"}},{"key":"Animelon","name":"Animelon","domain":"https://www.animelon.com","database":null,"search":{"anime":"https://www.animelon.com/search?searchTerm={searchTerm}","manga":null}},{"key":"AnimeSama","name":"AnimeSama","domain":"https://anime-sama.fr","database":null,"search":{"anime":"https://anime-sama.fr/catalogue/","manga":null}},{"key":"MangaFire","name":"MangaFire","domain":"https://mangafire.to","database":"MangaFire","search":{"anime":null,"manga":"https://mangafire.to/filter?keyword={searchtermPlus}"}},{"key":"projectsuki","name":"projectsuki","domain":"https://projectsuki.com","database":null,"search":{"anime":null,"manga":"https://projectsuki.com/search?q={searchtermPlus}"}},{"key":"AnimeBuff","name":"AnimeBuff","domain":"https://animebuff.ru","database":null,"search":{"anime":"https://animebuff.ru/search?q={searchtermPlus}","manga":null}},{"key":"AnimeOnegai","name":"AnimeOnegai","domain":"https://www.animeonegai.com","database":null,"search":{"anime":"https://www.animeonegai.com/es/search?q={searchterm}","manga":null}},{"key":"AnimeKO","name":"AnimeKO","domain":"https://animeko.co","database":null,"search":{"anime":"https://animeko.co/anime?search={searchtermPlus}","manga":null}},{"key":"AnimeGO","name":"AnimeGO","domain":"https://animego.org","database":null,"search":{"anime":"https://animego.org/search/all?q={searchterm}","manga":null}},{"key":"Animeflix","name":"Animeflix","domain":"https://animeflix.gg","database":null,"search":{"anime":"https://animeflix.gg/search/{searchterm}","manga":null}},{"key":"LuciferDonghua","name":"Lucifer Donghua","domain":"https://luciferdonghua.in","database":null,"search":{"anime":"https://luciferdonghua.in/?s={searchterm}","manga":null}},{"key":"NeoxScans","name":"NeoxScans","domain":"https://neoxscans.com/","database":null,"search":{"anime":null,"manga":"https://neoxscans.com/?post_type=wp-manga&s={searchtermPlus}"}},{"key":"Anix","name":"Anix","domain":"https://anix.to","database":null,"search":{"anime":"https://anix.to/filter?keyword={searchtermPlus}","manga":null}},{"key":"HinataSoul","name":"HinataSoul","domain":"https://hinatasoul.com","database":null,"search":{"anime":"https://www.hinatasoul.com/busca?busca={searchtermPlus}","manga":null}},{"key":"OgladajAnime","name":"OgladajAnime","domain":"https://ogladajanime.pl","database":null,"search":{"anime":"https://ogladajanime.pl/search/name/{searchtermPlus}","manga":null}},{"key":"hachi","name":"hachi","domain":"https://hachi.moe","database":null,"search":{"anime":null,"manga":"https://hachi.moe/search?query={searchterm}"}},{"key":"WitAnime","name":"WitAnime","domain":"https://witanime.pics","database":null,"search":{"anime":"https://witanime.pics/?search_param=animes&s={searchtermPlus}","manga":null}},{"key":"Suwayomi","name":"Suwayomi","domain":"https://suwayomi-webui-preview.github.io/","database":null,"search":{"anime":null,"manga":"https://suwayomi-webui-preview.github.io/sources/all/search/?query={searchtermPlus}"}},{"key":"ManhuaUS","name":"ManhuaUS","domain":"https://manhuaus.com","database":null,"search":{"anime":null,"manga":"https://manhuaus.com/?s={searchterm}&post_type=wp-manga&op=&author=&artist=&release=&adult="}},{"key":"Taiyo","name":"Taiyo","domain":"https://taiyo.moe","database":null,"search":{"anime":null,"manga":"home"}},{"key":"AnimesOnline","name":"Animes Online","domain":"https://animesonline.in","database":null,"search":{"anime":"https://www.animesonline.in/busca?s={searchtermPlus}","manga":null}},{"key":"Miruro","name":"Miruro","domain":"https://www.miruro.tv","database":null,"search":{"anime":"https://www.miruro.tv/search?query={searchterm}&sort=POPULARITY_DESC","manga":null}},{"key":"Latanime","name":"Latanime","domain":"https://latanime.org","database":null,"search":{"anime":"https://latanime.org/buscar?q={searchtermPlus}","manga":null}},{"key":"MangaRead","name":"MangaRead","domain":"https://www.mangaread.org","database":null,"search":{"anime":null,"manga":"https://www.mangaread.org/?s={searchtermPlus}&post_type=wp-manga"}},{"key":"Bakashi","name":"Bakashi","domain":"https://bakashi.tv","database":null,"search":{"anime":"https://bakashi.tv/?s={searchtermPlus}","manga":null}},{"key":"TempleScan","name":"TempleScan","domain":"https://templescan.net","database":null,"search":{"anime":null,"manga":"home"}}]')}},t={};function n(s){var i=t[s];if(void 0!==i)return i.exports;var a=t[s]={exports:{}};return e[s].call(a.exports,a,a.exports,n),a.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";var e=n(13647);function t(t=""){const n=e.settings.get("syncMode");return"SIMKL"!==n||"manga"!==t&&-1===t.indexOf("/manga/")?n:e.settings.get("syncModeSimkl")}var s=n(78584);let i;if(function(){try{return localStorage.getItem("x"),!0}catch(e){return s.info("Local storage is not available",e),!1}}())i=localStorage;else{let e={};i={getItem:t=>t in e?e[t]:null,setItem(t,n){e[t]=n},removeItem(t){t in e&&delete e[t]},clear(){e={}}}}const a=i;var r,o,l,c=n(13647);class u{constructor(e,t,n=!0,s=0){return this.key=e,this.ttl=t,this.localStorage=n,this.refetchTtl=s,this}containsValue(e){return null!=e}valueValid(e,t){return!(!e||!e.timestamp)&&(new Date).getTime()<e.timestamp+t}ttlValid(e){return this.valueValid(e,this.ttl)}refetchTtlValid(e){return this.valueValid(e,this.refetchTtl)}async hasValue(){const e=await this.getStorage();return!(!this.containsValue(e)||!this.ttlValid(e))}async hasValueAndIsNotEmpty(){const e=await this.getStorage();return!!(this.containsValue(e)&&void 0!==e.data&&null!==e.data&&Object.keys(e.data).length&&this.ttlValid(e))}async fullState(){const e=await this.getStorage(),t=this.containsValue(e)&&this.refetchTtlValid(e),n=this.ttlValid(e);return{value:e,hasValue:t,isValid:n,refetch:t&&!n}}async getValue(){return(await this.getStorage()).data}async setValue(e){const t={data:e,timestamp:(new Date).getTime()};return this.localStorage?a.setItem(this.key,JSON.stringify(t)):c.storage.set(this.key,t)}async clearValue(){return this.localStorage?a.removeItem(this.key):c.storage.remove(this.key)}async getStorage(){return this.localStorage?JSON.parse(a.getItem(this.key)):c.storage.get(this.key)}}(o=r||(r={}))[o.NoState=0]="NoState",o[o.Watching=1]="Watching",o[o.Completed=2]="Completed",o[o.Onhold=3]="Onhold",o[o.Dropped=4]="Dropped",o[o.PlanToWatch=6]="PlanToWatch",o[o.All=7]="All",o[o.Rewatching=23]="Rewatching",function(e){e[e.NoScore=0]="NoScore",e[e.R1=1]="R1",e[e.R2=2]="R2",e[e.R3=3]="R3",e[e.R4=4]="R4",e[e.R5=5]="R5",e[e.R6=6]="R6",e[e.R7=7]="R7",e[e.R8=8]="R8",e[e.R9=9]="R9",e[e.R10=10]="R10"}(l||(l={}));var h=n(13647),p=n(26017),m=n(78584);async function d(e,t){if(!t)return{};const n=await h.request.xhr("GET",`https://api.malsync.moe/nc/mal/${e}/${t}/pr`);return JSON.parse(n.responseText)}var g=n(13647);function f(e,t=!0){if(!e)return"";const n=Date.now();let s,i;if(n>e?(i=!1,s=n-e):(i=!0,s=e-n),s<3e4)return g.storage.lang("bookmarksItem_now");let a=function(e){let t="";return 1===e.y?t+=` ${e.y} ${g.storage.lang("bookmarksItem_Year")}`:e.y>1&&(t+=` ${e.y} ${g.storage.lang("bookmarksItem_Years")}`),1===e.d?t+=` ${e.d} ${g.storage.lang("bookmarksItem_Day")}`:e.d>1&&(t+=` ${e.d} ${g.storage.lang("bookmarksItem_Days")}`),1===e.h?t+=` ${e.h} ${g.storage.lang("bookmarksItem_Hour")}`:e.h>1&&(t+=` ${e.h} ${g.storage.lang("bookmarksItem_Hours")}`),1===e.m?t+=` ${e.m} ${g.storage.lang("bookmarksItem_min")}`:e.m>1&&(t+=` ${e.m} ${g.storage.lang("bookmarksItem_mins")}`),1===e.s?t+=` ${e.s} ${g.storage.lang("bookmarksItem_sec")}`:e.s>1&&(t+=` ${e.s} ${g.storage.lang("bookmarksItem_secs")}`),t.trim()}((r=function(e){let t,n,s,i;i=Math.floor(e/1e3),s=Math.floor(i/60),i%=60,n=Math.floor(s/60),s%=60,t=Math.floor(n/24),n%=24;const a=Math.floor(t/365);return t%=365,{y:a,d:t,h:n,m:s,s:i}}(s)).y>1?r.d>182?{y:r.y+1,d:0,h:0,m:0,s:0}:{y:r.y,d:0,h:0,m:0,s:0}:r.y?{y:r.y,d:r.d,h:0,m:0,s:0}:r.d>3?r.h>11?{y:0,d:r.d+1,h:0,m:0,s:0}:{y:0,d:r.d,h:0,m:0,s:0}:r.d?{y:0,d:r.d,h:r.h,m:0,s:0}:r.h>5?r.m>29?{y:0,d:0,h:r.h+1,m:0,s:0}:{y:0,d:0,h:r.h,m:0,s:0}:r.h?{y:0,d:0,h:r.h,m:r.m,s:0}:r.m>14?{y:0,d:0,h:0,m:r.m,s:0}:{y:0,d:0,h:0,m:r.m,s:r.s});var r;return!i&&t&&(a=g.storage.lang("bookmarksItem_ago",[a])),a}var y=n(78584),v=n(13647);class b{constructor(e,t){return this.cacheKey=e,this.type=t,this.releaseItem=void 0,this.logger=y.m("progress").m(e.toString()),this}async initReleaseProgress(e){e&&await async function(e,t,n="default",s=m.m("release")){if(n||(n="default"),(s=s.m(e.uid.toString())).log(e.title,e.cacheKey,e.apiCacheKey,`Mode: ${n}`),!e.apiCacheKey)return void s.log("No Api Cache Id");if(!h.settings.get("epPredictions"))return void s.log("epPredictions disabled");const i=await h.storage.get(`release/${t}/${e.cacheKey}`);s.m("Load").log(i);let a,r=!1;if(i&&i.mode&&i.mode!==n&&(r=!0),i&&i.timestamp&&Date.now()-i.timestamp<12e4&&!r)return void s.log("Up to date");if(i&&i.finished&&i.timestamp&&Date.now()-i.timestamp<6048e5&&!r)return void s.log("Fininshed");if(i&&!i.value&&i.timestamp&&Date.now()-i.timestamp<864e5&&!r)return void s.log("Nulled");r&&s.log("Update forced"),"off"===n&&(s.log("Disabled"),e.xhr=[]),void 0!==e.xhr?a=e.xhr:(a=await d(t,e.apiCacheKey),await p.wait(500)),s.log(a);const o=function(e,t,n){const s={};if(!e.length)return null;let i;if("default"===t?(s.mainId="anime"===n?h.settings.get("progressIntervalDefaultAnime"):h.settings.get("progressIntervalDefaultManga"),s.fallback="en/sub"):s.mainId=t,s.fallbackPrediction="jp/dub",s.mainId){const t=e.find((e=>e.id===s.mainId));t&&(i=t)}if(s.fallback&&!i){const t=e.find((e=>e.id===s.fallback));t&&(i=t)}if(s.fallbackPrediction&&i&&!i.predicition&&i.lastEp&&i.lastEp.timestamp){const t=e.find((e=>e.id===s.fallbackPrediction)),n=i.lastEp.timestamp+6048e5;n&&t&&t.predicition&&(i.lastEp.total===t.lastEp.total?Math.abs(n-t.predicition.timestamp)<108e6&&(i.predicition={timestamp:n,probability:"medium"}):t.lastEp.total&&i.lastEp.total===t.lastEp.total-1&&Math.abs(n-(t.predicition.timestamp-6048e5))<108e6&&(i.predicition={timestamp:n,probability:"medium"}))}if(s.fallbackPrediction&&!i){const t=e.find((e=>e.id===s.fallbackPrediction));t&&t.lastEp&&t.predicition&&0===t.lastEp.total&&(i=t,i.predicition.probability="medium")}return i||null}(a,n,t);o||s.log("No value for the selected mode");let l=!1;o&&o.state&&"complete"===o.state&&(l=!0),s.m("Save").log(o),i&&i.value&&async function(e,t,n,s){try{if("anime"===s&&!h.settings.get("progressNotificationsAnime")||"manga"===s&&!h.settings.get("progressNotificationsManga"))return;if(e&&n&&n&&t.lastEp&&void 0!==t.lastEp.total&&n.lastEp&&n.lastEp.total&&t.lang===n.lang&&t.type===n.type&&t.lastEp.total<n.lastEp.total&&e.watchedEp+1===n.lastEp.total){let t;t=e.single?{title:e.title,text:h.storage.lang(`syncPage_malObj_nextEp_${s}`,[n.lastEp.total]),sticky:h.settings.get("notificationsSticky"),image:await e.single.getImage(),url:e.single.getStreamingUrl()?e.single.getStreamingUrl():e.single.getUrl()}:{title:e.title,text:h.storage.lang(`syncPage_malObj_nextEp_${s}`,[n.lastEp.total]),sticky:h.settings.get("notificationsSticky"),image:e.image,url:e.options&&e.options.u?e.options.u:e.url},h.request.notification(t)}}catch(e){m.error("Could not check notification Progress",e)}}(e,i.value,o,t),await h.storage.set(`release/${t}/${e.cacheKey}`,{timestamp:Date.now(),value:o,mode:n,finished:l})}(e,this.type,e.progressMode);const t=await v.storage.get(`release/${this.type}/${this.cacheKey}`);this.logger.m("Init Release").log(t),t&&(function(e){if(e&&e.timestamp){const t=(new Date).getTime()-e.timestamp;if(e.finished&&t<6048e5)return!1;if(!e.value&&t<864e5)return!1;if(t<864e5)return!1}return!0}(t)?this.logger.log("Too old"):this.releaseItem=t)}getProgressCurrentEpisode(){const e=this.releaseItem;return e&&e.value&&e.value.lastEp&&e.value.lastEp.total?e.value.lastEp.total:null}isProgressFinished(){const e=this.releaseItem;return!(!e||!e.finished)}getProgressPrediction(){const e=this.releaseItem;return e&&e.value&&e.value.predicition&&e.value.predicition.timestamp?e.value.predicition.timestamp:null}getProgressLastTimestamp(){const e=this.releaseItem;return e&&e.value&&e.value.lastEp&&e.value.lastEp.timestamp?e.value.lastEp.timestamp:null}async init(e=!1){return await Promise.all([this.initReleaseProgress(e)]),this}getCurrentEpisode(){return v.settings.get("epPredictions")?this.getProgressCurrentEpisode():null}isFinished(){return this.isProgressFinished()}isAiring(){return!this.isFinished()}getPredictionTimestamp(){return!this.getProgressPrediction()||(new Date).getTime()>this.getProgressPrediction()?NaN:this.getProgressPrediction()}getPrediction(){return f(this.getPredictionTimestamp())}getPredictionText(){const e=this.getPrediction();return e?v.storage.lang(`prediction_Episode_${this.type}`,[e]):""}getLastTimestamp(){return this.getProgressLastTimestamp()}getLast(e=!0){return f(this.getLastTimestamp(),e)}getLastText(){const e=this.getLast(!1);return e?v.storage.lang(`prediction_Last_${this.type}`,[e]):""}getAuto(){const e=this.getPrediction();if(e)return e;return this.getLast()||""}getAutoText(){const e=this.getPredictionText();if(e)return e;return this.getLastText()||""}getColor(){return"#f57c00"}getBars(e,t){const n=this.getCurrentEpisode(),s={totalWidth:100,epWidth:0,predWidth:0};if(!t)if(s.totalWidth=0,e&&(!n||e>=n))t=Math.ceil(1.2*e);else{if(!n||e&&!(e<n))return s;t=Math.ceil(1.2*n)}return e&&(s.epWidth=e/t*100,s.epWidth>100&&(s.epWidth=100)),n&&(s.predWidth=n/t*100,s.predWidth>100&&(s.predWidth=100)),s}}var _=n(53011),w=n(78584),E=n(13647);const S=Math.floor(1e9*Math.random()),k=new _.EventEmitter2({wildcard:!0});function I(e,...t){w.m("Global").m("Emit").debug(e,...t),k.emit(`${e}`,...t),void 0!==E&&E&&"webextension"===E.type&&chrome.runtime.sendMessage({name:"emitter",item:{event:e,params:t,id:S}})}void 0!==E&&E&&"webextension"===E.type&&chrome.runtime.onMessage.addListener(((e,t,n)=>{e.name&&"emitter"===e.name&&(w.m("Global").m("Event").debug(e.item.id,e.item.event,e.item.params),e.item.id!==S&&k.emit(e.item.event,...e.item.params))})),Error;class x extends Error{constructor(e){super(e),this.name="SafeError"}}Error,Error;var T=n(13647);class L extends Error{constructor(e){super(e),this.name="NotAutenticatedError"}}class N extends Error{constructor(e){super(e),this.name="UrlNotSupportedError"}}class O extends Error{constructor(e){super(e),this.name="ServerOfflineError"}}class C extends Error{constructor(e){super(e),this.name="NotFoundError"}}class A extends Error{constructor(e){super(e),this.name="UnexpectedResponseError"}}function P(e){try{return JSON.parse(e)}catch(e){throw new A(e.message)}}var R=n(13647);const M={ui:{module:"dropdown"},getOptions:()=>[{value:0,label:R.storage.lang("UI_Score_Not_Rated")},{value:100,label:R.storage.lang("UI_Score_Masterpiece")},{value:90,label:R.storage.lang("UI_Score_Great")},{value:80,label:R.storage.lang("UI_Score_VeryGood")},{value:70,label:R.storage.lang("UI_Score_Good")},{value:60,label:R.storage.lang("UI_Score_Fine")},{value:50,label:R.storage.lang("UI_Score_Average")},{value:40,label:R.storage.lang("UI_Score_Bad")},{value:30,label:R.storage.lang("UI_Score_VeryBad")},{value:20,label:R.storage.lang("UI_Score_Horrible")},{value:10,label:R.storage.lang("UI_Score_Appalling")}],valueToOptionValue:e=>e?e<10?10:10*Math.round(e/10):0,optionValueToValue:e=>e?Number(e):0};var U=n(78584),j=n(13647),D=n(26017),F=n(7263);Object.seal(k);class V{constructor(e){return this.url=e,this.type=null,this.askCompleted=!1,this.rewatchingSupport=!0,this.ids={mal:NaN,ani:NaN,kitsu:{id:NaN,slug:""},simkl:NaN},this.options=null,this.progress=!1,this.updateProgress=!1,this._onList=!1,this._authenticated=!1,this.handleUrl(e),this.logger=U.m("[S]","#348fff"),this}getType(){return this.type}getUrl(){return this.url}supportsRewatching(){return this.rewatchingSupport}getApiCacheKey(){return this.getKey(["ANILIST"])}getRulesCacheKey(){return this.getKey(["ANILIST","KITSU"],!1)}setStatus(e){return e=Number(e),this._setStatus(e),this}getStatus(){return this.isOnList()?this._getStatus():r.NoState}getScoreMode(){return M}setScore(e){return(e=parseInt(`${e}`))||(e=0),this._setScore(e),this}getScore(){return this._getScore()||0}setAbsoluteScore(e){return e=parseInt(`${e}`),this._setAbsoluteScore(e),this}getAbsoluteScore(){return this._getAbsoluteScore()||0}setEpisode(e){return e=parseInt(`${e}`),this.getTotalEpisodes()&&e>this.getTotalEpisodes()&&(e=this.getTotalEpisodes()),this._setEpisode(e),this}getEpisode(){return this._getEpisode()}setVolume(e){return this._setVolume(e),this}getVolume(){return this._getVolume()}setStreamingUrl(e){return this.options&&(this.options.u=e),this}getStreamingUrl(){if(this.options&&this.options.u)return this.options.u}cleanTags(){this.options=null}async initProgress(){const e=await d(this.getType(),this.getApiCacheKey());return new b(this.getCacheKey(),this.getType()).init({uid:this.getCacheKey(),apiCacheKey:this.getApiCacheKey(),title:this.getTitle(),cacheKey:this.getCacheKey(),progressMode:this.getProgressMode(),watchedEp:this.getEpisode(),single:this,xhr:e}).then((t=>{this.updateProgress=!1,this.progress=t,this.progressXhr=e}))}getProgress(){return!!this.progress&&this.progress}getProgressFormated(){const e=[],t=new Intl.DisplayNames("en",{type:"language"});return U.log(this.progressXhr),this.progressXhr&&Object.keys(this.progressXhr).length&&this.progressXhr.forEach((n=>{e.push({type:n.type,key:n.id,state:n.state,label:t.of(n.lang.replace(/^jp$/,"ja"))||n.lang,dropped:"dropped"===n.state||"discontinued"===n.state,episode:n.lastEp&&n.lastEp.total?n.lastEp.total:0,lastEp:n.lastEp,predicition:n.prediction})})),e}getProgressOptions(){return this.getProgressFormated().filter((e=>"complete"!==e.state))}getProgressCompleted(){return this.getProgressFormated().filter((e=>"complete"===e.state))}getProgressMode(){return this.options&&this.options.p?this.options.p:""}setProgressMode(e){this.options&&(this.options.p=e,this.updateProgress=!0),j.settings.get("malTags")||D.setEntrySettings(this.type,this.getCacheKey(),this.options,this._getTags()).then((()=>this.initProgress()))}getProgressKey(){let e=this.getProgressMode();if(e||(e="anime"===this.getType()?j.settings.get("progressIntervalDefaultAnime"):j.settings.get("progressIntervalDefaultManga")),!e)return null;const t=/^([^/]*)\/(.*)$/.exec(e);return t?{key:e,lang:t[1],type:t[2]}:null}getPageRelations(){const e=this.shortName,t=[];return this.ids.mal&&"MAL"!==e&&t.push({name:"MAL",icon:"https://cdn.myanimelist.net/images/favicon.ico",link:`https://myanimelist.net/${this.type}/${this.ids.mal}`}),this.ids.ani&&"AniList"!==e&&t.push({name:"AniList",icon:"https://anilist.co/img/icons/favicon-32x32.png",link:`https://anilist.co/${this.type}/${this.ids.ani}`}),this.ids.kitsu.id&&"Kitsu"!==e&&t.push({name:"Kitsu",icon:"https://kitsu.app/favicon-32x32-3e0ecb6fc5a6ae681e65dcbc2bdf1f17.png",link:`https://kitsu.app/${this.type}/${this.ids.kitsu.id}`}),this.ids.simkl&&"Simkl"!==e&&t.push({name:"Simkl",icon:"https://eu.simkl.in/img_favicon/v2/favicon-32x32.png",link:`https://simkl.com/${this.type}/${this.ids.simkl}`}),t}fillRelations(){return Promise.resolve()}update(){return this.logger.log("[SINGLE]","Update info",this.ids),this.lastError=null,this._update().catch((e=>{throw this.lastError=e,e})).then((()=>(this.persistanceState=this.getStateEl(),D.getEntrySettings(this.type,this.getCacheKey(),this._getTags())))).then((e=>{this.options=e,this.registerEvent(),this.emitUpdate("state")}))}async sync(){return this.logger.log("[SINGLE]","Sync",this.ids),this.lastError=null,this._setTags(await D.setEntrySettings(this.type,this.getCacheKey(),this.options,this._getTags())),this._sync().catch((e=>{throw this.lastError=e,e})).then((()=>{this.undoState=this.persistanceState,this.updateProgress&&this.initProgress(),this._onList=!0,this.emitUpdate()}))}emitUpdate(e="update"){I(`${e}.${this.getCacheKey()}`,{id:this.getPageId(),type:this.getType(),cacheKey:this.getCacheKey(),state:this.getStateEl(),meta:{title:this.getTitle(),image:this.getImage(),malId:this.getMalId(),totalEp:this.getTotalEpisodes(),url:this.getUrl()}})}async delete(){return this._delete().then((()=>{this._onList=!1,I(`delete.${this.getCacheKey()}`,{id:this.getPageId(),type:this.getType(),cacheKey:this.getCacheKey()})}))}registerEvent(){this.globalUpdateEvent||(this.globalUpdateEvent=k.on(`update.${this.getCacheKey()}`,(e=>this.updateEvent(e))))}updateEvent(e){this.isDirty()?this.logger.log("Ignore event"):e&&e.state&&(this.setStateEl(e.state),this.persistanceState=this.getStateEl(),k.emit("syncPage_fillUi"))}isDirty(){return JSON.stringify(this.persistanceState)!==JSON.stringify(this.getStateEl())||this.updateProgress}undo(){if(this.logger.log("[SINGLE]","Undo",this.undoState),!this.undoState)throw new x("No undo state found");if(!this.undoState.onList){if(void 0===this.delete)throw new Error("Deleting an entry is not supported");return this.delete().then((()=>{this.setStateEl(this.undoState),this.undoState=null}))}return this.setStateEl(this.undoState),this.sync().then((()=>{this.undoState=null}))}getTitle(e=!1){return this._getTitle(e)}getTotalEpisodes(){let e=this._getTotalEpisodes();return e||(e=0),e}getTotalVolumes(){return this._getTotalVolumes()}isOnList(){return this._onList}isAuthenticated(){return this._authenticated}getDisplayUrl(){return this._getDisplayUrl()}getMalUrl(){return Number.isNaN(this.ids.mal)?null:`https://myanimelist.net/${this.getType()}/${this.ids.mal}`}getMalId(){return Number.isNaN(this.ids.mal)?null:this.ids.mal}getIds(){return this.ids}getImage(){return this._getImage()}getRating(){return this._getRating().then((e=>e||"N/A"))}setResumeWatching(e,t){return D.setResumeWaching(e,t,this.type,this.getCacheKey())}getResumeWatching(){return this.options&&this.options.r?this.options.r:null}setContinueWatching(e,t){return D.setContinueWaching(e,t,this.type,this.getCacheKey())}getContinueWatching(){return this.options&&this.options.c?this.options.c:null}increaseRewatchCount(){}getStateEl(){return{onList:this.isOnList(),episode:this.getEpisode(),volume:this.getVolume(),status:this.getStatus(),score:this.getScore(),absoluteScore:this.getAbsoluteScore()}}setStateEl(e){this._onList=e.onList,this.setEpisode(e.episode),this.setVolume(e.volume),this.setStatus(e.status),this.setScore(e.score),e.absoluteScore&&this.setAbsoluteScore(e.absoluteScore)}getStateDiff(){const e=this.getStateEl();if(e&&this.undoState){const t={};for(const n in e)e[n]!==this.undoState[n]&&(t[n]=e[n]);return t}}async lifeCycleHook(e){this.askCompleted&&("afterCheckSync"===e&&j.settings.get("askBefore")||"beforeSync"===e&&!j.settings.get("askBefore"))&&(this.askCompleted=!1,this.getStatus()===r.Rewatching?await this.finishRewatchingMessage():await this.finishWatchingMessage())}async checkSync(e,t){const n=this.getEpisode(),s=this.getStatus(),i=this.getVolume();return s===r.Completed?1===e&&this.startRewatchingMessage():!(n>=e&&!(void 0!==t&&(i||t>1||!e)&&t>i))&&(e&&e===this.getTotalEpisodes()?(this.askCompleted=!0,!0):s===r.Watching||s===r.Rewatching||this.startWatchingMessage())}async startWatchingMessage(){return D.flashConfirm(j.storage.lang(`syncPage_flashConfirm_start_${this.getType()}`),"add").then((e=>(e&&this.setStatus(r.Watching),e)))}async finishWatchingMessage(){const e=this.getScoreCheckboxValue();let t='<div><select id="finish_score" style="margin-top:5px; color:white; background-color:#4e4e4e; border: none;">';return this.getScoreCheckbox().forEach((n=>{t+=`<option value="${n.value}" ${e===n.value?"selected":""}>${n.label}</option>`})),t+="</select></div>",D.flashConfirm(j.storage.lang("syncPage_flashConfirm_complete")+t,"complete").then((e=>(e&&(this.setStatus(r.Completed),Number(F.$("#finish_score").val())>0&&(this.logger.log(`finish_score: ${F.$("#finish_score :selected").val()}`),this.handleScoreCheckbox(F.$("#finish_score :selected").val()))),e)))}async startRewatchingMessage(){return D.flashConfirm(j.storage.lang(`syncPage_flashConfirm_rewatch_start_${this.getType()}`),"add").then((e=>(e&&this.setStatus(r.Rewatching),e)))}async finishRewatchingMessage(){return D.flashConfirm(j.storage.lang(`syncPage_flashConfirm_rewatch_finish_${this.getType()}`),"complete").then((e=>(e&&(this.setStatus(r.Completed),this.increaseRewatchCount()),e)))}getScoreCheckbox(){return this.getScoreMode().getOptions()}getScoreCheckboxValue(){return this.getScoreMode().valueToOptionValue(this.getAbsoluteScore())}handleScoreCheckbox(e){this.setAbsoluteScore(this.getScoreMode().optionValueToValue(e))}getDisplayScoreCheckbox(){const e=this.getScoreCheckboxValue(),t=this.getScoreCheckbox().filter((t=>t.value===e));return t.length?t[0].label:""}getStatusCheckbox(){const e=[{value:"1",label:j.storage.lang(`UI_Status_watching_${this.getType()}`)},{value:"2",label:j.storage.lang("UI_Status_Completed")},{value:"3",label:j.storage.lang("UI_Status_OnHold")},{value:"4",label:j.storage.lang("UI_Status_Dropped")},{value:"6",label:j.storage.lang(`UI_Status_planTo_${this.getType()}`)}];return this.rewatchingSupport&&e.push({value:"23",label:j.storage.lang(`UI_Status_Rewatching_${this.getType()}`)}),e}handleStatusCheckbox(e){this.setStatus(e)}getStatusCheckboxValue(){return this.getStatus()}getKey(e,t=!0){return t&&this.ids.mal?this.ids.mal:this.ids.ani&&e.includes("ANILIST")?`anilist:${this.ids.ani}`:this.ids.kitsu.id&&e.includes("KITSU")?`kitsu:${this.ids.kitsu.id}`:this.ids.simkl&&e.includes("SIMKL")?`simkl:${this.ids.simkl}`:this.ids.mal}getLastError(){return this.lastError}getLastErrorMessage(){return this.errorMessage(this.getLastError())}flashmError(e){D.flashm(this.errorMessage(e),{error:!0,type:"error"})}errorMessage(e){return function(e,t){return e instanceof L?T.storage.lang("Error_Authenticate",[t]):e instanceof O?"Server Offline":e instanceof N?`Incorrect url provided [${e.message}]`:e instanceof C?"Could not find this entry":e.message}(e,this.authenticationUrl)}}n(7263),n(26017),n(13647);var B,H,z=n(13647);async function G(e){let t="https://api.myanimelist.net/v2/"+e.path;e.fields&&e.fields.length&&(t+=t.includes("?")?"&":"?",t+=`fields=${e.fields.join(",")}`);const n={Authorization:`Bearer ${z.settings.get("malToken")}`,"Content-Type":"application/x-www-form-urlencoded"};let s="";if(e.dataObj){const t=[];for(const n in e.dataObj){const s=encodeURIComponent(n),i=encodeURIComponent(e.dataObj[n]);t.push(`${s}=${i}`)}s=t.join("&")}return z.request.xhr(e.type,{url:t,headers:n,data:s}).then((async t=>{if(t.status>499&&t.status<600||0===t.status)throw new O(`Server Offline status: ${t.status}`);let n;try{n=JSON.parse(t.responseText)}catch(e){if(W(t.responseText))throw new Error(z.storage.lang("Error_Blocked",["MyAnimeList"]));throw e}if(n&&n.error)switch(n.error){case"forbidden":case"invalid_token":if(await async function(e){const t=e.m("Refresh");t.log("Refresh Access Token");const n=z.settings.get("malRefresh");return!!n&&z.request.xhr("POST",{url:"https://myanimelist.net/v1/oauth2/token",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:`client_id=10093a3f9f0174b6b5577c40e9accdae&grant_type=refresh_token&refresh_token=${n}`}).then((e=>{try{return P(e.responseText)}catch(t){if(W(e.responseText))throw new Error(z.storage.lang("Error_Blocked",["MyAnimeList"]));throw t}})).then((e=>e&&e.refresh_token&&e.access_token?(z.settings.set("malToken",e.access_token),z.settings.set("malRefresh",e.refresh_token),!0):e&&e.error?(t.error(e.error,"|",e.message),z.settings.set("malRefresh",""),!1):(t.error("Something went wrong"),!1)))}(this.logger))return this.apiCall(e);throw new L(n.message??n.error);case"not_found":throw new C(n.message??n.error);case"invalid_content":throw new Error("This Entry is currently pending approval. It cant be saved to mal for now");default:throw new Error(n.message??n.error)}if(400===t.status)throw new Error("Invalid Parameters");return n}))}function W(e){return Boolean(e.includes("Request blocked")||e.includes("your IP has been banned"))}!function(e){e[e.watching=r.Watching]="watching",e[e.completed=r.Completed]="completed",e[e.on_hold=r.Onhold]="on_hold",e[e.dropped=r.Dropped]="dropped",e[e.plan_to_watch=r.PlanToWatch]="plan_to_watch"}(B||(B={})),function(e){e[e.reading=r.Watching]="reading",e[e.completed=r.Completed]="completed",e[e.on_hold=r.Onhold]="on_hold",e[e.dropped=r.Dropped]="dropped",e[e.plan_to_read=r.PlanToWatch]="plan_to_read"}(H||(H={}));var K=n(78584),q=n(13647);const X=K.m("anilist","#3db4f2");var Y;async function J(e,t,n=!0){if(n&&!q.settings.get("anilistToken"))throw new L("No token found");const s={"Content-Type":"application/json",Accept:"application/json"};return q.settings.get("anilistToken")&&(s.Authorization=`Bearer ${q.settings.get("anilistToken")}`),q.request.xhr("POST",{url:"https://graphql.anilist.co",headers:s,data:JSON.stringify({query:e,variables:t})}).then((s=>{if(s.status>499&&s.status<600||0===s.status)throw new O(`Server Offline status: ${s.status}`);if(403===s.status)throw new Error(q.storage.lang("Error_Blocked",["AniList"]));const i=P(s.responseText);if(void 0!==i.errors&&i.errors.length){X.error("[SINGLE]","Error",i.errors);const s=i.errors[0];switch(s.status){case 400:if("Invalid token"===s.message&&!n)return q.settings.set("anilistToken",null),J(e,t,n);if("validation"===s.message)throw new Error("Wrong request format");if(s.message.includes("invalid"))throw new Error("Wrong request format");throw new L(s.message);case 404:throw new C(s.message);default:throw new Error(s.message)}}return i}))}function Z(e){return!e||e.endsWith("/default.jpg")?"":e}!function(e){e[e.CURRENT=r.Watching]="CURRENT",e[e.PLANNING=r.PlanToWatch]="PLANNING",e[e.COMPLETED=r.Completed]="COMPLETED",e[e.DROPPED=r.Dropped]="DROPPED",e[e.PAUSED=r.Onhold]="PAUSED",e[e.REPEATING=r.Rewatching]="REPEATING"}(Y||(Y={}));var Q=n(26017),ee=n(78584),te=n(26017);class ne extends V{constructor(e){return super(e),this.url=e,this.displayUrl="",this.pending=!1,this.shortName="MAL",this.authenticationUrl="https://malsync.moe/mal/oauth",this.apiCall=G,this.logger=ee.m(this.shortName,"#2e51a2"),this}handleUrl(e){if(e.match(/myanimelist\.net\/(anime|manga)\/\d*/i))return this.type="anime"===te.urlPart(e,3)?"anime":"manga",void(this.ids.mal=Number(te.urlPart(e,4)));throw new N(e)}getCacheKey(){return this.ids.mal}getPageId(){return this.ids.mal}_getStatus(){let e;return e="manga"===this.type?parseInt(H[this.animeInfo.my_list_status.status]):parseInt(B[this.animeInfo.my_list_status.status]),this.getRewatching()&&2===e?23:e}_setStatus(e){23===e?(e=2,this.setRewatching(!0)):this.setRewatching(!1),"manga"!==this.type?this.animeInfo.my_list_status.status=B[e]:this.animeInfo.my_list_status.status=H[e]}increaseRewatchCount(){"manga"===this.type?this.animeInfo.my_list_status.num_times_reread++:this.animeInfo.my_list_status.num_times_rewatched++}_getScore(){return this.animeInfo.my_list_status.score}_setScore(e){this.animeInfo.my_list_status.score=e}_getAbsoluteScore(){return 10*this.getScore()}_setAbsoluteScore(e){e?e<10?this.setScore(1):this.setScore(Math.round(e/10)):this.setScore(0)}_getEpisode(){return"manga"===this.type?this.animeInfo.my_list_status.num_chapters_read:this.animeInfo.my_list_status.num_watched_episodes}_setEpisode(e){e||(e=0),"manga"!==this.type?this.animeInfo.my_list_status.num_watched_episodes=e:this.animeInfo.my_list_status.num_chapters_read=e}_getVolume(){return"manga"===this.type?this.animeInfo.my_list_status.num_volumes_read:0}_setVolume(e){"manga"===this.type&&(this.animeInfo.my_list_status.num_volumes_read=e)}_getTags(){return this.animeInfo.my_list_status.tags.length?this.animeInfo.my_list_status.tags.join(","):""}_setTags(e){e&&","!==e.trim()?this.animeInfo.my_list_status.tags=e.split(","):this.animeInfo.my_list_status.tags=[]}getRewatching(){return"manga"===this.type?this.animeInfo.my_list_status.is_rereading:this.animeInfo.my_list_status.is_rewatching}setRewatching(e){"manga"!==this.type?this.animeInfo.my_list_status.is_rewatching=e:this.animeInfo.my_list_status.is_rereading=e}_getTitle(){return this.animeInfo.title}_getTotalEpisodes(){return"manga"===this.type?this.animeInfo.num_chapters:this.animeInfo.num_episodes}_getTotalVolumes(){return"manga"===this.type?this.animeInfo.num_volumes:0}_getDisplayUrl(){return this.url}_getImage(){return this.animeInfo.main_picture?.medium??""}_getRating(){return Promise.resolve(this.animeInfo.mean)}async _update(){return this.apiCall({type:"GET",path:`${this.type}/${this.ids.mal}`,fields:["my_list_status{tags,is_rewatching,is_rereading,num_times_rewatched,num_times_reread,start_date,finish_date}","num_episodes","mean","num_chapters","num_volumes"]}).catch((e=>{throw e instanceof L&&(this._authenticated=!1),e})).then((e=>{this.logger.m("Api").log(e),this._authenticated=!0,this.animeInfo=e,this._onList=!0,this.animeInfo.my_list_status||(this._onList=!1,"manga"===this.type?this.animeInfo.my_list_status={is_rereading:!1,num_chapters_read:0,num_volumes_read:0,score:0,status:"plan_to_read",tags:[]}:this.animeInfo.my_list_status={is_rewatching:!1,num_watched_episodes:0,score:0,status:"plan_to_watch",tags:[]}),this.animeInfo.my_list_status&&void 0!==this.animeInfo.my_list_status.num_episodes_watched&&(this.animeInfo.my_list_status.num_watched_episodes=this.animeInfo.my_list_status.num_episodes_watched,delete this.animeInfo.my_list_status.num_episodes_watched)}))}async _sync(){void 0===this.animeInfo.my_list_status.start_date&&1===this._getStatus()&&this._getEpisode()>0&&(this.animeInfo.my_list_status.start_date=(0,Q.returnYYYYMMDD)()),void 0===this.animeInfo.my_list_status.finish_date&&2===this._getStatus()&&(this.animeInfo.my_list_status.finish_date=(0,Q.returnYYYYMMDD)(),void 0===this.animeInfo.my_list_status.start_date&&(this.animeInfo.my_list_status.start_date=(0,Q.returnYYYYMMDD)()));const e={};for(const t in this.animeInfo.my_list_status)switch(t){case"priority":case"num_watched_episodes":case"num_volumes_read":case"num_chapters_read":case"score":case"is_rewatching":case"is_rereading":case"num_times_rewatched":case"num_times_reread":case"rewatch_value":case"reread_value":case"tags":case"comments":case"status":case"start_date":case"finish_date":e[t]=this.animeInfo.my_list_status[t]}return this.logger.m("Sync").log(this.ids.mal,e),this.apiCall({type:"PUT",path:`${this.type}/${this.ids.mal}/my_list_status`,dataObj:e}).then((e=>{this.logger.m("Sync").log("res",e)}))}_delete(){return this.apiCall({type:"DELETE",path:`${this.type}/${this.ids.mal}/my_list_status`})}async fillRelations(){const e=new u(`fillRelations/${this.ids.mal}/${this.getType()}`,6048e5);return e.hasValueAndIsNotEmpty().then((t=>t?e.getValue().then((e=>{e&&e.da&&parseInt(e.da)&&(this.ids.ani=parseInt(e.da))})):function(e,t){const n={id:e,type:t.toUpperCase()};return q.request.xhr("POST",{url:"https://graphql.anilist.co",headers:{"Content-Type":"application/json",Accept:"application/json"},data:JSON.stringify({query:"\n  query ($id: Int, $type: MediaType) {\n    Media (idMal: $id, type: $type) {\n      id\n      idMal\n    }\n  }\n  ",variables:n})}).then((e=>{if(404===e.status)return NaN;const t=P(e.responseText);return K.log(t),t.data.Media.id}))}(this.ids.mal,this.getType()).then((t=>(t&&parseInt(t)&&(this.ids.ani=parseInt(t)),e.setValue({da:t}))))))}}const se=ne;var ie=n(13647);const ae={ui:{module:"input",pattern:"^([0-9]{1,2}|100)$"},getOptions(){const e=[{value:0,label:ie.storage.lang("UI_Score_Not_Rated")}];for(let t=1;t<101;t++)e.push({value:t,label:String(t)});return e},valueToOptionValue:e=>e?Number(e):0,optionValueToValue:e=>e?Number(e):0};var re=n(13647);const oe={ui:{module:"click",type:"smiley"},getOptions:()=>[{value:0,label:re.storage.lang("UI_Score_Not_Rated")},{value:85,label:""},{value:60,label:""},{value:35,label:""}],valueToOptionValue:e=>e?e>=73?85:e<=47?35:60:0,optionValueToValue:e=>e?Number(e):0};var le=n(13647);const ce={ui:{module:"click",type:"star"},getOptions:()=>[{value:0,label:le.storage.lang("UI_Score_Not_Rated")},{value:90,label:""},{value:70,label:""},{value:50,label:""},{value:30,label:""},{value:10,label:""}],valueToOptionValue:e=>e?e<20?10:e<40?30:e<60?50:e<80?70:90:0,optionValueToValue:e=>e?Number(e):0};var ue=n(13647);const he={ui:{module:"input",pattern:"^([0-9](\\.[0-9]?)?|10(.0)?)$"},getOptions(){const e=[{value:0,label:ue.storage.lang("UI_Score_Not_Rated")}];for(let t=1;t<101;t++)e.push({value:t/10,label:(t/10).toFixed(1)});return e},valueToOptionValue:e=>e?Number(e/10):0,optionValueToValue:e=>e?Number(10*e):0};var pe=n(78584),me=n(26017),de=n(13647);class ge extends V{constructor(e){return super(e),this.url=e,this.displayUrl="",this.shortName="AniList",this.authenticationUrl="https://anilist.co/api/v2/oauth/authorize?client_id=1487&response_type=token",this.logger=pe.m(this.shortName,"#3db4f2"),this}handleUrl(e){if(e.match(/anilist\.co\/(anime|manga)\/\d*/i))return this.type="anime"===me.urlPart(e,3)?"anime":"manga",void(this.ids.ani=Number(me.urlPart(e,4)));if(e.match(/myanimelist\.net\/(anime|manga)\/\d*/i))return this.type="anime"===me.urlPart(e,3)?"anime":"manga",void(this.ids.mal=Number(me.urlPart(e,4)));throw new N(e)}getCacheKey(){return this.getKey(["ANILIST"])}getPageId(){return this.ids.ani}_getStatus(){return parseInt(Y[this.animeInfo.mediaListEntry.status])}_setStatus(e){this.animeInfo.mediaListEntry.status=Y[e]}_getScore(){if(0===Number(this.animeInfo.mediaListEntry.score))return 0;const e=Math.round(Number(this.animeInfo.mediaListEntry.score)/10);return 0===e?1:e}_setScore(e){this.animeInfo.mediaListEntry.score=10*e}_getAbsoluteScore(){return Number(this.animeInfo.mediaListEntry.score)}_setAbsoluteScore(e){this.animeInfo.mediaListEntry.score=Number(e)}_getEpisode(){return this.animeInfo.mediaListEntry.progress}_setEpisode(e){this.animeInfo.mediaListEntry.progress=parseInt(`${e}`)}_getVolume(){return this.animeInfo.mediaListEntry.progressVolumes}_setVolume(e){this.animeInfo.mediaListEntry.progressVolumes=e}_getTags(){let e=this.animeInfo.mediaListEntry.notes;return null!==e&&"null"!==e||(e=""),e}_setTags(e){this.animeInfo.mediaListEntry.notes=e}_getTitle(){return this.animeInfo.title.userPreferred}_getTotalEpisodes(){const e=this.animeInfo.episodes?this.animeInfo.episodes:this.animeInfo.chapters;return null===e?0:e}_getTotalVolumes(){return this.animeInfo.volumes||0}_getDisplayUrl(){return""!==this.displayUrl&&null!==this.displayUrl?this.displayUrl:this.url}_getImage(){return Z(this.animeInfo.coverImage.large)}_getRating(){return Promise.resolve(this.animeInfo.averageScore)}async _update(){let e=this.ids.mal,t="idMal";Number.isNaN(this.ids.mal)&&(e=this.ids.ani,t="id");const n=`\n    query ($id: Int, $type: MediaType) {\n      Media (${t}: $id, type: $type) {\n        id\n        idMal\n        siteUrl\n        episodes\n        chapters\n        volumes\n        averageScore\n        coverImage{\n          large\n        }\n        title {\n          userPreferred\n        }\n        mediaListEntry {\n          id\n          status\n          progress\n          progressVolumes\n          score(format: POINT_100)\n          repeat\n          notes\n        }\n      }\n    }\n    `,s={id:e,type:this.type.toUpperCase()};return this._authenticated=!0,this.apiCall(n,s).catch((e=>{if(e instanceof L)return this._authenticated=!1,this.apiCall(n,s,!1);throw e})).then((e=>{if(this.logger.log("[SINGLE]","Data",e),this.animeInfo=e.data.Media,this.ids.ani=this.animeInfo.id,Number.isNaN(this.ids.mal)&&this.animeInfo.idMal&&(this.ids.mal=this.animeInfo.idMal),this.displayUrl=this.animeInfo.siteUrl,this._onList=!0,null===this.animeInfo.mediaListEntry&&(this._onList=!1,this.animeInfo.mediaListEntry={notes:"",progress:0,progressVolumes:0,repeat:0,score:0,status:"PLANNING"}),!this._authenticated)throw new L("Not Authenticated")}))}async _sync(){let e="\n      mutation ($mediaId: Int, $status: MediaListStatus, $progress: Int, $scoreRaw: Int, $notes: String) {\n        SaveMediaListEntry (mediaId: $mediaId, status: $status, progress: $progress, scoreRaw: $scoreRaw, notes: $notes) {\n          id\n          status\n          progress\n        }\n      }\n    ";const t={mediaId:this.ids.ani,status:this.animeInfo.mediaListEntry.status,progress:this.animeInfo.mediaListEntry.progress,scoreRaw:this.animeInfo.mediaListEntry.score,notes:this.animeInfo.mediaListEntry.notes,volumes:null};return"manga"===this.type&&(e="\n        mutation ($mediaId: Int, $status: MediaListStatus, $progress: Int, $scoreRaw: Int, $notes: String, $volumes: Int) {\n          SaveMediaListEntry (mediaId: $mediaId, status: $status, progress: $progress, scoreRaw: $scoreRaw, notes: $notes, progressVolumes: $volumes) {\n            id\n            status\n            progress\n            progressVolumes\n          }\n        }\n      ",t.volumes=this.animeInfo.mediaListEntry.progressVolumes),this.apiCall(e,t).then((e=>(e&&e.data&&e.data.SaveMediaListEntry&&e.data.SaveMediaListEntry.id&&(this.animeInfo.mediaListEntry.id=e.data.SaveMediaListEntry.id),e)))}apiCall(e,t,n=!0){return J(e,t,n)}getScoreMode(){switch(de.settings.get("anilistOptions").scoreFormat){case"POINT_100":return ae;case"POINT_3":return oe;case"POINT_5":return ce;case"POINT_10_DECIMAL":return he;default:return M}}_delete(){const e={mediaId:this.animeInfo.mediaListEntry.id};return this.apiCall("\n      mutation ($mediaId: Int) {\n        DeleteMediaListEntry(id: $mediaId) {\n          deleted\n        }\n      }\n    ",e)}}var fe=n(78584),ye=n(13647);const ve=fe.m("kitsu","#d65e43");function be(e,t=null){const n={current:1,planned:6,completed:2,dropped:4,on_hold:3};return null!==t?Object.keys(n).find((e=>n[e]===t)):n[e]}function _e(e,t){let n;switch(ye.settings.get("kitsuOptions").titleLanguagePreference){case"english":n=e.en;break;case"romanized":n=e.en_jp;break;default:n=t}if(void 0!==n&&n||(n=e.en),void 0!==n&&n||(n=e.en_jp),void 0!==n&&n||(n=e.ja_jp),void 0===n||!n){const t=Object.keys(e);if(!t.length)return"No Title";n=e[t[0]]}return n}function we(e,t,n={},s=!0){const i={"Content-Type":"application/vnd.api+json",Accept:"application/vnd.api+json"};return s&&(i.Authorization=`Bearer ${ye.settings.get("kitsuToken")}`),ye.request.xhr(e,{url:t,headers:i,data:"GET"!==e?JSON.stringify(n):void 0}).then((e=>{if(e.status>499&&e.status<600||0===e.status)throw new O(`Server Offline status: ${e.status}`);if(204===e.status)return{};const t=P(e.responseText);if(void 0!==t.errors&&t.errors.length){ve.error("[SINGLE]","Error",t.errors);const e=t.errors[0];switch(parseInt(e.status)){case 401:case 403:throw new L(e.detail);case 404:throw new C(e.detail);default:throw new Error(e.detail)}}return t}))}var Ee=n(13647);const Se={ui:{module:"dropdown"},getOptions(){const e=[{value:0,label:Ee.storage.lang("UI_Score_Not_Rated")}];for(let t=2;t<21;t++)e.push({value:5*t,label:(t/2).toFixed(1).toString()});return e},valueToOptionValue:e=>e?e<10?10:5*Math.round(Number(e)/5):0,optionValueToValue:e=>e?Number(e):0};var ke=n(13647);const Ie={ui:{module:"click",type:"smiley"},getOptions:()=>[{value:0,label:ke.storage.lang("UI_Score_Not_Rated")},{value:100,label:""},{value:70,label:""},{value:40,label:""},{value:10,label:""}],valueToOptionValue:e=>e?e<25?10:e<55?40:e<85?70:100:0,optionValueToValue:e=>e?Number(e):0};var xe=n(13647);const Te={ui:{module:"dropdown"},getOptions(){const e=[{value:0,label:xe.storage.lang("UI_Score_Not_Rated")}];for(let t=1;t<11;t++)e.push({value:10*t,label:(t/2).toFixed(1).toString()});return e},valueToOptionValue:e=>e?e<10?10:10*Math.round(e/10):0,optionValueToValue:e=>e?Number(e):0};var $e=n(78584),Le=n(26017),Ne=n(13647);class Oe extends V{constructor(e){return super(e),this.url=e,this.shortName="Kitsu",this.authenticationUrl="https://kitsu.app/404?mal-sync=authentication",this.logger=$e.m(this.shortName,"#d65e43"),this}listI(){return this.animeInfo.data[0]}animeI(){return this.animeInfo.included[0]}handleUrl(e){if(e.match(/kitsu\.app\/(anime|manga)\/.*/i))return this.type="anime"===Le.urlPart(e,3)?"anime":"manga",void(this.ids.kitsu.slug=Le.urlPart(e,4));if(e.match(/myanimelist\.net\/(anime|manga)\/\d*/i))return this.type="anime"===Le.urlPart(e,3)?"anime":"manga",void(this.ids.mal=Number(Le.urlPart(e,4)));throw new N(e)}getCacheKey(){return this.getKey(["KITSU"])}getPageId(){return this.ids.kitsu.id}_getStatus(){return this.listI().attributes.reconsuming&&"current"===this.listI().attributes.status?23:parseInt(be(this.listI().attributes.status))}_setStatus(e){23===e?(e=1,this.listI().attributes.reconsuming=!0):this.listI().attributes.reconsuming=!1,this.listI().attributes.status=be(e,parseInt(e.toString()))}_getScore(){if(!this.listI().attributes.ratingHundred)return 0;const e=Math.round(this.listI().attributes.ratingHundred/10);return 0===e?1:e}_setScore(e){this.listI().attributes.ratingHundred=e?10*e:null}_getAbsoluteScore(){return Number(this.listI().attributes.ratingHundred)}_setAbsoluteScore(e){this.listI().attributes.ratingHundred=Number(e)}_getTwentyScore(){const e=this.listI().attributes.ratingHundred;return e?e<5?1:Math.round(e/5):null}_getEpisode(){return this.listI().attributes.progress}_setEpisode(e){this.listI().attributes.progress=parseInt(`${e}`)}_getVolume(){return this.listI().attributes.volumesOwned}_setVolume(e){this.listI().attributes.volumesOwned=e}_getTags(){let e=this.listI().attributes.notes;return null!==e&&"null"!==e||(e=""),e}_setTags(e){this.listI().attributes.notes=e}_getTitle(){try{return _e(this.animeI().attributes.titles,this.animeI().attributes.canonicalTitle)}catch(e){return console.error("title",e),"Failed"}}_getTotalEpisodes(){const e=this.animeI().attributes.episodeCount?this.animeI().attributes.episodeCount:this.animeI().attributes.chapterCount;return null===e?0:e}_getTotalVolumes(){return this.animeI().attributes.volumeCount||0}_getDisplayUrl(){return`https://kitsu.app/${this.getType()}/${this.animeI().attributes.slug}`}_getImage(){return this.animeI().attributes.posterImage&&this.animeI().attributes.posterImage.large?this.animeI().attributes.posterImage.large:""}_getRating(){return null===this.animeI().attributes.averageRating?Promise.resolve(""):Promise.resolve(`${this.animeI().attributes.averageRating}%`)}async _update(){if(Number.isNaN(this.ids.mal)){var e=await this.kitsuSlugtoKitsu(this.ids.kitsu.slug,this.getType());try{this.ids.kitsu.id=Number(e.res.data[0].id),this.ids.mal=Number(e.malId)}catch(e){throw this._authenticated=!0,new C("Not found")}}if(Number.isNaN(this.ids.kitsu.id)){var t=await this.malToKitsu(this.ids.mal,this.getType());try{const e=t.data.find((e=>e.relationships.item.data.type===this.getType()));if(!e)throw new C("Not found");this.ids.kitsu.id=Number(e.relationships.item.data.id)}catch(e){throw this._authenticated=!0,new C(`No entry found for malId ${this.ids.mal}`)}}return this._authenticated=!0,this.userId().then((e=>this.apiCall("GET",`https://kitsu.app/api/edge/library-entries?filter[user_id]=${e}&filter[kind]=${this.getType()}&filter[${this.getType()}_id]=${this.ids.kitsu.id}&page[limit]=1&page[limit]=1&include=${this.getType()}&fields[${this.getType()}]=slug,titles,canonicalTitle,averageRating,posterImage,${"anime"===this.getType()?"episodeCount":"chapterCount,volumeCount"}`))).catch((e=>{if(e instanceof L)return this._authenticated=!1,{data:[],included:[]};throw e})).then((async n=>{const s=n;this._onList=!0,n.data.length||(this._onList=!1,s.data[0]={attributes:{notes:"",progress:0,volumesOwned:0,reconsuming:!1,reconsumeCount:!1,ratingTwenty:null,status:"planned"}},void 0!==t?s.included=t.included:e?s.included=e.res.data:(t=await this.malToKitsu(this.ids.mal,this.getType()),s.included=t.included)),s.data[0].attributes.ratingHundred?s.data[0].attributes.ratingHundred=0:s.data[0].attributes.ratingHundred=Number(5*s.data[0].attributes.ratingTwenty),this.animeInfo=s;try{this.animeI()}catch(e){throw this.logger.error(e),new C("Not found")}if(!this._authenticated)throw new L("Not Authenticated")}))}async _sync(){const e={data:{attributes:{notes:this.listI().attributes.notes,progress:this.listI().attributes.progress,volumesOwned:this.listI().attributes.volumesOwned,reconsuming:this.listI().attributes.reconsuming,reconsumeCount:this.listI().attributes.reconsumeCount,ratingTwenty:this._getTwentyScore(),status:this.listI().attributes.status},type:"library-entries"}},t=this.getType();if(!t)return Promise.resolve();let n,s;return this.isOnList()?(n=`https://kitsu.app/api/edge/library-entries/${this.listI().id}`,e.data.id=this.listI().id,s="PATCH"):(n="https://kitsu.app/api/edge/library-entries/",e.data.relationships={[t]:{data:{type:t,id:this.ids.kitsu.id}},user:{data:{type:"users",id:await this.userId()}}},s="POST"),this.logger.log(s,e),this.apiCall(s,n,e).then((e=>(e&&e.data&&e.data.id&&(this.listI().id=e.data.id),e)))}apiCall(e,t,n={},s=!0){return we(e,t,n,s).catch((e=>{if(e instanceof L)throw new L(e.message);throw e}))}kitsuSlugtoKitsu(e,t){return this.apiCall("GET",`https://kitsu.app/api/edge/${t}?filter[slug]=${e}&page[limit]=1&include=mappings`,{}).catch((n=>{if(n instanceof L)return this._authenticated=!1,this.apiCall("GET",`https://kitsu.app/api/edge/${t}?filter[slug]=${e}&page[limit]=1&include=mappings`,{},!1);throw n})).then((e=>{let n=NaN;if(void 0!==e&&void 0!==e.included)for(let s=0;s<e.included.length;s++){const i=e.included[s];if("mappings"===i.type){if(i.attributes.externalSite===`myanimelist/${t}`){n=Number(i.attributes.externalId),e.included.splice(s,1);break}i.attributes.externalSite===`anilist/${t}`&&(this.ids.ani=Number(i.attributes.externalId))}}return{res:e,malId:n}}))}malToKitsu(e,t){return this.apiCall("GET",`https://kitsu.app/api/edge/mappings?filter[externalSite]=myanimelist/${t}&filter[externalId]=${e}&include=item&fields[item]=id`,{}).catch((n=>{if(n instanceof L)return this._authenticated=!1,this.apiCall("GET",`https://kitsu.app/api/edge/mappings?filter[externalSite]=myanimelist/${t}&filter[externalId]=${e}&include=item&fields[item]=id`,{},!1);throw n})).then((e=>e))}async userId(){const e=await Ne.storage.get("kitsuUserId");return void 0!==e&&e?e:this.apiCall("GET","https://kitsu.app/api/edge/users?filter[self]=true").then((e=>{if(void 0===e.data||!e.data.length||void 0===e.data[0])throw new L("Not Authenticated");return Ne.storage.set("kitsuUserId",e.data[0].id),e.data[0].id}))}getScoreMode(){switch(Ne.settings.get("kitsuOptions").ratingSystem){case"simple":return Ie;case"regular":return Te;case"advanced":return Se;default:return M}}_delete(){return this.apiCall("DELETE",`https://kitsu.app/api/edge/library-entries/${this.listI().id}`)}}var Ce=n(78584),Ae=n(13647);const Pe="39e8640b6f1a60aaf60f3f3313475e830517badab8048a4e52ff2d10deb2b9b0";function Re(){return`https://simkl.com/oauth/authorize?response_type=code&client_id=${Pe}&redirect_uri=https://simkl.com/apps/chrome/mal-sync/connected/`}function Me(e,t=null){const n={watching:1,plantowatch:6,completed:2,notinteresting:4,hold:3};return null!==t?Object.keys(n).find((e=>n[e]===t)):n[e]}function Ue(e){if("number"==typeof e)return e;if(e){const t=e.match(/e\d+/i);if(null!==t){const e=parseInt(t[0].replace(/\D/,""));return Number.isNaN(e)?0:e}}return 0}let je;async function De(e=!1){const t=Ce.m("Simkl","#9b7400").m("list");if(void 0===je)je=await Ae.storage.get("simklList");else if(e)return je;const n=await Ae.storage.get("simklLastCheck"),s=await this.call("https://api.simkl.com/sync/activities");if(t.log("Activity",n,s.anime),n&&n.removed_from_list!==s.anime.removed_from_list){const e=await this.call("https://api.simkl.com/sync/all-items/anime"),n={};if(e)for(let t=0;t<e.anime.length;t++){const s=e.anime[t];void 0!==je[s.show.ids.simkl]&&(n[s.show.ids.simkl]=je[s.show.ids.simkl])}je=n,t.log("remove",je)}let i="";if(n&&je&&(i=`date_from=${n.all}`,n.all===s.anime.all))return t.log("Up to date"),je;if(je||(je={}),n&&n.rated_at!==s.anime.rated_at){const e=await this.call(`https://api.simkl.com/sync/ratings/anime?${i}`);if(t.log("ratedUpdate",e),e)for(let t=0;t<e.anime.length;t++){const n=e.anime[t];je[n.show.ids.simkl]=n}}const a=await this.call(`https://api.simkl.com/sync/all-items/anime?${i}`);if(t.log("listUpdate",a),a)for(let e=0;e<a.anime.length;e++){const t=a.anime[e];je[t.show.ids.simkl]=t}return t.log("totalList",je),await Ae.storage.set("simklList",je),await Ae.storage.set("simklLastCheck",s.anime),je}async function Fe(e,t=!1){const n=await this.syncList(t);if(e.simkl){if(void 0!==n[e.simkl])return n[e.simkl]}else{if(!e.mal)throw"No id passed";{const t=Object.values(n);for(let n=0;n<t.length;n++){const s=t[n];if(void 0!==s.show.ids.mal&&Number(s.show.ids.mal)===Number(e.mal))return s}}}return null}async function Ve(e,t={},n=!1,s="GET",i=!0){const a=Ce.m("Simkl","#9b7400").m("call");n&&(e+=`?${new URLSearchParams(Object.entries(t))}`,t=void 0),a.log(s,e,t);const r={"simkl-api-key":Pe,Accept:"application/vnd.api+json","Content-Type":"application/json"};return i?r.Authorization=`Bearer ${Ae.settings.get("simklToken")}`:a.log("No login"),"GET"===s&&(t=void 0),Ae.request.xhr(s,{url:e,headers:r,data:t}).then((async e=>{const t=P(e.responseText);return this.errorHandling(t,e.status),t}))}function Be(e,t){if(t>499&&t<600||0===t)throw new O(`Server Offline status: ${t}`);if(e&&void 0!==e.error){this.logger.error("[SINGLE]","Error",e.error);const{error:t}=e;if(t.code)throw t.code,new Error(t.error);if("user_token_failed"===t)throw new L("user_token_failed");throw t}}var He=n(78584),ze=n(26017);class Ge extends V{constructor(e){return super(e),this.url=e,this.episodeUpdate=!1,this.statusUpdate=!1,this.ratingUpdate=!1,this.minWatchedEp=1,this.curWatchedEp=0,this.shortName="Simkl",this.authenticationUrl=Re(),this.rewatchingSupport=!1,this.syncList=De,this.getSingle=Fe,this.call=Ve,this.errorHandling=Be,this.logger=He.m(this.shortName,"#9b7400"),this}handleUrl(e){if(e.match(/simkl\.com\/(anime|manga)\/\d*/i)){if(this.type="anime"===ze.urlPart(e,3)?"anime":"manga",this.ids.simkl=parseInt(ze.urlPart(e,4)),"manga"===this.type)throw"Simkl has no manga support"}else{if(!e.match(/myanimelist\.net\/(anime|manga)\/\d*/i))throw new N(e);if(this.type="anime"===ze.urlPart(e,3)?"anime":"manga",this.ids.mal=Number(ze.urlPart(e,4)),"manga"===this.type)throw"Simkl has no manga support"}}getCacheKey(){return this.getKey(["SIMKL"])}getPageId(){return this.ids.simkl}_getStatus(){return parseInt(Me(this.animeInfo.status))}_setStatus(e){23===e&&(e=1),(e=Me(e,parseInt(e.toString())))!==this.animeInfo.status&&(this.statusUpdate=!0),this.animeInfo.status=e}_getScore(){const e=this.animeInfo.user_rating;return null===e?0:e}_setScore(e){0===e&&(e=null),e!==this.animeInfo.user_rating&&(this.ratingUpdate=!0),this.animeInfo.user_rating=e}_getAbsoluteScore(){return 10*this.getScore()}_setAbsoluteScore(e){e?e<10?this.setScore(1):this.setScore(Math.round(e/10)):this.setScore(0)}_getEpisode(){return 2===this._getStatus()?this._getTotalEpisodes():this.curWatchedEp}_setEpisode(e){e!==this.curWatchedEp&&(this.episodeUpdate=!0),this.curWatchedEp=e}_getVolume(){return 0}_setVolume(e){this.logger.error("You cant set Volumes for animes")}_getTags(){let e=this.animeInfo.private_memo;return null!==e&&"null"!==e||(e=""),e}_setTags(e){this.animeInfo.private_memo=e}_getTitle(){return this.animeInfo.show.title}_getTotalEpisodes(){const e=this.animeInfo.total_episodes_count;return null===e?0:e}_getTotalVolumes(){return 0}_getDisplayUrl(){return`https://simkl.com/${this.getType()}/${this.ids.simkl}`}_getImage(){return`https://simkl.in/posters/${this.animeInfo.show.poster}_ca.jpg`}async _getRating(){try{return(await this.call("https://api.simkl.com/ratings",{simkl:this.ids.simkl},!0)).simkl.rating}catch(e){return this.logger.error(e),"N/A"}}async _update(){let e;return e=Number.isNaN(this.ids.mal)?{simkl:this.ids.simkl}:{mal:this.ids.mal},this._authenticated=!0,this.getSingle(e).catch((e=>{if(e instanceof L)return this._authenticated=!1,"";throw e})).then((async t=>{if(this.logger.log(t),this.episodeUpdate=!1,this.statusUpdate=!1,this.ratingUpdate=!1,this.animeInfo=t,this._onList=!0,!this.animeInfo){let t;if(this._onList=!1,e.simkl){if(t=await this.call(`https://api.simkl.com/anime/${e.simkl}`,{extended:"full"},!0),!t)throw new C("Anime not found")}else{if(t=await this.call("https://api.simkl.com/search/id",e,!0),!t)throw new C("Anime not found");if(t[0].mal&&t[0].mal.type&&"Special"===t[0].mal.type)throw new Error("Is a special");t=t[0]}this.animeInfo={last_watched:"",last_watched_at:"",next_to_watch:"",not_aired_episodes_count:0,private_memo:"",status:"plantowatch",total_episodes_count:0,user_rating:null,watched_episodes_count:0,show:t},this.logger.log("Add anime",this.animeInfo)}if(Number.isNaN(this.ids.simkl)&&(this.ids.simkl=parseInt(this.animeInfo.show.ids.simkl)),Number.isNaN(this.ids.mal)&&void 0!==this.animeInfo.show.ids.mal&&(this.ids.mal=this.animeInfo.show.ids.mal),this.curWatchedEp=Ue(this.animeInfo.last_watched),!this.curWatchedEp&&this.animeInfo.next_to_watch){const e=Ue(this.animeInfo.next_to_watch);e&&(this.curWatchedEp=e-1)}if(this.minWatchedEp=this.curWatchedEp+1,!this._authenticated)throw new L("Not Authenticated")}))}async _sync(){if(this.logger.log("[SET] Object:",this.animeInfo,"status",this.statusUpdate,"episode",this.episodeUpdate,"rating",this.ratingUpdate,"minWatchedEp",this.minWatchedEp,"curWatchedEp",this.curWatchedEp),this.statusUpdate||!this.isOnList()){const e=await this.call("https://api.simkl.com/sync/add-to-list",JSON.stringify({shows:[{to:this.animeInfo.status,ids:{simkl:this.ids.simkl}}]}),!1,"POST");this.logger.log("Status response",e)}if(this.episodeUpdate||!this.isOnList()){const e=this.curWatchedEp,t=[];if(this.minWatchedEp<=e){if(e){for(let n=this.minWatchedEp;n<=e;n++)t.push({number:n});const n=await this.call("https://api.simkl.com/sync/history",JSON.stringify({shows:[{ids:{simkl:this.ids.simkl},private_memo:this.animeInfo.private_memo,seasons:[{number:1,episodes:t}]}]}),!1,"POST");this.logger.log("Episode response",n)}}else{for(let n=this.minWatchedEp-1;n>e;n-=1)t.push({number:n});const n=await this.call("https://api.simkl.com/sync/history/remove",JSON.stringify({shows:[{ids:{simkl:this.ids.simkl},seasons:[{number:1,episodes:t}]}]}),!1,"POST");this.logger.log("Episode remove response",n)}this.minWatchedEp=e+1}if(this.ratingUpdate)if(this.animeInfo.user_rating){const e=await this.call("https://api.simkl.com/sync/ratings",JSON.stringify({shows:[{rating:this.animeInfo.user_rating,ids:{simkl:this.ids.simkl}}]}),!1,"POST");this.logger.log("Rating response",e)}else{const e=await this.call("https://api.simkl.com/sync/ratings/remove",JSON.stringify({shows:[{ids:{simkl:this.ids.simkl}}]}),!1,"POST");this.logger.log("Rating remove response",e)}this.episodeUpdate=!1,this.statusUpdate=!1,this.ratingUpdate=!1}_delete(){return this.call("https://api.simkl.com/sync/history/remove",JSON.stringify({shows:[{ids:{simkl:this.ids.simkl}}]}),!1,"POST")}}var We=n(13647);const Ke="z3NJ84kK9iy5NU6SnhdCDB38rr4-jFIJ67bMIUDzdoo",qe=`https://shikimori.one/oauth/authorize?client_id=${Ke}&redirect_uri=https%3A%2F%2Fmalsync.moe%2Fshikimori%2Foauth&response_type=code&scope=user_rates`,Xe="https://shikimori.one/api/",Ye="https://shikimori.one";async function Je(e){const t=e.type||"GET",n=We.settings.get("shikiToken");if(!n&&!n.access_token&&!e.auth)throw new L("No token set");let s=Xe+e.path;if(e.parameter&&Object.keys(e.parameter).length){s+=s.includes("?")?"&":"?";const t=[];for(const n in e.parameter)t.push(`${n}=${e.parameter[n]}`);s+=t.join("&")}const i={Authorization:`Bearer ${n.access_token}`,"User-Agent":"MAL-Sync","Content-Type":"application/json"};let a="";return e.dataObj&&(a=JSON.stringify(e.dataObj)),e.auth&&(delete i.Authorization,s="https://shikimori.one/oauth/token"),We.request.xhr(t,{url:s,headers:i,data:a}).then((async t=>{if(t.status>499&&t.status<600||0===t.status)throw new O(`Server Offline status: ${t.status}`);let s=null;if(t.responseText&&(s=JSON.parse(t.responseText)),401===t.status){if(e.auth)throw new L(s.message??s.error);return await Ze(n.refresh_token),Je(e)}if(s&&s.error)switch(s.error){case"forbidden":case"invalid_token":if(e.auth)throw new L(s.message??s.error);return await Ze(n.refresh_token),Je(e);case"not_found":throw new C(s.message??s.error);default:throw new Error(s.message??s.error)}if(400===t.status)throw new Error("Invalid Parameters");return s}))}async function Ze(e){const t=await function(e){const t={client_id:Ke,client_secret:"6vkFaJN_wxQHmBoq23ac1z6tZKiAD7xqsXGudkkOqTg",redirect_uri:"https://malsync.moe/shikimori/oauth"};return"code"in e&&(t.code=e.code,t.grant_type="authorization_code"),"refresh_token"in e&&(t.refresh_token=e.refresh_token,t.grant_type="refresh_token"),Je({type:"POST",path:"oauth/token",auth:!0,dataObj:t})}({refresh_token:e}).catch((e=>{throw"invalid_request"===e.message&&We.settings.set("shikiToken",""),e}));await We.settings.set("shikiToken",{access_token:t.access_token,refresh_token:t.refresh_token})}function Qe(e,t,n=!1){const s=We.settings.get("shikiOptions");return"ru"===(s&&s.locale?s.locale:"ru")?e||t:n&&t&&e?`${t} / ${e}`:t||e}var et;!function(e){e[e.watching=r.Watching]="watching",e[e.planned=r.PlanToWatch]="planned",e[e.completed=r.Completed]="completed",e[e.dropped=r.Dropped]="dropped",e[e.on_hold=r.Onhold]="on_hold",e[e.rewatching=r.Rewatching]="rewatching"}(et||(et={}));var tt=n(78584),nt=n(26017);class st extends V{constructor(e){return super(e),this.url=e,this.shortName="Shiki",this.authenticationUrl=qe,this.logger=tt.m(this.shortName,"#3db4f2"),this}handleUrl(e){if(e.match(/shikimori\.one\/(animes|mangas|ranobe)\/\D?\d+/i)){this.type="animes"===nt.urlPart(e,3)?"anime":"manga";const t=nt.urlPart(e,4).match(/^\D?(\d+)/);if(t&&t[1])return void(this.ids.mal=Number(t[1]))}if(e.match(/myanimelist\.net\/(anime|manga)\/\d*/i))return this.type="anime"===nt.urlPart(e,3)?"anime":"manga",void(this.ids.mal=Number(nt.urlPart(e,4)));throw new N(e)}getCacheKey(){return this.ids.mal}getPageId(){return this.ids.mal}_getStatus(){return et[this.animeInfo.status]}_setStatus(e){this.animeInfo.status=et[e]}_getScore(){return this.animeInfo.score}_setScore(e){this.animeInfo.score=e}_getAbsoluteScore(){return 10*this.getScore()}_setAbsoluteScore(e){e?e<10?this.setScore(1):this.setScore(Math.round(e/10)):this.setScore(0)}_getEpisode(){return"manga"===this.type?this.animeInfo.chapters:this.animeInfo.episodes}_setEpisode(e){"manga"!==this.type?this.animeInfo.episodes=parseInt(`${e}`):this.animeInfo.chapters=parseInt(`${e}`)}_getVolume(){return this.animeInfo.volumes}_setVolume(e){this.animeInfo.volumes=e}_getTags(){let e=this.animeInfo.text;return null!==e&&"null"!==e||(e=""),e}_setTags(e){this.animeInfo.text=e}_getTitle(){return Qe(this.animeMeta.russian,this.animeMeta.name)}_getTotalEpisodes(){return("anime"===this.type?this.animeMeta.episodes:this.animeMeta.chapters)||0}_getTotalVolumes(){return this.animeMeta.volumes||0}_getDisplayUrl(){return this.animeMeta.url?`${Ye}${this.animeMeta.url}`:this.url}_getImage(){return this.animeMeta.image.preview?`${Ye}${this.animeMeta.image.preview}`:""}_getRating(){return Promise.resolve(this.animeMeta.score)}async _update(){const e=await async function(){const e=new u("shiki/userId",144e5);if(await e.hasValue())return e.getValue();const t=await Je({type:"GET",path:"users/whoami"}).then((e=>(e.locale&&We.settings.set("shikiOptions",{locale:e.locale}),e)));return t.id&&e.setValue(t.id),t.id}(),t=await Je({path:`${this.type}s/${this.ids.mal}`,type:"GET"});if(!t.id)throw new C(this.url);this.animeMeta=t;const n=await Je({path:"v2/user_rates",type:"GET",parameter:{target_id:this.ids.mal,user_id:e,target_type:"anime"===this.type?"Anime":"Manga"}});return n.length?(this._onList=!0,[this.animeInfo]=n):(this._onList=!1,this.animeInfo={user_id:e,target_id:this.ids.mal,target_type:"anime"===this.type?"Anime":"Manga",score:0,status:"planned",rewatches:0,episodes:0,volumes:0,chapters:0,text:""}),this._authenticated=!0,Promise.resolve()}async _sync(){return Je({type:this._onList?"PUT":"POST",path:this._onList?`v2/user_rates/${this.animeInfo.id}`:"v2/user_rates",dataObj:{user_rate:this.animeInfo}})}getScoreMode(){return M}_delete(){return Je({type:"DELETE",path:`v2/user_rates/${this.animeInfo.id}`})}}var it=n(78584),at=n(26017),rt=n(13647);class ot extends V{constructor(e){return super(e),this.url=e,this.shortName="Local",this.authenticationUrl="",this.logger=it.m(this.shortName,"black"),this}handleUrl(e){if(e.match(/local:\/\/.*/i))return this.id=at.urlPart(e,4),this.type="anime"===at.urlPart(e,3)?"anime":"manga",this.page=at.urlPart(e,2),this.key=`local://${this.page}/${this.type}/${this.id}`,void(at.urlPart(e,5)?this.title=decodeURIComponent(at.urlPart(e,5)):this.title="Unknown");throw new N(e)}getCacheKey(){return`local:${this.id}:${this.page}`}getPageId(){return this.getCacheKey()}_getStatus(){return this.animeInfo.status}_setStatus(e){this.animeInfo.status=e}_getScore(){return this.animeInfo.score}_setScore(e){this.animeInfo.score=e}_getAbsoluteScore(){return 10*this.getScore()}_setAbsoluteScore(e){e?e<10?this.setScore(1):this.setScore(Math.round(e/10)):this.setScore(0)}_getEpisode(){return this.animeInfo.progress}_setEpisode(e){this.animeInfo.progress=parseInt(`${e}`)}_getVolume(){return this.animeInfo.volumeprogress}_setVolume(e){this.animeInfo.volumeprogress=e}_getTags(){let{tags:e}=this.animeInfo;return e||(e=""),e}_setTags(e){this.animeInfo.tags=e}_getTitle(e=!1){return e?this.animeInfo.name:`[L] ${this.animeInfo.name}`}_getTotalEpisodes(){return 0}_getTotalVolumes(){return 0}_getDisplayUrl(){return"https://github.com/MALSync/MALSync/wiki/Local-Sync"}_getImage(){return this.animeInfo&&this.animeInfo.image?this.animeInfo.image:""}setImage(e){this.animeInfo.image=e,this._onList&&this.sync()}_getRating(){return Promise.resolve("Local")}async _update(){this._authenticated=!0,this.animeInfo=await rt.storage.get(this.key),this._onList=!0,this.animeInfo||(this._onList=!1,this.animeInfo={name:this.title,tags:"",sUrl:"",image:"",progress:0,volumeprogress:0,score:0,status:6})}async _sync(){return rt.storage.set(this.key,this.animeInfo)}_delete(){return rt.storage.remove(this.key)}setStreamingUrl(e){return this.animeInfo&&e&&(this.animeInfo.sUrl=e),super.setStreamingUrl(e)}getStreamingUrl(){return this.animeInfo&&this.animeInfo.sUrl?this.animeInfo.sUrl:super.getStreamingUrl()}}function lt(e){if(/^local:\/\//i.test(e))return new ot(e);const n=t(e);if("MAL"===n)return new se(e);if("MALAPI"===n)return new ne(e);if("ANILIST"===n)return new ge(e);if("KITSU"===n)return new Oe(e);if("SIMKL"===n)return new Ge(e);if("SHIKI"===n)return new st(e);throw"Unknown sync mode"}var ct=n(13647),ut=n(7263);let ht;function pt(){clearTimeout(ht),ht=null,ut.$(".floatbutton").fadeIn()}function mt(e=!1){e?ut.$(".floatbutton").fadeOut():ht||(ht=setTimeout((()=>{ht=null,ut.$(".floatbutton").fadeOut()}),500))}const dt={shortName:"MAL",score:"MAL Score:"},gt={shortName:"AniList",score:"AniList Score:"},ft={shortName:"Kitsu",score:"Kitsu Score:"},yt={shortName:"Simkl",score:"Simkl Score:"},vt={shortName:"local storage",score:"Local storage Score:"};var bt=n(13647);function _t(e){if(/^local:\/\//i.test(e))return vt;const t=bt.settings.get("syncMode");return"MAL"===t||"MALAPI"===t?dt:"ANILIST"===t?gt:"KITSU"===t?ft:yt}var wt=n(78584),Et=n(13647),St=n(7263);let kt;const It=wt.m("Player");let xt="";function Tt(e,t){const n=t.currentSrc;e.current>1&&xt!==n&&(xt=n,It.log("New player detected",t.currentSrc),async function(e){if(await Et.settings.getAsync("autofull"))if(window.fullScreen||window.innerWidth===window.screen.width&&window.innerHeight===window.screen.height)wt.info("Browser already in fullscreen");else{let t=e;const n=["player","vstr","vplayer","mgvideo","myVideo","b-video-wrapper","vilos"],s=["AT-player","plyr","AkiraPlayer","video-js"];let i=!1;for(const a in n){const r=document.getElementById(n[a]);if(null!==r){i=!0,t=r;break}}for(const o in s){const l=document.getElementsByClassName(s[o]).item(0);if(null!==l){i=!0,t=l;break}}if(!i){const c=t.offsetHeight,u=t.offsetWidth;for(;t.parentElement&&c===t.parentElement.offsetHeight&&u===t.parentElement.offsetWidth;)t=t.parentElement,i=!0}if(!i&&!e.getAttribute("controls")){function h(){(document.webkitIsFullScreen||document.mozFullScreen||null!==document.msFullscreenElement)&&e.removeAttribute("controls","controls")}document.addEventListener&&(document.addEventListener("fullscreenchange",h,!1),document.addEventListener("mozfullscreenchange",h,!1),document.addEventListener("MSFullscreenChange",h,!1),document.addEventListener("webkitfullscreenchange",h,!1)),e.setAttribute("controls","controls")}t.requestFullscreen?t.requestFullscreen():t.msRequestFullscreen?t.msRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen&&t.webkitRequestFullscreen()}}(t))}let $t,Lt=!1;const Nt=["introSkipFwd","introSkipBwd","nextEpShort","correctionShort","syncShort"];var Ot=n(50953),Ct=n(90033);function At(e,t,n,s){try{return s?e(...s):e()}catch(e){Rt(e,t,n)}}function Pt(e,t,n,s){if((0,Ct.Tn)(e)){const i=At(e,t,n,s);return i&&(0,Ct.yL)(i)&&i.catch((e=>{Rt(e,t,n)})),i}if((0,Ct.cy)(e)){const i=[];for(let a=0;a<e.length;a++)i.push(Pt(e[a],t,n,s));return i}}function Rt(e,t,n,s=!0){if(t&&t.vnode,t){let s=t.parent;const i=t.proxy,a=`https://vuejs.org/error-reference/#runtime-${n}`;for(;s;){const t=s.ec;if(t)for(let n=0;n<t.length;n++)if(!1===t[n](e,i,a))return;s=s.parent}const r=t.appContext.config.errorHandler;if(r)return(0,Ot.C4)(),At(r,null,10,[e,i,a]),void(0,Ot.bl)()}!function(e,t,n,s=!0){console.error(e)}(e,0,0,s)}let Mt=!1,Ut=!1;const jt=[];let Dt=0;const Ft=[];let Vt=null,Bt=0;const Ht=Promise.resolve();let zt=null;function Gt(e){const t=zt||Ht;return e?t.then(this?e.bind(this):e):t}function Wt(e){jt.length&&jt.includes(e,Mt&&e.allowRecurse?Dt+1:Dt)||(null==e.id?jt.push(e):jt.splice(function(e){let t=Dt+1,n=jt.length;for(;t<n;){const s=t+n>>>1,i=jt[s],a=Yt(i);a<e||a===e&&i.pre?t=s+1:n=s}return t}(e.id),0,e),Kt())}function Kt(){Mt||Ut||(Ut=!0,zt=Ht.then(Zt))}function qt(e,t,n=(Mt?Dt+1:0)){for(;n<jt.length;n++){const t=jt[n];if(t&&t.pre){if(e&&t.id!==e.uid)continue;jt.splice(n,1),n--,t()}}}function Xt(e){if(Ft.length){const e=[...new Set(Ft)].sort(((e,t)=>Yt(e)-Yt(t)));if(Ft.length=0,Vt)return void Vt.push(...e);for(Vt=e,Bt=0;Bt<Vt.length;Bt++){const e=Vt[Bt];!1!==e.active&&e()}Vt=null,Bt=0}}const Yt=e=>null==e.id?1/0:e.id,Jt=(e,t)=>{const n=Yt(e)-Yt(t);if(0===n){if(e.pre&&!t.pre)return-1;if(t.pre&&!e.pre)return 1}return n};function Zt(e){Ut=!1,Mt=!0,jt.sort(Jt),Ct.tE;try{for(Dt=0;Dt<jt.length;Dt++){const e=jt[Dt];e&&!1!==e.active&&At(e,null,14)}}finally{Dt=0,jt.length=0,Xt(),Mt=!1,zt=null,(jt.length||Ft.length)&&Zt(e)}}function Qt(e,t,...n){if(e.isUnmounted)return;const s=e.vnode.props||Ct.MZ;let i=n;const a=t.startsWith("update:"),r=a&&t.slice(7);if(r&&r in s){const e=`${"modelValue"===r?"model":r}Modifiers`,{number:t,trim:a}=s[e]||Ct.MZ;a&&(i=n.map((e=>(0,Ct.Kg)(e)?e.trim():e))),t&&(i=n.map(Ct.bB))}let o,l=s[o=(0,Ct.rU)(t)]||s[o=(0,Ct.rU)((0,Ct.PT)(t))];!l&&a&&(l=s[o=(0,Ct.rU)((0,Ct.Tg)(t))]),l&&Pt(l,e,6,i);const c=s[o+"Once"];if(c){if(e.emitted){if(e.emitted[o])return}else e.emitted={};e.emitted[o]=!0,Pt(c,e,6,i)}}function en(e,t,n=!1){const s=t.emitsCache,i=s.get(e);if(void 0!==i)return i;const a=e.emits;let r={},o=!1;if(!(0,Ct.Tn)(e)){const s=e=>{const n=en(e,t,!0);n&&(o=!0,(0,Ct.X$)(r,n))};!n&&t.mixins.length&&t.mixins.forEach(s),e.extends&&s(e.extends),e.mixins&&e.mixins.forEach(s)}return a||o?((0,Ct.cy)(a)?a.forEach((e=>r[e]=null)):(0,Ct.X$)(r,a),(0,Ct.Gv)(e)&&s.set(e,r),r):((0,Ct.Gv)(e)&&s.set(e,null),null)}function tn(e,t){return!(!e||!(0,Ct.Mp)(t))&&(t=t.slice(2).replace(/Once$/,""),(0,Ct.$3)(e,t[0].toLowerCase()+t.slice(1))||(0,Ct.$3)(e,(0,Ct.Tg)(t))||(0,Ct.$3)(e,t))}let nn=null,sn=null;function an(e){const t=nn;return nn=e,sn=e&&e.type.__scopeId||null,t}function rn(e){const{type:t,vnode:n,proxy:s,withProxy:i,propsOptions:[a],slots:r,attrs:o,emit:l,render:c,renderCache:u,props:h,data:p,setupState:m,ctx:d,inheritAttrs:g}=e,f=an(e);let y,v;try{if(4&n.shapeFlag){const e=i||s,t=e;y=fi(c.call(t,e,u,h,m,p,d)),v=o}else{const e=t;y=fi(e.length>1?e(h,{attrs:o,slots:r,emit:l}):e(h,null)),v=t.props?o:on(o)}}catch(t){Zs.length=0,Rt(t,e,1),y=hi(Ys)}let b=y;if(v&&!1!==g){const e=Object.keys(v),{shapeFlag:t}=b;e.length&&7&t&&(a&&e.some(Ct.CP)&&(v=ln(v,a)),b=pi(b,v,!1,!0))}return n.dirs&&(b=pi(b,null,!1,!0),b.dirs=b.dirs?b.dirs.concat(n.dirs):n.dirs),n.transition&&(b.transition=n.transition),y=b,an(f),y}const on=e=>{let t;for(const n in e)("class"===n||"style"===n||(0,Ct.Mp)(n))&&((t||(t={}))[n]=e[n]);return t},ln=(e,t)=>{const n={};for(const s in e)(0,Ct.CP)(s)&&s.slice(9)in t||(n[s]=e[s]);return n};function cn(e,t,n){const s=Object.keys(t);if(s.length!==Object.keys(e).length)return!0;for(let i=0;i<s.length;i++){const a=s[i];if(t[a]!==e[a]&&!tn(n,a))return!0}return!1}const un="components";function hn(e,t){return function(e,t,n=!0,s=!1){const i=nn||Ei;if(i){const n=i.type;if(e===un){const e=function(e,t=!0){return(0,Ct.Tn)(e)?e.displayName||e.name:e.name||t&&e.__name}(n,!1);if(e&&(e===t||e===(0,Ct.PT)(t)||e===(0,Ct.ZH)((0,Ct.PT)(t))))return n}const a=mn(i[e]||n[e],t)||mn(i.appContext[e],t);return!a&&s?n:a}}(un,e,!0,t)||e}const pn=Symbol.for("v-ndc");function mn(e,t){return e&&(e[t]||e[(0,Ct.PT)(t)]||e[(0,Ct.ZH)((0,Ct.PT)(t))])}function dn(e,t,n=Ei,s=!1){if(n){const i=n[e]||(n[e]=[]),a=t.__weh||(t.__weh=(...s)=>{(0,Ot.C4)();const i=xi(n),a=Pt(t,n,e,s);return i(),(0,Ot.bl)(),a});return s?i.unshift(a):i.push(a),a}}const gn=e=>(t,n=Ei)=>{Oi&&"sp"!==e||dn(e,((...e)=>t(...e)),n)},fn=gn("bm"),yn=gn("m"),vn=gn("bu"),bn=gn("u"),_n=gn("bum"),wn=gn("um"),En=gn("sp"),Sn=gn("rtg"),kn=gn("rtc");function In(e,t=Ei){dn("ec",e,t)}function xn(e,t){if(null===nn)return e;const n=Ri(nn),s=e.dirs||(e.dirs=[]);for(let e=0;e<t.length;e++){let[i,a,r,o=Ct.MZ]=t[e];i&&((0,Ct.Tn)(i)&&(i={mounted:i,updated:i}),i.deep&&Ls(a),s.push({dir:i,instance:n,value:a,oldValue:void 0,arg:r,modifiers:o}))}return e}function Tn(e,t,n,s){const i=e.dirs,a=t&&t.dirs;for(let r=0;r<i.length;r++){const o=i[r];a&&(o.oldValue=a[r].value);let l=o.dir[s];l&&((0,Ot.C4)(),Pt(l,n,8,[e.el,o,e,t]),(0,Ot.bl)())}}function $n(e,t,n,s){let i;const a=n&&n[s];if((0,Ct.cy)(e)||(0,Ct.Kg)(e)){i=new Array(e.length);for(let n=0,s=e.length;n<s;n++)i[n]=t(e[n],n,void 0,a&&a[n])}else if("number"==typeof e){i=new Array(e);for(let n=0;n<e;n++)i[n]=t(n+1,n,void 0,a&&a[n])}else if((0,Ct.Gv)(e))if(e[Symbol.iterator])i=Array.from(e,((e,n)=>t(e,n,void 0,a&&a[n])));else{const n=Object.keys(e);i=new Array(n.length);for(let s=0,r=n.length;s<r;s++){const r=n[s];i[s]=t(e[r],r,s,a&&a[s])}}else i=[];return n&&(n[s]=i),i}const Ln=e=>!!e.type.__asyncLoader,Nn=e=>e?$i(e)?Ri(e):Nn(e.parent):null,On=(0,Ct.X$)(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Nn(e.parent),$root:e=>Nn(e.root),$emit:e=>e.emit,$options:e=>jn(e),$forceUpdate:e=>e.f||(e.f=()=>{e.effect.dirty=!0,Wt(e.update)}),$nextTick:e=>e.n||(e.n=Gt.bind(e.proxy)),$watch:e=>Ts.bind(e)}),Cn=(e,t)=>e!==Ct.MZ&&!e.__isScriptSetup&&(0,Ct.$3)(e,t),An={get({_:e},t){if("__v_skip"===t)return!0;const{ctx:n,setupState:s,data:i,props:a,accessCache:r,type:o,appContext:l}=e;let c;if("$"!==t[0]){const o=r[t];if(void 0!==o)switch(o){case 1:return s[t];case 2:return i[t];case 4:return n[t];case 3:return a[t]}else{if(Cn(s,t))return r[t]=1,s[t];if(i!==Ct.MZ&&(0,Ct.$3)(i,t))return r[t]=2,i[t];if((c=e.propsOptions[0])&&(0,Ct.$3)(c,t))return r[t]=3,a[t];if(n!==Ct.MZ&&(0,Ct.$3)(n,t))return r[t]=4,n[t];Rn&&(r[t]=0)}}const u=On[t];let h,p;return u?("$attrs"===t&&(0,Ot.u4)(e.attrs,"get",""),u(e)):(h=o.__cssModules)&&(h=h[t])?h:n!==Ct.MZ&&(0,Ct.$3)(n,t)?(r[t]=4,n[t]):(p=l.config.globalProperties,(0,Ct.$3)(p,t)?p[t]:void 0)},set({_:e},t,n){const{data:s,setupState:i,ctx:a}=e;return Cn(i,t)?(i[t]=n,!0):s!==Ct.MZ&&(0,Ct.$3)(s,t)?(s[t]=n,!0):!((0,Ct.$3)(e.props,t)||"$"===t[0]&&t.slice(1)in e||(a[t]=n,0))},has({_:{data:e,setupState:t,accessCache:n,ctx:s,appContext:i,propsOptions:a}},r){let o;return!!n[r]||e!==Ct.MZ&&(0,Ct.$3)(e,r)||Cn(t,r)||(o=a[0])&&(0,Ct.$3)(o,r)||(0,Ct.$3)(s,r)||(0,Ct.$3)(On,r)||(0,Ct.$3)(i.config.globalProperties,r)},defineProperty(e,t,n){return null!=n.get?e._.accessCache[t]=0:(0,Ct.$3)(n,"value")&&this.set(e,t,n.value,null),Reflect.defineProperty(e,t,n)}};function Pn(e){return(0,Ct.cy)(e)?e.reduce(((e,t)=>(e[t]=null,e)),{}):e}let Rn=!0;function Mn(e,t,n){Pt((0,Ct.cy)(e)?e.map((e=>e.bind(t.proxy))):e.bind(t.proxy),t,n)}function Un(e,t,n,s){const i=s.includes(".")?$s(n,s):()=>n[s];if((0,Ct.Kg)(e)){const n=t[e];(0,Ct.Tn)(n)&&Is(i,n)}else if((0,Ct.Tn)(e))Is(i,e.bind(n));else if((0,Ct.Gv)(e))if((0,Ct.cy)(e))e.forEach((e=>Un(e,t,n,s)));else{const s=(0,Ct.Tn)(e.handler)?e.handler.bind(n):t[e.handler];(0,Ct.Tn)(s)&&Is(i,s,e)}}function jn(e){const t=e.type,{mixins:n,extends:s}=t,{mixins:i,optionsCache:a,config:{optionMergeStrategies:r}}=e.appContext,o=a.get(t);let l;return o?l=o:i.length||n||s?(l={},i.length&&i.forEach((e=>Dn(l,e,r,!0))),Dn(l,t,r)):l=t,(0,Ct.Gv)(t)&&a.set(t,l),l}function Dn(e,t,n,s=!1){const{mixins:i,extends:a}=t;a&&Dn(e,a,n,!0),i&&i.forEach((t=>Dn(e,t,n,!0)));for(const i in t)if(s&&"expose"===i);else{const s=Fn[i]||n&&n[i];e[i]=s?s(e[i],t[i]):t[i]}return e}const Fn={data:Vn,props:Gn,emits:Gn,methods:zn,computed:zn,beforeCreate:Hn,created:Hn,beforeMount:Hn,mounted:Hn,beforeUpdate:Hn,updated:Hn,beforeDestroy:Hn,beforeUnmount:Hn,destroyed:Hn,unmounted:Hn,activated:Hn,deactivated:Hn,errorCaptured:Hn,serverPrefetch:Hn,components:zn,directives:zn,watch:function(e,t){if(!e)return t;if(!t)return e;const n=(0,Ct.X$)(Object.create(null),e);for(const s in t)n[s]=Hn(e[s],t[s]);return n},provide:Vn,inject:function(e,t){return zn(Bn(e),Bn(t))}};function Vn(e,t){return t?e?function(){return(0,Ct.X$)((0,Ct.Tn)(e)?e.call(this,this):e,(0,Ct.Tn)(t)?t.call(this,this):t)}:t:e}function Bn(e){if((0,Ct.cy)(e)){const t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function Hn(e,t){return e?[...new Set([].concat(e,t))]:t}function zn(e,t){return e?(0,Ct.X$)(Object.create(null),e,t):t}function Gn(e,t){return e?(0,Ct.cy)(e)&&(0,Ct.cy)(t)?[...new Set([...e,...t])]:(0,Ct.X$)(Object.create(null),Pn(e),Pn(null!=t?t:{})):t}function Wn(){return{app:null,config:{isNativeTag:Ct.NO,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Kn=0;function qn(e,t){return function(n,s=null){(0,Ct.Tn)(n)||(n=(0,Ct.X$)({},n)),null==s||(0,Ct.Gv)(s)||(s=null);const i=Wn(),a=new WeakSet;let r=!1;const o=i.app={_uid:Kn++,_component:n,_props:s,_container:null,_context:i,_instance:null,version:Ui,get config(){return i.config},set config(e){},use:(e,...t)=>(a.has(e)||(e&&(0,Ct.Tn)(e.install)?(a.add(e),e.install(o,...t)):(0,Ct.Tn)(e)&&(a.add(e),e(o,...t))),o),mixin:e=>(i.mixins.includes(e)||i.mixins.push(e),o),component:(e,t)=>t?(i.components[e]=t,o):i.components[e],directive:(e,t)=>t?(i.directives[e]=t,o):i.directives[e],mount(a,l,c){if(!r){const u=hi(n,s);return u.appContext=i,!0===c?c="svg":!1===c&&(c=void 0),l&&t?t(u,a):e(u,a,c),r=!0,o._container=a,a.__vue_app__=o,Ri(u.component)}},unmount(){r&&(e(null,o._container),delete o._container.__vue_app__)},provide:(e,t)=>(i.provides[e]=t,o),runWithContext(e){const t=Xn;Xn=o;try{return e()}finally{Xn=t}}};return o}}let Xn=null;function Yn(e,t,n=!1){const s=Ei||nn;if(s||Xn){const i=s?null==s.parent?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides:Xn._context.provides;if(i&&e in i)return i[e];if(arguments.length>1)return n&&(0,Ct.Tn)(t)?t.call(s&&s.proxy):t}}const Jn={},Zn=()=>Object.create(Jn),Qn=e=>Object.getPrototypeOf(e)===Jn;function es(e,t,n,s){const[i,a]=e.propsOptions;let r,o=!1;if(t)for(let l in t){if((0,Ct.SU)(l))continue;const c=t[l];let u;i&&(0,Ct.$3)(i,u=(0,Ct.PT)(l))?a&&a.includes(u)?(r||(r={}))[u]=c:n[u]=c:tn(e.emitsOptions,l)||l in s&&c===s[l]||(s[l]=c,o=!0)}if(a){const t=(0,Ot.ux)(n),s=r||Ct.MZ;for(let r=0;r<a.length;r++){const o=a[r];n[o]=ts(i,t,o,s[o],e,!(0,Ct.$3)(s,o))}}return o}function ts(e,t,n,s,i,a){const r=e[n];if(null!=r){const e=(0,Ct.$3)(r,"default");if(e&&void 0===s){const e=r.default;if(r.type!==Function&&!r.skipFactory&&(0,Ct.Tn)(e)){const{propsDefaults:a}=i;if(n in a)s=a[n];else{const r=xi(i);s=a[n]=e.call(null,t),r()}}else s=e}r[0]&&(a&&!e?s=!1:!r[1]||""!==s&&s!==(0,Ct.Tg)(n)||(s=!0))}return s}function ns(e,t,n=!1){const s=t.propsCache,i=s.get(e);if(i)return i;const a=e.props,r={},o=[];let l=!1;if(!(0,Ct.Tn)(e)){const s=e=>{l=!0;const[n,s]=ns(e,t,!0);(0,Ct.X$)(r,n),s&&o.push(...s)};!n&&t.mixins.length&&t.mixins.forEach(s),e.extends&&s(e.extends),e.mixins&&e.mixins.forEach(s)}if(!a&&!l)return(0,Ct.Gv)(e)&&s.set(e,Ct.Oj),Ct.Oj;if((0,Ct.cy)(a))for(let e=0;e<a.length;e++){const t=(0,Ct.PT)(a[e]);ss(t)&&(r[t]=Ct.MZ)}else if(a)for(const e in a){const t=(0,Ct.PT)(e);if(ss(t)){const n=a[e],s=r[t]=(0,Ct.cy)(n)||(0,Ct.Tn)(n)?{type:n}:(0,Ct.X$)({},n);if(s){const e=rs(Boolean,s.type),n=rs(String,s.type);s[0]=e>-1,s[1]=n<0||e<n,(e>-1||(0,Ct.$3)(s,"default"))&&o.push(t)}}}const c=[r,o];return(0,Ct.Gv)(e)&&s.set(e,c),c}function ss(e){return"$"!==e[0]&&!(0,Ct.SU)(e)}function is(e){return null===e?"null":"function"==typeof e?e.name||"":"object"==typeof e&&e.constructor&&e.constructor.name||""}function as(e,t){return is(e)===is(t)}function rs(e,t){return(0,Ct.cy)(t)?t.findIndex((t=>as(t,e))):(0,Ct.Tn)(t)&&as(t,e)?0:-1}const os=e=>"_"===e[0]||"$stable"===e,ls=e=>(0,Ct.cy)(e)?e.map(fi):[fi(e)],cs=(e,t,n)=>{if(t._n)return t;const s=function(e,t=nn,n){if(!t)return e;if(e._n)return e;const s=(...n)=>{s._d&&ni(-1);const i=an(t);let a;try{a=e(...n)}finally{an(i),s._d&&ni(1)}return a};return s._n=!0,s._c=!0,s._d=!0,s}(((...e)=>ls(t(...e))),n);return s._c=!1,s},us=(e,t,n)=>{const s=e._ctx;for(const n in e){if(os(n))continue;const i=e[n];if((0,Ct.Tn)(i))t[n]=cs(0,i,s);else if(null!=i){const e=ls(i);t[n]=()=>e}}},hs=(e,t)=>{const n=ls(t);e.slots.default=()=>n},ps=(e,t)=>{const n=e.slots=Zn();if(32&e.vnode.shapeFlag){const e=t._;e?((0,Ct.X$)(n,t),(0,Ct.yQ)(n,"_",e,!0)):us(t,n)}else t&&hs(e,t)},ms=(e,t,n)=>{const{vnode:s,slots:i}=e;let a=!0,r=Ct.MZ;if(32&s.shapeFlag){const e=t._;e?n&&1===e?a=!1:((0,Ct.X$)(i,t),n||1!==e||delete i._):(a=!t.$stable,us(t,i)),r=t}else t&&(hs(e,t),r={default:1});if(a)for(const e in i)os(e)||null!=r[e]||delete i[e]};function ds(e,t,n,s,i=!1){if((0,Ct.cy)(e))return void e.forEach(((e,a)=>ds(e,t&&((0,Ct.cy)(t)?t[a]:t),n,s,i)));if(Ln(s)&&!i)return;const a=4&s.shapeFlag?Ri(s.component):s.el,r=i?null:a,{i:o,r:l}=e,c=t&&t.r,u=o.refs===Ct.MZ?o.refs={}:o.refs,h=o.setupState;if(null!=c&&c!==l&&((0,Ct.Kg)(c)?(u[c]=null,(0,Ct.$3)(h,c)&&(h[c]=null)):(0,Ot.i9)(c)&&(c.value=null)),(0,Ct.Tn)(l))At(l,o,12,[r,u]);else{const t=(0,Ct.Kg)(l),s=(0,Ot.i9)(l);if(t||s){const o=()=>{if(e.f){const n=t?(0,Ct.$3)(h,l)?h[l]:u[l]:l.value;i?(0,Ct.cy)(n)&&(0,Ct.TF)(n,a):(0,Ct.cy)(n)?n.includes(a)||n.push(a):t?(u[l]=[a],(0,Ct.$3)(h,l)&&(h[l]=u[l])):(l.value=[a],e.k&&(u[e.k]=l.value))}else t?(u[l]=r,(0,Ct.$3)(h,l)&&(h[l]=r)):s&&(l.value=r,e.k&&(u[e.k]=r))};r?(o.id=-1,gs(o,n)):o()}}}const gs=function(e,t){var n;t&&t.pendingBranch?(0,Ct.cy)(e)?t.effects.push(...e):t.effects.push(e):(n=e,(0,Ct.cy)(n)?Ft.push(...n):Vt&&Vt.includes(n,n.allowRecurse?Bt+1:Bt)||Ft.push(n),Kt())};function fs(e,t){"boolean"!=typeof __VUE_PROD_HYDRATION_MISMATCH_DETAILS__&&((0,Ct.We)().__VUE_PROD_HYDRATION_MISMATCH_DETAILS__=!1),(0,Ct.We)().__VUE__=!0;const{insert:n,remove:s,patchProp:i,createElement:a,createText:r,createComment:o,setText:l,setElementText:c,parentNode:u,nextSibling:h,setScopeId:p=Ct.tE,insertStaticContent:m}=e,d=(e,t,n,s=null,i=null,a=null,r=void 0,o=null,l=!!t.dynamicChildren)=>{if(e===t)return;e&&!oi(e,t)&&(s=F(e),R(e,i,a,!0),e=null),-2===t.patchFlag&&(l=!1,t.dynamicChildren=null);const{type:c,ref:u,shapeFlag:h}=t;switch(c){case Xs:g(e,t,n,s);break;case Ys:f(e,t,n,s);break;case Js:null==e&&y(t,n,s,r);break;case qs:I(e,t,n,s,i,a,r,o,l);break;default:1&h?v(e,t,n,s,i,a,r,o,l):6&h?x(e,t,n,s,i,a,r,o,l):(64&h||128&h)&&c.process(e,t,n,s,i,a,r,o,l,H)}null!=u&&i&&ds(u,e&&e.ref,a,t||e,!t)},g=(e,t,s,i)=>{if(null==e)n(t.el=r(t.children),s,i);else{const n=t.el=e.el;t.children!==e.children&&l(n,t.children)}},f=(e,t,s,i)=>{null==e?n(t.el=o(t.children||""),s,i):t.el=e.el},y=(e,t,n,s)=>{[e.el,e.anchor]=m(e.children,t,n,s,e.el,e.anchor)},v=(e,t,n,s,i,a,r,o,l)=>{"svg"===t.type?r="svg":"math"===t.type&&(r="mathml"),null==e?b(t,n,s,i,a,r,o,l):E(e,t,i,a,r,o,l)},b=(e,t,s,r,o,l,u,h)=>{let p,m;const{props:d,shapeFlag:g,transition:f,dirs:y}=e;if(p=e.el=a(e.type,l,d&&d.is,d),8&g?c(p,e.children):16&g&&w(e.children,p,null,r,o,ys(e,l),u,h),y&&Tn(e,null,r,"created"),_(p,e,e.scopeId,u,r),d){for(const t in d)"value"===t||(0,Ct.SU)(t)||i(p,t,null,d[t],l,e.children,r,o,D);"value"in d&&i(p,"value",null,d.value,l),(m=d.onVnodeBeforeMount)&&bi(m,r,e)}y&&Tn(e,null,r,"beforeMount");const v=function(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}(o,f);v&&f.beforeEnter(p),n(p,t,s),((m=d&&d.onVnodeMounted)||v||y)&&gs((()=>{m&&bi(m,r,e),v&&f.enter(p),y&&Tn(e,null,r,"mounted")}),o)},_=(e,t,n,s,i)=>{if(n&&p(e,n),s)for(let t=0;t<s.length;t++)p(e,s[t]);if(i&&t===i.subTree){const t=i.vnode;_(e,t,t.scopeId,t.slotScopeIds,i.parent)}},w=(e,t,n,s,i,a,r,o,l=0)=>{for(let c=l;c<e.length;c++){const l=e[c]=o?yi(e[c]):fi(e[c]);d(null,l,t,n,s,i,a,r,o)}},E=(e,t,n,s,a,r,o)=>{const l=t.el=e.el;let{patchFlag:u,dynamicChildren:h,dirs:p}=t;u|=16&e.patchFlag;const m=e.props||Ct.MZ,d=t.props||Ct.MZ;let g;if(n&&vs(n,!1),(g=d.onVnodeBeforeUpdate)&&bi(g,n,t,e),p&&Tn(t,e,n,"beforeUpdate"),n&&vs(n,!0),h?S(e.dynamicChildren,h,l,n,s,ys(t,a),r):o||O(e,t,l,null,n,s,ys(t,a),r,!1),u>0){if(16&u)k(l,t,m,d,n,s,a);else if(2&u&&m.class!==d.class&&i(l,"class",null,d.class,a),4&u&&i(l,"style",m.style,d.style,a),8&u){const r=t.dynamicProps;for(let t=0;t<r.length;t++){const o=r[t],c=m[o],u=d[o];u===c&&"value"!==o||i(l,o,c,u,a,e.children,n,s,D)}}1&u&&e.children!==t.children&&c(l,t.children)}else o||null!=h||k(l,t,m,d,n,s,a);((g=d.onVnodeUpdated)||p)&&gs((()=>{g&&bi(g,n,t,e),p&&Tn(t,e,n,"updated")}),s)},S=(e,t,n,s,i,a,r)=>{for(let o=0;o<t.length;o++){const l=e[o],c=t[o],h=l.el&&(l.type===qs||!oi(l,c)||70&l.shapeFlag)?u(l.el):n;d(l,c,h,null,s,i,a,r,!0)}},k=(e,t,n,s,a,r,o)=>{if(n!==s){if(n!==Ct.MZ)for(const l in n)(0,Ct.SU)(l)||l in s||i(e,l,n[l],null,o,t.children,a,r,D);for(const l in s){if((0,Ct.SU)(l))continue;const c=s[l],u=n[l];c!==u&&"value"!==l&&i(e,l,u,c,o,t.children,a,r,D)}"value"in s&&i(e,"value",n.value,s.value,o)}},I=(e,t,s,i,a,o,l,c,u)=>{const h=t.el=e?e.el:r(""),p=t.anchor=e?e.anchor:r("");let{patchFlag:m,dynamicChildren:d,slotScopeIds:g}=t;g&&(c=c?c.concat(g):g),null==e?(n(h,s,i),n(p,s,i),w(t.children||[],s,p,a,o,l,c,u)):m>0&&64&m&&d&&e.dynamicChildren?(S(e.dynamicChildren,d,s,a,o,l,c),(null!=t.key||a&&t===a.subTree)&&bs(e,t,!0)):O(e,t,s,p,a,o,l,c,u)},x=(e,t,n,s,i,a,r,o,l)=>{t.slotScopeIds=o,null==e?512&t.shapeFlag?i.ctx.activate(t,n,s,r,l):T(t,n,s,i,a,r,l):$(e,t,l)},T=(e,t,n,s,i,a,r)=>{const o=e.component=function(e,t,n){const s=e.type,i=(t?t.appContext:e.appContext)||_i,a={uid:wi++,vnode:e,type:s,parent:t,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,scope:new Ot.yC(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(i.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:ns(s,i),emitsOptions:en(s,i),emit:null,emitted:null,propsDefaults:Ct.MZ,inheritAttrs:s.inheritAttrs,ctx:Ct.MZ,data:Ct.MZ,props:Ct.MZ,attrs:Ct.MZ,slots:Ct.MZ,refs:Ct.MZ,setupState:Ct.MZ,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return a.ctx={_:a},a.root=t?t.root:a,a.emit=Qt.bind(null,a),e.ce&&e.ce(a),a}(e,s,i);if(Ns(e)&&(o.ctx.renderer=H),function(e,t=!1){t&&Ii(t);const{props:n,children:s}=e.vnode,i=$i(e);!function(e,t,n,s=!1){const i={},a=Zn();e.propsDefaults=Object.create(null),es(e,t,i,a);for(const t in e.propsOptions[0])t in i||(i[t]=void 0);n?e.props=s?i:(0,Ot.Gc)(i):e.type.props?e.props=i:e.props=a,e.attrs=a}(e,n,i,t),ps(e,s);const a=i?function(e,t){const n=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,An);const{setup:s}=n;if(s){const n=e.setupContext=s.length>1?function(e){const t=t=>{e.exposed=t||{}};return{attrs:new Proxy(e.attrs,Pi),slots:e.slots,emit:e.emit,expose:t}}(e):null,i=xi(e);(0,Ot.C4)();const a=At(s,e,0,[e.props,n]);if((0,Ot.bl)(),i(),(0,Ct.yL)(a)){if(a.then(Ti,Ti),t)return a.then((n=>{Ci(e,n,t)})).catch((t=>{Rt(t,e,0)}));e.asyncDep=a}else Ci(e,a,t)}else Ai(e,t)}(e,t):void 0;t&&Ii(!1)}(o),o.asyncDep){if(i&&i.registerDep(o,L,r),!e.el){const e=o.subTree=hi(Ys);f(null,e,t,n)}}else L(o,e,t,n,i,a,r)},$=(e,t,n)=>{const s=t.component=e.component;if(function(e,t,n){const{props:s,children:i,component:a}=e,{props:r,children:o,patchFlag:l}=t,c=a.emitsOptions;if(t.dirs||t.transition)return!0;if(!(n&&l>=0))return!(!i&&!o||o&&o.$stable)||s!==r&&(s?!r||cn(s,r,c):!!r);if(1024&l)return!0;if(16&l)return s?cn(s,r,c):!!r;if(8&l){const e=t.dynamicProps;for(let t=0;t<e.length;t++){const n=e[t];if(r[n]!==s[n]&&!tn(c,n))return!0}}return!1}(e,t,n)){if(s.asyncDep&&!s.asyncResolved)return void N(s,t,n);s.next=t,function(e){const t=jt.indexOf(e);t>Dt&&jt.splice(t,1)}(s.update),s.effect.dirty=!0,s.update()}else t.el=e.el,s.vnode=t},L=(e,t,n,s,i,a,r)=>{const o=()=>{if(e.isMounted){let{next:t,bu:n,u:s,parent:l,vnode:c}=e;{const n=_s(e);if(n)return t&&(t.el=c.el,N(e,t,r)),void n.asyncDep.then((()=>{e.isUnmounted||o()}))}let h,p=t;vs(e,!1),t?(t.el=c.el,N(e,t,r)):t=c,n&&(0,Ct.DY)(n),(h=t.props&&t.props.onVnodeBeforeUpdate)&&bi(h,l,t,c),vs(e,!0);const m=rn(e),g=e.subTree;e.subTree=m,d(g,m,u(g.el),F(g),e,i,a),t.el=m.el,null===p&&function({vnode:e,parent:t},n){for(;t;){const s=t.subTree;if(s.suspense&&s.suspense.activeBranch===e&&(s.el=e.el),s!==e)break;(e=t.vnode).el=n,t=t.parent}}(e,m.el),s&&gs(s,i),(h=t.props&&t.props.onVnodeUpdated)&&gs((()=>bi(h,l,t,c)),i)}else{let r;const{el:o,props:l}=t,{bm:c,m:u,parent:h}=e,p=Ln(t);if(vs(e,!1),c&&(0,Ct.DY)(c),!p&&(r=l&&l.onVnodeBeforeMount)&&bi(r,h,t),vs(e,!0),o&&G){const n=()=>{e.subTree=rn(e),G(o,e.subTree,e,i,null)};p?t.type.__asyncLoader().then((()=>!e.isUnmounted&&n())):n()}else{const r=e.subTree=rn(e);d(null,r,n,s,e,i,a),t.el=r.el}if(u&&gs(u,i),!p&&(r=l&&l.onVnodeMounted)){const e=t;gs((()=>bi(r,h,e)),i)}(256&t.shapeFlag||h&&Ln(h.vnode)&&256&h.vnode.shapeFlag)&&e.a&&gs(e.a,i),e.isMounted=!0,t=n=s=null}},l=e.effect=new Ot.X2(o,Ct.tE,(()=>Wt(c)),e.scope),c=e.update=()=>{l.dirty&&l.run()};c.id=e.uid,vs(e,!0),c()},N=(e,t,n)=>{t.component=e;const s=e.vnode.props;e.vnode=t,e.next=null,function(e,t,n,s){const{props:i,attrs:a,vnode:{patchFlag:r}}=e,o=(0,Ot.ux)(i),[l]=e.propsOptions;let c=!1;if(!(s||r>0)||16&r){let s;es(e,t,i,a)&&(c=!0);for(const a in o)t&&((0,Ct.$3)(t,a)||(s=(0,Ct.Tg)(a))!==a&&(0,Ct.$3)(t,s))||(l?!n||void 0===n[a]&&void 0===n[s]||(i[a]=ts(l,o,a,void 0,e,!0)):delete i[a]);if(a!==o)for(const e in a)t&&(0,Ct.$3)(t,e)||(delete a[e],c=!0)}else if(8&r){const n=e.vnode.dynamicProps;for(let s=0;s<n.length;s++){let r=n[s];if(tn(e.emitsOptions,r))continue;const u=t[r];if(l)if((0,Ct.$3)(a,r))u!==a[r]&&(a[r]=u,c=!0);else{const t=(0,Ct.PT)(r);i[t]=ts(l,o,t,u,e,!1)}else u!==a[r]&&(a[r]=u,c=!0)}}c&&(0,Ot.hZ)(e.attrs,"set","")}(e,t.props,s,n),ms(e,t.children,n),(0,Ot.C4)(),qt(e),(0,Ot.bl)()},O=(e,t,n,s,i,a,r,o,l=!1)=>{const u=e&&e.children,h=e?e.shapeFlag:0,p=t.children,{patchFlag:m,shapeFlag:d}=t;if(m>0){if(128&m)return void A(u,p,n,s,i,a,r,o,l);if(256&m)return void C(u,p,n,s,i,a,r,o,l)}8&d?(16&h&&D(u,i,a),p!==u&&c(n,p)):16&h?16&d?A(u,p,n,s,i,a,r,o,l):D(u,i,a,!0):(8&h&&c(n,""),16&d&&w(p,n,s,i,a,r,o,l))},C=(e,t,n,s,i,a,r,o,l)=>{e=e||Ct.Oj,t=t||Ct.Oj;const c=e.length,u=t.length,h=Math.min(c,u);let p;for(p=0;p<h;p++){const s=t[p]=l?yi(t[p]):fi(t[p]);d(e[p],s,n,null,i,a,r,o,l)}c>u?D(e,i,a,!0,!1,h):w(t,n,s,i,a,r,o,l,h)},A=(e,t,n,s,i,a,r,o,l)=>{let c=0;const u=t.length;let h=e.length-1,p=u-1;for(;c<=h&&c<=p;){const s=e[c],u=t[c]=l?yi(t[c]):fi(t[c]);if(!oi(s,u))break;d(s,u,n,null,i,a,r,o,l),c++}for(;c<=h&&c<=p;){const s=e[h],c=t[p]=l?yi(t[p]):fi(t[p]);if(!oi(s,c))break;d(s,c,n,null,i,a,r,o,l),h--,p--}if(c>h){if(c<=p){const e=p+1,h=e<u?t[e].el:s;for(;c<=p;)d(null,t[c]=l?yi(t[c]):fi(t[c]),n,h,i,a,r,o,l),c++}}else if(c>p)for(;c<=h;)R(e[c],i,a,!0),c++;else{const m=c,g=c,f=new Map;for(c=g;c<=p;c++){const e=t[c]=l?yi(t[c]):fi(t[c]);null!=e.key&&f.set(e.key,c)}let y,v=0;const b=p-g+1;let _=!1,w=0;const E=new Array(b);for(c=0;c<b;c++)E[c]=0;for(c=m;c<=h;c++){const s=e[c];if(v>=b){R(s,i,a,!0);continue}let u;if(null!=s.key)u=f.get(s.key);else for(y=g;y<=p;y++)if(0===E[y-g]&&oi(s,t[y])){u=y;break}void 0===u?R(s,i,a,!0):(E[u-g]=c+1,u>=w?w=u:_=!0,d(s,t[u],n,null,i,a,r,o,l),v++)}const S=_?function(e){const t=e.slice(),n=[0];let s,i,a,r,o;const l=e.length;for(s=0;s<l;s++){const l=e[s];if(0!==l){if(i=n[n.length-1],e[i]<l){t[s]=i,n.push(s);continue}for(a=0,r=n.length-1;a<r;)o=a+r>>1,e[n[o]]<l?a=o+1:r=o;l<e[n[a]]&&(a>0&&(t[s]=n[a-1]),n[a]=s)}}for(a=n.length,r=n[a-1];a-- >0;)n[a]=r,r=t[r];return n}(E):Ct.Oj;for(y=S.length-1,c=b-1;c>=0;c--){const e=g+c,h=t[e],p=e+1<u?t[e+1].el:s;0===E[c]?d(null,h,n,p,i,a,r,o,l):_&&(y<0||c!==S[y]?P(h,n,p,2):y--)}}},P=(e,t,s,i,a=null)=>{const{el:r,type:o,transition:l,children:c,shapeFlag:u}=e;if(6&u)P(e.component.subTree,t,s,i);else if(128&u)e.suspense.move(t,s,i);else if(64&u)o.move(e,t,s,H);else if(o!==qs)if(o!==Js)if(2!==i&&1&u&&l)if(0===i)l.beforeEnter(r),n(r,t,s),gs((()=>l.enter(r)),a);else{const{leave:e,delayLeave:i,afterLeave:a}=l,o=()=>n(r,t,s),c=()=>{e(r,(()=>{o(),a&&a()}))};i?i(r,o,c):c()}else n(r,t,s);else(({el:e,anchor:t},s,i)=>{let a;for(;e&&e!==t;)a=h(e),n(e,s,i),e=a;n(t,s,i)})(e,t,s);else{n(r,t,s);for(let e=0;e<c.length;e++)P(c[e],t,s,i);n(e.anchor,t,s)}},R=(e,t,n,s=!1,i=!1)=>{const{type:a,props:r,ref:o,children:l,dynamicChildren:c,shapeFlag:u,patchFlag:h,dirs:p,memoIndex:m}=e;if(-2===h&&(i=!1),null!=o&&ds(o,null,n,e,!0),null!=m&&(t.renderCache[m]=void 0),256&u)return void t.ctx.deactivate(e);const d=1&u&&p,g=!Ln(e);let f;if(g&&(f=r&&r.onVnodeBeforeUnmount)&&bi(f,t,e),6&u)j(e.component,n,s);else{if(128&u)return void e.suspense.unmount(n,s);d&&Tn(e,null,t,"beforeUnmount"),64&u?e.type.remove(e,t,n,H,s):c&&(a!==qs||h>0&&64&h)?D(c,t,n,!1,!0):(a===qs&&384&h||!i&&16&u)&&D(l,t,n),s&&M(e)}(g&&(f=r&&r.onVnodeUnmounted)||d)&&gs((()=>{f&&bi(f,t,e),d&&Tn(e,null,t,"unmounted")}),n)},M=e=>{const{type:t,el:n,anchor:i,transition:a}=e;if(t===qs)return void U(n,i);if(t===Js)return void(({el:e,anchor:t})=>{let n;for(;e&&e!==t;)n=h(e),s(e),e=n;s(t)})(e);const r=()=>{s(n),a&&!a.persisted&&a.afterLeave&&a.afterLeave()};if(1&e.shapeFlag&&a&&!a.persisted){const{leave:t,delayLeave:s}=a,i=()=>t(n,r);s?s(e.el,r,i):i()}else r()},U=(e,t)=>{let n;for(;e!==t;)n=h(e),s(e),e=n;s(t)},j=(e,t,n)=>{const{bum:s,scope:i,update:a,subTree:r,um:o,m:l,a:c}=e;ws(l),ws(c),s&&(0,Ct.DY)(s),i.stop(),a&&(a.active=!1,R(r,e,t,n)),o&&gs(o,t),gs((()=>{e.isUnmounted=!0}),t),t&&t.pendingBranch&&!t.isUnmounted&&e.asyncDep&&!e.asyncResolved&&e.suspenseId===t.pendingId&&(t.deps--,0===t.deps&&t.resolve())},D=(e,t,n,s=!1,i=!1,a=0)=>{for(let r=a;r<e.length;r++)R(e[r],t,n,s,i)},F=e=>6&e.shapeFlag?F(e.component.subTree):128&e.shapeFlag?e.suspense.next():h(e.anchor||e.el);let V=!1;const B=(e,t,n)=>{null==e?t._vnode&&R(t._vnode,null,null,!0):d(t._vnode||null,e,t,null,null,null,n),V||(V=!0,qt(),Xt(),V=!1),t._vnode=e},H={p:d,um:R,m:P,r:M,mt:T,mc:w,pc:O,pbc:S,n:F,o:e};let z,G;return t&&([z,G]=t(H)),{render:B,hydrate:z,createApp:qn(B,z)}}function ys({type:e,props:t},n){return"svg"===n&&"foreignObject"===e||"mathml"===n&&"annotation-xml"===e&&t&&t.encoding&&t.encoding.includes("html")?void 0:n}function vs({effect:e,update:t},n){e.allowRecurse=t.allowRecurse=n}function bs(e,t,n=!1){const s=e.children,i=t.children;if((0,Ct.cy)(s)&&(0,Ct.cy)(i))for(let e=0;e<s.length;e++){const t=s[e];let a=i[e];1&a.shapeFlag&&!a.dynamicChildren&&((a.patchFlag<=0||32===a.patchFlag)&&(a=i[e]=yi(i[e]),a.el=t.el),n||-2===a.patchFlag||bs(t,a)),a.type===Xs&&(a.el=t.el)}}function _s(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:_s(t)}function ws(e){if(e)for(let t=0;t<e.length;t++)e[t].active=!1}const Es=Symbol.for("v-scx"),Ss=()=>Yn(Es),ks={};function Is(e,t,n){return xs(e,t,n)}function xs(e,t,{immediate:n,deep:s,flush:i,once:a,onTrack:r,onTrigger:o}=Ct.MZ){if(t&&a){const e=t;t=(...t)=>{e(...t),w()}}const l=Ei,c=e=>!0===s?e:Ls(e,!1===s?1:void 0);let u,h,p=!1,m=!1;if((0,Ot.i9)(e)?(u=()=>e.value,p=(0,Ot.fE)(e)):(0,Ot.g8)(e)?(u=()=>c(e),p=!0):(0,Ct.cy)(e)?(m=!0,p=e.some((e=>(0,Ot.g8)(e)||(0,Ot.fE)(e))),u=()=>e.map((e=>(0,Ot.i9)(e)?e.value:(0,Ot.g8)(e)?c(e):(0,Ct.Tn)(e)?At(e,l,2):void 0))):u=(0,Ct.Tn)(e)?t?()=>At(e,l,2):()=>(h&&h(),Pt(e,l,3,[g])):Ct.tE,t&&s){const e=u;u=()=>Ls(e())}let d,g=e=>{h=b.onStop=()=>{At(e,l,4),h=b.onStop=void 0}};if(Oi){if(g=Ct.tE,t?n&&Pt(t,l,3,[u(),m?[]:void 0,g]):u(),"sync"!==i)return Ct.tE;{const e=Ss();d=e.__watcherHandles||(e.__watcherHandles=[])}}let f=m?new Array(e.length).fill(ks):ks;const y=()=>{if(b.active&&b.dirty)if(t){const e=b.run();(s||p||(m?e.some(((e,t)=>(0,Ct.$H)(e,f[t]))):(0,Ct.$H)(e,f)))&&(h&&h(),Pt(t,l,3,[e,f===ks?void 0:m&&f[0]===ks?[]:f,g]),f=e)}else b.run()};let v;y.allowRecurse=!!t,"sync"===i?v=y:"post"===i?v=()=>gs(y,l&&l.suspense):(y.pre=!0,l&&(y.id=l.uid),v=()=>Wt(y));const b=new Ot.X2(u,Ct.tE,v),_=(0,Ot.o5)(),w=()=>{b.stop(),_&&(0,Ct.TF)(_.effects,b)};return t?n?y():f=b.run():"post"===i?gs(b.run.bind(b),l&&l.suspense):b.run(),d&&d.push(w),w}function Ts(e,t,n){const s=this.proxy,i=(0,Ct.Kg)(e)?e.includes(".")?$s(s,e):()=>s[e]:e.bind(s,s);let a;(0,Ct.Tn)(t)?a=t:(a=t.handler,n=t);const r=xi(this),o=xs(i,a.bind(s),n);return r(),o}function $s(e,t){const n=t.split(".");return()=>{let t=e;for(let e=0;e<n.length&&t;e++)t=t[n[e]];return t}}function Ls(e,t=1/0,n){if(t<=0||!(0,Ct.Gv)(e)||e.__v_skip)return e;if((n=n||new Set).has(e))return e;if(n.add(e),t--,(0,Ot.i9)(e))Ls(e.value,t,n);else if((0,Ct.cy)(e))for(let s=0;s<e.length;s++)Ls(e[s],t,n);else if((0,Ct.vM)(e)||(0,Ct.CE)(e))e.forEach((e=>{Ls(e,t,n)}));else if((0,Ct.Qd)(e)){for(const s in e)Ls(e[s],t,n);for(const s of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,s)&&Ls(e[s],t,n)}return e}const Ns=e=>e.type.__isKeepAlive;function Os(e,t){As(e,"a",t)}function Cs(e,t){As(e,"da",t)}function As(e,t,n=Ei){const s=e.__wdc||(e.__wdc=()=>{let t=n;for(;t;){if(t.isDeactivated)return;t=t.parent}return e()});if(dn(t,s,n),n){let e=n.parent;for(;e&&e.parent;)Ns(e.parent.vnode)&&Ps(s,t,n,e),e=e.parent}}function Ps(e,t,n,s){const i=dn(t,e,s,!0);wn((()=>{(0,Ct.TF)(s[t],i)}),n)}RegExp,RegExp;const Rs=Symbol("_leaveCb"),Ms=Symbol("_enterCb");const Us=[Function,Array],js={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Us,onEnter:Us,onAfterEnter:Us,onEnterCancelled:Us,onBeforeLeave:Us,onLeave:Us,onAfterLeave:Us,onLeaveCancelled:Us,onBeforeAppear:Us,onAppear:Us,onAfterAppear:Us,onAppearCancelled:Us},Ds=e=>{const t=e.subTree;return t.component?Ds(t.component):t},Fs={name:"BaseTransition",props:js,setup(e,{slots:t}){const n=Si(),s=function(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return yn((()=>{e.isMounted=!0})),_n((()=>{e.isUnmounting=!0})),e}();return()=>{const i=t.default&&Ks(t.default(),!0);if(!i||!i.length)return;let a=i[0];if(i.length>1){let e=!1;for(const t of i)if(t.type!==Ys){a=t,e=!0;break}}const r=(0,Ot.ux)(e),{mode:o}=r;if(s.isLeaving)return zs(a);const l=Gs(a);if(!l)return zs(a);let c=Hs(l,r,s,n,(e=>c=e));Ws(l,c);const u=n.subTree,h=u&&Gs(u);if(h&&h.type!==Ys&&!oi(l,h)&&Ds(n).type!==Ys){const e=Hs(h,r,s,n);if(Ws(h,e),"out-in"===o&&l.type!==Ys)return s.isLeaving=!0,e.afterLeave=()=>{s.isLeaving=!1,!1!==n.update.active&&(n.effect.dirty=!0,n.update())},zs(a);"in-out"===o&&l.type!==Ys&&(e.delayLeave=(e,t,n)=>{Bs(s,h)[String(h.key)]=h,e[Rs]=()=>{t(),e[Rs]=void 0,delete c.delayedLeave},c.delayedLeave=n})}return a}}},Vs=Fs;function Bs(e,t){const{leavingVNodes:n}=e;let s=n.get(t.type);return s||(s=Object.create(null),n.set(t.type,s)),s}function Hs(e,t,n,s,i){const{appear:a,mode:r,persisted:o=!1,onBeforeEnter:l,onEnter:c,onAfterEnter:u,onEnterCancelled:h,onBeforeLeave:p,onLeave:m,onAfterLeave:d,onLeaveCancelled:g,onBeforeAppear:f,onAppear:y,onAfterAppear:v,onAppearCancelled:b}=t,_=String(e.key),w=Bs(n,e),E=(e,t)=>{e&&Pt(e,s,9,t)},S=(e,t)=>{const n=t[1];E(e,t),(0,Ct.cy)(e)?e.every((e=>e.length<=1))&&n():e.length<=1&&n()},k={mode:r,persisted:o,beforeEnter(t){let s=l;if(!n.isMounted){if(!a)return;s=f||l}t[Rs]&&t[Rs](!0);const i=w[_];i&&oi(e,i)&&i.el[Rs]&&i.el[Rs](),E(s,[t])},enter(e){let t=c,s=u,i=h;if(!n.isMounted){if(!a)return;t=y||c,s=v||u,i=b||h}let r=!1;const o=e[Ms]=t=>{r||(r=!0,E(t?i:s,[e]),k.delayedLeave&&k.delayedLeave(),e[Ms]=void 0)};t?S(t,[e,o]):o()},leave(t,s){const i=String(e.key);if(t[Ms]&&t[Ms](!0),n.isUnmounting)return s();E(p,[t]);let a=!1;const r=t[Rs]=n=>{a||(a=!0,s(),E(n?g:d,[t]),t[Rs]=void 0,w[i]===e&&delete w[i])};w[i]=e,m?S(m,[t,r]):r()},clone(e){const a=Hs(e,t,n,s,i);return i&&i(a),a}};return k}function zs(e){if(Ns(e))return(e=pi(e)).children=null,e}function Gs(e){if(!Ns(e))return e;const{shapeFlag:t,children:n}=e;if(n){if(16&t)return n[0];if(32&t&&(0,Ct.Tn)(n.default))return n.default()}}function Ws(e,t){6&e.shapeFlag&&e.component?Ws(e.component.subTree,t):128&e.shapeFlag?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function Ks(e,t=!1,n){let s=[],i=0;for(let a=0;a<e.length;a++){let r=e[a];const o=null==n?r.key:String(n)+String(null!=r.key?r.key:a);r.type===qs?(128&r.patchFlag&&i++,s=s.concat(Ks(r.children,t,o))):(t||r.type!==Ys)&&s.push(null!=o?pi(r,{key:o}):r)}if(i>1)for(let e=0;e<s.length;e++)s[e].patchFlag=-2;return s}const qs=Symbol.for("v-fgt"),Xs=Symbol.for("v-txt"),Ys=Symbol.for("v-cmt"),Js=Symbol.for("v-stc"),Zs=[];let Qs=null;function ei(e=!1){Zs.push(Qs=e?null:[])}let ti=1;function ni(e){ti+=e}function si(e){return e.dynamicChildren=ti>0?Qs||Ct.Oj:null,Zs.pop(),Qs=Zs[Zs.length-1]||null,ti>0&&Qs&&Qs.push(e),e}function ii(e,t,n,s,i,a){return si(ui(e,t,n,s,i,a,!0))}function ai(e,t,n,s,i){return si(hi(e,t,n,s,i,!0))}function ri(e){return!!e&&!0===e.__v_isVNode}function oi(e,t){return e.type===t.type&&e.key===t.key}const li=({key:e})=>null!=e?e:null,ci=({ref:e,ref_key:t,ref_for:n})=>("number"==typeof e&&(e=""+e),null!=e?(0,Ct.Kg)(e)||(0,Ot.i9)(e)||(0,Ct.Tn)(e)?{i:nn,r:e,k:t,f:!!n}:e:null);function ui(e,t=null,n=null,s=0,i=null,a=(e===qs?0:1),r=!1,o=!1){const l={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&li(t),ref:t&&ci(t),scopeId:sn,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:a,patchFlag:s,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:nn};return o?(vi(l,n),128&a&&e.normalize(l)):n&&(l.shapeFlag|=(0,Ct.Kg)(n)?8:16),ti>0&&!r&&Qs&&(l.patchFlag>0||6&a)&&32!==l.patchFlag&&Qs.push(l),l}const hi=function(e,t=null,n=null,s=0,i=null,a=!1){if(e&&e!==pn||(e=Ys),ri(e)){const s=pi(e,t,!0);return n&&vi(s,n),ti>0&&!a&&Qs&&(6&s.shapeFlag?Qs[Qs.indexOf(e)]=s:Qs.push(s)),s.patchFlag=-2,s}if(function(e){return(0,Ct.Tn)(e)&&"__vccOpts"in e}(e)&&(e=e.__vccOpts),t){t=function(e){return e?(0,Ot.ju)(e)||Qn(e)?(0,Ct.X$)({},e):e:null}(t);let{class:e,style:n}=t;e&&!(0,Ct.Kg)(e)&&(t.class=(0,Ct.C4)(e)),(0,Ct.Gv)(n)&&((0,Ot.ju)(n)&&!(0,Ct.cy)(n)&&(n=(0,Ct.X$)({},n)),t.style=(0,Ct.Tr)(n))}return ui(e,t,n,s,i,(0,Ct.Kg)(e)?1:(e=>e.__isSuspense)(e)?128:(e=>e.__isTeleport)(e)?64:(0,Ct.Gv)(e)?4:(0,Ct.Tn)(e)?2:0,a,!0)};function pi(e,t,n=!1,s=!1){const{props:i,ref:a,patchFlag:r,children:o,transition:l}=e,c=t?function(...e){const t={};for(let n=0;n<e.length;n++){const s=e[n];for(const e in s)if("class"===e)t.class!==s.class&&(t.class=(0,Ct.C4)([t.class,s.class]));else if("style"===e)t.style=(0,Ct.Tr)([t.style,s.style]);else if((0,Ct.Mp)(e)){const n=t[e],i=s[e];!i||n===i||(0,Ct.cy)(n)&&n.includes(i)||(t[e]=n?[].concat(n,i):i)}else""!==e&&(t[e]=s[e])}return t}(i||{},t):i,u={__v_isVNode:!0,__v_skip:!0,type:e.type,props:c,key:c&&li(c),ref:t&&t.ref?n&&a?(0,Ct.cy)(a)?a.concat(ci(t)):[a,ci(t)]:ci(t):a,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:o,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==qs?-1===r?16:16|r:r,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:l,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&pi(e.ssContent),ssFallback:e.ssFallback&&pi(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return l&&s&&Ws(u,l.clone(u)),u}function mi(e=" ",t=0){return hi(Xs,null,e,t)}function di(e,t){const n=hi(Js,null,e);return n.staticCount=t,n}function gi(e="",t=!1){return t?(ei(),ai(Ys,null,e)):hi(Ys,null,e)}function fi(e){return null==e||"boolean"==typeof e?hi(Ys):(0,Ct.cy)(e)?hi(qs,null,e.slice()):"object"==typeof e?yi(e):hi(Xs,null,String(e))}function yi(e){return null===e.el&&-1!==e.patchFlag||e.memo?e:pi(e)}function vi(e,t){let n=0;const{shapeFlag:s}=e;if(null==t)t=null;else if((0,Ct.cy)(t))n=16;else if("object"==typeof t){if(65&s){const n=t.default;return void(n&&(n._c&&(n._d=!1),vi(e,n()),n._c&&(n._d=!0)))}{n=32;const s=t._;s||Qn(t)?3===s&&nn&&(1===nn.slots._?t._=1:(t._=2,e.patchFlag|=1024)):t._ctx=nn}}else(0,Ct.Tn)(t)?(t={default:t,_ctx:nn},n=32):(t=String(t),64&s?(n=16,t=[mi(t)]):n=8);e.children=t,e.shapeFlag|=n}function bi(e,t,n,s=null){Pt(e,t,7,[n,s])}const _i=Wn();let wi=0;let Ei=null;const Si=()=>Ei||nn;let ki,Ii;{const e=(0,Ct.We)(),t=(t,n)=>{let s;return(s=e[t])||(s=e[t]=[]),s.push(n),e=>{s.length>1?s.forEach((t=>t(e))):s[0](e)}};ki=t("__VUE_INSTANCE_SETTERS__",(e=>Ei=e)),Ii=t("__VUE_SSR_SETTERS__",(e=>Oi=e))}const xi=e=>{const t=Ei;return ki(e),e.scope.on(),()=>{e.scope.off(),ki(t)}},Ti=()=>{Ei&&Ei.scope.off(),ki(null)};function $i(e){return 4&e.vnode.shapeFlag}let Li,Ni,Oi=!1;function Ci(e,t,n){(0,Ct.Tn)(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:(0,Ct.Gv)(t)&&(e.setupState=(0,Ot.Pr)(t)),Ai(e,n)}function Ai(e,t,n){const s=e.type;if(!e.render){if(!t&&Li&&!s.render){const t=s.template||jn(e).template;if(t){const{isCustomElement:n,compilerOptions:i}=e.appContext.config,{delimiters:a,compilerOptions:r}=s,o=(0,Ct.X$)((0,Ct.X$)({isCustomElement:n,delimiters:a},i),r);s.render=Li(t,o)}}e.render=s.render||Ct.tE,Ni&&Ni(e)}{const t=xi(e);(0,Ot.C4)();try{!function(e){const t=jn(e),n=e.proxy,s=e.ctx;Rn=!1,t.beforeCreate&&Mn(t.beforeCreate,e,"bc");const{data:i,computed:a,methods:r,watch:o,provide:l,inject:c,created:u,beforeMount:h,mounted:p,beforeUpdate:m,updated:d,activated:g,deactivated:f,beforeDestroy:y,beforeUnmount:v,destroyed:b,unmounted:_,render:w,renderTracked:E,renderTriggered:S,errorCaptured:k,serverPrefetch:I,expose:x,inheritAttrs:T,components:$,directives:L,filters:N}=t;if(c&&function(e,t,n=Ct.tE){(0,Ct.cy)(e)&&(e=Bn(e));for(const n in e){const s=e[n];let i;i=(0,Ct.Gv)(s)?"default"in s?Yn(s.from||n,s.default,!0):Yn(s.from||n):Yn(s),(0,Ot.i9)(i)?Object.defineProperty(t,n,{enumerable:!0,configurable:!0,get:()=>i.value,set:e=>i.value=e}):t[n]=i}}(c,s,null),r)for(const e in r){const t=r[e];(0,Ct.Tn)(t)&&(s[e]=t.bind(n))}if(i){const t=i.call(n,n);(0,Ct.Gv)(t)&&(e.data=(0,Ot.Kh)(t))}if(Rn=!0,a)for(const e in a){const t=a[e],i=(0,Ct.Tn)(t)?t.bind(n,n):(0,Ct.Tn)(t.get)?t.get.bind(n,n):Ct.tE,r=!(0,Ct.Tn)(t)&&(0,Ct.Tn)(t.set)?t.set.bind(n):Ct.tE,o=Mi({get:i,set:r});Object.defineProperty(s,e,{enumerable:!0,configurable:!0,get:()=>o.value,set:e=>o.value=e})}if(o)for(const e in o)Un(o[e],s,n,e);if(l){const e=(0,Ct.Tn)(l)?l.call(n):l;Reflect.ownKeys(e).forEach((t=>{!function(e,t){if(Ei){let n=Ei.provides;const s=Ei.parent&&Ei.parent.provides;s===n&&(n=Ei.provides=Object.create(s)),n[e]=t}}(t,e[t])}))}function O(e,t){(0,Ct.cy)(t)?t.forEach((t=>e(t.bind(n)))):t&&e(t.bind(n))}if(u&&Mn(u,e,"c"),O(fn,h),O(yn,p),O(vn,m),O(bn,d),O(Os,g),O(Cs,f),O(In,k),O(kn,E),O(Sn,S),O(_n,v),O(wn,_),O(En,I),(0,Ct.cy)(x))if(x.length){const t=e.exposed||(e.exposed={});x.forEach((e=>{Object.defineProperty(t,e,{get:()=>n[e],set:t=>n[e]=t})}))}else e.exposed||(e.exposed={});w&&e.render===Ct.tE&&(e.render=w),null!=T&&(e.inheritAttrs=T),$&&(e.components=$),L&&(e.directives=L)}(e)}finally{(0,Ot.bl)(),t()}}}const Pi={get:(e,t)=>((0,Ot.u4)(e,"get",""),e[t])};function Ri(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy((0,Ot.Pr)((0,Ot.IG)(e.exposed)),{get:(t,n)=>n in t?t[n]:n in On?On[n](e):void 0,has:(e,t)=>t in e||t in On})):e.proxy}const Mi=(e,t)=>(0,Ot.EW)(e,t,Oi),Ui="3.4.30",ji="undefined"!=typeof document?document:null,Di=ji&&ji.createElement("template"),Fi={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,s)=>{const i="svg"===t?ji.createElementNS("http://www.w3.org/2000/svg",e):"mathml"===t?ji.createElementNS("http://www.w3.org/1998/Math/MathML",e):n?ji.createElement(e,{is:n}):ji.createElement(e);return"select"===e&&s&&null!=s.multiple&&i.setAttribute("multiple",s.multiple),i},createText:e=>ji.createTextNode(e),createComment:e=>ji.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>ji.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,n,s,i,a){const r=n?n.previousSibling:t.lastChild;if(i&&(i===a||i.nextSibling))for(;t.insertBefore(i.cloneNode(!0),n),i!==a&&(i=i.nextSibling););else{Di.innerHTML="svg"===s?`<svg>${e}</svg>`:"mathml"===s?`<math>${e}</math>`:e;const i=Di.content;if("svg"===s||"mathml"===s){const e=i.firstChild;for(;e.firstChild;)i.appendChild(e.firstChild);i.removeChild(e)}t.insertBefore(i,n)}return[r?r.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}},Vi="transition",Bi="animation",Hi=Symbol("_vtc"),zi=(e,{slots:t})=>function(e,t,n){const s=arguments.length;return 2===s?(0,Ct.Gv)(t)&&!(0,Ct.cy)(t)?ri(t)?hi(e,null,[t]):hi(e,t):hi(e,null,t):(s>3?n=Array.prototype.slice.call(arguments,2):3===s&&ri(n)&&(n=[n]),hi(e,t,n))}(Vs,function(e){const t={};for(const n in e)n in Gi||(t[n]=e[n]);if(!1===e.css)return t;const{name:n="v",type:s,duration:i,enterFromClass:a=`${n}-enter-from`,enterActiveClass:r=`${n}-enter-active`,enterToClass:o=`${n}-enter-to`,appearFromClass:l=a,appearActiveClass:c=r,appearToClass:u=o,leaveFromClass:h=`${n}-leave-from`,leaveActiveClass:p=`${n}-leave-active`,leaveToClass:m=`${n}-leave-to`}=e,d=function(e){if(null==e)return null;if((0,Ct.Gv)(e))return[qi(e.enter),qi(e.leave)];{const t=qi(e);return[t,t]}}(i),g=d&&d[0],f=d&&d[1],{onBeforeEnter:y,onEnter:v,onEnterCancelled:b,onLeave:_,onLeaveCancelled:w,onBeforeAppear:E=y,onAppear:S=v,onAppearCancelled:k=b}=t,I=(e,t,n)=>{Yi(e,t?u:o),Yi(e,t?c:r),n&&n()},x=(e,t)=>{e._isLeaving=!1,Yi(e,h),Yi(e,m),Yi(e,p),t&&t()},T=e=>(t,n)=>{const i=e?S:v,r=()=>I(t,e,n);Wi(i,[t,r]),Ji((()=>{Yi(t,e?l:a),Xi(t,e?u:o),Ki(i)||Qi(t,s,g,r)}))};return(0,Ct.X$)(t,{onBeforeEnter(e){Wi(y,[e]),Xi(e,a),Xi(e,r)},onBeforeAppear(e){Wi(E,[e]),Xi(e,l),Xi(e,c)},onEnter:T(!1),onAppear:T(!0),onLeave(e,t){e._isLeaving=!0;const n=()=>x(e,t);Xi(e,h),Xi(e,p),document.body.offsetHeight,Ji((()=>{e._isLeaving&&(Yi(e,h),Xi(e,m),Ki(_)||Qi(e,s,f,n))})),Wi(_,[e,n])},onEnterCancelled(e){I(e,!1),Wi(b,[e])},onAppearCancelled(e){I(e,!0),Wi(k,[e])},onLeaveCancelled(e){x(e),Wi(w,[e])}})}(e),t);zi.displayName="Transition";const Gi={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},Wi=(zi.props=(0,Ct.X$)({},js,Gi),(e,t=[])=>{(0,Ct.cy)(e)?e.forEach((e=>e(...t))):e&&e(...t)}),Ki=e=>!!e&&((0,Ct.cy)(e)?e.some((e=>e.length>1)):e.length>1);function qi(e){return(0,Ct.Ro)(e)}function Xi(e,t){t.split(/\s+/).forEach((t=>t&&e.classList.add(t))),(e[Hi]||(e[Hi]=new Set)).add(t)}function Yi(e,t){t.split(/\s+/).forEach((t=>t&&e.classList.remove(t)));const n=e[Hi];n&&(n.delete(t),n.size||(e[Hi]=void 0))}function Ji(e){requestAnimationFrame((()=>{requestAnimationFrame(e)}))}let Zi=0;function Qi(e,t,n,s){const i=e._endId=++Zi,a=()=>{i===e._endId&&s()};if(n)return setTimeout(a,n);const{type:r,timeout:o,propCount:l}=function(e,t){const n=window.getComputedStyle(e),s=e=>(n[e]||"").split(", "),i=s(`${Vi}Delay`),a=s(`${Vi}Duration`),r=ea(i,a),o=s(`${Bi}Delay`),l=s(`${Bi}Duration`),c=ea(o,l);let u=null,h=0,p=0;return t===Vi?r>0&&(u=Vi,h=r,p=a.length):t===Bi?c>0&&(u=Bi,h=c,p=l.length):(h=Math.max(r,c),u=h>0?r>c?Vi:Bi:null,p=u?u===Vi?a.length:l.length:0),{type:u,timeout:h,propCount:p,hasTransform:u===Vi&&/\b(transform|all)(,|$)/.test(s(`${Vi}Property`).toString())}}(e,t);if(!r)return s();const c=r+"end";let u=0;const h=()=>{e.removeEventListener(c,p),a()},p=t=>{t.target===e&&++u>=l&&h()};setTimeout((()=>{u<l&&h()}),o+1),e.addEventListener(c,p)}function ea(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map(((t,n)=>ta(t)+ta(e[n]))))}function ta(e){return"auto"===e?0:1e3*Number(e.slice(0,-1).replace(",","."))}const na=Symbol("_vod"),sa=Symbol("_vsh"),ia={beforeMount(e,{value:t},{transition:n}){e[na]="none"===e.style.display?"":e.style.display,n&&t?n.beforeEnter(e):aa(e,t)},mounted(e,{value:t},{transition:n}){n&&t&&n.enter(e)},updated(e,{value:t,oldValue:n},{transition:s}){!t!=!n&&(s?t?(s.beforeEnter(e),aa(e,!0),s.enter(e)):s.leave(e,(()=>{aa(e,!1)})):aa(e,t))},beforeUnmount(e,{value:t}){aa(e,t)}};function aa(e,t){e.style.display=t?e[na]:"none",e[sa]=!t}const ra=Symbol(""),oa=/(^|;)\s*display\s*:/,la=/\s*!important$/;function ca(e,t,n){if((0,Ct.cy)(n))n.forEach((n=>ca(e,t,n)));else if(null==n&&(n=""),t.startsWith("--"))e.setProperty(t,n);else{const s=function(e,t){const n=ha[t];if(n)return n;let s=(0,Ct.PT)(t);if("filter"!==s&&s in e)return ha[t]=s;s=(0,Ct.ZH)(s);for(let n=0;n<ua.length;n++){const i=ua[n]+s;if(i in e)return ha[t]=i}return t}(e,t);la.test(n)?e.setProperty((0,Ct.Tg)(s),n.replace(la,""),"important"):e[s]=n}}const ua=["Webkit","Moz","ms"],ha={},pa="http://www.w3.org/1999/xlink";function ma(e,t,n,s,i,a=(0,Ct.J$)(t)){s&&t.startsWith("xlink:")?null==n?e.removeAttributeNS(pa,t.slice(6,t.length)):e.setAttributeNS(pa,t,n):null==n||a&&!(0,Ct.Y2)(n)?e.removeAttribute(t):e.setAttribute(t,a?"":(0,Ct.Bm)(n)?String(n):n)}function da(e,t,n,s){e.addEventListener(t,n,s)}const ga=Symbol("_vei");const fa=/(?:Once|Passive|Capture)$/;let ya=0;const va=Promise.resolve(),ba=()=>ya||(va.then((()=>ya=0)),ya=Date.now()),_a=e=>111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123;"undefined"!=typeof HTMLElement&&HTMLElement,Symbol("_moveCb"),Symbol("_enterCb");const wa=e=>{const t=e.props["onUpdate:modelValue"]||!1;return(0,Ct.cy)(t)?e=>(0,Ct.DY)(t,e):t};function Ea(e){e.target.composing=!0}function Sa(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const ka=Symbol("_assign"),Ia={created(e,{modifiers:{lazy:t,trim:n,number:s}},i){e[ka]=wa(i);const a=s||i.props&&"number"===i.props.type;da(e,t?"change":"input",(t=>{if(t.target.composing)return;let s=e.value;n&&(s=s.trim()),a&&(s=(0,Ct.bB)(s)),e[ka](s)})),n&&da(e,"change",(()=>{e.value=e.value.trim()})),t||(da(e,"compositionstart",Ea),da(e,"compositionend",Sa),da(e,"change",Sa))},mounted(e,{value:t}){e.value=null==t?"":t},beforeUpdate(e,{value:t,oldValue:n,modifiers:{lazy:s,trim:i,number:a}},r){if(e[ka]=wa(r),e.composing)return;const o=null==t?"":t;if((!a&&"number"!==e.type||/^0\d/.test(e.value)?e.value:(0,Ct.bB)(e.value))!==o){if(document.activeElement===e&&"range"!==e.type){if(s&&t===n)return;if(i&&e.value.trim()===o)return}e.value=o}}},xa={deep:!0,created(e,t,n){e[ka]=wa(n),da(e,"change",(()=>{const t=e._modelValue,n=Oa(e),s=e.checked,i=e[ka];if((0,Ct.cy)(t)){const e=(0,Ct.u3)(t,n),a=-1!==e;if(s&&!a)i(t.concat(n));else if(!s&&a){const n=[...t];n.splice(e,1),i(n)}}else if((0,Ct.vM)(t)){const e=new Set(t);s?e.add(n):e.delete(n),i(e)}else i(Ca(e,s))}))},mounted:Ta,beforeUpdate(e,t,n){e[ka]=wa(n),Ta(e,t,n)}};function Ta(e,{value:t,oldValue:n},s){e._modelValue=t,(0,Ct.cy)(t)?e.checked=(0,Ct.u3)(t,s.props.value)>-1:(0,Ct.vM)(t)?e.checked=t.has(s.props.value):t!==n&&(e.checked=(0,Ct.BX)(t,Ca(e,!0)))}const $a={created(e,{value:t},n){e.checked=(0,Ct.BX)(t,n.props.value),e[ka]=wa(n),da(e,"change",(()=>{e[ka](Oa(e))}))},beforeUpdate(e,{value:t,oldValue:n},s){e[ka]=wa(s),t!==n&&(e.checked=(0,Ct.BX)(t,s.props.value))}},La={deep:!0,created(e,{value:t,modifiers:{number:n}},s){const i=(0,Ct.vM)(t);da(e,"change",(()=>{const t=Array.prototype.filter.call(e.options,(e=>e.selected)).map((e=>n?(0,Ct.bB)(Oa(e)):Oa(e)));e[ka](e.multiple?i?new Set(t):t:t[0]),e._assigning=!0,Gt((()=>{e._assigning=!1}))})),e[ka]=wa(s)},mounted(e,{value:t,modifiers:{number:n}}){Na(e,t)},beforeUpdate(e,t,n){e[ka]=wa(n)},updated(e,{value:t,modifiers:{number:n}}){e._assigning||Na(e,t)}};function Na(e,t,n){const s=e.multiple,i=(0,Ct.cy)(t);if(!s||i||(0,Ct.vM)(t)){for(let n=0,a=e.options.length;n<a;n++){const a=e.options[n],r=Oa(a);if(s)if(i){const e=typeof r;a.selected="string"===e||"number"===e?t.some((e=>String(e)===String(r))):(0,Ct.u3)(t,r)>-1}else a.selected=t.has(r);else if((0,Ct.BX)(Oa(a),t))return void(e.selectedIndex!==n&&(e.selectedIndex=n))}s||-1===e.selectedIndex||(e.selectedIndex=-1)}}function Oa(e){return"_value"in e?e._value:e.value}function Ca(e,t){const n=t?"_trueValue":"_falseValue";return n in e?e[n]:t}const Aa={created(e,t,n){Pa(e,t,n,null,"created")},mounted(e,t,n){Pa(e,t,n,null,"mounted")},beforeUpdate(e,t,n,s){Pa(e,t,n,s,"beforeUpdate")},updated(e,t,n,s){Pa(e,t,n,s,"updated")}};function Pa(e,t,n,s,i){const a=function(e,t){switch(e){case"SELECT":return La;case"TEXTAREA":return Ia;default:switch(t){case"checkbox":return xa;case"radio":return $a;default:return Ia}}}(e.tagName,n.props&&n.props.type)[i];a&&a(e,t,n,s)}const Ra=(0,Ct.X$)({patchProp:(e,t,n,s,i,a,r,o,l)=>{const c="svg"===i;"class"===t?function(e,t,n){const s=e[Hi];s&&(t=(t?[t,...s]:[...s]).join(" ")),null==t?e.removeAttribute("class"):n?e.setAttribute("class",t):e.className=t}(e,s,c):"style"===t?function(e,t,n){const s=e.style,i=(0,Ct.Kg)(n);let a=!1;if(n&&!i){if(t)if((0,Ct.Kg)(t))for(const e of t.split(";")){const t=e.slice(0,e.indexOf(":")).trim();null==n[t]&&ca(s,t,"")}else for(const e in t)null==n[e]&&ca(s,e,"");for(const e in n)"display"===e&&(a=!0),ca(s,e,n[e])}else if(i){if(t!==n){const e=s[ra];e&&(n+=";"+e),s.cssText=n,a=oa.test(n)}}else t&&e.removeAttribute("style");na in e&&(e[na]=a?s.display:"",e[sa]&&(s.display="none"))}(e,n,s):(0,Ct.Mp)(t)?(0,Ct.CP)(t)||function(e,t,n,s,i=null){const a=e[ga]||(e[ga]={}),r=a[t];if(s&&r)r.value=s;else{const[n,o]=function(e){let t;if(fa.test(e)){let n;for(t={};n=e.match(fa);)e=e.slice(0,e.length-n[0].length),t[n[0].toLowerCase()]=!0}return[":"===e[2]?e.slice(3):(0,Ct.Tg)(e.slice(2)),t]}(t);if(s){const r=a[t]=function(e,t){const n=e=>{if(e._vts){if(e._vts<=n.attached)return}else e._vts=Date.now();Pt(function(e,t){if((0,Ct.cy)(t)){const n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map((e=>t=>!t._stopped&&e&&e(t)))}return t}(e,n.value),t,5,[e])};return n.value=e,n.attached=ba(),n}(s,i);da(e,n,r,o)}else r&&(function(e,t,n,s){e.removeEventListener(t,n,s)}(e,n,r,o),a[t]=void 0)}}(e,t,0,s,r):("."===t[0]?(t=t.slice(1),1):"^"===t[0]?(t=t.slice(1),0):function(e,t,n,s){if(s)return"innerHTML"===t||"textContent"===t||!!(t in e&&_a(t)&&(0,Ct.Tn)(n));if("spellcheck"===t||"draggable"===t||"translate"===t)return!1;if("form"===t)return!1;if("list"===t&&"INPUT"===e.tagName)return!1;if("type"===t&&"TEXTAREA"===e.tagName)return!1;if("width"===t||"height"===t){const t=e.tagName;if("IMG"===t||"VIDEO"===t||"CANVAS"===t||"SOURCE"===t)return!1}return(!_a(t)||!(0,Ct.Kg)(n))&&t in e}(e,t,s,c))?(function(e,t,n,s,i,a,r){if("innerHTML"===t||"textContent"===t)return s&&r(s,i,a),void(e[t]=null==n?"":n);const o=e.tagName;if("value"===t&&"PROGRESS"!==o&&!o.includes("-")){const s="OPTION"===o?e.getAttribute("value")||"":e.value,i=null==n?"":String(n);return s===i&&"_value"in e||(e.value=i),null==n&&e.removeAttribute(t),void(e._value=n)}let l=!1;if(""===n||null==n){const s=typeof e[t];"boolean"===s?n=(0,Ct.Y2)(n):null==n&&"string"===s?(n="",l=!0):"number"===s&&(n=0,l=!0)}try{e[t]=n}catch(e){}l&&e.removeAttribute(t)}(e,t,s,a,r,o,l),e.tagName.includes("-")||"value"!==t&&"checked"!==t&&"selected"!==t||ma(e,t,s,c,0,"value"!==t)):("true-value"===t?e._trueValue=s:"false-value"===t&&(e._falseValue=s),ma(e,t,s,c))}},Fi);let Ma;var Ua=n(42838);function ja(){return Ua()}const Da={install(e,t={},n=ja){e.directive("dompurify-html",function(e={},t=ja){const n=t();!function(e,t){const n=e.hooks??{};let s;for(s in n){const e=n[s];void 0!==e&&t.addHook(s,e)}}(e,n);const s=function(t,s){const i=s.value;if(s.oldValue===i)return;const a=`${i}`,r=s.arg,o=e.namedConfigurations,l=e.default??{};t.innerHTML=o&&void 0!==r?n.sanitize(a,o[r]??l):n.sanitize(a,l)};return{mounted:s,updated:s}}(t,n))}};var Fa=n(13647);function Va(e,t,n){const s=((...e)=>{const t=(Ma||(Ma=fs(Ra))).createApp(...e),{mount:n}=t;return t.mount=e=>{const s=function(e){return(0,Ct.Kg)(e)?document.querySelector(e):e}(e);if(!s)return;const i=t._component;(0,Ct.Tn)(i)||i.render||i.template||(i.template=s.innerHTML),s.innerHTML="";const a=n(s,!1,function(e){return e instanceof SVGElement?"svg":"function"==typeof MathMLElement&&e instanceof MathMLElement?"mathml":void 0}(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),a},t})(e);s.use(Da,{default:{ADD_ATTR:["target"]},namedConfigurations:{noMedia:{FORBID_TAGS:["img","svg","picture","video","audio"]}}}),n&&n.use&&n.use(s);let i="string"==typeof t?document.querySelector(t):t;if(!i)throw new Error("Can't find root element");if(n&&n.shadowDom){let e;i.shadowRoot?(e=i.shadowRoot,e.innerHTML=""):e=i.attachShadow({mode:"open"}),i=e.appendChild(document.createElement("div"))}const a={};return s.mixin({beforeCreate(){this.$options.styles&&!a[this.$options.__file]&&(i.appendChild(function(e,t=""){const n=document.createElement("style");n.type="text/css",n.setAttribute("data-name",t);const s=document.createTextNode(e);return n.appendChild(s),n}(this.$options.styles.join("\n"),this.$options.__file)),a[this.$options.__file]=!0)},methods:{lang:Fa.storage.lang,getOption:e=>Fa.settings.get(e)}}),s.directive("visible",((e,t)=>{e.style.visibility=t.value?"visible":"hidden"})),s.mount(i)}var Ba=n(25721);const Ha={apiCall:G,logger:n(78584).m("MAL Search"),type:"anime"},za=async function(e,t,n={},s=!1){if(Ha.type=t,(e=e.trim()).length>64&&(e=e.substr(0,64)),!e)return[];if(e.length<3)throw new Error("Search term must be at least 3 characters long");return Ha.apiCall({type:"GET",path:`${t}?q=${e}&limit=15&nsfw=true`,fields:["start_date","mean","alternative_titles","media_type","num_episodes","num_chapters"]}).then((e=>{const n=[];return e.data.forEach((function(e){let s=[e.node.title];e.node.alternative_titles&&(e.node.alternative_titles.en&&s.push(e.node.alternative_titles.en),e.node.alternative_titles.ja&&s.push(e.node.alternative_titles.ja),e.node.alternative_titles.synonyms&&(s=s.concat(e.node.alternative_titles.synonyms))),n.push({id:e.node.id,name:e.node.title,altNames:s,url:`https://myanimelist.net/${t}/${e.node.id}`,malUrl:()=>`https://myanimelist.net/${t}/${e.node.id}`,image:e.node.main_picture?.medium??"",imageLarge:e.node.main_picture?.large||e.node.main_picture?.medium||"",media_type:e.node.media_type?(e.node.media_type.charAt(0)+e.node.media_type.slice(1).toLowerCase()).replace("_"," "):"",isNovel:e.node.media_type.toLowerCase().includes("novel"),score:e.node.mean,year:e.node.start_date,totalEp:e.node.num_episodes||e.node.num_chapters||0})})),Ha.logger.log(n),n}))},Ga=za;var Wa=n(78584),Ka=n(7263);var qa=n(78584);var Xa=n(78584),Ya=n(7263),Ja=n(13647),Za=n(26017);async function Qa(e,t={},n=!1,s="GET",i=!0){n&&(e+=`?${Ya.$.param(t)}`),Xa.log("call",s,e,t);const a={Authorization:i?`Bearer ${Ja.settings.get("simklToken")}`:void 0,"simkl-api-key":Pe,Accept:"application/vnd.api+json","Content-Type":"application/json"};return i||Xa.log("No login"),"GET"===s&&(t=void 0),Ja.request.xhr(s,{url:e,headers:a,data:t}).then((async a=>{switch(a.status){case 200:case 201:case 204:case 302:break;case 401:if(i)return Qa(e,t,n,s,!1);throw Za.flashm(`Please Authenticate <a target="_blank" href="${Re()}">Here</a>`,{error:!0,type:"error"}),o();default:throw Za.flashm(`Simkl: ${r()}`,{error:!0,type:"error"}),o()}try{return P(a.responseText)}catch(e){throw Xa.error(a),e}function r(){return P(a.responseText).error}function o(){return new Error(r())}}))}function er(e,n,s={},i=!1,a=""){return a||(a=t(n)),"KITSU"===a?async function(e,t,n={},s=!1){return we("GET",`https://kitsu.app/api/edge/${t}?filter[text]=${e}&page[limit]=20&page[offset]=0&fields[${t}]=id,slug,titles,averageRating,startDate,posterImage,coverImage,subtype,${"anime"===t?"episodeCount":"chapterCount"}`,{}).then((e=>{qa.log("search",e);const n=[];return e.data.forEach((function(e){n.push({id:Number(e.id),name:_e(e.attributes.titles,e.attributes.canonicalTitle),altNames:Object.values(e.attributes.titles),url:`https://kitsu.app/${t}/${e.attributes.slug}`,malUrl:async()=>{const n=await function(e,t){return ye.request.xhr("GET",{url:`https://kitsu.app/api/edge/${t}/${e}/mappings?filter[externalSite]=myanimelist/${t}`,headers:{"Content-Type":"application/vnd.api+json",Accept:"application/vnd.api+json"}}).then((e=>{const t=JSON.parse(e.responseText);return fe.log("[KtoM]",t),void 0!==t.data&&t.data.length?Number(t.data[0].attributes.externalId):null}))}(e.id,t);return n?`https://myanimelist.net/${t}/${n}`:null},image:e.attributes.posterImage&&e.attributes.posterImage.small?e.attributes.posterImage.small:"",imageLarge:e.attributes.posterImage&&e.attributes.posterImage.original?e.attributes.posterImage.original:"",imageBanner:e.attributes.coverImage&&e.attributes.coverImage.large?e.attributes.coverImage.large:"",media_type:e.attributes.subtype,isNovel:"novel"===e.attributes.subtype,score:e.attributes.averageRating,year:e.attributes.startDate,totalEp:e.attributes.episodeCount||e.attributes.chapterCount||0})})),n}))}(e,n,s,i):"ANILIST"===a?async function(e,t,n={},s=!1){const i=`\n    query ($search: String) {\n      ${t}: Page (perPage: 25) {\n        pageInfo {\n          total\n        }\n        results: media (type: ${t.toUpperCase()}, search: $search) {\n          id\n          siteUrl\n          idMal\n          episodes\n          chapters\n          title {\n            userPreferred\n            romaji\n            english\n            native\n          }\n          coverImage {\n            large\n            extraLarge\n          }\n          bannerImage\n          type\n          format\n          averageScore\n          startDate {\n            year\n          }\n          synonyms\n        }\n      }\n    }\n  `,a={search:e},r=await J(i,a,!1);Wa.log(r);const o=[];return Ka.$.each(r.data[t].results,(function(e,n){o.push({id:n.id,name:n.title.userPreferred,altNames:Object.values(n.title).concat(n.synonyms),url:n.siteUrl,malUrl:()=>n.idMal?`https://myanimelist.net/${t}/${n.idMal}`:null,image:Z(n.coverImage.large),imageLarge:Z(n.coverImage.extraLarge),imageBanner:Z(n.bannerImage),media_type:n.format?(n.format.charAt(0)+n.format.slice(1).toLowerCase()).replace("_"," "):"",isNovel:"NOVEL"===n.format,score:n.averageScore,year:n.startDate.year,totalEp:n.episodes||n.chapters||0})})),o}(e,n,s,i):"SIMKL"===a?async function(e,t,n={},s=!1){return Qa(`https://api.simkl.com/search/${t}`,{q:e},!0).then((e=>{const n=[];return Xa.log("search",e),Ya.$.each(e,(function(e,s){n.push({id:s.ids.simkl_id,name:s.title,altNames:[],url:`https://simkl.com/${t}/${s.ids.simkl_id}/${s.ids.slug}`,malUrl:async()=>{const e=await(n=s.ids.simkl_id,Qa(`https://api.simkl.com/anime/${n}`,{extended:"full"},!0).then((e=>void 0===e.ids.mal?null:e.ids.mal)));var n;return e?`https://myanimelist.net/${t}/${e}`:null},image:`https://simkl.in/posters/${s.poster}_ca.jpg`,imageLarge:`https://simkl.in/posters/${s.poster}_m.jpg`,imageBanner:`https://simkl.in/posters/${s.poster}_w.jpg`,media_type:s.type,isNovel:!1,score:null,year:s.year})})),n}))}(e,n,s,i):"SHIKI"===a?async function(e,t,n={},s=!1){return(await Je({path:`${t}s`,parameter:{limit:25,search:e},type:"GET"})).map((e=>({id:e.id,name:Qe(e.russian,e.name),altNames:[e.name,e.russian].filter((e=>e)),url:Ye+e.url,malUrl:()=>Promise.resolve(e.id?`https://myanimelist.net/${t}/${e.id}`:null),image:Ye+e.image.preview,imageLarge:Ye+e.image.original,media_type:e.kind,isNovel:"light_novel"===e.kind,score:Number(e.score)?e.score:"",year:e.aired_on,totalEp:e.episodes||e.chapters||0})))}(e,n,s,i):"MALAPI"===a?za(e,n,s,i):Ga(e,n,s,i)}var tr=n(78584),nr=n(13647),sr=n(26017);class ir{constructor(e,t){return this.cacheKey=e,this.type=t,this.logger=tr.m("Rules"),this}async init(){if(this.state=await this.getCache(),!this.state||"firebase"===this.state.provider&&this.state.updated&&this.state.updated+6048e5<(new Date).getTime()){const e=await this.api();e&&(this.state=e)}return this.logger.m("Result").log(this.state),this.state&&await this.setCache(this.state),this}getRules(){return this.state&&this.state.rules&&this.state.rules.length?this.state.rules:[]}async api(){const e=this.logger.m("API");try{if("anime"!==this.type)return void e.info("Only supports anime");if(String(this.cacheKey).startsWith("simkl:"))return void e.info("Simkl is not supported");const t=`https://api.malsync.moe/rules/${this.cacheKey}`;e.log(t);const n=await nr.request.xhr("GET",t);e.log("Response",n);const s=JSON.parse(n.responseText);return{provider:"firebase",updated:(new Date).getTime(),last_modified:s.last_modified,rules:s.rules.map((e=>({from:{title:e.from.title,url:sr.pageUrl(s.page,this.type,e.from.id),start:e.from.start,end:e.from.end},to:{title:e.to.title,url:sr.pageUrl(s.page,this.type,e.to.id),start:e.to.start,end:e.to.end}})))}}catch(t){return void e.error(t)}}async getCache(){return nr.storage.get(`${this.type}/${this.cacheKey}/Rules`).then((e=>(e&&(e.cache=!0),e)))}setCache(e){return e=JSON.parse(JSON.stringify(e)),nr.storage.set(`${this.type}/${this.cacheKey}/Rules`,e)}applyRules(e,t){const n=this.logger.m("apply");this.activeRule=void 0,t||(t=this.getRules()),n.log(e,t);const s=t.find((t=>t.from.start<=e&&t.from.end>=e));if(s)return n.log("Rule found",s),this.activeRule=s,{url:s.to.url,offset:s.to.start-s.from.start};if(t.length>1){const s=t.find((t=>t.from.url===t.to.url&&e>t.from.end));if(s){const i=s.to.start-s.from.start,a=e+i;n.log("Self Rule",s,a,i);const r=this.applyRules(a,t.filter((e=>e.from.url!==e.to.url)));if(r)return r.offset+=i,r}}}}var ar=n(78584),rr=n(13647),or=n(26017);class lr{constructor(e,t,n){this.title=e,this.type=t,this.identifier=n,this.localUrl="",this.state=!1,this.changed=!1,this.identifier+="",this.sanitizedTitel=this.sanitizeTitel(this.title),this.logger=ar.m("search","red")}setPage(e){this.page=e}setLocalUrl(e){this.localUrl=e}setSyncPage(e){this.syncPage=e}getSyncPage(){return this.syncPage}getUrl(){return this.state?this.state.url:null}setUrl(e,t=0){this.state?(this.state.url!==e&&(this.changed=!0),this.state.provider="user",this.state.url=e,this.state.id=t,this.state.cache=!1,this.state.similarity={same:!0,value:1}):(this.changed=!0,this.state={id:t,url:e,offset:0,provider:"user",similarity:{same:!0,value:1}}),this.setCache(this.state)}getOffset(){return this.state&&this.state.offset?this.state.offset:0}setOffset(e){this.state&&(this.state.offset!==e&&(this.changed=!0),this.state.offset=e),this.setCache(this.state)}async getCachedOffset(){return this.state=await this.getCache(),this.state?this.state.offset:0}getId(){return this.state&&this.state.id?this.state.id:0}getSanitizedTitel(){return this.sanitizedTitel}getNormalizedType(){return"anime"===this.type?"anime":"manga"}sanitizeTitel(e){let t=e.replace(/ *(\(dub\)|\(sub\)|\(uncensored\)|\(uncut\)|\(subbed\)|\(dubbed\))/i,"");return t=t.replace(/ *\([^)]+audio\)/i,""),t=t.replace(/ BD( |$)/i,""),t=t.trim(),t=t.substring(0,99),t}async search(){if(this.state=await this.getCache(),this.state||(this.state=await this.searchLocal()),this.state||(this.state=await this.searchForIt()),!this.state||this.state&&!["user","firebase","sync","local"].includes(this.state.provider)){const e=await this.onsiteSearch();e&&(this.state=e)}return this.state&&await this.setCache(this.state),this.logger.log("Result",this.state),this.state}async getCache(){return rr.storage.get(`${this.page.name}/${this.identifier}/Search`).then((e=>(e&&(e.cache=!0),e)))}setCache(e){return e=JSON.parse(JSON.stringify(e)),setTimeout((()=>{this.databaseRequest()}),200),rr.storage.set(`${this.page.name}/${this.identifier}/Search`,e)}static similarity(e,t,n=[]){let s=(0,Ba.compareTwoStrings)(t.toLowerCase(),e.toLowerCase());n.forEach((e=>{if(e){const n=(0,Ba.compareTwoStrings)(t.toLowerCase(),e.toLowerCase());n>s&&(s=n)}}));let i=!1;return s>.6&&(i=!0),{same:i,value:s}}async searchLocal(){if(!this.localUrl)return!1;const e=new ot(this.localUrl);return await e.update(),!!e.isOnList()&&(this.logger.m("Local").log("On List"),{url:"",offset:0,provider:"local",similarity:{same:!0,value:1}})}async searchForIt(){let e=!1;try{e=t(e,await this.malSync())}catch(e){this.page&&this.page.database&&this.logger.error("MALSync api error or not supported",e)}if(e&&"firebase"!==e.provider||!e)try{e=t(e,await this.malSearch())}catch(e){this.logger.m(e)}if(e&&"firebase"!==e.provider||!e)try{e=t(e,await this.pageSearch(),.5)}catch(e){this.logger.m(e)}if(e&&"firebase"===e.provider&&"MAL"!==rr.settings.get("syncMode")&&!e.url)try{const t=await this.pageSearch();t&&!or.isDomainMatching(t.url,"myanimelist.net")&&t.similarity.same&&(this.logger.log("Ignore Firebase",e),e=t)}catch(e){this.logger.m(e)}return e;function t(e,t,n=0){return!1!==e&&!1!==t&&t.similarity.value>n?e.similarity.value>=t.similarity.value?e:t:!1!==e?e:t}}async firebase(){if(!this.page||!this.page.database)return!1;const e=this.logger.m("Firebase"),t=`https://kissanimelist.firebaseio.com/Data2/${this.page.database}/${encodeURIComponent(this.identifierToDbKey(this.identifier)).toLowerCase()}/Mal.json`;e.log(t);const n=await rr.request.xhr("GET",t);if(e.log("response",n.responseText),!n.responseText||"null"===n.responseText||n.responseText.includes("error"))return!1;let s;try{s=JSON.parse(n.responseText)}catch(t){return e.info("Parse failed"),!1}if(!s||0===Object.keys(s).length)return!1;const i=Object.keys(s)[0];let a="";return"Not-Found"!==i&&(a=`https://myanimelist.net/${this.page.type}/${i}`),{url:a,offset:0,provider:"firebase",similarity:{same:!0,value:1}}}async malSync(){const e=this.logger.m("API");if(!this.page)return!1;const n=this.page.database;if(!n)return!1;const s=`https://api.malsync.moe/page/${n}/${encodeURIComponent(this.identifierToDbKey(this.identifier)).toLowerCase()}`;e.log(s);const i=await rr.request.xhr("GET",s);if(e.log("Response",i),400!==i.status&&200!==i.status)throw new Error("malsync offline");if(400===i.status&&i.responseText?.includes("error"))return!1;const a=JSON.parse(i.responseText);let r=a.malUrl;return!r&&a.aniUrl&&"ANILIST"===t(this.getNormalizedType())&&(r=a.aniUrl),{url:r,offset:0,provider:"firebase",similarity:{same:!0,value:1}}}async malSearch(){const e=this.logger.m("MAL");let t=`https://myanimelist.net/${this.getNormalizedType()}.php?q=${encodeURI(this.sanitizedTitel)}`;"novel"===this.type&&(t=`https://myanimelist.net/${this.getNormalizedType()}.php?type=2&q=${encodeURI(this.sanitizedTitel)}`),e.log(t);const n=await rr.request.xhr("GET",t);return!(!n||n.responseText?.includes("  error "))&&!(!n||n.responseText?.includes("No titles that matched"))&&function t(n,s,i){const a=function(t,n){try{return t.responseText.split('<a class="hoverinfo_trigger" href="')[n].split('"')[0]}catch(s){e.error(s);try{return t.responseText.split('class="picSurround')[n].split("<a")[1].split('href="')[1].split('"')[0]}catch(t){return e.error(t),!1}}}(n,s);let r=0,o={same:!1,value:0};if(!1!==a)try{if("manga"===i.type&&-1!==n.responseText.split(`href="${a}" id="si`)[1].split("</tr>")[0].indexOf("Novel"))return e.log("Novel Found check next entry"),t(n,s+1,i);const l=function(t,n){try{const e=n.split("/")[4];return t.responseText.split(`rel="#sinfo${e}"><strong>`)[1].split("<")[0]}catch(t){return e.error(t),""}}(n,a);o=lr.similarity(l,i.sanitizedTitel),r=parseInt(a.split("/")[4])}catch(t){e.error(t)}return{id:r,url:a,offset:0,provider:"mal",similarity:o}}(n,1,this)}async pageSearch(){const e=await er(this.sanitizedTitel,this.getNormalizedType());let t=null;for(let n=0;n<e.length&&n<5;n++){const s=e[n],i=lr.similarity(s.name,this.sanitizedTitel,s.altNames),a={index:n,similarity:i};("manga"===this.type&&!s.isNovel||"novel"===this.type&&s.isNovel||"anime"===this.type)&&(!t||i.value>t.similarity.value)&&(t=a)}if(t){const n=e[t.index],s=await n.malUrl();return{id:n.id,url:s||n.url,offset:0,provider:"page",similarity:t.similarity}}return!1}async databaseRequest(){const e=this.logger.m("DB Request");if(this.page&&this.page.database&&this.syncPage&&this.state){if(this.state.cache)return;if("user"===this.state.provider&&!this.changed)return;if("firebase"===this.state.provider)return;if("local"===this.state.provider)return;let t;if(!t)if(this.page.isSyncPage(this.syncPage.url))t=this.page.sync.getOverviewUrl(this.syncPage.url),"Crunchyroll"===this.page.database&&(t=`${this.syncPage.url}`);else{if("Crunchyroll"===this.page.database)return void e.log("CR block");t=this.syncPage.url}const n={pageUrl:t,malUrl:this.state.url,correction:!1,page:this.page.database};if("user"===this.state.provider){if(!await or.flashConfirm(rr.storage.lang("correction_DBRequest"),"dbrequest",(()=>{}),(()=>{}),!0))return;n.correction=!0}const s="https://api.malsync.moe/corrections";rr.request.xhr("POST",{url:s,data:JSON.stringify(n),headers:{"Content-Type":"application/json"}}).then((t=>{try{const n=JSON.parse(t.responseText);if(n.error)throw n;e.log("Send to database:",n)}catch(t){e.error("Send to database:",t)}}))}}async onsiteSearch(){if(this.page&&this.syncPage&&this.syncPage.curState&&this.syncPage.curState.on){let e=!1;if("OVERVIEW"===this.syncPage.curState.on?this.page.overview&&this.page.overview.getMalUrl&&(e=await this.page.overview.getMalUrl(rr.settings.get("syncMode"))):this.page.sync&&this.page.sync.getMalUrl&&(e=await this.page.sync.getMalUrl(rr.settings.get("syncMode"))),e)return this.logger.m("Onsite").log("[SEARCH]","Overwrite by onsite url",e),{url:e,offset:0,provider:"sync",similarity:{same:!0,value:1}}}return!1}openCorrection(){}identifierToDbKey(e){return"Crunchyroll"===this.page.database?encodeURIComponent(e.toLowerCase().split("#")[0]).replace(/\./g,"%2E"):"MangaFire"===this.page.database?encodeURIComponent(e.toLowerCase().split("#")[0]):e.toLowerCase().split("#")[0].replace(/\./g,"%2E")}async initRules(){const e=ar.m("Rules"),t=this.getUrl();if(e.log("Url",t),t){const n=await async function(e){const t=new u(`rulesCacheKey/${e}`,6048e5);if(await t.hasValue())return t.getValue().then((e=>({rulesCacheKey:e})));const n=lt(e);return await n.update(),t.setValue(n.getRulesCacheKey()),{rulesCacheKey:n.getRulesCacheKey(),singleObj:n}}(t);return e.log("Cachekey",n),this.rules=await new ir(n.rulesCacheKey,this.getNormalizedType()).init(),n.singleObj}}applyRules(e){if(this.rules){const t=this.getOffset()||0,n=this.rules.applyRules(Number(e)+Number(t));return n&&(n.offset=Number(n.offset)+Number(t)),n}}getRuledOffset(e){const t=this.applyRules(e);return t?t.offset:this.getOffset()}getRuledUrl(e){const t=this.applyRules(e);return t?t.url:this.getUrl()}}const cr={key:0,id:"material"},ur={class:"m-s-pill-section"},hr={class:"m-s-pill"},pr={href:"https://malsync.moe/pwa/#/settings",target:"_blank"},mr={key:0},dr={key:1,class:"scroll"},gr={key:3,id:"offsetUi"},fr={class:"mdl-color--primary top"},yr=di('<div class="offsetBox"><div class="mdl-color--primary top">...</div><div class="bottom">...</div></div><div class="offsetBox"><div class="mdl-color--primary top"></div><div class="bottom"></div></div>',2),vr={class:"search"},br={class:"input"},_r={class:"group"},wr=ui("span",{class:"bar"},null,-1),Er={class:"loadingBar"},Sr={class:"mdl-progress mdl-js-progress mdl-progress__indeterminate",style:{width:"100%"}},kr=[ui("div",{class:"progressbar bar bar1",style:{width:"0%"}},null,-1),ui("div",{class:"bufferbar bar bar2",style:{width:"100%"}},null,-1),ui("div",{class:"auxbar bar bar3",style:{width:"0%"}},null,-1)],Ir={key:0,class:"results"},xr=ui("div",{class:"image"},null,-1),Tr={class:"right"},$r={class:"title"},Lr=["href","onClick"],Nr={class:"image"},Or=["src"],Cr={class:"right"},Ar={class:"title"},Pr={key:0},Rr={key:1},Mr={key:0},Ur={key:1},jr={key:2};var Dr=n(13647),Fr=n(13647),Vr=n(26017);let Br;const Hr={components:{},props:{type:{type:String,default:"anime"},keyword:{type:String,default:""},syncMode:{type:Boolean,default:!1},currentId:{type:Number,default:0}},data:()=>({items:[],loading:!1,searchKeyword:""}),watch:{keyword(){this.searchKeyword=this.keyword,this.load()},searchKeyword(){clearTimeout(Br),Br=setTimeout((()=>{this.load()}),200)},type(){this.load()}},mounted(){this.syncMode&&(this.searchKeyword=this.keyword,this.load())},methods:{lang:Fr.storage.lang,getStatusText:Vr.getStatusText,episodeText:Vr.episode,load(){this.searchKeyword&&(this.loading=!0,async function(e,t){return er(e,t).then((e=>Promise.all(e.map((async e=>{const n=await Dr.request.database("entry",{id:e.id,type:t});return n&&(e.list={status:n.status,score:n.score,episode:n.watchedEp}),e})))))}(this.searchKeyword,this.type).then((e=>{this.loading=!1,this.items=e,this.$nextTick((()=>{this.$el.scrollIntoView({behavior:"smooth"})}))})))},inputFocus(){this.searchKeyword||(this.searchKeyword=this.keyword)},async clickItem(e,t){if(e.preventDefault(),!t)return void this.$emit("clicked",{url:"",id:0});const n=await t.malUrl();n?this.$emit("clicked",{url:n,id:t.id}):this.$emit("clicked",{url:t.url,id:t.id})}}};var zr=n(66262);const Gr=(0,zr.A)(Hr,[["render",function(e,t,n,s,i,a){return ei(),ii("div",vr,[ui("div",br,[ui("div",_r,[xn(ui("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>i.searchKeyword=e),type:"text",required:"",onFocus:t[1]||(t[1]=e=>a.inputFocus())},null,544),[[Ia,i.searchKeyword]]),wr,ui("label",null,(0,Ct.v_)(a.lang("correction_Search")),1)])]),ui("div",Er,[xn(ui("div",Sr,kr,512),[[ia,i.loading]])]),i.searchKeyword?(ei(),ii("div",Ir,[ui("a",{class:"result",href:"",style:{cursor:"pointer"},onClick:t[2]||(t[2]=e=>a.clickItem(e,""))},[xr,ui("div",Tr,[ui("span",$r,(0,Ct.v_)(a.lang("correction_NoEntry")),1),ui("p",null,(0,Ct.v_)(a.lang("correction_NoMal")),1)])]),(ei(!0),ii(qs,null,$n(i.items,(e=>(ei(),ii("a",{key:e.id,class:(0,Ct.C4)(["result",{active:n.currentId===e.id,onList:e.list}]),href:e.url,onClick:t=>a.clickItem(t,e)},[ui("div",Nr,[ui("img",{src:e.image},null,8,Or)]),ui("div",Cr,[ui("span",Ar,(0,Ct.v_)(e.name),1),e.list?(ei(),ii(qs,{key:0},[ui("p",null,(0,Ct.v_)(a.lang("UI_Status"))+" "+(0,Ct.v_)(a.getStatusText(n.type,e.list.status)),1),e.list.score?(ei(),ii("p",Pr,(0,Ct.v_)(a.lang("UI_Score"))+" "+(0,Ct.v_)(e.list.score),1)):1===e.list.status?(ei(),ii("p",Rr,(0,Ct.v_)(a.episodeText(n.type))+" "+(0,Ct.v_)(e.list.episode),1)):gi("v-if",!0)],64)):(ei(),ii(qs,{key:1},[e.media_type?(ei(),ii("p",Mr,(0,Ct.v_)(a.lang("search_Type"))+" "+(0,Ct.v_)(e.media_type),1)):gi("v-if",!0),e.score?(ei(),ii("p",Ur,(0,Ct.v_)(a.lang("search_Score"))+" "+(0,Ct.v_)(e.score),1)):gi("v-if",!0),e.year?(ei(),ii("p",jr,(0,Ct.v_)(a.lang("search_Year"))+" "+(0,Ct.v_)(e.year),1)):gi("v-if",!0)],64))])],10,Lr)))),128))])):gi("v-if",!0)])}],["__file","search.vue"]]),Wr={class:"inputButton"},Kr={class:"group"},qr=["type"],Xr=ui("span",{class:"bar"},null,-1);var Yr=n(13647);const Jr={props:{state:{type:[String,Number],default:""},type:{type:String,default:""},label:{type:String,default:""}},data:()=>({inputString:""}),watch:{state(){this.inputString=this.state},inputString(){this.$emit("changed",this.inputString)}},mounted(){this.inputString=this.state},methods:{lang:Yr.storage.lang,click(){this.$emit("clicked",this.inputString)}}},Zr=(0,zr.A)(Jr,[["render",function(e,t,n,s,i,a){return ei(),ii("div",Wr,[ui("div",Kr,[xn(ui("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>i.inputString=e),type:n.type,required:""},null,8,qr),[[Aa,i.inputString]]),Xr,ui("label",null,(0,Ct.v_)(n.label),1)]),i.inputString!==n.state?(ei(),ii("button",{key:0,onClick:t[1]||(t[1]=(...e)=>a.click&&a.click(...e))},"Update")):gi("v-if",!0)])}],["__file","inputButton.vue"]]),Qr={key:0,class:"entry"},eo=["href"],to={class:"image"},no=["src"],so={class:"right"},io={class:"title"},ao={key:0},ro={key:1},oo={key:2},lo={key:0,id:"curEps"},co={key:1};var uo=n(13647),ho=n(26017);const po={props:{obj:{type:Object,default:void 0}},data:()=>({}),computed:{status:{get(){return this.obj&&this.obj.isAuthenticated()?this.obj.getStatus():null},set(e){this.obj&&this.obj.isAuthenticated()&&this.obj.setStatus(e)}},episode:{get(){return this.obj&&this.obj.isAuthenticated()&&this.obj.isOnList()?this.obj.getEpisode():null},set(e){this.obj&&this.obj.isAuthenticated()&&this.obj.setEpisode(e)}},volume:{get(){return this.obj&&this.obj.isAuthenticated()&&this.obj.isOnList()?this.obj.getVolume():null},set(e){this.obj&&this.obj.isAuthenticated()&&this.obj.setVolume(e)}},score:{get(){return this.obj&&this.obj.isAuthenticated()?this.obj.getDisplayScoreCheckbox():null},set(e){this.obj&&this.obj.isAuthenticated()&&this.obj.setScore(e)}}},methods:{lang:uo.storage.lang,utilsepisode:ho.episode,statusText(e){switch(e){case 1:return uo.storage.lang(`UI_Status_watching_${this.obj.getType()}`);case 2:return uo.storage.lang("UI_Status_Completed");case 3:return uo.storage.lang("UI_Status_OnHold");case 4:return uo.storage.lang("UI_Status_Dropped");case 6:return uo.storage.lang(`UI_Status_planTo_${this.obj.getType()}`);case 23:return uo.storage.lang(`UI_Status_Rewatching_${this.obj.getType()}`);default:return""}}}},mo=(0,zr.A)(po,[["render",function(e,t,n,s,i,a){return n.obj?(ei(),ii("div",Qr,[ui("a",{class:"result",href:n.obj.getDisplayUrl(),target:"_blank",style:{cursor:"pointer"}},[ui("div",to,[n.obj.getImage()?(ei(),ii("img",{key:0,src:n.obj.getImage()},null,8,no)):gi("v-if",!0)]),ui("div",so,[ui("span",io,(0,Ct.v_)(n.obj.getTitle()),1),n.obj.isOnList()?(ei(),ii("p",ao,(0,Ct.v_)(a.lang("UI_Status"))+" "+(0,Ct.v_)(a.statusText(a.status)),1)):gi("v-if",!0),n.obj.isOnList()?(ei(),ii("p",ro,(0,Ct.v_)(a.lang("UI_Score"))+" "+(0,Ct.v_)(a.score),1)):gi("v-if",!0),n.obj.isOnList()?(ei(),ii("p",oo,[mi((0,Ct.v_)(a.utilsepisode(n.obj.getType()))+" "+(0,Ct.v_)(a.episode),1),n.obj.getTotalEpisodes()?(ei(),ii("span",lo,"/"+(0,Ct.v_)(n.obj.getTotalEpisodes()),1)):(ei(),ii("span",co,"/?"))])):gi("v-if",!0)])],8,eo)])):gi("v-if",!0)}],["__file","entry.vue"]]),go={key:0,class:"rules"},fo={class:"title"},yo={class:"header"},vo={class:"noHover"},bo={class:"hover"},_o={class:"content"};var wo=n(13647);const Eo={props:{obj:{type:Object,default:void 0}},data:()=>({}),computed:{rules(){return this.obj&&this.obj.getRules()?this.obj.getRules().sort(((e,t)=>e.from.start-t.from.start)):[]}},methods:{lang:wo.storage.lang,activeRule(e){return{active:!!this.obj&&e===this.obj.activeRule}}}},So=(0,zr.A)(Eo,[["render",function(e,t,n,s,i,a){return a.rules&&a.rules.length?(ei(),ii("div",go,[ui("div",fo,(0,Ct.v_)(a.lang("UI_Rules")),1),(ei(!0),ii(qs,null,$n(a.rules,((e,t)=>(ei(),ii("div",{key:t,class:(0,Ct.C4)(["rule",a.activeRule(e)])},[ui("div",yo,[e.to.title?(ei(),ii(qs,{key:0},[ui("span",vo,(0,Ct.v_)(e.to.title),1),ui("span",bo,(0,Ct.v_)(e.to.url),1)],64)):(ei(),ii(qs,{key:1},[mi((0,Ct.v_)(e.to.url),1)],64))]),ui("div",_o,[mi((0,Ct.v_)(a.lang("UI_Episode"))+" "+(0,Ct.v_)(e.from.start)+" ",1),e.from.start!==e.from.end?(ei(),ii(qs,{key:0},[mi(" - "+(0,Ct.v_)(Number.MAX_SAFE_INTEGER===e.from.end?"":e.from.end),1)],64)):gi("v-if",!0),mi("  "+(0,Ct.v_)(Number.MAX_SAFE_INTEGER===e.to.start?"":e.to.start)+" ",1),e.to.start!==e.to.end?(ei(),ii(qs,{key:1},[mi(" - "+(0,Ct.v_)(Number.MAX_SAFE_INTEGER===e.to.end?"":e.to.end),1)],64)):gi("v-if",!0)])],2)))),128))])):gi("v-if",!0)}],["__file","rules.vue"]]);var ko=n(13647),Io=n(26017);const xo={components:{entry:mo,inputButton:Zr,search:Gr,rules:So},data:()=>({inputOffset:0,minimized:!1,syncMode:null,searchClass:null,unmountFnc:()=>{}}),computed:{syncPage(){return this.searchClass?this.searchClass.getSyncPage():null},rulesClass(){return this.searchClass.rules},currentStateEp(){if(this.syncPage&&this.syncPage.curState&&this.syncPage.curState.episode)return this.syncPage.curState.episode},offset(){return this.searchClass.getOffset()}},created(){this.minimized=ko.settings.get("minimizeBigPopup"),ko.settings.get("floatButtonCorrection")&&mt(!0)},unmounted(){this.unmountFnc(),pt()},methods:{lang:ko.storage.lang,setPage(e,t=0){this.searchClass.setUrl(e,t),Io.flashm(ko.storage.lang("correction_NewUrl",[e])),this.close()},setOffset(e){this.searchClass.setOffset(e)},close(){this.$.appContext.app.unmount()},calcEpOffset(e){return parseInt(e)-parseInt(this.inputOffset)}}},To=(0,zr.A)(xo,[["render",function(e,t,n,s,i,a){const r=hn("entry"),o=hn("rules"),l=hn("input-button"),c=hn("search");return a.syncPage?(ei(),ii("div",cr,[ui("div",ur,[ui("div",hr,[ui("a",pr,(0,Ct.v_)(a.lang("minimalApp_Settings"))+" ",1)])]),e.syncMode&&e.minimized?(ei(),ii("div",mr,[ui("a",{style:{cursor:"pointer"},onClick:t[0]||(t[0]=t=>e.minimized=!1)}," Action required ")])):(ei(),ii("div",dr,[e.syncMode?gi("v-if",!0):(ei(),ai(r,{key:0,obj:a.syncPage.singleObj},null,8,["obj"])),hi(o,{obj:a.rulesClass},null,8,["obj"]),e.syncMode?gi("v-if",!0):(ei(),ai(l,{key:1,label:"URL",state:e.searchClass.getUrl(),onClicked:a.setPage},null,8,["state","onClicked"])),e.syncMode?gi("v-if",!0):(ei(),ai(l,{key:2,label:a.lang("correction_Offset"),state:a.offset,type:"number",onClicked:a.setOffset,onChanged:t[1]||(t[1]=t=>e.inputOffset=t)},null,8,["label","state","onClicked"])),e.inputOffset&&"0"!==e.inputOffset?(ei(),ii("div",gr,[(ei(),ii(qs,null,$n(5,(e=>ui("div",{key:e,class:"offsetBox"},[ui("div",fr,(0,Ct.v_)(e),1),ui("div",{class:(0,Ct.C4)(["bottom",{active:parseInt(a.currentStateEp)===a.calcEpOffset(e)}])},(0,Ct.v_)(a.calcEpOffset(e)),3)]))),64)),yr])):gi("v-if",!0),hi(c,{keyword:e.searchClass.getSanitizedTitel(),type:e.searchClass.getNormalizedType(),"sync-mode":Boolean(e.syncMode),"current-id":e.searchClass.getId(),onClicked:t[2]||(t[2]=e=>a.setPage(e.url,e.id))},null,8,["keyword","type","sync-mode","current-id"])])),e.syncMode&&e.minimized?gi("v-if",!0):(ei(),ii("a",{key:2,class:"close",onClick:t[3]||(t[3]=e=>a.close())},(0,Ct.v_)(a.lang("close")),1))])):gi("v-if",!0)}],["styles",["::-webkit-scrollbar {\n  display: none;\n}\n#material {\n  all: initial;\n  color: white;\n  font-family: Helvetica, Arial, sans-serif;\n  font-size: 14px;\n  font-weight: 400;\n  line-height: 20px;\n}\n#material * {\n  box-sizing: border-box;\n}\n#material .scroll {\n  overflow-y: auto;\n  max-height: 80vh;\n  scrollbar-width: none;\n}\n#material .close {\n  display: block;\n  margin-top: 15px;\n  text-align: center;\n  cursor: pointer;\n}\n#material .mdl-color--primary {\n  background-color: #3f51b5;\n}\n#material p {\n  font-weight: 400;\n  line-height: 24px;\n  font-size: 14px;\n  letter-spacing: 0;\n  margin: 0 0 16px;\n}\n#material a {\n  color: #f43b7a;\n  text-decoration: none !important;\n}\n#material .search .input {\n  width: 100%;\n}\n#material .result {\n  cursor: pointer;\n  display: flex;\n  position: relative;\n  margin-bottom: 15px;\n  background-color: #484848;\n  max-width: 400px;\n}\n#material .result.active {\n  border: 1px solid #f43b7a;\n  border-style: dashed;\n}\n#material .result.onList::before {\n  content: '';\n  top: 0;\n  right: 0;\n  position: absolute;\n  width: 0;\n  height: 0;\n  border-style: solid;\n  border-width: 0 20px 20px 0;\n  border-color: transparent #f43b7a transparent transparent;\n}\n#material .result .image {\n  height: 100px;\n  width: 64px;\n  min-width: 64px;\n  background-color: grey;\n}\n#material .result .image img {\n  height: 100%;\n  width: 100%;\n  object-fit: cover;\n}\n#material .result .right {\n  flex-grow: 100;\n  cursor: pointer;\n  margin-top: 0;\n  margin-bottom: 0;\n  padding: 5px 10px;\n  display: flex;\n  flex-direction: column;\n}\n#material .result .right .title {\n  font-size: 20px;\n  font-weight: 400;\n  line-height: 1;\n  margin-bottom: 3px;\n}\n#material .result .right p {\n  margin-bottom: 0;\n  line-height: 20px;\n  color: white;\n}\n#material .rules .title {\n  color: #f43b7a;\n}\n#material .rules .rule {\n  margin-bottom: 15px;\n  background-color: #484848;\n  max-width: 400px;\n}\n#material .rules .rule .header {\n  padding: 5px 10px;\n  border-bottom: 1px solid white;\n}\n#material .rules .rule.active {\n  border: 1px solid #f43b7a;\n}\n#material .rules .rule .content {\n  padding: 5px 10px;\n}\n#material .rules .rule .hover {\n  display: none;\n}\n#material .rules .rule:hover .hover {\n  display: block;\n}\n#material .rules .rule:hover .noHover {\n  display: none;\n}\n#material .inputButton {\n  display: flex;\n  align-items: center;\n}\n#material .inputButton .group {\n  width: 100%;\n}\n#material .group {\n  position: relative;\n  margin-bottom: 15px;\n  margin-top: 25px;\n}\n#material .group input {\n  font-size: 18px;\n  padding: 10px 10px 10px 5px;\n  display: block;\n  color: white;\n  width: 100%;\n  border: none;\n  background-color: #484848;\n  border-bottom: 1px solid white;\n}\n#material .group input:focus {\n  outline: none;\n}\n#material .group label {\n  color: #999;\n  font-size: 18px;\n  font-weight: normal;\n  position: absolute;\n  pointer-events: none;\n  left: 5px;\n  top: 10px;\n  transition: 0.2s ease all;\n}\n#material .group input:focus ~ label,\n#material .group input:valid ~ label {\n  left: 0;\n  top: -20px;\n  font-size: 14px;\n  color: #f43b7a;\n}\n#material .group .bar {\n  position: relative;\n  display: block;\n}\n#material .group .bar::before,\n#material .group .bar::after {\n  content: '';\n  height: 2px;\n  width: 0;\n  bottom: 0;\n  position: absolute;\n  background: #f43b7a;\n  transition: 0.2s ease all;\n}\n#material .group .bar::before {\n  left: 50%;\n}\n#material .group .bar::after {\n  right: 50%;\n}\n#material .group input:focus ~ .bar::before,\n#material .group input:focus ~ .bar::after {\n  width: 50%;\n}\n#material .mdl-progress {\n  display: block;\n  position: relative;\n  height: 3px;\n  width: 500px;\n  max-width: 100%;\n}\n#material .mdl-progress > .bar {\n  display: block;\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  width: 0%;\n  transition: width 0.2s linear;\n}\n#material .mdl-progress > .bar1 {\n  background-color: #3f51b5;\n  animation-name: indeterminate1;\n  animation-duration: 2s;\n  animation-iteration-count: infinite;\n  animation-timing-function: linear;\n}\n@keyframes indeterminate1 {\n0% {\n    left: 0%;\n    width: 0%;\n}\n50% {\n    left: 25%;\n    width: 75%;\n}\n75% {\n    left: 100%;\n    width: 0%;\n}\n}\n#material .loadingBar {\n  position: relative;\n}\n#material .loadingBar .mdl-progress {\n  position: absolute;\n  top: -9px;\n}\n#material button {\n  margin-top: 10px;\n  margin-left: 10px;\n  background-color: #3f51b5;\n  color: white;\n  border: none;\n  border-radius: 2px;\n  position: relative;\n  height: 42px;\n  padding: 0 16px;\n  display: inline-block;\n  font-size: 14px;\n  font-weight: 500;\n  text-transform: uppercase;\n  letter-spacing: 0;\n  cursor: pointer;\n  text-decoration: none;\n  text-align: center;\n  line-height: 36px;\n  vertical-align: middle;\n}\n#material #offsetUi {\n  display: flex;\n  justify-content: space-around;\n}\n#material #offsetUi .offsetBox {\n  text-align: center;\n  min-width: 40px;\n  margin-left: 5px;\n  margin-right: 5px;\n}\n#material #offsetUi .offsetBox .top {\n  padding: 5px 10px;\n}\n#material #offsetUi .offsetBox .bottom {\n  padding: 5px 10px;\n}\n#material #offsetUi .offsetBox .bottom.active {\n  border: 1px solid #f43b7a;\n  border-top: 0;\n}\n#material .m-s-pill-section {\n  display: flex;\n  justify-content: flex-end;\n  margin-bottom: 15px;\n}\n#material .m-s-pill-section .m-s-pill {\n  border-radius: 5px;\n  padding: 2px 10px;\n  background: #484848;\n  display: inline-block;\n}\n"]],["__file","correctionApp.vue"]]);var $o=n(78584),Lo=n(26017),No=n(7263);class Oo extends lr{constructor(){super(...arguments),this.reloadSync=!1,this.keyInterruptRunning=!1}openCorrectionCheck(){return this.state&&this.state.similarity&&this.state.similarity.same?($o.log("similarity",this.state.similarity.value),!1):this.openCorrection(!0).then((()=>this.changed))}openCorrection(e=!1){return new Promise(((t,n)=>{if(this.vueInstance&&(this.vueInstance.$.appContext.app.unmount(),!e))return void t(!1);const s=Lo.flashm('<div class="ms-shadow"></div>',{permanent:!0,position:"top",type:"correction"});this.vueInstance=Va(To,s.find(".ms-shadow").get(0),{shadowDom:!0}),this.vueInstance.searchClass=this,this.vueInstance.syncMode=e,this.vueInstance.unmountFnc=()=>{t(this.changed),s.remove(),this.vueInstance=void 0},this.keyInterrupt()}))}isCorrectionMenuOpen(){return No.$(".type-correction").length>0}keyInterrupt(){this.keyInterruptRunning||(this.keyInterruptRunning=!0,document.addEventListener("keydown",(e=>{this.isCorrectionMenuOpen()&&(e.stopImmediatePropagation(),$o.info("Correction menu is open, stopped keydown event"))})))}}const Co=/^(https?|wss?|file|ftp|\*):\/\/(\*|\*\.[^*/]+|[^*/]+)\/.*$|^file:\/\/\/.*$|^resource:\/\/(\*|\*\.[^*/]+|[^*/]+)\/.*$|^about:/,Ao=globalThis.navigator?.userAgent.includes("Firefox/"),Po=Ao?/^(https?|wss?):[/][/][^/]+([/].*)?$/:/^https?:[/][/][^/]+([/].*)?$/,Ro=/^(https?|file|ftp):[/]+/;function Mo(...e){return 0===e.length?/$./:e.includes("<all_urls>")?Ro:e.includes("*://*/*")?Po:new RegExp(e.map((e=>function(e){!function(e){if(!function(e){return"<all_urls>"===e||Co.test(e)}(e))throw new Error(e+" is an invalid pattern, it must match "+String(Co))}(e);let[,t,n="",s]=e.split(/(^[^:]+:[/][/])([^/]+)?/);return t=t.replace("*",Ao?"(https?|wss?)":"https?").replaceAll(/[/]/g,"[/]"),"*"===n?n="[^/]+":n&&(n=n.replace(/^[*][.]/,"([^/]+.)*").replaceAll(/[.]/g,"[.]").replace(/[*]$/,"[^.]+")),s=s.replaceAll(/[/]/g,"[/]").replaceAll(/[.]/g,"[.]").replaceAll(/[*]/g,".*"),"^"+t+n+"("+s+")?$"}(e))).join("|"))}var Uo=n(54089),jo=n.n(Uo),Do=n(13647);n(13647),n(78584);const Fo=n(52163);var Vo=n(26017),Bo=n(13647),Ho=n(78584);class zo{constructor(){this.missingPermissions={},this.options=function(){const e=[{key:"iframe",title:"Video Iframe"},{key:"hostpermission",title:"Host Permission"},{key:"spacer1",title:"-_-_-"}];return Fo.sort(((e,t)=>Vo.sortAlphabetically(e.name,t.name))).forEach((t=>{e.push({key:t.key,title:t.name})})),e}()}async init(){return Bo.request.xhr("GET","https://api.malsync.moe/general/permissions").then((e=>{const t=JSON.parse(e.responseText),n=Object.keys(t).filter((e=>"ttl"!==e)).filter((e=>function(e){return jo()(e,Do.storage.version())}(e))).reduce(((e,n)=>{for(const s in t[n])this.options.some((e=>e.key===s))&&(e[s]?e[s]=e[s].concat(t[n][s]):e[s]=t[n][s]);return e}),{});this.missingPermissions=n}))}getMissingPermissions(e){const t=this.getFormatedPermissions();return console.log(e),t.filter((t=>!e.some((e=>e.page===t.page&&e.domain===t.domain)))).filter((e=>!function(e){try{return chrome.runtime.getManifest().content_scripts.some((t=>t.matches&&t.matches.some((t=>Mo(t).test(e)))))}catch(e){return!1}}(e.domain)))}getFormatedPermissions(){const e=[];for(const t in this.missingPermissions)this.missingPermissions[t].forEach((n=>{e.push({page:t,domain:n,auto:!0})}));return e}}class Go{getProgress(e){return Number(this.execute(e))}}var Wo=n(7263),Ko=n(7263),qo=n(7263),Xo=n(7263),Yo=n(7263);const Jo={text:class extends Go{execute(e){let t=Wo.$(e.selector).first().text().trim();if(e.regex){const n=new RegExp(e.regex),s=t.match(n);s&&(t=s[e.group||0])}const n=Number(t);if(Number.isNaN(n)||0===n)throw new Error(`No number found in text '${t}' (${n})`);return n}},count:class extends Go{execute(e){const t=Ko.$(e.selector).length;if(0===t)throw new Error(`No element found for '${e.selector}'`);return t}},countAbove:class extends Go{execute(e){const t=qo.$(e.selector);if(0===t.length)throw new Error(`No element found for '${e.selector}'`);const n=this.getElementInViewport(t);return n?this.countElementsAbove(t,n):0}getElementInViewport(e){const t=[],n=window.innerHeight||document.documentElement.clientHeight,s=window.innerWidth||document.documentElement.clientWidth;for(let i=0;i<e.length;i++){const a=e[i],r=a.getBoundingClientRect();r.bottom<=n&&r.left<=s&&r.width&&r.height&&t.push(a)}return t.length?t[t.length-1]:null}countElementsAbove(e,t){let n=0;for(let s=0;s<e.length&&(n++,e[s]!==t);s++);return n}},prop:class extends Go{execute(e){let t=Xo.$(e.selector).first().prop(e.property).trim();if(e.regex){const n=new RegExp(e.regex),s=t.match(n);s&&(t=s[e.group||0])}const n=Number(t);if(Number.isNaN(n)||0===n)throw new Error(`No number found in property '${e.property}' for '${t}' (${n})`);return n}},url:class extends Go{execute(e){let t=window.location.href.trim();if(e.regex){const n=new RegExp(e.regex),s=t.match(n);s&&(t=s[e.group||0])}const n=Number(t);if(Number.isNaN(n)||0===n)throw new Error(`No number found in text '${t}' (${n})`);return n}},attr:class extends Go{execute(e){let t=Yo.$(e.selector).first().attr(e.attribute).trim();if(e.regex){const n=new RegExp(e.regex),s=t.match(n);s&&(t=s[e.group||0])}const n=Number(t);if(Number.isNaN(n)||0===n)throw new Error(`No number found in attribute '${e.attribute}' for '${t}' (${n})`);return n}},callback:class extends Go{execute(e){const t=e.callback(),n=Number(t);if(Number.isNaN(n)||0===n)throw new Error(`No number found in text '${t}' (${n})`);return n}}};function Zo(e){return(new Jo[e.mode]).getProgress(e)}var Qo=n(78584),el=n(7263),tl=n(13647);const nl=Qo.m("MangaProgress"),sl=[{condition:"#amrapp",current:{mode:"text",selector:".amr-pages-nav .text-h6",regex:"(\\d+) /",group:1},total:{mode:"text",selector:".amr-pages-nav .text-h6",regex:"/ (\\d+)",group:1}}];class il{constructor(e,t){this.result=null,this.stopPromise=()=>{},this.configs=[...sl,...e],this.page=t,nl.log("config",this.configs)}getProgressFromCollectors(e){return{current:Zo(e.current),total:Zo(e.total)}}applyConfig(){for(const e in this.configs){const t=this.configs[e];if(!t.condition||el.$(t.condition).length)try{return this.getProgressFromCollectors(t)}catch(n){nl.m(`skip ${e}`).debug(n.message,t)}}return null}getProgress(){return this.result}isSuccessful(){return null!==this.result}getLimit(){const e=this.getProgress();return null===e?0:Math.floor(e.total/100*90)}progressPercentage(){const e=this.getProgress();if(null===e)return null;if(0===e.total)return 0;const t=e.current/this.getLimit();return t>1?1:t<0?0:t}finished(){const e=this.getProgress();if(null===e)return!1;const t=this.getLimit();return t<1||e.current>=t}execute(){this.result=this.applyConfig()}async start(){return clearInterval(this.interval),await this.checkForUpdatedConfig().catch((e=>nl.error(e))),new Promise(((e,t)=>{this.stopPromise=()=>e(!1);let n=!1;this.interval=setInterval((()=>{if(this.execute(),!this.isSuccessful())return clearInterval(this.interval),void t(new Error("MangaProgress: Progress not found"));n||(n=!0,e(!0)),this.setProgress(),nl.debug(this.finished(),this.getProgress())}),1e3)}))}stop(){clearInterval(this.interval)}setProgress(){el.$(".ms-progress").css("width",100*this.progressPercentage()+"%"),el.$("#malSyncProgress").removeClass("ms-loading").removeClass("ms-done"),this.finished()&&el.$("#malSyncProgress").length&&(el.$("#malSyncProgress").addClass("ms-done"),el.$(".flash.type-update .sync").trigger("click"),clearInterval(this.interval))}async checkForUpdatedConfig(){const e=new u(`reader/${this.page}`,864e5);let t;if(await e.hasValue())t=await e.getValue();else{const n=`https://api.malsync.moe/static/reader/${this.page}`;t=await tl.request.xhr("GET",n).then((async e=>200===e.status&&e.responseText?JSON.parse(e.responseText):null)),await e.setValue(t)}t&&(nl.log("Override config",t),this.configs=[...sl,...t])}}var al=n(7263),rl=n(26017);function ol(e,t){const n=rl.urlPart(t,2).replace(".com.br",".br").split(".").slice(-2,-1)[0];return new RegExp(`(\\.|^|\\/)${n}\\.`).test(e)}var ll=n(78584),cl=n(13647),ul=n(7263),hl=n(26017);let pl="agnaejlkbiiggajjmnpmeheigkflbnoo";"undefined"!=typeof browser&&"undefined"!=typeof chrome&&(pl="{57081fef-67b4-482f-bcb0-69296e63ec4f}");const ml=ll.m("Sync","#348fff");let dl,gl;class fl{constructor(e,t,n=(()=>{throw"No click handling found"})){if(this.url=e,this.pages=t,this.floatClick=n,this.novel=!1,this.strongVolumes=!1,this.videoSyncOffset=!0,this.autoNextEpRun=!1,this.curState=void 0,this.tempPlayer=void 0,this.UILoaded=!1,this.browsingtime=Date.now(),this.page=this.getPage(e),null===this.page)throw new Error("Page could not be recognized");if(this.domainSet(),ml.log("Page",this.page.name),void 0!==cl.settings.get("enablePages")[this.page.name]&&!cl.settings.get("enablePages")[this.page.name])throw ml.info("Sync is disabled for this page",this.page.name),"Stop Script";"manga"===this.page.type&&cl.settings.get("readerTracking")&&(this.mangaProgress=new il(this.page.sync.readerConfig||[],this.page.name)),k.on("syncPage_fillUi",(()=>this.fillUI()))}init(){const e=this;if(ul.$(document).ready((function(){!function(e,t){const n=ct.settings.get("posLeft"),s=ct.settings.get("miniMalWidth"),i=ct.settings.get("miniMalHeight");if(!ut.$("#info-popup").length){ct.storage.addStyle(`.modal-content-kal.fullscreen{width: 100% !important;height: 100% !important; bottom: 0 !important;${n}: 0 !important;}      .modal-content-kal{-webkit-transition: all 0.5s ease; -moz-transition: all 0.5s ease; -o-transition: all 0.5s ease; transition: all 0.5s ease;}      .floatbutton:hover {background-color:rgb(63,81,181) !important;}      .floatbutton:hover div {background-color:white;border-color:white;}      .floatbutton div {background-color:black;border-color:black;-webkit-transition: all 0.5s ease;-moz-transition: all 0.5s ease;-o-transition: all 0.5s ease;transition: all 0.5s ease;}      .floatbutton {       z-index: 9999;display: none; position:fixed; bottom:40px; right:40px; border-radius: 50%; font-size: 24px; height: 56px; margin: auto; min-width: 56px; width: 56px; padding: 0; overflow: hidden; background: rgba(158,158,158,.2); box-shadow: 0 1px 1.5px 0 rgba(0,0,0,.12), 0 1px 1px 0 rgba(0,0,0,.24); line-height: normal; border: none;       font-weight: 500; text-transform: uppercase; letter-spacing: 0; will-change: box-shadow; transition: box-shadow .2s cubic-bezier(.4,0,1,1),background-color .2s cubic-bezier(.4,0,.2,1),color .2s cubic-bezier(.4,0,.2,1); outline: none; cursor: pointer; text-decoration: none; text-align: center; vertical-align: middle; padding: 16px !important;      }      .floatbutton.stealth {        background: rgba(158,158,158,.03);      }      .floatbutton.stealth .open-info-popup{        visibility: hidden;      }      .floatbutton.floatHide{        visibility: hidden !important;      }`);let a=`max-width: 100%; max-height: 100%; min-width: 500px; min-height: 300px; width: ${s}; height: ${i}; position: absolute; bottom: 0%; ${n}: 0%`;ut.$(window).width()<500&&(a=`width: 100vw; height: 100%; position: absolute; top: 0%; ${n}: 0%`);let r='<div class="modal-kal" id="info-popup" style="pointer-events: none;display: none; position: fixed;z-index: 9999;left: 0;top: 0;bottom: 0;width: 100%; height: 100%; background-color: transparent; padding: 0; margin: 0; border: 0;">';r+=`<div id="modal-content" class="modal-content-kal" Style="pointer-events: all; background-color: #f9f9f9; margin: 0; ${a}">`,r+="</div>",r+="</div>",ut.$("body").after(ut.html(r));let o="";ct.settings.get("floatButtonStealth")&&(o+="stealth "),ct.settings.get("floatButtonHide")&&(o+="floatHide ");let l=`<button dir="ltr" class="open-info-popup floatbutton ${o}" style="">`;ct.settings.get("floatButtonCorrection")?l+='\n        <i\n          class="my-float open-info-popup"\n          style="display: flex; height: 8px; transform: rotate(-45deg); margin-left: -7px; margin-right: -5px; pointer-events: none;"\n        >\n          <div\n            style="\n              width: 1px;\n              margin-left: 2px;\n              border-top: 4px solid transparent;\n              border-bottom: 4px solid transparent;\n              border-right-width: 4px;\n              border-right-style: solid;\n              background-color: transparent;\n            "\n          ></div>\n          <div style="flex-grow: 1; border-top-left-radius: 2px; border-bottom-left-radius: 2px; margin-left: -1px;"></div>\n          <div style="width: 5px; margin-left: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px;"></div>\n        </i>\n      ':l+='<i class="my-float open-info-popup" style="margin-top:22px; pointer-events: none;"><div class="open-info-popup" style="width: 100%; height: 4px; margin-bottom: 15%;"></div><div class="open-info-popup" style="width: 100%; height: 4px; margin-bottom: 15%;"></div><div class="open-info-popup" style="width: 100%; height: 4px"></div></i>',l+="</button>",ut.$("#info-popup").after(ut.html(l)),ct.settings.get("floatButtonCorrection")||pt(),ct.settings.get("autoCloseMinimal")&&ut.$(".modal-kal").css("pointer-events","initial"),document.addEventListener("click",(function(n){n&&n.target&&(ut.$(n.target).hasClass("open-info-popup")&&t(e),ut.$(n.target).hasClass("modal-kal")&&(document.getElementById("info-popup").style.display="none",pt()))}))}}(e,e.floatClick)})),this.testForCloudflare())return ml.log("loading"),void this.cdn();if(this.page.init(this),"webextension"===cl.type)try{chrome.runtime.onMessage.addListener(((e,t,n)=>{this.presence(e,t,n)}))}catch(e){ml.error(e)}}getPage(e){return this.pages.type?this.pages:function(e,t){for(const n in t){const s=t[n];if(al.$.isArray(s.domain)){let t;if(s.domain.forEach((n=>{ol(e,n)&&(s.domain=n,t=s)})),t)return t}else if(ol(e,s.domain))return s}return null}(e,this.pages)}domainSet(){this.page.domain=new URL(window.location.href).origin}openNextEp(){if(void 0===this.page.sync.nextEpUrl)hl.flashm(cl.storage.lang("nextEpShort_no_support"),{error:!0,type:"EpError"});else{if(this.page.isSyncPage(this.url)){const e=this.page.sync.nextEpUrl(this.url);if(e)return void(window.location.href=e)}hl.flashm(cl.storage.lang("nextEpShort_no_nextEp"),{error:!0,type:"EpError"})}}setVideoTime(e,t){this.resetPlayerError();const n=cl.settings.get("videoDuration"),s=e.current/(e.duration*(n/100))*100;ul.$("#malSyncProgress").length&&(s<100?(ul.$(".ms-progress").css("width",`${s}%`),ul.$("#malSyncProgress").removeClass("ms-loading").removeClass("ms-done")):this.videoSyncOffset?(ul.$("#malSyncProgress").addClass("ms-done"),ul.$(".flash.type-update .sync").click()):ll.log("videoSyncOffset",s)),this.handleVideoResume(e,t),this.autoNextEp(e)}autoNextEp(e){cl.settings.get("autoNextEp")&&!this.autoNextEpRun&&e.current+1>e.duration&&(this.autoNextEpRun=!0,this.openNextEp())}handleVideoResume(e,t){if(void 0===this.curState||void 0===this.curState.identifier||void 0===this.curState.episode)return;const n=this,s=`${this.curState.identifier}/${this.curState.episode}`;if(this.curState.lastVideoTime=e,void 0!==this.curState.videoChecked&&this.curState.videoChecked)this.curState.videoChecked>1&&e.current>10&&(ml.debug("Set Resume",e.current),a.setItem(s,e.current),this.curState.videoChecked=!0,setTimeout((()=>{this.curState&&(this.curState.videoChecked=2)}),1e4));else{const i=a.getItem(s);if(ml.info("Resume",i),null!==i&&parseInt(i)-30>e.current&&parseInt(i)>30){ul.$("#MALSyncResume").length||ul.$("#MALSyncResume").parent().parent().remove();const s=Math.round(parseInt(i));let a="";if(cl.settings.get("autoresume")&&e.duration-s>.1*e.duration)return t(s),void(n.curState.videoChecked=2);let r=s;const o=Math.floor(r/60);r-=60*o;let l=`${r}`;for(;l.length<2;)l=`0${l}`;a=`${o}:${l}`;const c=hl.flashm(`<button id="MALSyncResume" class="sync" style="margin-bottom: 2px; background-color: transparent; border: none; color: rgb(255,64,129);cursor: pointer;">${cl.storage.lang("syncPage_flashm_resumeMsg",[a])}</button><br><button class="resumeClose" style="background-color: transparent; border: none; color: white;margin-top: 10px;cursor: pointer;">Close</button>`,{permanent:!0,error:!1,type:"resume",minimized:!1,position:"top"});c.find(".sync").on("click",(function(){t(s),n.curState.videoChecked=2,ul.$(this).parent().parent().remove()})),c.find(".resumeClose").on("click",(function(){n.curState.videoChecked=2,ul.$(this).parent().parent().remove()}))}else setTimeout((()=>{this.curState.videoChecked=2}),15e3);this.curState.videoChecked=!0}}reset(){this.url=window.location.href,this.UILoaded=!1,this.curState=void 0,this.setSearchObj(void 0),this.mangaProgress&&this.mangaProgress.stop(),$("#flashinfo-div, #flash-div-bottom, #flash-div-top, #malp").remove()}setSearchObj(e){e?pt():cl.settings.get("floatButtonCorrection")&&mt(),this.searchObj=e}async handlePage(e=window.location.href){let t,n;if(this.resetPlayerError(),this.curState=void 0,this.setSearchObj(void 0),this.url=e,this.browsingtime=Date.now(),this.videoSyncOffset=!1,clearTimeout(this.videoSyncInterval),this.videoSyncInterval=setTimeout((()=>{this.videoSyncOffset=!0}),1e4),this.page.isSyncPage(this.url)){this.loadUI(),t={on:"SYNC",title:this.page.sync.getTitle(this.url),identifier:this.page.sync.getIdentifier(this.url),detectedEpisode:parseInt(`${this.page.sync.getEpisode(this.url)}`)},this.setSearchObj(new Oo(t.title,this.novel?"novel":this.page.type,t.identifier)),this.searchObj.setPage(this.page),this.searchObj.setSyncPage(this),this.searchObj.setLocalUrl(this.generateLocalUrl(this.page,t)),this.curState=t,await this.searchObj.search();try{n=await this.searchObj.initRules()}catch(e){throw e instanceof N&&this.incorrectUrl(),e}t.detectedEpisode||0===t.detectedEpisode?t.episode=t.detectedEpisode+parseInt(this.searchObj.getRuledOffset(t.detectedEpisode)):"anime"===this.page.type?t.episode=1:t.episode=0,void 0!==this.page.sync.getVolume&&(t.volume=this.page.sync.getVolume(this.url)),"anime"===this.page.type&&(s=(e,t)=>{this.tempPlayer=t,this.setVideoTime(e,(e=>{void 0!==t?void 0!==e&&(t.play(),t.currentTime=e):ml.error("No player Found")}))},clearInterval(kt),kt=setInterval((function(){const e=document.getElementsByTagName("video");for(let t=0;t<e.length;t++){const n=e[t],{duration:i}=n,a=n.currentTime,{paused:r}=n;if(i&&i>60){const e={current:a,duration:i,paused:r};It.debug(window.location.href,e),s(e,n),Tt(e,n);break}}}),1e3)),ml.m("Sync","green").log(t)}else{if(void 0===this.page.overview)return void ml.log("No overview definition");if(void 0!==this.page.isOverviewPage&&!this.page.isOverviewPage(this.url))return void ml.info("Not an overview/sync page");this.loadUI(),t={on:"OVERVIEW",title:this.page.overview.getTitle(this.url),identifier:this.page.overview.getIdentifier(this.url)},this.setSearchObj(new Oo(t.title,this.novel?"novel":this.page.type,t.identifier)),this.searchObj.setPage(this.page),this.searchObj.setSyncPage(this),this.searchObj.setLocalUrl(this.generateLocalUrl(this.page,t)),this.curState=t,await this.searchObj.search();try{n=await this.searchObj.initRules()}catch(e){throw e instanceof N&&this.incorrectUrl(),e}ml.m("Overview","green").log(t)}var s;this.curState=t;let i=this.searchObj.getRuledUrl(t.detectedEpisode);const a=this.generateLocalUrl(this.page,t);if(null!==i&&i||!cl.settings.get("localSync")||(ml.log("Local Fallback"),i=a),null===i)ul.$("#MalInfo").text(cl.storage.lang("Not_Found")),ul.$("#MalData").css("display","none"),ml.log("Not on mal");else if(i){ml.log("MyAnimeList",i);try{n||(n=lt(i),await n.update()),this.singleObj=n}catch(e){if(e instanceof N)throw this.incorrectUrl(),e;if(!(e instanceof C&&cl.settings.get("localSync")))throw n&&(this.singleObj=n),this.singleObj.flashmError(e),this.fillUI(),e;ml.log("Local Fallback"),n=lt(a),await n.update(),this.singleObj=n}if("webextension"===cl.type&&cl.settings.get("rpc"))try{chrome.runtime.sendMessage(pl,{mode:"active"},(function(e){ml.log("Presence registred",e)}))}catch(e){ml.error(e)}if(this.fillUI(),this.page.isSyncPage(this.url)){if(await this.searchObj.openCorrectionCheck())return void this.handlePage(e);await this.singleObj.checkSync(t.episode,t.volume)?(await this.singleObj.lifeCycleHook("afterCheckSync"),this.strongVolumes&&!t.episode||this.singleObj.setEpisode(t.episode),this.singleObj.setStreamingUrl(this.page.sync.getOverviewUrl(this.url)),void 0!==t.volume&&t.volume>this.singleObj.getVolume()&&this.singleObj.setVolume(t.volume),ml.log(`Start Sync (${cl.settings.get("delay")} Seconds)`),this.singleObj.getMalId()&&"anime"===this.singleObj.getType()&&cl.settings.get("checkForFiller")&&this.checkForFiller(this.singleObj.getMalId(),this.singleObj.getEpisode()),await this.startSyncHandling(t,i)):ml.log("Nothing to Sync")}await this.imageFallback()}else ul.$("#MalInfo").text(cl.storage.lang("NothingFound")),ul.$("#MalData").css("display","none"),ml.log("Nothing found")}async startSyncHandling(e,t){let n=!1;if(this.mangaProgress)try{if(n=await this.mangaProgress.start(),!n)return}catch(e){ml.error(e)}if(n||"instant"!==cl.settings.get(`autoTrackingMode${this.page.type}`)){const s={key:`syncPage_flashm_sync_${this.page.type}`,value:String(e.episode)};"manga"===this.page.type&&!e.episode&&e.volume&&(s.key="syncPage_flashm_sync_manga_volume",s.value=String(e.volume));let i=`<button class="sync" style="margin-bottom: 8px; background-color: transparent; border: none; color: rgb(255,64,129);margin-top: 10px;cursor: pointer;">${cl.storage.lang(s.key,[_t(t).shortName,s.value])}</button>`,a={hoverInfo:!0,error:!0,type:"update",minimized:!1};"video"===cl.settings.get(`autoTrackingMode${this.page.type}`)&&"anime"===this.page.type&&(i=`\n          <div id="malSyncProgress" class="ms-loading" style="background-color: transparent; position: absolute; top: 0; left: 0; right: 0; height: 4px;">\n            <div class="ms-progress" style="background-color: #2980b9; width: 0%; height: 100%; transition: width 1s;"></div>\n          </div>\n          <div class="player-error" style="display: none; position: absolute; left: 0; right: 0; padding: 5px; bottom: 100%; color: rgb(255,64,129); background-color: #323232;">\n            <span class="player-error-default">${cl.storage.lang("syncPage_flash_player_error")}</span>\n            <span class="player-error-missing-permissions" style="display: none; padding-top: 10px">\n              ${cl.storage.lang("settings_custom_domains_missing_permissions_header")}\n            </span>\n            <div style="display: flex; justify-content: space-evenly">\n              <a class="player-error-missing-permissions" href="https://malsync.moe/pwa/#/settings/customDomains" style="display: none; margin: 10px; border-bottom: 2px solid #e13f7b;">\n                ${cl.storage.lang("Add")}\n              </a>\n              <a href="https://discord.com/invite/cTH4yaw" style="display: block; margin: 10px">Help</a>\n            </div>\n\n          </div>\n        ${i}`,a={hoverInfo:!0,error:!1,type:"update",minimized:!0}),n&&(i=`\n          <div id="malSyncProgress" style="background-color: transparent; position: absolute; top: 0; left: 0; right: 0; height: 4px;">\n            <div class="ms-progress" style="background-color: #2980b9; width: 0%; height: 100%; transition: width 1s;"></div>\n          </div>\n        ${i}`,a={hoverInfo:!0,error:!1,type:"update",minimized:!0}),hl.flashm(i,a).find(".sync").on("click",(()=>{ul.$(".flashinfo").remove(),this.sync(e),this.resetPlayerError()})),"anime"===this.singleObj.getType()&&(gl=setTimeout((async()=>{ul.$("#flashinfo-div").addClass("player-error"),await async function(){if("webextension"!==Bo.type)return!1;const e=new zo;await e.init();const t=e.getMissingPermissions(Bo.settings.get("customDomains"));return Ho.m("Missing Permissions").log(t),Boolean(t.length)}()&&ul.$("#flashinfo-div").addClass("player-error-missing-permissions");const e=$("iframe").toArray().map((e=>hl.absoluteLink($(e).attr("src"),window.location.origin))).filter((e=>e)).filter((e=>!function(e){try{const t=chrome.runtime.getManifest().content_scripts.find((e=>e.js&&e.js.includes("content/iframe.js")));return!(!t||!t.matches)&&Mo(...t.matches).test(e)}catch(e){return!1}}(e)));ll.log("No Player found",e)}),3e5)),ml.log("overviewUrl",this.page.sync.getOverviewUrl(this.url)),void 0!==this.page.sync.nextEpUrl&&ml.log("nextEp",this.page.sync.nextEpUrl(this.url))}else setTimeout((()=>{this.sync(e)}),1e3*cl.settings.get("delay"))}async sync(e){if(await this.singleObj.lifeCycleHook("beforeSync"),this.singleObj.setResumeWatching(this.url,e.episode),void 0!==this.page.sync.nextEpUrl){const t=this.page.sync.nextEpUrl(this.url);t&&-1===t.indexOf("undefined")&&this.singleObj.setContinueWatching(t,e.episode+1)}this.syncHandling(!0)}resetPlayerError(){gl&&(clearTimeout(gl),gl=void 0,ul.$("#flashinfo-div").removeClass("player-error"),ul.$("#flashinfo-div").removeClass("player-error-missing-permissions"))}generateLocalUrl(e,t){return`local://${e.name}/${e.type}/${t.identifier}/${encodeURIComponent(t.title)}`}openCorrectionUi(){if(this.searchObj)return this.searchObj.openCorrection().then((e=>{e&&this.handlePage()}))}syncHandling(e=!1,t=!1){let n;return n=t?this.singleObj.undo():this.singleObj.sync(),n.then((()=>{let t=this.singleObj.getTitle(),n="<br>",s=this.singleObj.getTotalVolumes();0===s&&(s="?");let i=this.singleObj.getTotalEpisodes();0===i&&(i="?");let a=this.singleObj.getStateDiff();if(a||(a={onList:this.singleObj.isOnList(),episode:this.singleObj.getEpisode(),volume:this.singleObj.getVolume(),status:this.singleObj.getStatus(),score:this.singleObj.getScore()}),void 0===a.onList&&(a.onList=!0),a.onList&&a.status){let e="";switch(parseInt(a.status)){case 1:e=cl.storage.lang(`UI_Status_watching_${this.page.type}`);break;case 2:e=cl.storage.lang("UI_Status_Completed");break;case 3:e=cl.storage.lang("UI_Status_OnHold");break;case 4:e=cl.storage.lang("UI_Status_Dropped");break;case 6:e=cl.storage.lang(`UI_Status_planTo_${this.page.type}`);break;case 23:e=cl.storage.lang(`UI_Status_Rewatching_${this.page.type}`)}t+=n+e,n=" | "}if(a.onList||(t+=n+cl.storage.lang("removed"),n=" | "),a.onList&&"manga"===this.page.type&&a.volume&&(t+=`${n+cl.storage.lang("UI_Volume")} ${a.volume}/${s}`,n=" | "),a.onList&&a.episode&&(t+=`${n+hl.episode(this.page.type)} ${a.episode}/${i}`,n=" | "),a.onList&&a.score&&(t+=`${n+cl.storage.lang("UI_Score")} ${a.score}`,n=" | "),e){this.fullNotification(t),t+=`\n            <br>\n            <button class="undoButton" style="background-color: transparent; border: none; color: rgb(255,64,129);margin-top: 10px;cursor: pointer;">\n              ${cl.storage.lang("syncPage_flashm_sync_undefined_undo")}\n            </button>\n            <button class="wrongButton" style="background-color: transparent; border: none; color: rgb(255,64,129);margin-top: 10px;cursor: pointer;">\n              ${cl.storage.lang("syncPage_flashm_sync_undefined_wrong")}\n            </button>`;const e=hl.flashm(t,{hoverInfo:!0,type:"update"});e.find(".undoButton").on("click",(e=>{const t=e.target.closest(".flash");t&&t.remove(),this.syncHandling(!1,!0)})),e.find(".wrongButton").on("click",(e=>{this.openCorrectionUi();const t=e.target.closest(".flash");t&&t.remove(),this.syncHandling(!1,!0)}))}else hl.flashm(t);this.fillUI()})).catch((e=>{throw this.singleObj.flashmError(e),e}))}fullNotification(e){try{!function(e){if(Et.settings.get("floatButtonStealth"))return;const t=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement;if(t){const n=St.$(St.html(`\n        <div style="\n          all: initial;\n          position: absolute;\n          bottom: 0;\n          left: 0;\n          right: 0;\n          color: white;\n          display: none;\n          z-index: 20000;\n        ">\n          <div style="\n            background: rgba(50, 50, 50, 0.6);\n            color: white;\n            padding: 10px 15px 10px;\n            margin-left: auto;\n            margin-right: auto;\n            max-width: 60%;\n            display: table;\n            font-family: Helvetica,Arial,sans-serif;\n            text-align: center;\n          ">${e}</div>\n        </div>\n        `)).appendTo(St.$(t));n.slideDown(400).delay(2e3).slideUp(400,(()=>{n.remove()}))}}(e),"webextension"===cl.type&&chrome.runtime.sendMessage({name:"content",item:{action:"fullscreenNotification",text:e}})}catch(e){ml.error(e)}}fillUI(){if(ul.$(".MalLogin").css("display",""),ul.$("#AddMalDiv, #LoginMalDiv").remove(),ul.$("#malRating").attr("href",this.singleObj.getDisplayUrl()),this.singleObj.getLastError())return ul.$(".MalLogin").css("display","none"),ul.$("#MalData").css("display","flex"),ul.$("#MalInfo").text(""),void ul.$("#malRating").after(ul.html(`&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id='LoginMalDiv'>${this.singleObj.getLastErrorMessage()}</span>`));let e="";this.singleObj.getScoreCheckbox().forEach((t=>{e+=`<option value="${t.value}" >${t.label}</option>`})),ul.$("#malUserRating").html(ul.html(e));let t="";if(this.singleObj.getStatusCheckbox().forEach((e=>{t+=`<option value="${e.value}" >${e.label}</option>`})),ul.$("#malStatus").html(ul.html(t)),this.singleObj.getRating().then((e=>{ul.$("#malRating").text(e)})),this.singleObj.isOnList())ul.$("#malTotal, #malTotalCha").text(this.singleObj.getTotalEpisodes()),0===this.singleObj.getTotalEpisodes()&&ul.$("#malTotal, #malTotalCha").text("?"),ul.$("#malTotalVol").text(this.singleObj.getTotalVolumes()),0===this.singleObj.getTotalVolumes()&&ul.$("#malTotalVol").text("?"),ul.$("#malEpisodes").val(this.singleObj.getEpisode()),ul.$("#malVolumes").val(this.singleObj.getVolume()),ul.$("#malStatus").val(this.singleObj.getStatusCheckboxValue()),ul.$("#malUserRating").val(this.singleObj.getScoreCheckboxValue());else{ul.$(".MalLogin").css("display","none"),ul.$("#malRating").after(ul.html(`<span id='AddMalDiv'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href='#' id='AddMal' onclick='return false;'>${cl.storage.lang("syncPage_malObj_addAnime",[this.singleObj.shortName])}</a></span>`));const e=this;ul.$("#AddMal").click((async function(t){t.preventDefault(),e.page.isSyncPage(e.url)||e.singleObj.setStreamingUrl(e.url),await e.searchObj.openCorrectionCheck()?e.handlePage():e.syncHandling().then((()=>e.singleObj.update())).then((()=>{e.fillUI()}))}))}ul.$("#MalData").css("display","flex"),ul.$("#MalInfo").text(""),this.calcSelectWidth(ul.$("#malEpisodes, #malVolumes, #malUserRating, #malStatus")),ul.$("#malEpisodes, #malVolumes").trigger("input");try{this.handleList(!0)}catch(e){ml.error(e)}}handleList(e=!1,t=0){if(this.singleObj&&(ul.$(".mal-sync-active").removeClass("mal-sync-active"),void 0!==this.page.overview&&void 0!==this.page.overview.list)){const n=this.getEpList();if(void 0!==n&&n.length>0&&(this.offsetHandler(n),this.page.overview.list.elementUrl)){const{elementUrl:s}=this.page.overview.list;ml.log("Episode List",ul.$.map(n,(function(e,t){return void 0!==e?s(e):"-"}))),void 0!==this.page.overview.list.handleListHook&&this.page.overview.list.handleListHook(this.singleObj.getEpisode(),n);const i=n[parseInt(this.singleObj.getEpisode()||1)];if(void 0===i&&!i&&e&&t<10&&void 0!==this.page.overview.list.paginationNext){ml.log("Pagination next");const e=this;this.page.overview.list.paginationNext(!1)&&setTimeout((function(){t++,e.handleList(!0,t)}),500)}const a=n[this.singleObj.getEpisode()+1];if(void 0!==a&&a&&!this.page.isSyncPage(this.url)){const e=`<a href="${s(a)}">${cl.storage.lang(`syncPage_malObj_nextEp_${this.page.type}`,[this.singleObj.getEpisode()+1])}</a>`;hl.flashm(e,{hoverInfo:!0,type:"nextEp",minimized:!0})}}}}getEpList(){const e=this,t=[];if(void 0!==this.page.overview&&void 0!==this.page.overview.list){const{elementEp:n}=this.page.overview.list;let s=0;this.singleObj&&(s=parseInt(this.singleObj.getEpisode())),this.page.overview.list.elementsSelector().each((function(i,a){try{const i=parseInt(`${n(ul.$(a))}`)+parseInt(e.getOffset());t[i]=ul.$(a),(cl.settings.get("highlightAllEp")&&i<=s||i===s)&&ul.$(a).addClass("mal-sync-active")}catch(e){ml.info(e)}}))}return t}offsetHandler(e){if(this.page.overview.list.offsetHandler&&!this.getOffset()&&this.searchObj&&"user"!==this.searchObj.provider)for(let t=0;t<e.length;++t)if(void 0!==e[t]){if(ml.log("Offset",t),t>1){const e=1-t;hl.flashConfirm(cl.storage.lang("syncPage_flashConfirm_offsetHandler_1",[String(e)]),"offset",(()=>{this.setOffset(e)}),(()=>{this.setOffset(0)}),!0)}return}}async imageFallback(){if(this.singleObj&&void 0!==this.singleObj.setImage&&this.page.getImage){const e=await this.page.getImage();e&&this.singleObj.setImage(e)}}incorrectUrl(){hl.flashm("Incorrect url provided",{error:!0,type:"error"}),this.openCorrectionUi()}testForCloudflare(){return"Just a moment..."===document.title||-1!==document.title.indexOf("Cloudflare")}cdn(e="default"){cl.storage.addStyle("\n      .bubbles {\n        display: none !important;\n      }\n      div#cf-content:before {\n        content: '';\n        background-image: url(https://raw.githubusercontent.com/MALSync/MALSync/master/assets/icons/icon128.png);\n        height: 64px;\n        width: 64px;\n        display: block;\n        background-size: cover;\n        animation: rotate 3s linear infinite;\n        background-color: #251e2b;\n        border-radius: 50%;\n      }\n      @keyframes rotate{ to{ transform: rotate(360deg); } }\n    ")}getOffset(){return this.searchObj&&this.searchObj.getOffset()?this.searchObj.getOffset():0}async setOffset(e){this.searchObj&&this.searchObj.setOffset(e),void 0!==this.singleObj&&cl.storage.remove(`updateCheck/${this.singleObj.getType()}/${this.singleObj.getCacheKey()}`)}loadUI(){const e=this;if(this.UILoaded)return;this.UILoaded=!0;const t="</span>";let n=`<p id="malp" dir="${cl.storage.langDirection()}">`;n+=`<span id="MalInfo">${cl.storage.lang("Loading")}</span>`,n+='<span id="MalData" style="display: none; justify-content: space-between; flex-wrap: wrap;">',n+='<span style="display: inline-block;" class="malp-group malp-group-rating">',n+=`<span class="info malp-group-label">${cl.storage.lang("search_Score")} </span>`,n+='<a id="malRating" class="malp-group-field" style="min-width: 30px;display: inline-block;" target="_blank" href="">____</a>',n+=t;const s=e=>`<span style="display: inline-block; display: none;" class="MalLogin malp-group malp-group-${e}">`;n+=s("status"),n+=`<span class="info malp-group-label">${cl.storage.lang("UI_Status")} </span>`,n+='<select id="malStatus" class="malp-group-field malp-group-select">',n+="</select>",n+=t;let i="";"anime"===this.page.type?(i+=s("episode"),i+=`<span class="info malp-group-label">${cl.storage.lang("UI_Episode")} </span>`,i+='<span style=" text-decoration: none; outline: medium none;" class="malp-group-value-section">',i+='<input id="malEpisodes" class="malp-group-field malp-group-input" value="0" type="text" size="1" maxlength="4">',i+='/<span id="malTotal" class="malp-group-value">0</span>',i+="</span>",i+=t):(i+=s("volume"),i+=`<span class="info malp-group-label">${cl.storage.lang("UI_Volume")} </span>`,i+='<span style=" text-decoration: none; outline: medium none;" class="malp-group-value-section">',i+='<input id="malVolumes" class="malp-group-field malp-group-input" value="0" type="text" size="1" maxlength="4">',i+='/<span id="malTotalVol" class="malp-group-value">0</span>',i+="</span>",i+=t,i+=s("chapter"),i+=`<span class="info malp-group-label">${cl.storage.lang("UI_Chapter")} </span>`,i+='<span style=" text-decoration: none; outline: medium none;" class="malp-group-value-section">',i+='<input id="malEpisodes" class="malp-group-field malp-group-input" value="0" type="text" size="1" maxlength="4">',i+='/<span id="malTotalCha" class="malp-group-value">0</span>',i+="</span>",i+=t),n+=i,n+=s("score"),n+=`<span class="info malp-group-label">${cl.storage.lang("UI_Score")}</span>`,n+='<select id="malUserRating" class="malp-group-field malp-group-select">',n+="</select>",n+=t,n+="</span>",n+="</p>",this.page.isSyncPage(this.url)?void 0!==this.page.sync.uiSelector&&this.page.sync.uiSelector(n):void 0!==this.page.overview&&this.page.overview.uiSelector(n),ul.$("#malEpisodes, #malVolumes, #malUserRating, #malStatus").change((function(){e.buttonclick();const t=ul.$(this);e.calcSelectWidth(t)})),ul.$("#malEpisodes, #malVolumes").on("input",(function(){const e=ul.$(this);let t=e.val().toString().length;t<1&&(t=1);const n=7.7*t+3;e.css("width",`${n}px`)})).trigger("input")}calcSelectWidth(e){e.each((function(e,t){const n=ul.$(t).find("option:selected").text(),s=ul.$('<select style="width: auto;"/>').append(ul.html(`<option>${n}</option>`)),i=s.width()||0;i&&(ul.$("#malp").append(ul.html(s)),ul.$(t).width(i+5),s.remove())}))}async buttonclick(){this.singleObj.setEpisode(ul.$("#malEpisodes").val()),ul.$("#malVolumes").length&&this.singleObj.setVolume(ul.$("#malVolumes").val()),this.singleObj.handleScoreCheckbox(ul.$("#malUserRating").val()),this.singleObj.handleStatusCheckbox(ul.$("#malStatus").val()),this.page.isSyncPage(this.url)||this.singleObj.setStreamingUrl(this.url),await this.searchObj.openCorrectionCheck()?this.handlePage():this.syncHandling().then((()=>this.singleObj.update())).then((()=>{this.fillUI()}))}presence(e,t,n){try{if("presence"===e.action){console.log("Presence requested",e,this.curState),clearTimeout(dl),dl=setTimeout((()=>{this.browsingtime=void 0}),3e5),this.browsingtime||(this.browsingtime=Date.now());let t=!0,s=!0;switch(cl.settings.get("presenceLargeImage")){case"website":t=!1,s=!1;break;case"malsync":t=!1,s=!0}let i,a,r="606504719212478504";if(cl.settings.get("presenceShowMalsync")||(r="anime"!==this.page.type?"823563138669608980":"823563096747802695"),s?(i="malsync",a="MAL-Sync"):(i=this.page.name.toLowerCase(),a=`${this.page.name}  MAL-Sync`),t&&this.singleObj.getImage()&&(i=this.singleObj.getImage()),this.curState){const e={clientId:r,presence:{details:this.singleObj.getTitle(!0)||this.curState.title,largeImageKey:i,largeImageText:a,instance:!0}};if(cl.settings.get("presenceShowButtons")){let t=null;"Local"!==this.singleObj.shortName&&(t=this.singleObj.getDisplayUrl()),t||(t=this.singleObj.getMalUrl()),t||s||(t=this.singleObj.getStreamingUrl()),t&&(e.presence.buttons=[{label:cl.storage.lang(`discord_rpc_view_${this.singleObj.getType()}`),url:t}])}if(void 0!==this.curState.episode){const t=[];if(this.curState.episode>0){let e=this.singleObj.getTotalEpisodes();e=e?`/${e}`:"",t.push(`${hl.episode(this.page.type)} ${this.curState.episode}${e}`)}if(this.curState.volume>0){const e=this.curState.volume;let n=this.singleObj.getTotalVolumes();n=n?`/${n}`:"",t.push(`${cl.storage.lang("UI_Volume")} ${e}${n}`)}if(e.presence.state=t.join(" | "),void 0!==this.curState.lastVideoTime)if(this.curState.lastVideoTime.paused)e.presence.smallImageKey="pause",e.presence.smallImageText="Paused";else{const t=this.curState.lastVideoTime.duration-this.curState.lastVideoTime.current;e.presence.endTimestamp=Date.now()+1e3*t,e.presence.smallImageKey="play",e.presence.smallImageText="Playing"}else e.presence.startTimestamp=this.browsingtime,"anime"!==this.page.type&&(e.presence.smallImageKey="reading",e.presence.smallImageText="Reading")}else{let t;t=s?this.page.type.toString():this.page.name,e.presence.startTimestamp=this.browsingtime,e.presence.state=cl.storage.lang("Discord_rpc_browsing",[t])}return void n(e)}}}catch(e){ml.error(e)}n({})}async checkForFiller(e,t){const n=Math.ceil(t/100),s=new u(`fillers/${e}/${n}`,6048e5);if(!await s.hasValueAndIsNotEmpty()){const t=`https://api.jikan.moe/v4/anime/${e}/episodes?page=${n}`,i=await cl.request.xhr("GET",t).then((async e=>{try{if(200===e.status&&e.responseText){const t=JSON.parse(e.responseText);if(t.data&&t.data.length)return t.data.map((e=>({filler:e.filler,recap:e.recap,episode_id:e.mal_id}))).filter((e=>e.filler||e.recap))}}catch(e){}return[]}));await s.setValue(i)}const i=await s.getValue();if(i&&i.length){const e=i.find((e=>e.episode_id===t));if(e&&(e.filler||e.recap)){const t=e.filler?"filler":"recap";hl.flashConfirm(cl.storage.lang(`filler_${t}_confirm`),"filler",(()=>{this.openNextEp()}),(()=>{}),!0)}}}}var yl=n(13647),vl=n(7263),bl=n(78584),_l=n(26017);async function wl(){const e=await yl.storage.get("timestampUpdate/firebaseNotification");(void 0===e||vl.$.now()-e>6e5)&&(await El(),yl.storage.set("timestampUpdate/firebaseNotification",vl.$.now()))}async function El(){bl.log("checkNotifications");const e=await yl.request.xhr("GET","https://kissanimelist.firebaseio.com/Data2/Notification/Current.json"),t=parseInt(JSON.parse(e.responseText));Number.isNaN(t)&&bl.error("Could not read current Notification number"),bl.log("Current Notification",t);const n=parseInt(await yl.storage.get("firebaseNotification")),s=n+1;if(void 0===n||Number.isNaN(n))return void yl.storage.set("firebaseNotification",t);if(t<s)return void bl.log("No new notifications");const i=`https://kissanimelist.firebaseio.com/Data2/Notification/list/N${s}.json`,a=await yl.request.xhr("GET",i);if(!a)return;const r=JSON.parse(a.responseText);if(!r)return bl.info("Notification empty",a.responseText),void yl.storage.set("firebaseNotification",s).then((function(){El()}));vl.$(document).ready((function(){const e=_l.flashm(`<div style="text-align: left;">${r}</div><button class="okChangelog" style="background-color: transparent; border: none; color: rgb(255,64,129);margin-top: 10px;cursor: pointer;">Close</button>`,{permanent:!0,position:"top"});e.find(".okChangelog").click((function(){e.remove(),yl.storage.set("firebaseNotification",s).then((function(){El()}))}))}))}var Sl=n(13647),kl=n(78584);function Il(e){Sl.settings.get("floatButtonCorrection")?(kl.log("Open correction"),e.openCorrectionUi()):(kl.log("Open miniMAL"),function(e){const t=xl(Sl.settings.get("miniMalWidth"),window.screen.width),n=xl(Sl.settings.get("miniMalHeight"),window.screen.height);let s;s="right"===Sl.settings.get("posLeft")?window.screen.width-t:"left"===Sl.settings.get("posLeft")?1:0,chrome.runtime.sendMessage({name:"minimalWindow",height:n,width:t,left:s},(function(e){kl.log("Opened")}))}())}function xl(e,t){if(/^\d+px$/i.test(e))return parseInt(e.replace(/px/i,""));if(/^\d+%$/i.test(e)){const n=parseInt(e.replace(/%/i,""));return parseInt(""+t*(n/100))}return NaN}var Tl=n(78584),$l=n(13647),Ll=n(7263);let Nl,Ol;if(void 0!==n.g.doubleLoad&&n.g.doubleLoad)throw Tl.error("Double Execution"),"Double Execution";n.g.doubleLoad=!0,console.log("%cMAL-Sync","font-size: 40px; padding-bottom: 3px; color: white; text-shadow: -1px -1px #2e51a2, 1px -1px #2e51a2, -1px 1px #2e51a2, 1px 1px #2e51a2, 2px 2px #2e51a2, 3px 3px #2e51a2;",`Version: ${$l.storage.version()}`),$l.settings.init().then((()=>{!function(){if($l.settings.get("userscriptModeButton"))throw"Userscript mode";const e=new fl(window.location.href,_Page,Il);!function(e){var t;chrome.runtime.onMessage.addListener((function(t,n,s){if("TabMalUrl"===t.action&&Date.now()-Nl<3e3&&(Tl.log("TabMalUrl Message",e.singleObj.url),s({url:e.singleObj.url,title:e.singleObj.getTitle(),image:e.singleObj.getImage()})),"videoTime"===t.action&&(e.setVideoTime(t.item,(function(e){chrome.runtime.sendMessage({name:"videoTimeSet",time:e,sender:t.sender})})),Ol=async function(e){chrome.runtime.sendMessage({name:"videoTimeSet",timeAdd:e,sender:t.sender})}),"videoTimeSet"===t.action){if(Tl.log("[Iframe] Set Time",t),void 0===e.tempPlayer)return void Tl.error("[Iframe] No player Found");if(void 0!==t.time)return e.tempPlayer.play(),void(e.tempPlayer.currentTime=t.time);if(void 0!==t.timeAdd)return e.tempPlayer.play(),void(e.tempPlayer.currentTime+=t.timeAdd)}if("content"===t.action)switch(t.item.action){case"nextEpShort":e.openNextEp();break;case"correctionShort":e.openCorrectionUi();break;case"syncShort":Ll.$("#malSyncProgress").addClass("ms-done"),Ll.$(".flash.type-update .sync").click()}})),$t=t=t=>{switch(Tl.log("[content] Shortcut",t),t.shortcut){case"introSkipFwd":n(!0);break;case"introSkipBwd":n(!1);break;case"nextEpShort":e.openNextEp();break;case"correctionShort":e.openCorrectionUi();break;case"syncShort":Ll.$("#malSyncProgress").addClass("ms-done"),Ll.$(".flash.type-update .sync").click()}async function n(t){if(void 0===e.tempPlayer)return Ol?void Ol(t):void Tl.error("[content] No iframe and onsite player found");let n=parseInt(await $l.settings.getAsync("introSkip"));t||(n=0-n);const s=e.tempPlayer.currentTime+n;e.tempPlayer.duration&&e.tempPlayer.duration>15&&s>e.tempPlayer.duration-3?e.tempPlayer.currentTime=e.tempPlayer.duration-3:e.tempPlayer.currentTime=s}},Lt||function(){Lt=!0;let e={};function n(n){const i=(n=n||event).which||n.keyCode;e[i]="keydown"===n.type;for(let e=0;e<Nt.length;e++){const t=Nt[e];s(t)&&(n.target instanceof Node&&(/textarea|input|select/i.test(n.target.nodeName)||n.target instanceof Element&&n.target.shadowRoot)?wt.info("Input field. Shortcut suppressed."):a(t))}function a(n){return e={},t({shortcut:n}),!1}}function s(t){const n=Et.settings.get(t);if(!n.length)return!1;let s=!0;return n.forEach((function(t){e[t]||(s=!1)})),s&&Object.values(e).filter((e=>e)).length!==n.length&&(s=!1),s}document.addEventListener("keydown",n),document.addEventListener("keyup",n),window.addEventListener("focus",(function(){e={}}),!1)}()}(e),e.init(),wl(),$(window).blur((function(){Nl=Date.now()}))}()}))})()})();
//# sourceMappingURL=content-script.js.map