"use strict";(()=>{var eB=Object.create;var Va=Object.defineProperty;var tB=Object.getOwnPropertyDescriptor;var rB=Object.getOwnPropertyNames;var AB=Object.getPrototypeOf,iB=Object.prototype.hasOwnProperty;var D=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var oB=(e,t,r,A)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of rB(t))!iB.call(e,i)&&i!==r&&Va(e,i,{get:()=>t[i],enumerable:!(A=tB(t,i))||A.enumerable});return e};var G=(e,t,r)=>(r=e!=null?eB(AB(e)):{},oB(t||!e||!e.__esModule?Va(r,"default",{value:e,enumerable:!0}):r,e));var he=D((Ao,za)=>{"use strict";var Mr=function(e){return e&&e.Math===Math&&e};za.exports=Mr(typeof globalThis=="object"&&globalThis)||Mr(typeof window=="object"&&window)||Mr(typeof self=="object"&&self)||Mr(typeof global=="object"&&global)||Mr(typeof Ao=="object"&&Ao)||function(){return this}()||Function("return this")()});var xe=D((x0,Wa)=>{"use strict";Wa.exports=function(e){try{return!!e()}catch{return!0}}});var qe=D((k0,Xa)=>{"use strict";var nB=xe();Xa.exports=!nB(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7})});var io=D((b0,Za)=>{"use strict";var aB=xe();Za.exports=!aB(function(){var e=function(){}.bind();return typeof e!="function"||e.hasOwnProperty("prototype")})});var mA=D((N0,ja)=>{"use strict";var sB=io(),hA=Function.prototype.call;ja.exports=sB?hA.bind(hA):function(){return hA.apply(hA,arguments)}});var rs=D(ts=>{"use strict";var $a={}.propertyIsEnumerable,es=Object.getOwnPropertyDescriptor,gB=es&&!$a.call({1:2},1);ts.f=gB?function(t){var r=es(this,t);return!!r&&r.enumerable}:$a});var oo=D((G0,As)=>{"use strict";As.exports=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}}});var ke=D((U0,ns)=>{"use strict";var is=io(),os=Function.prototype,no=os.call,IB=is&&os.bind.bind(no,no);ns.exports=is?IB:function(e){return function(){return no.apply(e,arguments)}}});var ao=D((M0,ss)=>{"use strict";var as=ke(),cB=as({}.toString),lB=as("".slice);ss.exports=function(e){return lB(cB(e),8,-1)}});var Is=D((H0,gs)=>{"use strict";var uB=ke(),fB=xe(),dB=ao(),so=Object,pB=uB("".split);gs.exports=fB(function(){return!so("z").propertyIsEnumerable(0)})?function(e){return dB(e)==="String"?pB(e,""):so(e)}:so});var go=D((R0,cs)=>{"use strict";cs.exports=function(e){return e==null}});var Io=D((q0,ls)=>{"use strict";var BB=go(),CB=TypeError;ls.exports=function(e){if(BB(e))throw new CB("Can't call method on "+e);return e}});var $e=D((T0,us)=>{"use strict";var QB=Is(),hB=Io();us.exports=function(e){return QB(hB(e))}});var we=D((_0,fs)=>{"use strict";var co=typeof document=="object"&&document.all;fs.exports=typeof co>"u"&&co!==void 0?function(e){return typeof e=="function"||e===co}:function(e){return typeof e=="function"}});var Yt=D((P0,ds)=>{"use strict";var mB=we();ds.exports=function(e){return typeof e=="object"?e!==null:mB(e)}});var Vt=D((O0,ps)=>{"use strict";var lo=he(),EB=we(),yB=function(e){return EB(e)?e:void 0};ps.exports=function(e,t){return arguments.length<2?yB(lo[e]):lo[e]&&lo[e][t]}});var Cs=D((J0,Bs)=>{"use strict";var wB=ke();Bs.exports=wB({}.isPrototypeOf)});var Es=D((K0,ms)=>{"use strict";var DB=he(),Qs=DB.navigator,hs=Qs&&Qs.userAgent;ms.exports=hs?String(hs):""});var ks=D((L0,xs)=>{"use strict";var Ss=he(),uo=Es(),ys=Ss.process,ws=Ss.Deno,Ds=ys&&ys.versions||ws&&ws.version,Fs=Ds&&Ds.v8,be,EA;Fs&&(be=Fs.split("."),EA=be[0]>0&&be[0]<4?1:+(be[0]+be[1]));!EA&&uo&&(be=uo.match(/Edge\/(\d+)/),(!be||be[1]>=74)&&(be=uo.match(/Chrome\/(\d+)/),be&&(EA=+be[1])));xs.exports=EA});var fo=D((Y0,Ns)=>{"use strict";var bs=ks(),FB=xe(),SB=he(),xB=SB.String;Ns.exports=!!Object.getOwnPropertySymbols&&!FB(function(){var e=Symbol("symbol detection");return!xB(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&bs&&bs<41})});var po=D((V0,vs)=>{"use strict";var kB=fo();vs.exports=kB&&!Symbol.sham&&typeof Symbol.iterator=="symbol"});var Bo=D((z0,Gs)=>{"use strict";var bB=Vt(),NB=we(),vB=Cs(),GB=po(),UB=Object;Gs.exports=GB?function(e){return typeof e=="symbol"}:function(e){var t=bB("Symbol");return NB(t)&&vB(t.prototype,UB(e))}});var Ms=D((W0,Us)=>{"use strict";var MB=String;Us.exports=function(e){try{return MB(e)}catch{return"Object"}}});var yA=D((X0,Hs)=>{"use strict";var HB=we(),RB=Ms(),qB=TypeError;Hs.exports=function(e){if(HB(e))return e;throw new qB(RB(e)+" is not a function")}});var qs=D((Z0,Rs)=>{"use strict";var TB=yA(),_B=go();Rs.exports=function(e,t){var r=e[t];return _B(r)?void 0:TB(r)}});var _s=D((j0,Ts)=>{"use strict";var Co=mA(),Qo=we(),ho=Yt(),PB=TypeError;Ts.exports=function(e,t){var r,A;if(t==="string"&&Qo(r=e.toString)&&!ho(A=Co(r,e))||Qo(r=e.valueOf)&&!ho(A=Co(r,e))||t!=="string"&&Qo(r=e.toString)&&!ho(A=Co(r,e)))return A;throw new PB("Can't convert object to primitive value")}});var mo=D(($0,Ps)=>{"use strict";Ps.exports=!1});var wA=D((eN,Js)=>{"use strict";var Os=he(),OB=Object.defineProperty;Js.exports=function(e,t){try{OB(Os,e,{value:t,configurable:!0,writable:!0})}catch{Os[e]=t}return t}});var DA=D((tN,Ys)=>{"use strict";var JB=mo(),KB=he(),LB=wA(),Ks="__core-js_shared__",Ls=Ys.exports=KB[Ks]||LB(Ks,{});(Ls.versions||(Ls.versions=[])).push({version:"3.39.0",mode:JB?"pure":"global",copyright:"\xA9 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.39.0/LICENSE",source:"https://github.com/zloirock/core-js"})});var Eo=D((rN,zs)=>{"use strict";var Vs=DA();zs.exports=function(e,t){return Vs[e]||(Vs[e]=t||{})}});var yo=D((AN,Ws)=>{"use strict";var YB=Io(),VB=Object;Ws.exports=function(e){return VB(YB(e))}});var dt=D((iN,Xs)=>{"use strict";var zB=ke(),WB=yo(),XB=zB({}.hasOwnProperty);Xs.exports=Object.hasOwn||function(t,r){return XB(WB(t),r)}});var wo=D((oN,Zs)=>{"use strict";var ZB=ke(),jB=0,$B=Math.random(),eC=ZB(1 .toString);Zs.exports=function(e){return"Symbol("+(e===void 0?"":e)+")_"+eC(++jB+$B,36)}});var Wt=D((nN,$s)=>{"use strict";var tC=he(),rC=Eo(),js=dt(),AC=wo(),iC=fo(),oC=po(),zt=tC.Symbol,Do=rC("wks"),nC=oC?zt.for||zt:zt&&zt.withoutSetter||AC;$s.exports=function(e){return js(Do,e)||(Do[e]=iC&&js(zt,e)?zt[e]:nC("Symbol."+e)),Do[e]}});var Ag=D((aN,rg)=>{"use strict";var aC=mA(),eg=Yt(),tg=Bo(),sC=qs(),gC=_s(),IC=Wt(),cC=TypeError,lC=IC("toPrimitive");rg.exports=function(e,t){if(!eg(e)||tg(e))return e;var r=sC(e,lC),A;if(r){if(t===void 0&&(t="default"),A=aC(r,e,t),!eg(A)||tg(A))return A;throw new cC("Can't convert object to primitive value")}return t===void 0&&(t="number"),gC(e,t)}});var Fo=D((sN,ig)=>{"use strict";var uC=Ag(),fC=Bo();ig.exports=function(e){var t=uC(e,"string");return fC(t)?t:t+""}});var xo=D((gN,ng)=>{"use strict";var dC=he(),og=Yt(),So=dC.document,pC=og(So)&&og(So.createElement);ng.exports=function(e){return pC?So.createElement(e):{}}});var ko=D((IN,ag)=>{"use strict";var BC=qe(),CC=xe(),QC=xo();ag.exports=!BC&&!CC(function(){return Object.defineProperty(QC("div"),"a",{get:function(){return 7}}).a!==7})});var bo=D(gg=>{"use strict";var hC=qe(),mC=mA(),EC=rs(),yC=oo(),wC=$e(),DC=Fo(),FC=dt(),SC=ko(),sg=Object.getOwnPropertyDescriptor;gg.f=hC?sg:function(t,r){if(t=wC(t),r=DC(r),SC)try{return sg(t,r)}catch{}if(FC(t,r))return yC(!mC(EC.f,t,r),t[r])}});var No=D((lN,Ig)=>{"use strict";var xC=qe(),kC=xe();Ig.exports=xC&&kC(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42})});var Hr=D((uN,cg)=>{"use strict";var bC=Yt(),NC=String,vC=TypeError;cg.exports=function(e){if(bC(e))return e;throw new vC(NC(e)+" is not an object")}});var Xt=D(ug=>{"use strict";var GC=qe(),UC=ko(),MC=No(),FA=Hr(),lg=Fo(),HC=TypeError,vo=Object.defineProperty,RC=Object.getOwnPropertyDescriptor,Go="enumerable",Uo="configurable",Mo="writable";ug.f=GC?MC?function(t,r,A){if(FA(t),r=lg(r),FA(A),typeof t=="function"&&r==="prototype"&&"value"in A&&Mo in A&&!A[Mo]){var i=RC(t,r);i&&i[Mo]&&(t[r]=A.value,A={configurable:Uo in A?A[Uo]:i[Uo],enumerable:Go in A?A[Go]:i[Go],writable:!1})}return vo(t,r,A)}:vo:function(t,r,A){if(FA(t),r=lg(r),FA(A),UC)try{return vo(t,r,A)}catch{}if("get"in A||"set"in A)throw new HC("Accessors not supported");return"value"in A&&(t[r]=A.value),t}});var Ho=D((dN,fg)=>{"use strict";var qC=qe(),TC=Xt(),_C=oo();fg.exports=qC?function(e,t,r){return TC.f(e,t,_C(1,r))}:function(e,t,r){return e[t]=r,e}});var Bg=D((pN,pg)=>{"use strict";var Ro=qe(),PC=dt(),dg=Function.prototype,OC=Ro&&Object.getOwnPropertyDescriptor,qo=PC(dg,"name"),JC=qo&&function(){}.name==="something",KC=qo&&(!Ro||Ro&&OC(dg,"name").configurable);pg.exports={EXISTS:qo,PROPER:JC,CONFIGURABLE:KC}});var Qg=D((BN,Cg)=>{"use strict";var LC=ke(),YC=we(),To=DA(),VC=LC(Function.toString);YC(To.inspectSource)||(To.inspectSource=function(e){return VC(e)});Cg.exports=To.inspectSource});var Eg=D((CN,mg)=>{"use strict";var zC=he(),WC=we(),hg=zC.WeakMap;mg.exports=WC(hg)&&/native code/.test(String(hg))});var _o=D((QN,wg)=>{"use strict";var XC=Eo(),ZC=wo(),yg=XC("keys");wg.exports=function(e){return yg[e]||(yg[e]=ZC(e))}});var SA=D((hN,Dg)=>{"use strict";Dg.exports={}});var kg=D((mN,xg)=>{"use strict";var jC=Eg(),Sg=he(),$C=Yt(),eQ=Ho(),Po=dt(),Oo=DA(),tQ=_o(),rQ=SA(),Fg="Object already initialized",Jo=Sg.TypeError,AQ=Sg.WeakMap,xA,Rr,kA,iQ=function(e){return kA(e)?Rr(e):xA(e,{})},oQ=function(e){return function(t){var r;if(!$C(t)||(r=Rr(t)).type!==e)throw new Jo("Incompatible receiver, "+e+" required");return r}};jC||Oo.state?(Ne=Oo.state||(Oo.state=new AQ),Ne.get=Ne.get,Ne.has=Ne.has,Ne.set=Ne.set,xA=function(e,t){if(Ne.has(e))throw new Jo(Fg);return t.facade=e,Ne.set(e,t),t},Rr=function(e){return Ne.get(e)||{}},kA=function(e){return Ne.has(e)}):(Ut=tQ("state"),rQ[Ut]=!0,xA=function(e,t){if(Po(e,Ut))throw new Jo(Fg);return t.facade=e,eQ(e,Ut,t),t},Rr=function(e){return Po(e,Ut)?e[Ut]:{}},kA=function(e){return Po(e,Ut)});var Ne,Ut;xg.exports={set:xA,get:Rr,has:kA,enforce:iQ,getterFor:oQ}});var Gg=D((EN,vg)=>{"use strict";var Lo=ke(),nQ=xe(),aQ=we(),bA=dt(),Ko=qe(),sQ=Bg().CONFIGURABLE,gQ=Qg(),Ng=kg(),IQ=Ng.enforce,cQ=Ng.get,bg=String,NA=Object.defineProperty,lQ=Lo("".slice),uQ=Lo("".replace),fQ=Lo([].join),dQ=Ko&&!nQ(function(){return NA(function(){},"length",{value:8}).length!==8}),pQ=String(String).split("String"),BQ=vg.exports=function(e,t,r){lQ(bg(t),0,7)==="Symbol("&&(t="["+uQ(bg(t),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!bA(e,"name")||sQ&&e.name!==t)&&(Ko?NA(e,"name",{value:t,configurable:!0}):e.name=t),dQ&&r&&bA(r,"arity")&&e.length!==r.arity&&NA(e,"length",{value:r.arity});try{r&&bA(r,"constructor")&&r.constructor?Ko&&NA(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch{}var A=IQ(e);return bA(A,"source")||(A.source=fQ(pQ,typeof t=="string"?t:"")),e};Function.prototype.toString=BQ(function(){return aQ(this)&&cQ(this).source||gQ(this)},"toString")});var Mg=D((yN,Ug)=>{"use strict";var CQ=we(),QQ=Xt(),hQ=Gg(),mQ=wA();Ug.exports=function(e,t,r,A){A||(A={});var i=A.enumerable,o=A.name!==void 0?A.name:t;if(CQ(r)&&hQ(r,o,A),A.global)i?e[t]=r:mQ(t,r);else{try{A.unsafe?e[t]&&(i=!0):delete e[t]}catch{}i?e[t]=r:QQ.f(e,t,{value:r,enumerable:!1,configurable:!A.nonConfigurable,writable:!A.nonWritable})}return e}});var Rg=D((wN,Hg)=>{"use strict";var EQ=Math.ceil,yQ=Math.floor;Hg.exports=Math.trunc||function(t){var r=+t;return(r>0?yQ:EQ)(r)}});var Zt=D((DN,qg)=>{"use strict";var wQ=Rg();qg.exports=function(e){var t=+e;return t!==t||t===0?0:wQ(t)}});var Yo=D((FN,Tg)=>{"use strict";var DQ=Zt(),FQ=Math.max,SQ=Math.min;Tg.exports=function(e,t){var r=DQ(e);return r<0?FQ(r+t,0):SQ(r,t)}});var Pg=D((SN,_g)=>{"use strict";var xQ=Zt(),kQ=Math.min;_g.exports=function(e){var t=xQ(e);return t>0?kQ(t,9007199254740991):0}});var Mt=D((xN,Og)=>{"use strict";var bQ=Pg();Og.exports=function(e){return bQ(e.length)}});var Lg=D((kN,Kg)=>{"use strict";var NQ=$e(),vQ=Yo(),GQ=Mt(),Jg=function(e){return function(t,r,A){var i=NQ(t),o=GQ(i);if(o===0)return!e&&-1;var n=vQ(A,o),a;if(e&&r!==r){for(;o>n;)if(a=i[n++],a!==a)return!0}else for(;o>n;n++)if((e||n in i)&&i[n]===r)return e||n||0;return!e&&-1}};Kg.exports={includes:Jg(!0),indexOf:Jg(!1)}});var zo=D((bN,Vg)=>{"use strict";var UQ=ke(),Vo=dt(),MQ=$e(),HQ=Lg().indexOf,RQ=SA(),Yg=UQ([].push);Vg.exports=function(e,t){var r=MQ(e),A=0,i=[],o;for(o in r)!Vo(RQ,o)&&Vo(r,o)&&Yg(i,o);for(;t.length>A;)Vo(r,o=t[A++])&&(~HQ(i,o)||Yg(i,o));return i}});var vA=D((NN,zg)=>{"use strict";zg.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]});var Xg=D(Wg=>{"use strict";var qQ=zo(),TQ=vA(),_Q=TQ.concat("length","prototype");Wg.f=Object.getOwnPropertyNames||function(t){return qQ(t,_Q)}});var jg=D(Zg=>{"use strict";Zg.f=Object.getOwnPropertySymbols});var eI=D((UN,$g)=>{"use strict";var PQ=Vt(),OQ=ke(),JQ=Xg(),KQ=jg(),LQ=Hr(),YQ=OQ([].concat);$g.exports=PQ("Reflect","ownKeys")||function(t){var r=JQ.f(LQ(t)),A=KQ.f;return A?YQ(r,A(t)):r}});var AI=D((MN,rI)=>{"use strict";var tI=dt(),VQ=eI(),zQ=bo(),WQ=Xt();rI.exports=function(e,t,r){for(var A=VQ(t),i=WQ.f,o=zQ.f,n=0;n<A.length;n++){var a=A[n];!tI(e,a)&&!(r&&tI(r,a))&&i(e,a,o(t,a))}}});var oI=D((HN,iI)=>{"use strict";var XQ=xe(),ZQ=we(),jQ=/#|\.prototype\./,qr=function(e,t){var r=eh[$Q(e)];return r===rh?!0:r===th?!1:ZQ(t)?XQ(t):!!t},$Q=qr.normalize=function(e){return String(e).replace(jQ,".").toLowerCase()},eh=qr.data={},th=qr.NATIVE="N",rh=qr.POLYFILL="P";iI.exports=qr});var et=D((RN,nI)=>{"use strict";var GA=he(),Ah=bo().f,ih=Ho(),oh=Mg(),nh=wA(),ah=AI(),sh=oI();nI.exports=function(e,t){var r=e.target,A=e.global,i=e.stat,o,n,a,s,g,I;if(A?n=GA:i?n=GA[r]||nh(r,{}):n=GA[r]&&GA[r].prototype,n)for(a in t){if(g=t[a],e.dontCallGetSet?(I=Ah(n,a),s=I&&I.value):s=n[a],o=sh(A?a:r+(i?".":"#")+a,e.forced),!o&&s!==void 0){if(typeof g==typeof s)continue;ah(g,s)}(e.sham||s&&s.sham)&&ih(g,"sham",!0),oh(n,a,g,e)}}});var sI=D((qN,aI)=>{"use strict";var gh=zo(),Ih=vA();aI.exports=Object.keys||function(t){return gh(t,Ih)}});var II=D(gI=>{"use strict";var ch=qe(),lh=No(),uh=Xt(),fh=Hr(),dh=$e(),ph=sI();gI.f=ch&&!lh?Object.defineProperties:function(t,r){fh(t);for(var A=dh(r),i=ph(r),o=i.length,n=0,a;o>n;)uh.f(t,a=i[n++],A[a]);return t}});var lI=D((_N,cI)=>{"use strict";var Bh=Vt();cI.exports=Bh("document","documentElement")});var hI=D((PN,QI)=>{"use strict";var Ch=Hr(),Qh=II(),uI=vA(),hh=SA(),mh=lI(),Eh=xo(),yh=_o(),fI=">",dI="<",Xo="prototype",Zo="script",BI=yh("IE_PROTO"),Wo=function(){},CI=function(e){return dI+Zo+fI+e+dI+"/"+Zo+fI},pI=function(e){e.write(CI("")),e.close();var t=e.parentWindow.Object;return e=null,t},wh=function(){var e=Eh("iframe"),t="java"+Zo+":",r;return e.style.display="none",mh.appendChild(e),e.src=String(t),r=e.contentWindow.document,r.open(),r.write(CI("document.F=Object")),r.close(),r.F},UA,MA=function(){try{UA=new ActiveXObject("htmlfile")}catch{}MA=typeof document<"u"?document.domain&&UA?pI(UA):wh():pI(UA);for(var e=uI.length;e--;)delete MA[Xo][uI[e]];return MA()};hh[BI]=!0;QI.exports=Object.create||function(t,r){var A;return t!==null?(Wo[Xo]=Ch(t),A=new Wo,Wo[Xo]=null,A[BI]=t):A=MA(),r===void 0?A:Qh.f(A,r)}});var Tr=D((ON,mI)=>{"use strict";var Dh=Wt(),Fh=hI(),Sh=Xt().f,jo=Dh("unscopables"),$o=Array.prototype;$o[jo]===void 0&&Sh($o,jo,{configurable:!0,value:Fh(null)});mI.exports=function(e){$o[jo][e]=!0}});var EI=D(()=>{"use strict";var xh=et(),kh=yo(),bh=Mt(),Nh=Zt(),vh=Tr();xh({target:"Array",proto:!0},{at:function(t){var r=kh(this),A=bh(r),i=Nh(t),o=i>=0?i:A+i;return o<0||o>=A?void 0:r[o]}});vh("at")});var wI=D((LN,yI)=>{"use strict";var Gh=Mt();yI.exports=function(e,t){for(var r=Gh(e),A=new t(r),i=0;i<r;i++)A[i]=e[r-i-1];return A}});var DI=D(()=>{"use strict";var Uh=et(),Mh=wI(),Hh=$e(),Rh=Tr(),qh=Array;Uh({target:"Array",proto:!0},{toReversed:function(){return Mh(Hh(this),qh)}});Rh("toReversed")});var SI=D((zN,FI)=>{"use strict";var Th=Mt();FI.exports=function(e,t,r){for(var A=0,i=arguments.length>2?r:Th(t),o=new e(i);i>A;)o[A]=t[A++];return o}});var kI=D((WN,xI)=>{"use strict";var _h=he();xI.exports=function(e,t){var r=_h[e],A=r&&r.prototype;return A&&A[t]}});var bI=D(()=>{"use strict";var Ph=et(),Oh=ke(),Jh=yA(),Kh=$e(),Lh=SI(),Yh=kI(),Vh=Tr(),zh=Array,Wh=Oh(Yh("Array","sort"));Ph({target:"Array",proto:!0},{toSorted:function(t){t!==void 0&&Jh(t);var r=Kh(this),A=Lh(zh,r);return Wh(A,t)}});Vh("toSorted")});var vI=D((jN,NI)=>{"use strict";var Xh=TypeError,Zh=9007199254740991;NI.exports=function(e){if(e>Zh)throw Xh("Maximum allowed index exceeded");return e}});var GI=D(()=>{"use strict";var jh=et(),$h=Tr(),em=vI(),tm=Mt(),rm=Yo(),Am=$e(),im=Zt(),om=Array,nm=Math.max,am=Math.min;jh({target:"Array",proto:!0},{toSpliced:function(t,r){var A=Am(this),i=tm(A),o=rm(t,i),n=arguments.length,a=0,s,g,I,l;for(n===0?s=g=0:n===1?(s=0,g=i-o):(s=n-2,g=am(nm(im(r),0),i-o)),I=em(i+s-g),l=om(I);a<o;a++)l[a]=A[a];for(;a<o+s;a++)l[a]=arguments[a-o+2];for(;a<I;a++)l[a]=A[a+g-s];return l}});$h("toSpliced")});var MI=D((tv,UI)=>{"use strict";var sm=Mt(),gm=Zt(),Im=RangeError;UI.exports=function(e,t,r,A){var i=sm(e),o=gm(r),n=o<0?i+o:o;if(n>=i||n<0)throw new Im("Incorrect index");for(var a=new t(i),s=0;s<i;s++)a[s]=s===n?A:e[s];return a}});var HI=D(()=>{"use strict";var cm=et(),lm=MI(),um=$e(),fm=Array;cm({target:"Array",proto:!0},{with:function(e,t){return lm(um(this),fm,e,t)}})});var TI=D((iv,qI)=>{"use strict";var RI=yA(),dm=TypeError,pm=function(e){var t,r;this.promise=new e(function(A,i){if(t!==void 0||r!==void 0)throw new dm("Bad Promise constructor");t=A,r=i}),this.resolve=RI(t),this.reject=RI(r)};qI.exports.f=function(e){return new pm(e)}});var _I=D(()=>{"use strict";var Bm=et(),Cm=TI();Bm({target:"Promise",stat:!0},{withResolvers:function(){var t=Cm.f(this);return{promise:t.promise,resolve:t.resolve,reject:t.reject}}})});var en=D((av,PI)=>{"use strict";var Qm=TypeError;PI.exports=function(e,t){if(e<t)throw new Qm("Not enough arguments");return e}});var KI=D((sv,JI)=>{"use strict";var hm=Wt(),mm=hm("toStringTag"),OI={};OI[mm]="z";JI.exports=String(OI)==="[object z]"});var YI=D((gv,LI)=>{"use strict";var Em=KI(),ym=we(),HA=ao(),wm=Wt(),Dm=wm("toStringTag"),Fm=Object,Sm=HA(function(){return arguments}())==="Arguments",xm=function(e,t){try{return e[t]}catch{}};LI.exports=Em?HA:function(e){var t,r,A;return e===void 0?"Undefined":e===null?"Null":typeof(r=xm(t=Fm(e),Dm))=="string"?r:Sm?HA(t):(A=HA(t))==="Object"&&ym(t.callee)?"Arguments":A}});var tn=D((Iv,VI)=>{"use strict";var km=YI(),bm=String;VI.exports=function(e){if(km(e)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return bm(e)}});var rn=D((cv,WI)=>{"use strict";var Nm=xe(),vm=Wt(),Gm=qe(),zI=mo(),Um=vm("iterator");WI.exports=!Nm(function(){var e=new URL("b?a=1&b=2&c=3","https://a"),t=e.searchParams,r=new URLSearchParams("a=1&a=2&b=3"),A="";return e.pathname="c%20d",t.forEach(function(i,o){t.delete("b"),A+=o+i}),r.delete("a",2),r.delete("b",void 0),zI&&(!e.toJSON||!r.has("a",1)||r.has("a",2)||!r.has("a",void 0)||r.has("b"))||!t.size&&(zI||!Gm)||!t.sort||e.href!=="https://a/c%20d?a=1&c=3"||t.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!t[Um]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("https://\u0442\u0435\u0441\u0442").host!=="xn--e1aybc"||new URL("https://a#\u0431").hash!=="#%D0%B1"||A!=="a1c3"||new URL("https://x",void 0).host!=="x"})});var jI=D(()=>{"use strict";var Mm=et(),Hm=Vt(),ZI=xe(),Rm=en(),XI=tn(),qm=rn(),An=Hm("URL"),Tm=qm&&ZI(function(){An.canParse()}),_m=ZI(function(){return An.canParse.length!==1});Mm({target:"URL",stat:!0,forced:!Tm||_m},{canParse:function(t){var r=Rm(arguments.length,1),A=XI(t),i=r<2||arguments[1]===void 0?void 0:XI(arguments[1]);try{return!!new An(A,i)}catch{return!1}}})});var ec=D(()=>{"use strict";var Pm=et(),Om=Vt(),Jm=en(),$I=tn(),Km=rn(),Lm=Om("URL");Pm({target:"URL",stat:!0,forced:!Km},{parse:function(t){var r=Jm(arguments.length,1),A=$I(t),i=r<2||arguments[1]===void 0?void 0:$I(arguments[1]);try{return new Lm(A,i)}catch{return null}}})});var K=D((pn,Gu)=>{(function(e,t){if(typeof define=="function"&&define.amd)define("webextension-polyfill",["module"],t);else if(typeof pn<"u")t(Gu);else{var r={exports:{}};t(r),e.browser=r.exports}})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:pn,function(e){"use strict";if(!(globalThis.chrome&&globalThis.chrome.runtime&&globalThis.chrome.runtime.id))throw new Error("This script should only be loaded in a browser extension.");if(globalThis.browser&&globalThis.browser.runtime&&globalThis.browser.runtime.id)e.exports=globalThis.browser;else{let t="The message port closed before a response was received.",r=A=>{let i={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(Object.keys(i).length===0)throw new Error("api-metadata.json has not been included in browser-polyfill");class o extends WeakMap{constructor(w,f=void 0){super(f),this.createItem=w}get(w){return this.has(w)||this.set(w,this.createItem(w)),super.get(w)}}let n=d=>d&&typeof d=="object"&&typeof d.then=="function",a=(d,w)=>(...f)=>{A.runtime.lastError?d.reject(new Error(A.runtime.lastError.message)):w.singleCallbackArg||f.length<=1&&w.singleCallbackArg!==!1?d.resolve(f[0]):d.resolve(f)},s=d=>d==1?"argument":"arguments",g=(d,w)=>function(Q,...p){if(p.length<w.minArgs)throw new Error(`Expected at least ${w.minArgs} ${s(w.minArgs)} for ${d}(), got ${p.length}`);if(p.length>w.maxArgs)throw new Error(`Expected at most ${w.maxArgs} ${s(w.maxArgs)} for ${d}(), got ${p.length}`);return new Promise((N,S)=>{if(w.fallbackToNoCallback)try{Q[d](...p,a({resolve:N,reject:S},w))}catch{Q[d](...p),w.fallbackToNoCallback=!1,w.noCallback=!0,N()}else w.noCallback?(Q[d](...p),N()):Q[d](...p,a({resolve:N,reject:S},w))})},I=(d,w,f)=>new Proxy(w,{apply(Q,p,N){return f.call(p,d,...N)}}),l=Function.call.bind(Object.prototype.hasOwnProperty),c=(d,w={},f={})=>{let Q=Object.create(null),p={has(S,x){return x in d||x in Q},get(S,x,U){if(x in Q)return Q[x];if(!(x in d))return;let E=d[x];if(typeof E=="function")if(typeof w[x]=="function")E=I(d,d[x],w[x]);else if(l(f,x)){let v=g(x,f[x]);E=I(d,d[x],v)}else E=E.bind(d);else if(typeof E=="object"&&E!==null&&(l(w,x)||l(f,x)))E=c(E,w[x],f[x]);else if(l(f,"*"))E=c(E,w[x],f["*"]);else return Object.defineProperty(Q,x,{configurable:!0,enumerable:!0,get(){return d[x]},set(v){d[x]=v}}),E;return Q[x]=E,E},set(S,x,U,E){return x in Q?Q[x]=U:d[x]=U,!0},defineProperty(S,x,U){return Reflect.defineProperty(Q,x,U)},deleteProperty(S,x){return Reflect.deleteProperty(Q,x)}},N=Object.create(d);return new Proxy(N,p)},u=d=>({addListener(w,f,...Q){w.addListener(d.get(f),...Q)},hasListener(w,f){return w.hasListener(d.get(f))},removeListener(w,f){w.removeListener(d.get(f))}}),C=new o(d=>typeof d!="function"?d:function(f){let Q=c(f,{},{getContent:{minArgs:0,maxArgs:0}});d(Q)}),m=new o(d=>typeof d!="function"?d:function(f,Q,p){let N=!1,S,x=new Promise(H=>{S=function(q){N=!0,H(q)}}),U;try{U=d(f,Q,S)}catch(H){U=Promise.reject(H)}let E=U!==!0&&n(U);if(U!==!0&&!E&&!N)return!1;let v=H=>{H.then(q=>{p(q)},q=>{let L;q&&(q instanceof Error||typeof q.message=="string")?L=q.message:L="An unexpected error occurred",p({__mozWebExtensionPolyfillReject__:!0,message:L})}).catch(q=>{})};return v(E?U:x),!0}),y=({reject:d,resolve:w},f)=>{A.runtime.lastError?A.runtime.lastError.message===t?w():d(new Error(A.runtime.lastError.message)):f&&f.__mozWebExtensionPolyfillReject__?d(new Error(f.message)):w(f)},h=(d,w,f,...Q)=>{if(Q.length<w.minArgs)throw new Error(`Expected at least ${w.minArgs} ${s(w.minArgs)} for ${d}(), got ${Q.length}`);if(Q.length>w.maxArgs)throw new Error(`Expected at most ${w.maxArgs} ${s(w.maxArgs)} for ${d}(), got ${Q.length}`);return new Promise((p,N)=>{let S=y.bind(null,{resolve:p,reject:N});Q.push(S),f.sendMessage(...Q)})},F={devtools:{network:{onRequestFinished:u(C)}},runtime:{onMessage:u(m),onMessageExternal:u(m),sendMessage:h.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:h.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},b={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return i.privacy={network:{"*":b},services:{"*":b},websites:{"*":b}},c(A,F,i)};e.exports=r(chrome)}})});var wf=D((FJ,Ei)=>{(function(){"use strict";var e={}.hasOwnProperty;function t(){for(var i="",o=0;o<arguments.length;o++){var n=arguments[o];n&&(i=A(i,r(n)))}return i}function r(i){if(typeof i=="string"||typeof i=="number")return i;if(typeof i!="object")return"";if(Array.isArray(i))return t.apply(null,i);if(i.toString!==Object.prototype.toString&&!i.toString.toString().includes("[native code]"))return i.toString();var o="";for(var n in i)e.call(i,n)&&i[n]&&(o=A(o,n));return o}function A(i,o){return o?i?i+" "+o:i+o:i}typeof Ei<"u"&&Ei.exports?(t.default=t,Ei.exports=t):typeof define=="function"&&typeof define.amd=="object"&&define.amd?define("classnames",[],function(){return t}):window.classNames=t})()});var Qd=D(O=>{"use strict";var gA=Symbol.for("react.element"),Gk=Symbol.for("react.portal"),Uk=Symbol.for("react.fragment"),Mk=Symbol.for("react.strict_mode"),Hk=Symbol.for("react.profiler"),Rk=Symbol.for("react.provider"),qk=Symbol.for("react.context"),Tk=Symbol.for("react.forward_ref"),_k=Symbol.for("react.suspense"),Pk=Symbol.for("react.memo"),Ok=Symbol.for("react.lazy"),gd=Symbol.iterator;function Jk(e){return e===null||typeof e!="object"?null:(e=gd&&e[gd]||e["@@iterator"],typeof e=="function"?e:null)}var ld={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ud=Object.assign,fd={};function Dr(e,t,r){this.props=e,this.context=t,this.refs=fd,this.updater=r||ld}Dr.prototype.isReactComponent={};Dr.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Dr.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function dd(){}dd.prototype=Dr.prototype;function oa(e,t,r){this.props=e,this.context=t,this.refs=fd,this.updater=r||ld}var na=oa.prototype=new dd;na.constructor=oa;ud(na,Dr.prototype);na.isPureReactComponent=!0;var Id=Array.isArray,pd=Object.prototype.hasOwnProperty,aa={current:null},Bd={key:!0,ref:!0,__self:!0,__source:!0};function Cd(e,t,r){var A,i={},o=null,n=null;if(t!=null)for(A in t.ref!==void 0&&(n=t.ref),t.key!==void 0&&(o=""+t.key),t)pd.call(t,A)&&!Bd.hasOwnProperty(A)&&(i[A]=t[A]);var a=arguments.length-2;if(a===1)i.children=r;else if(1<a){for(var s=Array(a),g=0;g<a;g++)s[g]=arguments[g+2];i.children=s}if(e&&e.defaultProps)for(A in a=e.defaultProps,a)i[A]===void 0&&(i[A]=a[A]);return{$$typeof:gA,type:e,key:o,ref:n,props:i,_owner:aa.current}}function Kk(e,t){return{$$typeof:gA,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function sa(e){return typeof e=="object"&&e!==null&&e.$$typeof===gA}function Lk(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var cd=/\/+/g;function ia(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Lk(""+e.key):t.toString(36)}function Ui(e,t,r,A,i){var o=typeof e;(o==="undefined"||o==="boolean")&&(e=null);var n=!1;if(e===null)n=!0;else switch(o){case"string":case"number":n=!0;break;case"object":switch(e.$$typeof){case gA:case Gk:n=!0}}if(n)return n=e,i=i(n),e=A===""?"."+ia(n,0):A,Id(i)?(r="",e!=null&&(r=e.replace(cd,"$&/")+"/"),Ui(i,t,r,"",function(g){return g})):i!=null&&(sa(i)&&(i=Kk(i,r+(!i.key||n&&n.key===i.key?"":(""+i.key).replace(cd,"$&/")+"/")+e)),t.push(i)),1;if(n=0,A=A===""?".":A+":",Id(e))for(var a=0;a<e.length;a++){o=e[a];var s=A+ia(o,a);n+=Ui(o,t,r,s,i)}else if(s=Jk(e),typeof s=="function")for(e=s.call(e),a=0;!(o=e.next()).done;)o=o.value,s=A+ia(o,a++),n+=Ui(o,t,r,s,i);else if(o==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return n}function Gi(e,t,r){if(e==null)return e;var A=[],i=0;return Ui(e,A,"","",function(o){return t.call(r,o,i++)}),A}function Yk(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var de={current:null},Mi={transition:null},Vk={ReactCurrentDispatcher:de,ReactCurrentBatchConfig:Mi,ReactCurrentOwner:aa};O.Children={map:Gi,forEach:function(e,t,r){Gi(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Gi(e,function(){t++}),t},toArray:function(e){return Gi(e,function(t){return t})||[]},only:function(e){if(!sa(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};O.Component=Dr;O.Fragment=Uk;O.Profiler=Hk;O.PureComponent=oa;O.StrictMode=Mk;O.Suspense=_k;O.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Vk;O.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var A=ud({},e.props),i=e.key,o=e.ref,n=e._owner;if(t!=null){if(t.ref!==void 0&&(o=t.ref,n=aa.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(s in t)pd.call(t,s)&&!Bd.hasOwnProperty(s)&&(A[s]=t[s]===void 0&&a!==void 0?a[s]:t[s])}var s=arguments.length-2;if(s===1)A.children=r;else if(1<s){a=Array(s);for(var g=0;g<s;g++)a[g]=arguments[g+2];A.children=a}return{$$typeof:gA,type:e.type,key:i,ref:o,props:A,_owner:n}};O.createContext=function(e){return e={$$typeof:qk,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Rk,_context:e},e.Consumer=e};O.createElement=Cd;O.createFactory=function(e){var t=Cd.bind(null,e);return t.type=e,t};O.createRef=function(){return{current:null}};O.forwardRef=function(e){return{$$typeof:Tk,render:e}};O.isValidElement=sa;O.lazy=function(e){return{$$typeof:Ok,_payload:{_status:-1,_result:e},_init:Yk}};O.memo=function(e,t){return{$$typeof:Pk,type:e,compare:t===void 0?null:t}};O.startTransition=function(e){var t=Mi.transition;Mi.transition={};try{e()}finally{Mi.transition=t}};O.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};O.useCallback=function(e,t){return de.current.useCallback(e,t)};O.useContext=function(e){return de.current.useContext(e)};O.useDebugValue=function(){};O.useDeferredValue=function(e){return de.current.useDeferredValue(e)};O.useEffect=function(e,t){return de.current.useEffect(e,t)};O.useId=function(){return de.current.useId()};O.useImperativeHandle=function(e,t,r){return de.current.useImperativeHandle(e,t,r)};O.useInsertionEffect=function(e,t){return de.current.useInsertionEffect(e,t)};O.useLayoutEffect=function(e,t){return de.current.useLayoutEffect(e,t)};O.useMemo=function(e,t){return de.current.useMemo(e,t)};O.useReducer=function(e,t,r){return de.current.useReducer(e,t,r)};O.useRef=function(e){return de.current.useRef(e)};O.useState=function(e){return de.current.useState(e)};O.useSyncExternalStore=function(e,t,r){return de.current.useSyncExternalStore(e,t,r)};O.useTransition=function(){return de.current.useTransition()};O.version="18.2.0"});var Ce=D((d8,hd)=>{"use strict";hd.exports=Qd()});var Sd=D((S8,Fd)=>{"use strict";Fd.exports=()=>{let e={};return e.promise=new Promise((t,r)=>{e.resolve=t,e.reject=r}),e}});var kd=D((x8,xd)=>{"use strict";var eb=Sd();function tb(e,t="maxAge"){let r,A,i,o=async()=>{if(r!==void 0)return;let s=async g=>{i=eb();let I=g[1][t]-Date.now();if(I<=0){e.delete(g[0]),i.resolve();return}return r=g[0],A=setTimeout(()=>{e.delete(g[0]),i&&i.resolve()},I),typeof A.unref=="function"&&A.unref(),i.promise};try{for(let g of e)await s(g)}catch{}r=void 0},n=()=>{r=void 0,A!==void 0&&(clearTimeout(A),A=void 0),i!==void 0&&(i.reject(void 0),i=void 0)},a=e.set.bind(e);return e.set=(s,g)=>{e.has(s)&&e.delete(s);let I=a(s,g);return r&&r===s&&n(),o(),I},o(),e}xd.exports=tb});var la=D((k8,bd)=>{"use strict";var rb=kd(),ca=class{constructor(t,r){if(this.maxAge=t,this[Symbol.toStringTag]="Map",this.data=new Map,rb(this.data),r)for(let[A,i]of r)this.set(A,i)}get size(){return this.data.size}clear(){this.data.clear()}delete(t){return this.data.delete(t)}has(t){return this.data.has(t)}get(t){let r=this.data.get(t);if(r)return r.data}set(t,r){return this.data.set(t,{maxAge:Date.now()+this.maxAge,data:r}),this}values(){return this.createIterator(t=>t[1].data)}keys(){return this.data.keys()}entries(){return this.createIterator(t=>[t[0],t[1].data])}forEach(t,r){for(let[A,i]of this.entries())t.apply(r,[i,A,this])}[Symbol.iterator](){return this.entries()}*createIterator(t){for(let r of this.data.entries())yield t(r)}};bd.exports=ca});var Cp=D((J1,Bp)=>{Bp.exports={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0}});var pv=G(EI()),Bv=G(DI()),Cv=G(bI()),Qv=G(GI()),hv=G(HI()),mv=G(_I()),Ev=G(jI()),yv=G(ec()),tc=AbortSignal.any||function(t){let r=new AbortController;if(t.length===0)return r.signal;let A=t.find(o=>o.aborted);if(A)return r.abort(A.reason),r.signal;let i=function(){r.abort(this.reason)};for(let o of t)o.addEventListener("abort",i,{once:!0,signal:r.signal});return r.signal},rc=AbortSignal.timeout||function(t){let r=new AbortController;return setTimeout(()=>{r.abort(new DOMException("Timeout","TimeoutError"))},t),r.signal};var Ym=typeof global=="object"&&global&&global.Object===Object&&global,RA=Ym;var Vm=typeof self=="object"&&self&&self.Object===Object&&self,zm=RA||Vm||Function("return this")(),re=zm;var Wm=re.Symbol,fe=Wm;var Ac=Object.prototype,Xm=Ac.hasOwnProperty,Zm=Ac.toString,_r=fe?fe.toStringTag:void 0;function jm(e){var t=Xm.call(e,_r),r=e[_r];try{e[_r]=void 0;var A=!0}catch{}var i=Zm.call(e);return A&&(t?e[_r]=r:delete e[_r]),i}var ic=jm;var $m=Object.prototype,eE=$m.toString;function tE(e){return eE.call(e)}var oc=tE;var rE="[object Null]",AE="[object Undefined]",nc=fe?fe.toStringTag:void 0;function iE(e){return e==null?e===void 0?AE:rE:nc&&nc in Object(e)?ic(e):oc(e)}var me=iE;function oE(e){return e!=null&&typeof e=="object"}var ne=oE;var nE="[object Symbol]";function aE(e){return typeof e=="symbol"||ne(e)&&me(e)==nE}var pt=aE;function sE(e,t){for(var r=-1,A=e==null?0:e.length,i=Array(A);++r<A;)i[r]=t(e[r],r,e);return i}var qA=sE;var gE=Array.isArray,$=gE;var IE=1/0,ac=fe?fe.prototype:void 0,sc=ac?ac.toString:void 0;function gc(e){if(typeof e=="string")return e;if($(e))return qA(e,gc)+"";if(pt(e))return sc?sc.call(e):"";var t=e+"";return t=="0"&&1/e==-IE?"-0":t}var Ic=gc;var cE=/\s/;function lE(e){for(var t=e.length;t--&&cE.test(e.charAt(t)););return t}var cc=lE;var uE=/^\s+/;function fE(e){return e&&e.slice(0,cc(e)+1).replace(uE,"")}var lc=fE;function dE(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var W=dE;var uc=NaN,pE=/^[-+]0x[0-9a-f]+$/i,BE=/^0b[01]+$/i,CE=/^0o[0-7]+$/i,QE=parseInt;function hE(e){if(typeof e=="number")return e;if(pt(e))return uc;if(W(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=W(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=lc(e);var r=BE.test(e);return r||CE.test(e)?QE(e.slice(2),r?2:8):pE.test(e)?uc:+e}var on=hE;function mE(e){return e}var jt=mE;var EE="[object AsyncFunction]",yE="[object Function]",wE="[object GeneratorFunction]",DE="[object Proxy]";function FE(e){if(!W(e))return!1;var t=me(e);return t==yE||t==wE||t==EE||t==DE}var $t=FE;var SE=re["__core-js_shared__"],TA=SE;var fc=function(){var e=/[^.]+$/.exec(TA&&TA.keys&&TA.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function xE(e){return!!fc&&fc in e}var dc=xE;var kE=Function.prototype,bE=kE.toString;function NE(e){if(e!=null){try{return bE.call(e)}catch{}try{return e+""}catch{}}return""}var tt=NE;var vE=/[\\^$.*+?()[\]{}|]/g,GE=/^\[object .+?Constructor\]$/,UE=Function.prototype,ME=Object.prototype,HE=UE.toString,RE=ME.hasOwnProperty,qE=RegExp("^"+HE.call(RE).replace(vE,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function TE(e){if(!W(e)||dc(e))return!1;var t=$t(e)?qE:GE;return t.test(tt(e))}var pc=TE;function _E(e,t){return e?.[t]}var Bc=_E;function PE(e,t){var r=Bc(e,t);return pc(r)?r:void 0}var Be=PE;var OE=Be(re,"WeakMap"),_A=OE;var Cc=Object.create,JE=function(){function e(){}return function(t){if(!W(t))return{};if(Cc)return Cc(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}(),Qc=JE;function KE(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var hc=KE;function LE(){}var rt=LE;function YE(e,t){var r=-1,A=e.length;for(t||(t=Array(A));++r<A;)t[r]=e[r];return t}var PA=YE;var VE=800,zE=16,WE=Date.now;function XE(e){var t=0,r=0;return function(){var A=WE(),i=zE-(A-r);if(r=A,i>0){if(++t>=VE)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var mc=XE;function ZE(e){return function(){return e}}var Ec=ZE;var jE=function(){try{var e=Be(Object,"defineProperty");return e({},"",{}),e}catch{}}(),er=jE;var $E=er?function(e,t){return er(e,"toString",{configurable:!0,enumerable:!1,value:Ec(t),writable:!0})}:jt,yc=$E;var ey=mc(yc),wc=ey;function ty(e,t){for(var r=-1,A=e==null?0:e.length;++r<A&&t(e[r],r,e)!==!1;);return e}var Dc=ty;var ry=9007199254740991,Ay=/^(?:0|[1-9]\d*)$/;function iy(e,t){var r=typeof e;return t=t??ry,!!t&&(r=="number"||r!="symbol"&&Ay.test(e))&&e>-1&&e%1==0&&e<t}var Bt=iy;function oy(e,t,r){t=="__proto__"&&er?er(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var tr=oy;function ny(e,t){return e===t||e!==e&&t!==t}var Te=ny;var ay=Object.prototype,sy=ay.hasOwnProperty;function gy(e,t,r){var A=e[t];(!(sy.call(e,t)&&Te(A,r))||r===void 0&&!(t in e))&&tr(e,t,r)}var rr=gy;function Iy(e,t,r,A){var i=!r;r||(r={});for(var o=-1,n=t.length;++o<n;){var a=t[o],s=A?A(r[a],e[a],a,r,e):void 0;s===void 0&&(s=e[a]),i?tr(r,a,s):rr(r,a,s)}return r}var _e=Iy;var Fc=Math.max;function cy(e,t,r){return t=Fc(t===void 0?e.length-1:t,0),function(){for(var A=arguments,i=-1,o=Fc(A.length-t,0),n=Array(o);++i<o;)n[i]=A[t+i];i=-1;for(var a=Array(t+1);++i<t;)a[i]=A[i];return a[t]=r(n),hc(e,this,a)}}var Sc=cy;function ly(e,t){return wc(Sc(e,t,jt),e+"")}var xc=ly;var uy=9007199254740991;function fy(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=uy}var Ar=fy;function dy(e){return e!=null&&Ar(e.length)&&!$t(e)}var Pe=dy;function py(e,t,r){if(!W(r))return!1;var A=typeof t;return(A=="number"?Pe(r)&&Bt(t,r.length):A=="string"&&t in r)?Te(r[t],e):!1}var kc=py;function By(e){return xc(function(t,r){var A=-1,i=r.length,o=i>1?r[i-1]:void 0,n=i>2?r[2]:void 0;for(o=e.length>3&&typeof o=="function"?(i--,o):void 0,n&&kc(r[0],r[1],n)&&(o=i<3?void 0:o,i=1),t=Object(t);++A<i;){var a=r[A];a&&e(t,a,A,o)}return t})}var bc=By;var Cy=Object.prototype;function Qy(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||Cy;return e===r}var Ct=Qy;function hy(e,t){for(var r=-1,A=Array(e);++r<e;)A[r]=t(r);return A}var Nc=hy;var my="[object Arguments]";function Ey(e){return ne(e)&&me(e)==my}var nn=Ey;var vc=Object.prototype,yy=vc.hasOwnProperty,wy=vc.propertyIsEnumerable,Dy=nn(function(){return arguments}())?nn:function(e){return ne(e)&&yy.call(e,"callee")&&!wy.call(e,"callee")},At=Dy;function Fy(){return!1}var Gc=Fy;var Hc=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Uc=Hc&&typeof module=="object"&&module&&!module.nodeType&&module,Sy=Uc&&Uc.exports===Hc,Mc=Sy?re.Buffer:void 0,xy=Mc?Mc.isBuffer:void 0,ky=xy||Gc,ve=ky;var by="[object Arguments]",Ny="[object Array]",vy="[object Boolean]",Gy="[object Date]",Uy="[object Error]",My="[object Function]",Hy="[object Map]",Ry="[object Number]",qy="[object Object]",Ty="[object RegExp]",_y="[object Set]",Py="[object String]",Oy="[object WeakMap]",Jy="[object ArrayBuffer]",Ky="[object DataView]",Ly="[object Float32Array]",Yy="[object Float64Array]",Vy="[object Int8Array]",zy="[object Int16Array]",Wy="[object Int32Array]",Xy="[object Uint8Array]",Zy="[object Uint8ClampedArray]",jy="[object Uint16Array]",$y="[object Uint32Array]",Z={};Z[Ly]=Z[Yy]=Z[Vy]=Z[zy]=Z[Wy]=Z[Xy]=Z[Zy]=Z[jy]=Z[$y]=!0;Z[by]=Z[Ny]=Z[Jy]=Z[vy]=Z[Ky]=Z[Gy]=Z[Uy]=Z[My]=Z[Hy]=Z[Ry]=Z[qy]=Z[Ty]=Z[_y]=Z[Py]=Z[Oy]=!1;function ew(e){return ne(e)&&Ar(e.length)&&!!Z[me(e)]}var Rc=ew;function tw(e){return function(t){return e(t)}}var ir=tw;var qc=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Pr=qc&&typeof module=="object"&&module&&!module.nodeType&&module,rw=Pr&&Pr.exports===qc,an=rw&&RA.process,Aw=function(){try{var e=Pr&&Pr.require&&Pr.require("util").types;return e||an&&an.binding&&an.binding("util")}catch{}}(),it=Aw;var Tc=it&&it.isTypedArray,iw=Tc?ir(Tc):Rc,Qt=iw;var ow=Object.prototype,nw=ow.hasOwnProperty;function aw(e,t){var r=$(e),A=!r&&At(e),i=!r&&!A&&ve(e),o=!r&&!A&&!i&&Qt(e),n=r||A||i||o,a=n?Nc(e.length,String):[],s=a.length;for(var g in e)(t||nw.call(e,g))&&!(n&&(g=="length"||i&&(g=="offset"||g=="parent")||o&&(g=="buffer"||g=="byteLength"||g=="byteOffset")||Bt(g,s)))&&a.push(g);return a}var OA=aw;function sw(e,t){return function(r){return e(t(r))}}var JA=sw;var gw=JA(Object.keys,Object),_c=gw;var Iw=Object.prototype,cw=Iw.hasOwnProperty;function lw(e){if(!Ct(e))return _c(e);var t=[];for(var r in Object(e))cw.call(e,r)&&r!="constructor"&&t.push(r);return t}var KA=lw;function uw(e){return Pe(e)?OA(e):KA(e)}var ht=uw;function fw(e){var t=[];if(e!=null)for(var r in Object(e))t.push(r);return t}var Pc=fw;var dw=Object.prototype,pw=dw.hasOwnProperty;function Bw(e){if(!W(e))return Pc(e);var t=Ct(e),r=[];for(var A in e)A=="constructor"&&(t||!pw.call(e,A))||r.push(A);return r}var Oc=Bw;function Cw(e){return Pe(e)?OA(e,!0):Oc(e)}var Oe=Cw;var Qw=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,hw=/^\w*$/;function mw(e,t){if($(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||pt(e)?!0:hw.test(e)||!Qw.test(e)||t!=null&&e in Object(t)}var or=mw;var Ew=Be(Object,"create"),ot=Ew;function yw(){this.__data__=ot?ot(null):{},this.size=0}var Jc=yw;function ww(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var Kc=ww;var Dw="__lodash_hash_undefined__",Fw=Object.prototype,Sw=Fw.hasOwnProperty;function xw(e){var t=this.__data__;if(ot){var r=t[e];return r===Dw?void 0:r}return Sw.call(t,e)?t[e]:void 0}var Lc=xw;var kw=Object.prototype,bw=kw.hasOwnProperty;function Nw(e){var t=this.__data__;return ot?t[e]!==void 0:bw.call(t,e)}var Yc=Nw;var vw="__lodash_hash_undefined__";function Gw(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=ot&&t===void 0?vw:t,this}var Vc=Gw;function nr(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var A=e[t];this.set(A[0],A[1])}}nr.prototype.clear=Jc;nr.prototype.delete=Kc;nr.prototype.get=Lc;nr.prototype.has=Yc;nr.prototype.set=Vc;var sn=nr;function Uw(){this.__data__=[],this.size=0}var zc=Uw;function Mw(e,t){for(var r=e.length;r--;)if(Te(e[r][0],t))return r;return-1}var mt=Mw;var Hw=Array.prototype,Rw=Hw.splice;function qw(e){var t=this.__data__,r=mt(t,e);if(r<0)return!1;var A=t.length-1;return r==A?t.pop():Rw.call(t,r,1),--this.size,!0}var Wc=qw;function Tw(e){var t=this.__data__,r=mt(t,e);return r<0?void 0:t[r][1]}var Xc=Tw;function _w(e){return mt(this.__data__,e)>-1}var Zc=_w;function Pw(e,t){var r=this.__data__,A=mt(r,e);return A<0?(++this.size,r.push([e,t])):r[A][1]=t,this}var jc=Pw;function ar(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var A=e[t];this.set(A[0],A[1])}}ar.prototype.clear=zc;ar.prototype.delete=Wc;ar.prototype.get=Xc;ar.prototype.has=Zc;ar.prototype.set=jc;var Et=ar;var Ow=Be(re,"Map"),yt=Ow;function Jw(){this.size=0,this.__data__={hash:new sn,map:new(yt||Et),string:new sn}}var $c=Jw;function Kw(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var el=Kw;function Lw(e,t){var r=e.__data__;return el(t)?r[typeof t=="string"?"string":"hash"]:r.map}var wt=Lw;function Yw(e){var t=wt(this,e).delete(e);return this.size-=t?1:0,t}var tl=Yw;function Vw(e){return wt(this,e).get(e)}var rl=Vw;function zw(e){return wt(this,e).has(e)}var Al=zw;function Ww(e,t){var r=wt(this,e),A=r.size;return r.set(e,t),this.size+=r.size==A?0:1,this}var il=Ww;function sr(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var A=e[t];this.set(A[0],A[1])}}sr.prototype.clear=$c;sr.prototype.delete=tl;sr.prototype.get=rl;sr.prototype.has=Al;sr.prototype.set=il;var Ht=sr;var Xw="Expected a function";function gn(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(Xw);var r=function(){var A=arguments,i=t?t.apply(this,A):A[0],o=r.cache;if(o.has(i))return o.get(i);var n=e.apply(this,A);return r.cache=o.set(i,n)||o,n};return r.cache=new(gn.Cache||Ht),r}gn.Cache=Ht;var ol=gn;var Zw=500;function jw(e){var t=ol(e,function(A){return r.size===Zw&&r.clear(),A}),r=t.cache;return t}var nl=jw;var $w=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,eD=/\\(\\)?/g,tD=nl(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace($w,function(r,A,i,o){t.push(i?o.replace(eD,"$1"):A||r)}),t}),al=tD;function rD(e){return e==null?"":Ic(e)}var sl=rD;function AD(e,t){return $(e)?e:or(e,t)?[e]:al(sl(e))}var Dt=AD;var iD=1/0;function oD(e){if(typeof e=="string"||pt(e))return e;var t=e+"";return t=="0"&&1/e==-iD?"-0":t}var Je=oD;function nD(e,t){t=Dt(t,e);for(var r=0,A=t.length;e!=null&&r<A;)e=e[Je(t[r++])];return r&&r==A?e:void 0}var gr=nD;function aD(e,t,r){var A=e==null?void 0:gr(e,t);return A===void 0?r:A}var gl=aD;function sD(e,t){for(var r=-1,A=t.length,i=e.length;++r<A;)e[i+r]=t[r];return e}var LA=sD;var gD=JA(Object.getPrototypeOf,Object),Ir=gD;var ID="[object Object]",cD=Function.prototype,lD=Object.prototype,Il=cD.toString,uD=lD.hasOwnProperty,fD=Il.call(Object);function dD(e){if(!ne(e)||me(e)!=ID)return!1;var t=Ir(e);if(t===null)return!0;var r=uD.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&Il.call(r)==fD}var cr=dD;function pD(){this.__data__=new Et,this.size=0}var cl=pD;function BD(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var ll=BD;function CD(e){return this.__data__.get(e)}var ul=CD;function QD(e){return this.__data__.has(e)}var fl=QD;var hD=200;function mD(e,t){var r=this.__data__;if(r instanceof Et){var A=r.__data__;if(!yt||A.length<hD-1)return A.push([e,t]),this.size=++r.size,this;r=this.__data__=new Ht(A)}return r.set(e,t),this.size=r.size,this}var dl=mD;function lr(e){var t=this.__data__=new Et(e);this.size=t.size}lr.prototype.clear=cl;lr.prototype.delete=ll;lr.prototype.get=ul;lr.prototype.has=fl;lr.prototype.set=dl;var Ke=lr;function ED(e,t){return e&&_e(t,ht(t),e)}var pl=ED;function yD(e,t){return e&&_e(t,Oe(t),e)}var Bl=yD;var ml=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Cl=ml&&typeof module=="object"&&module&&!module.nodeType&&module,wD=Cl&&Cl.exports===ml,Ql=wD?re.Buffer:void 0,hl=Ql?Ql.allocUnsafe:void 0;function DD(e,t){if(t)return e.slice();var r=e.length,A=hl?hl(r):new e.constructor(r);return e.copy(A),A}var YA=DD;function FD(e,t){for(var r=-1,A=e==null?0:e.length,i=0,o=[];++r<A;){var n=e[r];t(n,r,e)&&(o[i++]=n)}return o}var El=FD;function SD(){return[]}var VA=SD;var xD=Object.prototype,kD=xD.propertyIsEnumerable,yl=Object.getOwnPropertySymbols,bD=yl?function(e){return e==null?[]:(e=Object(e),El(yl(e),function(t){return kD.call(e,t)}))}:VA,ur=bD;function ND(e,t){return _e(e,ur(e),t)}var wl=ND;var vD=Object.getOwnPropertySymbols,GD=vD?function(e){for(var t=[];e;)LA(t,ur(e)),e=Ir(e);return t}:VA,zA=GD;function UD(e,t){return _e(e,zA(e),t)}var Dl=UD;function MD(e,t,r){var A=t(e);return $(e)?A:LA(A,r(e))}var WA=MD;function HD(e){return WA(e,ht,ur)}var Or=HD;function RD(e){return WA(e,Oe,zA)}var XA=RD;var qD=Be(re,"DataView"),ZA=qD;var TD=Be(re,"Promise"),jA=TD;var _D=Be(re,"Set"),$A=_D;var Fl="[object Map]",PD="[object Object]",Sl="[object Promise]",xl="[object Set]",kl="[object WeakMap]",bl="[object DataView]",OD=tt(ZA),JD=tt(yt),KD=tt(jA),LD=tt($A),YD=tt(_A),Rt=me;(ZA&&Rt(new ZA(new ArrayBuffer(1)))!=bl||yt&&Rt(new yt)!=Fl||jA&&Rt(jA.resolve())!=Sl||$A&&Rt(new $A)!=xl||_A&&Rt(new _A)!=kl)&&(Rt=function(e){var t=me(e),r=t==PD?e.constructor:void 0,A=r?tt(r):"";if(A)switch(A){case OD:return bl;case JD:return Fl;case KD:return Sl;case LD:return xl;case YD:return kl}return t});var Ge=Rt;var VD=Object.prototype,zD=VD.hasOwnProperty;function WD(e){var t=e.length,r=new e.constructor(t);return t&&typeof e[0]=="string"&&zD.call(e,"index")&&(r.index=e.index,r.input=e.input),r}var Nl=WD;var XD=re.Uint8Array,fr=XD;function ZD(e){var t=new e.constructor(e.byteLength);return new fr(t).set(new fr(e)),t}var dr=ZD;function jD(e,t){var r=t?dr(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}var vl=jD;var $D=/\w*$/;function eF(e){var t=new e.constructor(e.source,$D.exec(e));return t.lastIndex=e.lastIndex,t}var Gl=eF;var Ul=fe?fe.prototype:void 0,Ml=Ul?Ul.valueOf:void 0;function tF(e){return Ml?Object(Ml.call(e)):{}}var Hl=tF;function rF(e,t){var r=t?dr(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}var ei=rF;var AF="[object Boolean]",iF="[object Date]",oF="[object Map]",nF="[object Number]",aF="[object RegExp]",sF="[object Set]",gF="[object String]",IF="[object Symbol]",cF="[object ArrayBuffer]",lF="[object DataView]",uF="[object Float32Array]",fF="[object Float64Array]",dF="[object Int8Array]",pF="[object Int16Array]",BF="[object Int32Array]",CF="[object Uint8Array]",QF="[object Uint8ClampedArray]",hF="[object Uint16Array]",mF="[object Uint32Array]";function EF(e,t,r){var A=e.constructor;switch(t){case cF:return dr(e);case AF:case iF:return new A(+e);case lF:return vl(e,r);case uF:case fF:case dF:case pF:case BF:case CF:case QF:case hF:case mF:return ei(e,r);case oF:return new A;case nF:case gF:return new A(e);case aF:return Gl(e);case sF:return new A;case IF:return Hl(e)}}var Rl=EF;function yF(e){return typeof e.constructor=="function"&&!Ct(e)?Qc(Ir(e)):{}}var ti=yF;var wF="[object Map]";function DF(e){return ne(e)&&Ge(e)==wF}var ql=DF;var Tl=it&&it.isMap,FF=Tl?ir(Tl):ql,_l=FF;var SF="[object Set]";function xF(e){return ne(e)&&Ge(e)==SF}var Pl=xF;var Ol=it&&it.isSet,kF=Ol?ir(Ol):Pl,Jl=kF;var bF=1,NF=2,vF=4,Kl="[object Arguments]",GF="[object Array]",UF="[object Boolean]",MF="[object Date]",HF="[object Error]",Ll="[object Function]",RF="[object GeneratorFunction]",qF="[object Map]",TF="[object Number]",Yl="[object Object]",_F="[object RegExp]",PF="[object Set]",OF="[object String]",JF="[object Symbol]",KF="[object WeakMap]",LF="[object ArrayBuffer]",YF="[object DataView]",VF="[object Float32Array]",zF="[object Float64Array]",WF="[object Int8Array]",XF="[object Int16Array]",ZF="[object Int32Array]",jF="[object Uint8Array]",$F="[object Uint8ClampedArray]",eS="[object Uint16Array]",tS="[object Uint32Array]",X={};X[Kl]=X[GF]=X[LF]=X[YF]=X[UF]=X[MF]=X[VF]=X[zF]=X[WF]=X[XF]=X[ZF]=X[qF]=X[TF]=X[Yl]=X[_F]=X[PF]=X[OF]=X[JF]=X[jF]=X[$F]=X[eS]=X[tS]=!0;X[HF]=X[Ll]=X[KF]=!1;function ri(e,t,r,A,i,o){var n,a=t&bF,s=t&NF,g=t&vF;if(r&&(n=i?r(e,A,i,o):r(e)),n!==void 0)return n;if(!W(e))return e;var I=$(e);if(I){if(n=Nl(e),!a)return PA(e,n)}else{var l=Ge(e),c=l==Ll||l==RF;if(ve(e))return YA(e,a);if(l==Yl||l==Kl||c&&!i){if(n=s||c?{}:ti(e),!a)return s?Dl(e,Bl(n,e)):wl(e,pl(n,e))}else{if(!X[l])return i?e:{};n=Rl(e,l,a)}}o||(o=new Ke);var u=o.get(e);if(u)return u;o.set(e,n),Jl(e)?e.forEach(function(y){n.add(ri(y,t,r,y,e,o))}):_l(e)&&e.forEach(function(y,h){n.set(h,ri(y,t,r,h,e,o))});var C=g?s?XA:Or:s?Oe:ht,m=I?void 0:C(e);return Dc(m||e,function(y,h){m&&(h=y,y=e[h]),rr(n,h,ri(y,t,r,h,e,o))}),n}var Vl=ri;var rS=4;function AS(e){return Vl(e,rS)}var In=AS;var iS="__lodash_hash_undefined__";function oS(e){return this.__data__.set(e,iS),this}var zl=oS;function nS(e){return this.__data__.has(e)}var Wl=nS;function Ai(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new Ht;++t<r;)this.add(e[t])}Ai.prototype.add=Ai.prototype.push=zl;Ai.prototype.has=Wl;var Xl=Ai;function aS(e,t){for(var r=-1,A=e==null?0:e.length;++r<A;)if(t(e[r],r,e))return!0;return!1}var Zl=aS;function sS(e,t){return e.has(t)}var jl=sS;var gS=1,IS=2;function cS(e,t,r,A,i,o){var n=r&gS,a=e.length,s=t.length;if(a!=s&&!(n&&s>a))return!1;var g=o.get(e),I=o.get(t);if(g&&I)return g==t&&I==e;var l=-1,c=!0,u=r&IS?new Xl:void 0;for(o.set(e,t),o.set(t,e);++l<a;){var C=e[l],m=t[l];if(A)var y=n?A(m,C,l,t,e,o):A(C,m,l,e,t,o);if(y!==void 0){if(y)continue;c=!1;break}if(u){if(!Zl(t,function(h,F){if(!jl(u,F)&&(C===h||i(C,h,r,A,o)))return u.push(F)})){c=!1;break}}else if(!(C===m||i(C,m,r,A,o))){c=!1;break}}return o.delete(e),o.delete(t),c}var ii=cS;function lS(e){var t=-1,r=Array(e.size);return e.forEach(function(A,i){r[++t]=[i,A]}),r}var $l=lS;function uS(e){var t=-1,r=Array(e.size);return e.forEach(function(A){r[++t]=A}),r}var eu=uS;var fS=1,dS=2,pS="[object Boolean]",BS="[object Date]",CS="[object Error]",QS="[object Map]",hS="[object Number]",mS="[object RegExp]",ES="[object Set]",yS="[object String]",wS="[object Symbol]",DS="[object ArrayBuffer]",FS="[object DataView]",tu=fe?fe.prototype:void 0,cn=tu?tu.valueOf:void 0;function SS(e,t,r,A,i,o,n){switch(r){case FS:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case DS:return!(e.byteLength!=t.byteLength||!o(new fr(e),new fr(t)));case pS:case BS:case hS:return Te(+e,+t);case CS:return e.name==t.name&&e.message==t.message;case mS:case yS:return e==t+"";case QS:var a=$l;case ES:var s=A&fS;if(a||(a=eu),e.size!=t.size&&!s)return!1;var g=n.get(e);if(g)return g==t;A|=dS,n.set(e,t);var I=ii(a(e),a(t),A,i,o,n);return n.delete(e),I;case wS:if(cn)return cn.call(e)==cn.call(t)}return!1}var ru=SS;var xS=1,kS=Object.prototype,bS=kS.hasOwnProperty;function NS(e,t,r,A,i,o){var n=r&xS,a=Or(e),s=a.length,g=Or(t),I=g.length;if(s!=I&&!n)return!1;for(var l=s;l--;){var c=a[l];if(!(n?c in t:bS.call(t,c)))return!1}var u=o.get(e),C=o.get(t);if(u&&C)return u==t&&C==e;var m=!0;o.set(e,t),o.set(t,e);for(var y=n;++l<s;){c=a[l];var h=e[c],F=t[c];if(A)var b=n?A(F,h,c,t,e,o):A(h,F,c,e,t,o);if(!(b===void 0?h===F||i(h,F,r,A,o):b)){m=!1;break}y||(y=c=="constructor")}if(m&&!y){var d=e.constructor,w=t.constructor;d!=w&&"constructor"in e&&"constructor"in t&&!(typeof d=="function"&&d instanceof d&&typeof w=="function"&&w instanceof w)&&(m=!1)}return o.delete(e),o.delete(t),m}var Au=NS;var vS=1,iu="[object Arguments]",ou="[object Array]",oi="[object Object]",GS=Object.prototype,nu=GS.hasOwnProperty;function US(e,t,r,A,i,o){var n=$(e),a=$(t),s=n?ou:Ge(e),g=a?ou:Ge(t);s=s==iu?oi:s,g=g==iu?oi:g;var I=s==oi,l=g==oi,c=s==g;if(c&&ve(e)){if(!ve(t))return!1;n=!0,I=!1}if(c&&!I)return o||(o=new Ke),n||Qt(e)?ii(e,t,r,A,i,o):ru(e,t,s,r,A,i,o);if(!(r&vS)){var u=I&&nu.call(e,"__wrapped__"),C=l&&nu.call(t,"__wrapped__");if(u||C){var m=u?e.value():e,y=C?t.value():t;return o||(o=new Ke),i(m,y,r,A,o)}}return c?(o||(o=new Ke),Au(e,t,r,A,i,o)):!1}var au=US;function su(e,t,r,A,i){return e===t?!0:e==null||t==null||!ne(e)&&!ne(t)?e!==e&&t!==t:au(e,t,r,A,su,i)}var ni=su;var MS=1,HS=2;function RS(e,t,r,A){var i=r.length,o=i,n=!A;if(e==null)return!o;for(e=Object(e);i--;){var a=r[i];if(n&&a[2]?a[1]!==e[a[0]]:!(a[0]in e))return!1}for(;++i<o;){a=r[i];var s=a[0],g=e[s],I=a[1];if(n&&a[2]){if(g===void 0&&!(s in e))return!1}else{var l=new Ke;if(A)var c=A(g,I,s,e,t,l);if(!(c===void 0?ni(I,g,MS|HS,A,l):c))return!1}}return!0}var gu=RS;function qS(e){return e===e&&!W(e)}var ai=qS;function TS(e){for(var t=ht(e),r=t.length;r--;){var A=t[r],i=e[A];t[r]=[A,i,ai(i)]}return t}var Iu=TS;function _S(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}var si=_S;function PS(e){var t=Iu(e);return t.length==1&&t[0][2]?si(t[0][0],t[0][1]):function(r){return r===e||gu(r,e,t)}}var cu=PS;function OS(e,t){return e!=null&&t in Object(e)}var lu=OS;function JS(e,t,r){t=Dt(t,e);for(var A=-1,i=t.length,o=!1;++A<i;){var n=Je(t[A]);if(!(o=e!=null&&r(e,n)))break;e=e[n]}return o||++A!=i?o:(i=e==null?0:e.length,!!i&&Ar(i)&&Bt(n,i)&&($(e)||At(e)))}var uu=JS;function KS(e,t){return e!=null&&uu(e,t,lu)}var fu=KS;var LS=1,YS=2;function VS(e,t){return or(e)&&ai(t)?si(Je(e),t):function(r){var A=gl(r,e);return A===void 0&&A===t?fu(r,e):ni(t,A,LS|YS)}}var du=VS;function zS(e){return function(t){return t?.[e]}}var pu=zS;function WS(e){return function(t){return gr(t,e)}}var Bu=WS;function XS(e){return or(e)?pu(Je(e)):Bu(e)}var Cu=XS;function ZS(e){return typeof e=="function"?e:e==null?jt:typeof e=="object"?$(e)?du(e[0],e[1]):cu(e):Cu(e)}var Qu=ZS;function jS(e){return function(t,r,A){for(var i=-1,o=Object(t),n=A(t),a=n.length;a--;){var s=n[e?a:++i];if(r(o[s],s,o)===!1)break}return t}}var hu=jS;var $S=hu(),mu=$S;var ex=function(){return re.Date.now()},gi=ex;var tx="Expected a function",rx=Math.max,Ax=Math.min;function ix(e,t,r){var A,i,o,n,a,s,g=0,I=!1,l=!1,c=!0;if(typeof e!="function")throw new TypeError(tx);t=on(t)||0,W(r)&&(I=!!r.leading,l="maxWait"in r,o=l?rx(on(r.maxWait)||0,t):o,c="trailing"in r?!!r.trailing:c);function u(f){var Q=A,p=i;return A=i=void 0,g=f,n=e.apply(p,Q),n}function C(f){return g=f,a=setTimeout(h,t),I?u(f):n}function m(f){var Q=f-s,p=f-g,N=t-Q;return l?Ax(N,o-p):N}function y(f){var Q=f-s,p=f-g;return s===void 0||Q>=t||Q<0||l&&p>=o}function h(){var f=gi();if(y(f))return F(f);a=setTimeout(h,m(f))}function F(f){return a=void 0,c&&A?u(f):(A=i=void 0,n)}function b(){a!==void 0&&clearTimeout(a),g=0,A=s=i=a=void 0}function d(){return a===void 0?n:F(gi())}function w(){var f=gi(),Q=y(f);if(A=arguments,i=this,s=f,Q){if(a===void 0)return C(s);if(l)return clearTimeout(a),a=setTimeout(h,t),u(s)}return a===void 0&&(a=setTimeout(h,t)),n}return w.cancel=b,w.flush=d,w}var Ee=ix;function ox(e,t,r){(r!==void 0&&!Te(e[t],r)||r===void 0&&!(t in e))&&tr(e,t,r)}var Jr=ox;function nx(e){return ne(e)&&Pe(e)}var Eu=nx;function ax(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var Kr=ax;function sx(e){return _e(e,Oe(e))}var yu=sx;function gx(e,t,r,A,i,o,n){var a=Kr(e,r),s=Kr(t,r),g=n.get(s);if(g){Jr(e,r,g);return}var I=o?o(a,s,r+"",e,t,n):void 0,l=I===void 0;if(l){var c=$(s),u=!c&&ve(s),C=!c&&!u&&Qt(s);I=s,c||u||C?$(a)?I=a:Eu(a)?I=PA(a):u?(l=!1,I=YA(s,!0)):C?(l=!1,I=ei(s,!0)):I=[]:cr(s)||At(s)?(I=a,At(a)?I=yu(a):(!W(a)||$t(a))&&(I=ti(s))):l=!1}l&&(n.set(s,I),i(I,s,A,o,n),n.delete(s)),Jr(e,r,I)}var wu=gx;function Du(e,t,r,A,i){e!==t&&mu(t,function(o,n){if(i||(i=new Ke),W(o))wu(e,t,n,r,Du,A,i);else{var a=A?A(Kr(e,n),o,n+"",e,t,i):void 0;a===void 0&&(a=o),Jr(e,n,a)}},Oe)}var Fu=Du;var Ix=bc(function(e,t,r,A){Fu(e,t,r,A)}),Lr=Ix;var cx="[object Map]",lx="[object Set]",ux=Object.prototype,fx=ux.hasOwnProperty;function dx(e){if(e==null)return!0;if(Pe(e)&&($(e)||typeof e=="string"||typeof e.splice=="function"||ve(e)||Qt(e)||At(e)))return!e.length;var t=Ge(e);if(t==cx||t==lx)return!e.size;if(Ct(e))return!KA(e).length;for(var r in e)if(fx.call(e,r))return!1;return!0}var Yr=dx;function px(e,t,r,A){if(!W(e))return e;t=Dt(t,e);for(var i=-1,o=t.length,n=o-1,a=e;a!=null&&++i<o;){var s=Je(t[i]),g=r;if(s==="__proto__"||s==="constructor"||s==="prototype")return e;if(i!=n){var I=a[s];g=A?A(I,s,a):void 0,g===void 0&&(g=W(I)?I:Bt(t[i+1])?[]:{})}rr(a,s,g),a=a[s]}return e}var Su=px;function Bx(e,t,r){for(var A=-1,i=t.length,o={};++A<i;){var n=t[A],a=gr(e,n);r(a,n)&&Su(o,Dt(n,e),a)}return o}var xu=Bx;function Cx(e,t){if(e==null)return{};var r=qA(XA(e),function(A){return[A]});return t=Qu(t),xu(e,r,function(A,i){return t(A,i[0])})}var ln=Cx;var Qx=[EvalError,RangeError,ReferenceError,SyntaxError,TypeError,URIError,globalThis.DOMException,globalThis.AssertionError,globalThis.SystemError].filter(Boolean).map(e=>[e.name,e]),hx=new Map(Qx),ku=hx;var un=class e extends Error{name="NonError";constructor(t){super(e._prepareSuperMessage(t))}static _prepareSuperMessage(t){try{return JSON.stringify(t)}catch{return String(t)}}},mx=[{property:"name",enumerable:!1},{property:"message",enumerable:!1},{property:"stack",enumerable:!1},{property:"code",enumerable:!0},{property:"cause",enumerable:!1}],fn=new WeakSet,Ex=e=>{fn.add(e);let t=e.toJSON();return fn.delete(e),t},Nu=e=>ku.get(e)??Error,dn=({from:e,seen:t,to:r,forceEnumerable:A,maxDepth:i,depth:o,useToJSON:n,serialize:a})=>{if(!r)if(Array.isArray(e))r=[];else if(!a&&bu(e)){let g=Nu(e.name);r=new g}else r={};if(t.push(e),o>=i)return r;if(n&&typeof e.toJSON=="function"&&!fn.has(e))return Ex(e);let s=g=>dn({from:g,seen:[...t],forceEnumerable:A,maxDepth:i,depth:o,useToJSON:n,serialize:a});for(let[g,I]of Object.entries(e)){if(I&&I instanceof Uint8Array&&I.constructor.name==="Buffer"){r[g]="[object Buffer]";continue}if(I!==null&&typeof I=="object"&&typeof I.pipe=="function"){r[g]="[object Stream]";continue}if(typeof I!="function"){if(!I||typeof I!="object"){try{r[g]=I}catch{}continue}if(!t.includes(e[g])){o++,r[g]=s(e[g]);continue}r[g]="[Circular]"}}for(let{property:g,enumerable:I}of mx)typeof e[g]<"u"&&e[g]!==null&&Object.defineProperty(r,g,{value:bu(e[g])?s(e[g]):e[g],enumerable:A?!0:I,configurable:!0,writable:!0});return r};function Vr(e,t={}){let{maxDepth:r=Number.POSITIVE_INFINITY,useToJSON:A=!0}=t;return typeof e=="object"&&e!==null?dn({from:e,seen:[],forceEnumerable:!0,maxDepth:r,depth:0,useToJSON:A,serialize:!0}):typeof e=="function"?`[Function: ${e.name||"anonymous"}]`:e}function vu(e,t={}){let{maxDepth:r=Number.POSITIVE_INFINITY}=t;if(e instanceof Error)return e;if(yx(e)){let A=Nu(e.name);return dn({from:e,seen:[],to:new A,maxDepth:r,depth:0,serialize:!1})}return new un(e)}function bu(e){return!!e&&typeof e=="object"&&"name"in e&&"message"in e&&"stack"in e}function yx(e){return!!e&&typeof e=="object"&&"message"in e&&!Array.isArray(e)}var B=G(K());var Ii,wx=new Uint8Array(16);function Bn(){if(!Ii&&(Ii=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Ii))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Ii(wx)}var ge=[];for(let e=0;e<256;++e)ge.push((e+256).toString(16).slice(1));function Uu(e,t=0){return ge[e[t+0]]+ge[e[t+1]]+ge[e[t+2]]+ge[e[t+3]]+"-"+ge[e[t+4]]+ge[e[t+5]]+"-"+ge[e[t+6]]+ge[e[t+7]]+"-"+ge[e[t+8]]+ge[e[t+9]]+"-"+ge[e[t+10]]+ge[e[t+11]]+ge[e[t+12]]+ge[e[t+13]]+ge[e[t+14]]+ge[e[t+15]]}var Dx=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Cn={randomUUID:Dx};function Fx(e,t,r){if(Cn.randomUUID&&!t&&!e)return Cn.randomUUID();e=e||{};let A=e.random||(e.rng||Bn)();if(A[6]=A[6]&15|64,A[8]=A[8]&63|128,t){r=r||0;for(let i=0;i<16;++i)t[r+i]=A[i];return t}return Uu(A)}var ee=Fx;var sA=G(K());var gf=G(K());var Qn=function(e,t){return Qn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,A){r.__proto__=A}||function(r,A){for(var i in A)Object.prototype.hasOwnProperty.call(A,i)&&(r[i]=A[i])},Qn(e,t)};function Ft(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Qn(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}function Mu(e,t,r,A){function i(o){return o instanceof r?o:new r(function(n){n(o)})}return new(r||(r=Promise))(function(o,n){function a(I){try{g(A.next(I))}catch(l){n(l)}}function s(I){try{g(A.throw(I))}catch(l){n(l)}}function g(I){I.done?o(I.value):i(I.value).then(a,s)}g((A=A.apply(e,t||[])).next())})}function ci(e,t){var r={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},A,i,o,n;return n={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(n[Symbol.iterator]=function(){return this}),n;function a(g){return function(I){return s([g,I])}}function s(g){if(A)throw new TypeError("Generator is already executing.");for(;n&&(n=0,g[0]&&(r=0)),r;)try{if(A=1,i&&(o=g[0]&2?i.return:g[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,g[1])).done)return o;switch(i=0,o&&(g=[g[0]&2,o.value]),g[0]){case 0:case 1:o=g;break;case 4:return r.label++,{value:g[1],done:!1};case 5:r.label++,i=g[1],g=[0];continue;case 7:g=r.ops.pop(),r.trys.pop();continue;default:if(o=r.trys,!(o=o.length>0&&o[o.length-1])&&(g[0]===6||g[0]===2)){r=0;continue}if(g[0]===3&&(!o||g[1]>o[0]&&g[1]<o[3])){r.label=g[1];break}if(g[0]===6&&r.label<o[1]){r.label=o[1],o=g;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(g);break}o[2]&&r.ops.pop(),r.trys.pop();continue}g=t.call(e,r)}catch(I){g=[6,I],i=0}finally{A=o=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}}function nt(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],A=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&A>=e.length&&(e=void 0),{value:e&&e[A++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Le(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var A=r.call(e),i,o=[],n;try{for(;(t===void 0||t-- >0)&&!(i=A.next()).done;)o.push(i.value)}catch(a){n={error:a}}finally{try{i&&!i.done&&(r=A.return)&&r.call(A)}finally{if(n)throw n.error}}return o}function Ye(e,t,r){if(r||arguments.length===2)for(var A=0,i=t.length,o;A<i;A++)(o||!(A in t))&&(o||(o=Array.prototype.slice.call(t,0,A)),o[A]=t[A]);return e.concat(o||Array.prototype.slice.call(t))}function qt(e){return this instanceof qt?(this.v=e,this):new qt(e)}function Hu(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var A=r.apply(e,t||[]),i,o=[];return i={},n("next"),n("throw"),n("return"),i[Symbol.asyncIterator]=function(){return this},i;function n(c){A[c]&&(i[c]=function(u){return new Promise(function(C,m){o.push([c,u,C,m])>1||a(c,u)})})}function a(c,u){try{s(A[c](u))}catch(C){l(o[0][3],C)}}function s(c){c.value instanceof qt?Promise.resolve(c.value.v).then(g,I):l(o[0][2],c)}function g(c){a("next",c)}function I(c){a("throw",c)}function l(c,u){c(u),o.shift(),o.length&&a(o[0][0],o[0][1])}}function Ru(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof nt=="function"?nt(e):e[Symbol.iterator](),r={},A("next"),A("throw"),A("return"),r[Symbol.asyncIterator]=function(){return this},r);function A(o){r[o]=e[o]&&function(n){return new Promise(function(a,s){n=e[o](n),i(a,s,n.done,n.value)})}}function i(o,n,a,s){Promise.resolve(s).then(function(g){o({value:g,done:a})},n)}}function V(e){return typeof e=="function"}function li(e){var t=function(A){Error.call(A),A.stack=new Error().stack},r=e(t);return r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,r}var ui=li(function(e){return function(r){e(this),this.message=r?r.length+` errors occurred during unsubscription:
`+r.map(function(A,i){return i+1+") "+A.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=r}});function zr(e,t){if(e){var r=e.indexOf(t);0<=r&&e.splice(r,1)}}var pr=function(){function e(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var t,r,A,i,o;if(!this.closed){this.closed=!0;var n=this._parentage;if(n)if(this._parentage=null,Array.isArray(n))try{for(var a=nt(n),s=a.next();!s.done;s=a.next()){var g=s.value;g.remove(this)}}catch(m){t={error:m}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}else n.remove(this);var I=this.initialTeardown;if(V(I))try{I()}catch(m){o=m instanceof ui?m.errors:[m]}var l=this._finalizers;if(l){this._finalizers=null;try{for(var c=nt(l),u=c.next();!u.done;u=c.next()){var C=u.value;try{qu(C)}catch(m){o=o??[],m instanceof ui?o=Ye(Ye([],Le(o)),Le(m.errors)):o.push(m)}}}catch(m){A={error:m}}finally{try{u&&!u.done&&(i=c.return)&&i.call(c)}finally{if(A)throw A.error}}}if(o)throw new ui(o)}},e.prototype.add=function(t){var r;if(t&&t!==this)if(this.closed)qu(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=(r=this._finalizers)!==null&&r!==void 0?r:[]).push(t)}},e.prototype._hasParent=function(t){var r=this._parentage;return r===t||Array.isArray(r)&&r.includes(t)},e.prototype._addParent=function(t){var r=this._parentage;this._parentage=Array.isArray(r)?(r.push(t),r):r?[r,t]:t},e.prototype._removeParent=function(t){var r=this._parentage;r===t?this._parentage=null:Array.isArray(r)&&zr(r,t)},e.prototype.remove=function(t){var r=this._finalizers;r&&zr(r,t),t instanceof e&&t._removeParent(this)},e.EMPTY=function(){var t=new e;return t.closed=!0,t}(),e}();var hn=pr.EMPTY;function fi(e){return e instanceof pr||e&&"closed"in e&&V(e.remove)&&V(e.add)&&V(e.unsubscribe)}function qu(e){V(e)?e():e.unsubscribe()}var Ue={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Br={setTimeout:function(e,t){for(var r=[],A=2;A<arguments.length;A++)r[A-2]=arguments[A];var i=Br.delegate;return i?.setTimeout?i.setTimeout.apply(i,Ye([e,t],Le(r))):setTimeout.apply(void 0,Ye([e,t],Le(r)))},clearTimeout:function(e){var t=Br.delegate;return(t?.clearTimeout||clearTimeout)(e)},delegate:void 0};function di(e){Br.setTimeout(function(){var t=Ue.onUnhandledError;if(t)t(e);else throw e})}function mn(){}var Tu=function(){return En("C",void 0,void 0)}();function _u(e){return En("E",void 0,e)}function Pu(e){return En("N",e,void 0)}function En(e,t,r){return{kind:e,value:t,error:r}}var Tt=null;function Cr(e){if(Ue.useDeprecatedSynchronousErrorHandling){var t=!Tt;if(t&&(Tt={errorThrown:!1,error:null}),e(),t){var r=Tt,A=r.errorThrown,i=r.error;if(Tt=null,A)throw i}}else e()}function Ou(e){Ue.useDeprecatedSynchronousErrorHandling&&Tt&&(Tt.errorThrown=!0,Tt.error=e)}var Wr=function(e){Ft(t,e);function t(r){var A=e.call(this)||this;return A.isStopped=!1,r?(A.destination=r,fi(r)&&r.add(A)):A.destination=bx,A}return t.create=function(r,A,i){return new _t(r,A,i)},t.prototype.next=function(r){this.isStopped?wn(Pu(r),this):this._next(r)},t.prototype.error=function(r){this.isStopped?wn(_u(r),this):(this.isStopped=!0,this._error(r))},t.prototype.complete=function(){this.isStopped?wn(Tu,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(r){this.destination.next(r)},t.prototype._error=function(r){try{this.destination.error(r)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(pr);var Sx=Function.prototype.bind;function yn(e,t){return Sx.call(e,t)}var xx=function(){function e(t){this.partialObserver=t}return e.prototype.next=function(t){var r=this.partialObserver;if(r.next)try{r.next(t)}catch(A){pi(A)}},e.prototype.error=function(t){var r=this.partialObserver;if(r.error)try{r.error(t)}catch(A){pi(A)}else pi(t)},e.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(r){pi(r)}},e}(),_t=function(e){Ft(t,e);function t(r,A,i){var o=e.call(this)||this,n;if(V(r)||!r)n={next:r??void 0,error:A??void 0,complete:i??void 0};else{var a;o&&Ue.useDeprecatedNextContext?(a=Object.create(r),a.unsubscribe=function(){return o.unsubscribe()},n={next:r.next&&yn(r.next,a),error:r.error&&yn(r.error,a),complete:r.complete&&yn(r.complete,a)}):n=r}return o.destination=new xx(n),o}return t}(Wr);function pi(e){Ue.useDeprecatedSynchronousErrorHandling?Ou(e):di(e)}function kx(e){throw e}function wn(e,t){var r=Ue.onStoppedNotification;r&&Br.setTimeout(function(){return r(e,t)})}var bx={closed:!0,next:mn,error:kx,complete:mn};var Qr=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function Ju(e){return e}function Ku(e){return e.length===0?Ju:e.length===1?e[0]:function(r){return e.reduce(function(A,i){return i(A)},r)}}var De=function(){function e(t){t&&(this._subscribe=t)}return e.prototype.lift=function(t){var r=new e;return r.source=this,r.operator=t,r},e.prototype.subscribe=function(t,r,A){var i=this,o=vx(t)?t:new _t(t,r,A);return Cr(function(){var n=i,a=n.operator,s=n.source;o.add(a?a.call(o,s):s?i._subscribe(o):i._trySubscribe(o))}),o},e.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(r){t.error(r)}},e.prototype.forEach=function(t,r){var A=this;return r=Lu(r),new r(function(i,o){var n=new _t({next:function(a){try{t(a)}catch(s){o(s),n.unsubscribe()}},error:o,complete:i});A.subscribe(n)})},e.prototype._subscribe=function(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)},e.prototype[Qr]=function(){return this},e.prototype.pipe=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return Ku(t)(this)},e.prototype.toPromise=function(t){var r=this;return t=Lu(t),new t(function(A,i){var o;r.subscribe(function(n){return o=n},function(n){return i(n)},function(){return A(o)})})},e.create=function(t){return new e(t)},e}();function Lu(e){var t;return(t=e??Ue.Promise)!==null&&t!==void 0?t:Promise}function Nx(e){return e&&V(e.next)&&V(e.error)&&V(e.complete)}function vx(e){return e&&e instanceof Wr||Nx(e)&&fi(e)}function Gx(e){return V(e?.lift)}function Bi(e){return function(t){if(Gx(t))return t.lift(function(r){try{return e(r,this)}catch(A){this.error(A)}});throw new TypeError("Unable to lift unknown Observable type")}}function Yu(e,t,r,A,i){return new Ux(e,t,r,A,i)}var Ux=function(e){Ft(t,e);function t(r,A,i,o,n,a){var s=e.call(this,r)||this;return s.onFinalize=n,s.shouldUnsubscribe=a,s._next=A?function(g){try{A(g)}catch(I){r.error(I)}}:e.prototype._next,s._error=o?function(g){try{o(g)}catch(I){r.error(I)}finally{this.unsubscribe()}}:e.prototype._error,s._complete=i?function(){try{i()}catch(g){r.error(g)}finally{this.unsubscribe()}}:e.prototype._complete,s}return t.prototype.unsubscribe=function(){var r;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var A=this.closed;e.prototype.unsubscribe.call(this),!A&&((r=this.onFinalize)===null||r===void 0||r.call(this))}},t}(Wr);var Vu=li(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}});var Dn=function(e){Ft(t,e);function t(){var r=e.call(this)||this;return r.closed=!1,r.currentObservers=null,r.observers=[],r.isStopped=!1,r.hasError=!1,r.thrownError=null,r}return t.prototype.lift=function(r){var A=new zu(this,this);return A.operator=r,A},t.prototype._throwIfClosed=function(){if(this.closed)throw new Vu},t.prototype.next=function(r){var A=this;Cr(function(){var i,o;if(A._throwIfClosed(),!A.isStopped){A.currentObservers||(A.currentObservers=Array.from(A.observers));try{for(var n=nt(A.currentObservers),a=n.next();!a.done;a=n.next()){var s=a.value;s.next(r)}}catch(g){i={error:g}}finally{try{a&&!a.done&&(o=n.return)&&o.call(n)}finally{if(i)throw i.error}}}})},t.prototype.error=function(r){var A=this;Cr(function(){if(A._throwIfClosed(),!A.isStopped){A.hasError=A.isStopped=!0,A.thrownError=r;for(var i=A.observers;i.length;)i.shift().error(r)}})},t.prototype.complete=function(){var r=this;Cr(function(){if(r._throwIfClosed(),!r.isStopped){r.isStopped=!0;for(var A=r.observers;A.length;)A.shift().complete()}})},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var r;return((r=this.observers)===null||r===void 0?void 0:r.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(r){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,r)},t.prototype._subscribe=function(r){return this._throwIfClosed(),this._checkFinalizedStatuses(r),this._innerSubscribe(r)},t.prototype._innerSubscribe=function(r){var A=this,i=this,o=i.hasError,n=i.isStopped,a=i.observers;return o||n?hn:(this.currentObservers=null,a.push(r),new pr(function(){A.currentObservers=null,zr(a,r)}))},t.prototype._checkFinalizedStatuses=function(r){var A=this,i=A.hasError,o=A.thrownError,n=A.isStopped;i?r.error(o):n&&r.complete()},t.prototype.asObservable=function(){var r=new De;return r.source=this,r},t.create=function(r,A){return new zu(r,A)},t}(De);var zu=function(e){Ft(t,e);function t(r,A){var i=e.call(this)||this;return i.destination=r,i.source=A,i}return t.prototype.next=function(r){var A,i;(i=(A=this.destination)===null||A===void 0?void 0:A.next)===null||i===void 0||i.call(A,r)},t.prototype.error=function(r){var A,i;(i=(A=this.destination)===null||A===void 0?void 0:A.error)===null||i===void 0||i.call(A,r)},t.prototype.complete=function(){var r,A;(A=(r=this.destination)===null||r===void 0?void 0:r.complete)===null||A===void 0||A.call(r)},t.prototype._subscribe=function(r){var A,i;return(i=(A=this.source)===null||A===void 0?void 0:A.subscribe(r))!==null&&i!==void 0?i:hn},t}(Dn);var Wu=function(e){return e&&typeof e.length=="number"&&typeof e!="function"};function Xu(e){return V(e?.then)}function Zu(e){return V(e[Qr])}function ju(e){return Symbol.asyncIterator&&V(e?.[Symbol.asyncIterator])}function $u(e){return new TypeError("You provided "+(e!==null&&typeof e=="object"?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function Mx(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var ef=Mx();function tf(e){return V(e?.[ef])}function rf(e){return Hu(this,arguments,function(){var r,A,i,o;return ci(this,function(n){switch(n.label){case 0:r=e.getReader(),n.label=1;case 1:n.trys.push([1,,9,10]),n.label=2;case 2:return[4,qt(r.read())];case 3:return A=n.sent(),i=A.value,o=A.done,o?[4,qt(void 0)]:[3,5];case 4:return[2,n.sent()];case 5:return[4,qt(i)];case 6:return[4,n.sent()];case 7:return n.sent(),[3,2];case 8:return[3,10];case 9:return r.releaseLock(),[7];case 10:return[2]}})})}function Af(e){return V(e?.getReader)}function Fn(e){if(e instanceof De)return e;if(e!=null){if(Zu(e))return Hx(e);if(Wu(e))return Rx(e);if(Xu(e))return qx(e);if(ju(e))return of(e);if(tf(e))return Tx(e);if(Af(e))return _x(e)}throw $u(e)}function Hx(e){return new De(function(t){var r=e[Qr]();if(V(r.subscribe))return r.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function Rx(e){return new De(function(t){for(var r=0;r<e.length&&!t.closed;r++)t.next(e[r]);t.complete()})}function qx(e){return new De(function(t){e.then(function(r){t.closed||(t.next(r),t.complete())},function(r){return t.error(r)}).then(null,di)})}function Tx(e){return new De(function(t){var r,A;try{for(var i=nt(e),o=i.next();!o.done;o=i.next()){var n=o.value;if(t.next(n),t.closed)return}}catch(a){r={error:a}}finally{try{o&&!o.done&&(A=i.return)&&A.call(i)}finally{if(r)throw r.error}}t.complete()})}function of(e){return new De(function(t){Px(e,t).catch(function(r){return t.error(r)})})}function _x(e){return of(rf(e))}function Px(e,t){var r,A,i,o;return Mu(this,void 0,void 0,function(){var n,a;return ci(this,function(s){switch(s.label){case 0:s.trys.push([0,5,6,11]),r=Ru(e),s.label=1;case 1:return[4,r.next()];case 2:if(A=s.sent(),!!A.done)return[3,4];if(n=A.value,t.next(n),t.closed)return[2];s.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return a=s.sent(),i={error:a},[3,11];case 6:return s.trys.push([6,,9,10]),A&&!A.done&&(o=r.return)?[4,o.call(r)]:[3,8];case 7:s.sent(),s.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}})})}function nf(e,t){return Bi(function(r,A){var i=0;r.subscribe(Yu(A,function(o){A.next(e.call(t,o,i++))}))})}var Ox=Array.isArray;function Jx(e,t){return Ox(t)?e.apply(void 0,Ye([],Le(t))):e(t)}function af(e){return nf(function(t){return Jx(e,t)})}function Ci(e,t,r){return r?Ci(e,t).pipe(af(r)):new De(function(A){var i=function(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];return A.next(n.length===1?n[0]:n)},o=e(i);return V(t)?function(){return t(i,o)}:void 0})}function xn(e){e===void 0&&(e={});var t=e.connector,r=t===void 0?function(){return new Dn}:t,A=e.resetOnError,i=A===void 0?!0:A,o=e.resetOnComplete,n=o===void 0?!0:o,a=e.resetOnRefCountZero,s=a===void 0?!0:a;return function(g){var I,l,c,u=0,C=!1,m=!1,y=function(){l?.unsubscribe(),l=void 0},h=function(){y(),I=c=void 0,C=m=!1},F=function(){var b=I;h(),b?.unsubscribe()};return Bi(function(b,d){u++,!m&&!C&&y();var w=c=c??r();d.add(function(){u--,u===0&&!m&&!C&&(l=Sn(F,s))}),w.subscribe(d),!I&&u>0&&(I=new _t({next:function(f){return w.next(f)},error:function(f){m=!0,y(),l=Sn(h,i,f),w.error(f)},complete:function(){C=!0,y(),l=Sn(h,n),w.complete()}}),Fn(b).subscribe(I))})(g)}}function Sn(e,t){for(var r=[],A=2;A<arguments.length;A++)r[A-2]=arguments[A];if(t===!0){e();return}if(t!==!1){var i=new _t({next:function(){i.unsubscribe(),e()}});return Fn(t.apply(void 0,Ye([],Le(r)))).subscribe(i)}}var Pt=G(K());async function J(e,t){let r=await Pt.default.storage.local.get(e);return typeof e=="string"?Object.hasOwn(r,e)?r[e]:t:r}async function St(e,t){return typeof e=="string"?Pt.default.storage.local.set({[e]:t}):Pt.default.storage.local.set(e)}var kn=Ci(e=>Pt.default.storage.local.onChanged.addListener(e),e=>Pt.default.runtime.id&&Pt.default.storage.local.onChanged.removeListener(e),e=>e).pipe(xn({resetOnRefCountZero:!0}));var bn=gf.default.runtime.getManifest(),Ie=bn.version_name===bn.version+"-e",If="Sider";var Xr=Ie?"dhoenijjpgpeimemopealfcbiecgceod":"difoiogjjojoaoomphldepapgpbgkhkb",Qi=`ChitChat_${Ie?"Edge":"Chrome"}_Ext`,ce=bn.version,cf=["gpmljinohlbfgmeoaeceoajachkabijo","nlipoenfbbikpbjkfpfillcgkoblgpmj"];var lf=["translate"];var uf={name:"Robot",avatar:"",gender:"unknown",platform:"system",requireVIP:!1};var Nn="gpt-3.5-turbo";var Kx={dev:"",test:"",preview:"https://preview.sider.ai",prod:"https://sider.ai"},Lx={dev:"",test:"",preview:"sider.ai",prod:"sider.ai"},sf=Kx.prod,z={origin:sf,api:`${sf}/api`,domain:Lx.prod},ff="https://www.google-analytics.com/mp/collect",df="G-0PRFKME4HP";var pf="6FX_tIISST2SsnSx29yQRg";var Fe={English:"en","Chinese(Simplified)":"zh_CN","Chinese(Traditional)":"zh_TW",Spanish:"es",French:"fr",Japanese:"ja",German:"de",Portuguese:"pt",Arabic:"ar",Russian:"ru",Italian:"it",Korean:"ko",Hindi:"hi",Dutch:"nl",Polish:"pl",Amharic:"am",Bulgarian:"bg",Bengali:"bn",Catalan:"ca",Czech:"cs",Danish:"da",Greek:"el",Estonian:"et",Persian:"fa",Finnish:"fi",Filipino:"fil",Gujarati:"gu",Hebrew:"he",Croatian:"hr",Hungarian:"hu",Indonesian:"id",Kannada:"kn",Lithuanian:"lt",Latvian:"lv",Malayalam:"ml",Marathi:"mr",Malay:"ms",Norwegian:"no",Romanian:"ro",Slovak:"sk",Slovenian:"sl",Serbian:"sr",Swedish:"sv",Swahili:"sw",Tamil:"ta",Telugu:"te",Thai:"th",Turkish:"tr",Ukrainian:"uk",Urdu:"ur",Vietnamese:"vi"},Yx={English:"en","English (Australia)":"en_AU","English (Canada)":"en_CA","English (India)":"en_IN","English (UK)":"en_UK","English (US)":"en_US","Chinese (Simplified)":"zh_CN","Chinese (Traditional)":"zh_TW",Spanish:"es","Spanish (Argentina)":"es_AR","Spanish (Colombia)":"es_CO","Spanish (Spain)":"es_ES","Spanish (Mexico)":"es_MX",French:"fr",Japanese:"ja",German:"de",Portuguese:"pt","Portuguese (Brazil)":"pt_BR","Portuguese (Portugal)":"pt_PT",Arabic:"ar","Arabic (Egypt)":"ar_EG","Arabic (Saudi)":"ar_SA",Russian:"ru",Italian:"it",Korean:"ko",Hindi:"hi",Dutch:"nl",Polish:"pl",Amharic:"am",Bengali:"bn",Bulgarian:"bg",Catalan:"ca",Croatian:"hr",Czech:"cs",Danish:"da",Estonian:"et",Filipino:"fil",Finnish:"fi",Greek:"el",Gujarati:"gu",Hebrew:"he",Hungarian:"hu",Indonesian:"id",Kannada:"kn",Latvian:"lv",Lithuanian:"lt",Malay:"ms",Malayalam:"ml",Marathi:"mr",Norwegian:"no",Persian:"fa",Romanian:"ro",Serbian:"sr",Slovak:"sk",Slovenian:"sl",Swahili:"sw",Swedish:"sv",Tamil:"ta",Telugu:"te",Thai:"th",Turkish:"tr",Ukrainian:"uk",Urdu:"ur",Vietnamese:"vi"};var vn=Object.entries(Fe).reduce((e,[t,r])=>(e[r]=t,e),{}),hi=Object.entries(Yx).reduce((e,[t,r])=>(e[r]=t,e),{});var Zr="provider:siderApi",EJ=`${Zr}:SelectedModels`;async function Bf(){let e="provider:gpt3",[t="siderApi",r]=await Promise.all([J("provider"),J(e)]);return{provider:t,configs:{gpt3:r}}}var at={login:`${z.origin}/login`,openaiChat:"https://chatgpt.com",openaiLogin:"https://platform.openai.com/login",openaiSignup:"https://platform.openai.com/signup",openaiApiKey:"https://platform.openai.com/account/api-keys",openaiApiSession:"https://chatgpt.com/api/auth/session",edgeStore:"https://microsoftedge.microsoft.com/addons/detail/sider-ai-sidebar/dhoenijjpgpeimemopealfcbiecgceod",chromeStore:"https://chromewebstore.google.com/detail/sider-chatgpt-sidebar-+-v/difoiogjjojoaoomphldepapgpbgkhkb",chromeStoreReview:"https://chromewebstore.google.com/detail/sider-chatgpt-sidebar-+-v/difoiogjjojoaoomphldepapgpbgkhkb/reviews",weChatQrCode:"https://sider.ai/resource/weixin/qrcode.jpeg",producthuntPromoteApi:"https://sider.ai/resource/promotion/extension-promote.json",promoteConfigApi:"https://sider.ai/resource/promotion/promote-config.json"};var Vx={key:"j",keyCode:74,metaKey:!0,ctrlKey:!0,altKey:!1,shiftKey:!1,disabled:!1},zx={key:"a",keyCode:65,metaKey:!1,ctrlKey:!1,altKey:!0,shiftKey:!1,disabled:!1};var mi={"provider:gpt3":{apiKey:"",customURL:"",enableCustomURL:!0,model:"gpt-3.5-turbo"},language:"zh_CN",theme:"light",isShowSearch:!1,triggerMode:"questionMark",submitShortcut:"Enter",sidebarShortcut:{altKey:!1,ctrlKey:!0,key:"O",keyCode:79,metaKey:!1,shiftKey:!0},sidebarLocation:"right",sidebarDisplayOption:"overlay",sidebarFab:!0,sidebarFabDisabledHost:{},selectionSidebarFab:!0,sidebarOnStartup:"new",showSelectedTextInSidebarEnable:!0,chatVisiblePromptKeys:[],readVisiblePromptKeys:[],writeVisiblePromptKeys:[],quickActionDispalyModifier:"",quickActionEnable:!0,quickActionSelectionEnable:!0,quickActionInputSelectionEnable:!0,translatorShortcut:Vx,translatorPinnedTemplates:[],quickActionPinnedReading:[],quickActionPinnedWriting:[],quickActionInputIconEnable:!0,quickActionInputIconDisabledHost:{},translatorHostConfig:{"fab-config.example.com":{favicon:"",enable:!0}},enableWebAssistantVideo:!0,enableBilingualSubtitle:!0,enableWebAssistantArticle:!0,enableWebAssistantQA:!0,enableWebAssistantEmail:!0,enableWebAssistantCode:!0,enableWebAssistantImage:!0,webAssistantImageDisabledHost:{},pageTranslationLastTargetLang:"",pageTranslationAutoEn:!0,pageTranslationDisplayStyle:"none",pageTranslationShowOriginalText:!0,pageTranslationNeverHost:{},pageTranslateShortcut:zx,inputTranslationEnable:!1,inputTranslationTargetLang:"",inputTranslationTriggerKey:" ",inputTranslationDisabledHost:{}},Cf={device:"free",login:"free",premium_starter:"starter",premium:"basic",premium_pro:"pro",premium_ultra:"ultra",premium_ultra_mobile:"pocket"};var yJ=1024*1024*10,wJ=1024*1024*100;var Qf="chatgpt:img:",hf=["g-BlafpMvzd","g-nleealfRT"],mf={"g-BlafpMvzd":{flair:{kind:"sidebar_keep"},resource:{files:[],gizmo:{appeal_info:null,author:{display_name:"sider.ai",is_verified:!0,link_to:"https://sider.ai",selected_display:"website",user_id:"user-inve40FQN9r2Tg4j1mlXSMQb",will_receive_support_emails:null},created_at:"2024-01-10T07:08:34.362699+00:00",display:{categories:["productivity"],description:"Top browser expert! Provide 3X accurate responses. Read any links: PDFs, videos, etc. Create 10+ types of files, like mind maps & spreadsheets, from search-derived contents.",name:"Browser Pro",profile_picture_url:"https://files.oaiusercontent.com/file-HKO0TEnSmvIb1M9G1HUyuAZJ?se=2123-12-27T11%3A10%3A22Z&sp=r&sv=2021-08-06&sr=b&rscc=max-age%3D1209600%2C%20immutable&rscd=attachment%3B%20filename%3DFrame%2520616.png&sig=fJSm%2BvONY8TkDO8IopKdwun%2BWeW2Wo9hti5JG%2Bb5Bj4%3D",prompt_starters:["Search for latest AI research outcomes.","Read this link and summarize the key points.","Create a mind map on ChatGPT prompt skills.","Type E to show all extensions."],welcome_message:"Hi, I'm Browser+! How can I assist you today?"},id:"g-BlafpMvzd",instructions:null,last_interacted_at:"2024-01-20T07:48:12.598861+00:00",live_version:null,model:null,organization_id:"org-i9SD3zX6OqRLnBDt97AtVHHk",settings:null,share_recipient:"marketplace",sharing_targets:null,short_url:"g-BlafpMvzd-browser-pro",tags:["public","reportable","uses_function_calls","pinned"],training_disabled:null,updated_at:"2024-01-20T11:10:24.859178+00:00",vanity_metrics:{created_ago_str:"last week",num_conversations:1066,num_conversations_str:"1066",num_pins:0,num_users_interacted_with:0},version:null,voice:{id:"ember"},workspace_approval_date:null,workspace_approved:null,workspace_id:null},product_features:{attachments:{accepted_mime_types:["application/json","application/vnd.openxmlformats-officedocument.wordprocessingml.document","text/javascript","text/plain","text/x-c++","text/x-script.python","text/x-typescript","text/markdown","application/pdf","text/x-sh","text/x-csharp","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/x-latext","text/x-tex","text/html","text/x-php","text/x-java","text/x-c","text/x-ruby","application/msword"],can_accept_all_mime_types:!0,image_mime_types:["image/webp","image/gif","image/png","image/jpeg"],type:"retrieval"}},tools:[{id:"gzm_cnf_jSWQ9Aj5eNZu3L3mS3bzGxGI~gzm_tool_l6SR7MvRO40YmUGDO8JfhnU8",metadata:{action_id:"g-d08200cb39473e72a1058ed24f66ff9838cf07c1",auth:{type:"none"},domain:"actions.sider.ai",json_schema:null,privacy_policy_url:"https://sider.ai/policies/privacy",raw_spec:""},settings:null,type:"plugins_prototype"},{id:"gzm_cnf_p4GmqNKla5EIJWaJ78Qjnq0B~gzm_tool_wtkmQ099hG3LZNbfZ6jXBMfN",metadata:null,settings:null,type:"dalle"}]}},"g-nleealfRT":{flair:{kind:"sidebar_keep"},resource:{files:[],gizmo:{appeal_info:null,author:{display_name:"awesomegpts.ai",is_verified:!0,link_to:"https://awesomegpts.ai",selected_display:"website",user_id:"user-MV1EPMI80LBUBFXL3yqj7TxP",will_receive_support_emails:null},created_at:"2023-11-15T09:08:04.569234+00:00",display:{categories:["lifestyle"],description:"Shop Smarter, Save Bigger! Quickly find top-rated gems and the best deals in the shopping sea!",name:"Shopping GPT",profile_picture_url:"https://files.oaiusercontent.com/file-epOlIRgMgGrqAHUd0l3Oq2HP?se=2123-12-22T06%3A43%3A25Z&sp=r&sv=2021-08-06&sr=b&rscc=max-age%3D1209600%2C%20immutable&rscd=attachment%3B%20filename%3DFrame%2520613.png&sig=ryqJXchYBS%2BMGC2aa4EPU6zGnOR93RgQoBXoV12b5KY%3D",prompt_starters:["Compare MacBook series products in a table","Locate nearby headphone retailers","Find sofas with top reviews","Find the cheapest Apple Watch Series 9"],welcome_message:""},id:"g-nleealfRT",instructions:null,last_interacted_at:"2024-01-20T06:16:29.030796+00:00",live_version:null,model:null,organization_id:"org-1uI21Op8M017HxHB8qTGnaym",settings:null,share_recipient:"marketplace",sharing_targets:null,short_url:"g-nleealfRT-shopping-gpt",tags:["public","reportable","uses_function_calls","pinned"],training_disabled:null,updated_at:"2024-01-20T02:52:49.252542+00:00",vanity_metrics:{created_ago_str:"2 months ago",num_conversations:341,num_conversations_str:"341",num_pins:0,num_users_interacted_with:0},version:null,voice:{id:"ember"},workspace_approval_date:null,workspace_approved:null,workspace_id:null},product_features:{attachments:{accepted_mime_types:["text/x-csharp","text/javascript","application/json","text/x-php","application/pdf","text/x-c","application/x-latext","text/html","text/x-sh","text/markdown","text/x-script.python","application/msword","application/vnd.openxmlformats-officedocument.presentationml.presentation","text/x-typescript","text/x-c++","text/x-ruby","text/plain","application/vnd.openxmlformats-officedocument.wordprocessingml.document","text/x-tex","text/x-java"],can_accept_all_mime_types:!0,image_mime_types:["image/gif","image/png","image/jpeg","image/webp"],type:"retrieval"}},tools:[{id:"gzm_cnf_mEdggaHyWwxFTAlH5vuabKsd~gzm_tool_sJQMJJ1tT9JqB6NizdOV6ChU",metadata:{action_id:"g-6a3d44cc7cf012a5f2222be5dadb5cc8140a15e3",auth:{type:"none"},domain:"actions.sider.ai",json_schema:null,privacy_policy_url:"https://sider.ai/policies/privacy",raw_spec:""},settings:null,type:"plugins_prototype"},{id:"gzm_cnf_gWRjhVNf1a0XZfN7oDjbgOEC~gzm_tool_YJucv3shUVUdtXn36lZJWVfs",metadata:null,settings:null,type:"browser"}]}}},Ef=["thinking_mode","artifacts","search","text_to_image","data_analysis"],yf=[{name:"thinking_mode",isExperimental:!0,isPro:!0},{name:"artifacts",isExperimental:!1,isPro:!0},{name:"search",isExperimental:!1,isPro:!0},{name:"text_to_image",isExperimental:!1,isPro:!0},{name:"data_analysis",isExperimental:!1,isPro:!0}];var jx=G(wf());var Me=G(K());var _=G(K());function M(e){return _.default.storage.local.get(e)}async function k(e){return _.default.storage.local.set(e)}async function ae(e){return _.default.storage.local.remove(e)}function Gn(e,t,r){return typeof e=="string"&&(e=[e]),Wx(_.default.storage.local.onChanged,A=>{for(let i of e)if(i in A){t(e.reduce((o,n)=>(o[n]=A[n],o),{}));break}},{signal:r?.signal})}async function Un(e){if(_.default.cookies){let t=await _.default.cookies.get(e);return t?.value?decodeURIComponent(t.value):""}return _.default.runtime.sendMessage({type:"GET_COOKIE",data:e})}async function Mn(e){return _.default?.cookies?await _.default.cookies.set(e):_.default.runtime.sendMessage({type:"SET_COOKIE",data:e})}function yi(e){return Un({name:e,url:z.origin})}function Hn(e,t,r=360){let A=Math.round(Date.now()/1e3)+86400*r;try{return Mn({name:e,value:t,url:z.origin,domain:"."+new URL(z.origin).hostname,expirationDate:A,secure:!0})}catch{}}function Ve(e){return _.default.tabs?_.default.tabs.create(e):_.default.runtime.sendMessage({type:"OPEN_URL_IN_NEW_TAB",details:e})}async function Df(e,t){let r=await _.default.tabs.query(e);for(let A of r)A.id&&await _.default.tabs.update(A.id,t)}async function Ff(e){return _.default?.tabs?wi(e):_.default.runtime.sendMessage({type:"SWITCH_TAB",queryInfo:e})}async function wi(e,t=!1,r){let{url:A,...i}=e,o=new URL(A),n=`${o.origin}${o.pathname}*`,a=await _.default.tabs.query({url:n,...i});if(a.length)for(let s of a)s.id&&(await _.default.tabs.update(s.id,{active:!0}),t&&await _.default.tabs.reload(s.id,r));else{let{url:s,cookieStoreId:g,...I}=e,l={url:Array.isArray(s)?s[0]:s,...I};await _.default.tabs.create(l)}}function Rn(e="general",t,r){let A="/options.html";if(e&&(A+=`?section=${e}`),r){let i=new URLSearchParams(r);A+=`&${i.toString()}`}t&&(t.startsWith("#")||(t="#"+t),A+=t),_.default.tabs.create({url:A})}function st(e){return _.default.runtime.getURL(e)}async function gt(){return(await _.default.tabs.query({active:!0,currentWindow:!0}))[0]}function Sf(){return _.default.tabs?_.default.extension.isAllowedFileSchemeAccess():_.default.runtime.sendMessage({type:"IS_ALLOWED_FILE_SCHEME_ACCESS"})}function xf(){return!!(_.default.tabs&&_.default.tabs.query)}function Wx(e,t,r={}){let A=r.signal;if(A?.aborted)return rt;e.addListener(t);let i=()=>e.removeListener(t);return A?(A.addEventListener("abort",i,{once:!0}),()=>{i(),A.removeEventListener("abort",i)}):i}async function qn(){let[e]=await _.default.tabs.query({active:!0,currentWindow:!0});if(!e)throw new Error("No active tab");let t=e.id;if(t===void 0)throw new Error("No active tab");return t}function kf(){try{let t=_.default.runtime.getManifest().side_panel.default_path,r=new URL(_.default.runtime.getURL(t)),A=new URL(window.location.href);return A.pathname===r.pathname&&A.origin===r.origin}catch{return!1}}function bf(){if(!("serviceWorker"in navigator)&&!_.default.extension.getViews)return!0;try{let e=new URL(window.location.href);return browser.runtime.getManifest().background.scripts.some(r=>{let A=new URL(_.default.runtime.getURL(r));return e.pathname===A.pathname&&e.origin===A.origin})}catch{return!1}}async function jr(e,t){let{fileTextStatus:r}=await _.default.storage.local.get({fileTextStatus:{}});return e.forEach(A=>{r[A]=t}),_.default.storage.local.set({fileTextStatus:r})}var Tn=Object.hasOwn;var Xx=Array.isArray;var Zx="_";function _n(e,t){let r=e in t?t[e]:t[Zx];return typeof r=="function"?r():r}function Pn(e){return[...new Set(e)]}var xt=(...e)=>e.join("/").replace(/([^:])\/{2,}/g,"$1/");function Ot(e=1e3,t){return new Promise((r,A)=>{let i=setTimeout(r,e);t&&t.addEventListener("abort",()=>{clearTimeout(i),A(new DOMException("Aborted","AbortError"))},{once:!0})})}function On(e){return e!=null}async function kt(e,t=1e3,r=2){let A=0;for(;;){try{return await e()}catch(i){if(r>=0&&A++>=r)throw i}await Ot(t)}}function ze(e,t=0){let r=!1,A;return function(...i){return r||(r=!0,A=new Promise((o,n)=>{e(...i).then(o).catch(n).finally(async()=>{t&&await Ot(t),r=!1})})),A}}function Nf(e,t,r){return async function(){let A=`__debounceJob:${e}__`,i=(await M({[A]:{running:!1,startAt:0,endAt:0,retryCount:0}}))[A],{running:o=!1,startAt:n=0,endAt:a=0,retryCount:s=0}=i,g=async m=>(Object.assign(i,m),k({[A]:i})),I=Date.now(),l=a===0,c=s>0,u=c?s*1e4:r??0;if((l||I-a>=u)&&(!o||I-n>3e3)){g({startAt:I,running:!0});try{return await t(),g({endAt:Date.now(),running:!1,retryCount:0}),""}catch{throw g({endAt:Date.now(),running:!1,retryCount:s>=60?60:s+1}),new Error(e)}}if(c)throw new Error(e);return""}}function It(e){return new Promise((t,r)=>{let A=new FileReader;A.readAsDataURL(e),A.onload=()=>{t(A.result)},A.onerror=r})}async function vf(){return(await Me.default.cookies.getAll({domain:".chat.openai.com"})).some(r=>r.name=="__Secure-next-auth.session-token")}function Gf(e,t,r){let A=Me.default.runtime.getURL("chat/index.html");return Me.default.tabs.query({url:A+"*",currentWindow:!0}).then(async i=>{if(i.length){let o=await Me.default.tabs.update(i[0].id,{active:!0});return t&&t(),o}else return r&&await r(),Me.default.tabs.create({url:A+(e?"?reason="+e:"")})})}async function $r(){let e=Me.default.runtime.getURL("standalone.html?from=sidebar"),[t]=await Me.default.tabs.query({currentWindow:!0,url:`${e}*`});return t&&t.id?Me.default.tabs.reload(t.id).then(()=>Me.default.tabs.update(t.id,{active:!0})):Me.default.tabs.create({url:e})}function Jn(e){let t=e.lastIndexOf(".");return e.substring(0,t)}function Di(e,t="https://"){let r=e.trim();return/https?:\/\//.test(r)?r:t+r}function Uf(e,t,r){let A=$x(e,r);switch(t){case"<":return A===-1;case"<=":return A===-1||A===0;case"=":return A===0;case">":return A===1;case">=":return A===1||A===0;default:break}}function $x(e,t){let r=e.split(".").map(Number),A=t.split(".").map(Number),i=Math.max(r.length,A.length);for(let o=0;o<i;o++){let n=r[o]||0,a=A[o]||0;if(n>a)return 1;if(n<a)return-1}return 0}var Fk=G(K());var rA=G(K());var eA=G(K());function tA(e){return eA.default.tabs.sendMessage(e,{type:"check"}).catch(t=>{if(eA.default.scripting?.executeScript)return Promise.all([eA.default.scripting.executeScript({target:{tabId:e},files:["content-all.js"]}),eA.default.scripting.executeScript({target:{tabId:e,allFrames:!0},files:["all-frames.js"]})]).then(r=>r).catch(r=>{if(!(r instanceof Error&&r.message.startsWith("Cannot access a chrome")))throw new Error("Failed to inject content script")})})}var Fi=class{constructor(){this.queue=[];this.isRunning=!1}async run(t){if(this.queue.push(t),!this.isRunning){for(this.isRunning=!0;this.queue.length;){let r=this.queue.shift();r&&await r()}this.isRunning=!1}}};async function*Mf(e=200,t=15){let r=0;for(;r++<t;)yield rA.default.runtime.sendMessage({type:"is-sidepanel-open"}).catch(()=>!1),await Ot(e)}async function Hf(e,t=!1){let{siderModelsLastUpdateTime:r}=await M({siderModelsLastUpdateTime:0});if(!r||Date.now()-r>60*60*1e3||t)return R.loadSiderModels(e).then(A=>{A&&A.length&&tk(A)&&(k({siderModels:A.map(i=>({name:i.name,displayName:i.display_name,cost:i.cost,level:i.level,category:i.category,creator:i.creator,icon:i.logo,desc:i.desc,enable:i.enable,replaceBy:i.replace_by})),siderModelsLastUpdateTime:Date.now()}),M({"provider:siderApi":{model:"sider"},siderGrammarKey:{model:"sider"},"quickAction:provider:siderApi":"sider"}).then(i=>{let o=i["provider:siderApi"]?.model,n=i.siderGrammarKey?.model,a=i["quickAction:provider:siderApi"];if(o){let s=A.find(g=>g.name===o);s&&s.replace_by&&rA.default.storage.local.set({"provider:siderApi":{model:s.replace_by}})}if(n){let s=A.find(g=>g.name===n);s&&s.replace_by&&rA.default.storage.local.set({siderGrammarKey:{model:s.replace_by}})}if(a){let s=A.find(g=>g.name===a);s&&s.replace_by&&rA.default.storage.local.set({"quickAction:provider:siderApi":{model:s.replace_by}})}}))})}async function Rf(e,t=!1){let{websiteToolsLastUpdateTime:r}=await M({websiteToolsLastUpdateTime:0});if(!r||Date.now()-r>60*60*1e3||t)return R.loadWebsiteTools(e).then(A=>{if(A&&A.categories&&A.categories.length){let i=A.categories;k({websiteTools:i,websiteToolsLastUpdateTime:Date.now()})}})}function tk(e){return Array.isArray(e)?e.every(t=>typeof t!="object"||t===null?!1:typeof t.name=="string"&&typeof t.display_name=="string"&&typeof t.creator=="string"&&typeof t.logo=="string"&&typeof t.desc=="string"&&typeof t.category=="number"&&typeof t.enable=="boolean"&&typeof t.replace_by=="string"&&typeof t.cost=="object"&&t.cost!==null&&typeof t.cost.type=="string"&&typeof t.cost.count=="number"):!1}var qf=G(K());async function AA(){let{generatedRandomId:e}=await M({generatedRandomId:""});if(!e){let t=await rk();return t||(t=ee(),Ak(t)),qf.default.storage.local.set({generatedRandomId:t}),t}return e}var Tf=z.origin.replace(/\/\/\w+?\./,"//Y2hhdGdwdC1zaWRlYmFy."),_f="zgv2awnlswq";async function rk(){try{return await Un({url:Tf,name:_f})}catch{return""}}async function Ak(e){let t=Math.round(Date.now()/1e3)+31104e3;try{return await Mn({url:Tf,name:_f,value:e,expirationDate:t,secure:!0})}catch{}}var Dk=G(K());var Xf=G(K());var Yn=G(K());var hr=G(K());var Pf="__webext_forward_tabs_message__",Si=new Map,ik=bf(),ok=kf(),Kn=(e,t)=>{if(ik){let i=nk(e,t);if(i)return i}if(e.view==="sidebar"&&!ok)return;let r=e.type,A=Si.get(r);if(A)return new Promise(async i=>{try{i({data:await A({sender:t,data:e.data,id:r,originalSender:e.sender})})}catch(o){i({error:Vr(o)})}})};function nk(e,t){if(e.type===Pf)return new Promise(async(r,A)=>{let{tabId:i,frameId:o,type:n,data:a,view:s}=e.data,g;try{g=i==="sender"?t.tab.id:i==="active"?await qn():i}catch(l){return A(l)}let I=o==="sender"?t.frameId:o;r(hr.default.tabs.sendMessage(g,{type:n,data:a,sender:t,view:s},I===void 0?void 0:{frameId:I}))})}async function Jt(...e){if(!hr.default.runtime.id)throw new Error("Extension not initialized.");let[t,r,A={}]=e,i=A.tabId,o=A.frameId,n=A.view,a;if(i===void 0?a=await hr.default.runtime.sendMessage({type:t,data:r,view:n}):i!=="sender"&&o!=="sender"&&xf()?a=await hr.default.tabs.sendMessage(i==="active"?await qn():i,{type:t,data:r,view:n},o===void 0?void 0:{frameId:o}):a=await hr.default.runtime.sendMessage({type:Pf,data:{tabId:i,frameId:o,type:t,data:r,view:n}}),!a)throw new Error(`null for Message ID "${t}". Maybe multiple async runtime.onMessage listeners or no listener.`);if("error"in a)throw vu(a.error);return a.data}function ye(e,t,r={}){let A=r.signal;if(A?.aborted)return rt;if(Si.get(e))throw new Error(`Message ID "${e}" already has a listener.`);Si.set(e,t);let o=()=>Si.delete(e);return A&&A.addEventListener("abort",o,{once:!0}),()=>{o(),A&&A.removeEventListener("abort",o)}}var ak=G(K()),xi=new Map;function ki(e,t){if(xi.get(e))throw new Error(`Channel "${e}" already has a listener.`);return xi.set(e,t),()=>{xi.delete(e)}}function Ln(e){let t=e.name,r=xi.get(t);return r?(r(sk(e)),!0):!1}function sk(e){let t=new AbortController,r=!0;e.onDisconnect.addListener(()=>{t.abort(),r=!1});function A(o){return e.onDisconnect.addListener(o),()=>e.onDisconnect.removeListener(o)}function i(o){return e.onMessage.addListener(o),()=>e.onMessage.removeListener(o)}return{signal:t.signal,send:o=>r&&e.postMessage(o),close:()=>r&&e.disconnect(),onMessage:i,onClose:A,async*iter(...o){let n,a=i(g=>n(g)),s=A(()=>n=rt);o.length&&e.postMessage(o[0]);try{for(;;)yield new Promise(g=>n=g)}finally{a(),s()}}}}var We={installSuccess(){return R.googleAnalytics(`${Ie?"edge_":""}sider_install_success`,{id:"install"})},report(e,t){let A=(Ie?"edge_":"chrome_")+e;R.googleAnalytics(A,{...t}).catch(()=>{})},async tts(e={}){let t=e.id||(await M({lastTab:""})).lastTab,r=e.voice||(await M({lastVoiceRole:""})).lastVoiceRole;We.report(`tts_${t}_${r}`)}};async function gk(){let e=await J("sider_event_device_id");if(!e){let t=ee();return await k({sider_event_device_id:t}),t}return e}async function Ik(){let e=await J("sider_event_unique_id");if(!e){let t=ee();return await k({sider_event_unique_id:t}),t}return e}function ck(){let e={Win:"Windows",Mac:"MacOS",X11:"UNIX",Linux:"Linux",Android:"Android",iPhone:"iOS"};for(let[t,r]of Object.entries(e))if(navigator.userAgent.includes(t))return r;return"Unknown"}async function lk(){return(await J("userInfo"))?.id}async function uk(){return(await J("vipInfo"))?.isVIP}function Of(e){let t=typeof e;return t==="string"||t==="number"||t==="boolean"}var Jf="sider_extension",fk="https://event.sider.ai/collect",Vn=async(e,t)=>{if(!Yn.default.tabs)return Yn.default.runtime.sendMessage({type:"SIDER_STAT_API",args:[e,t]});let r=e.replace(/-/gi,"_");r.length>50,t&&Object.entries(t).forEach(([o,n])=>{Array.isArray(n)?t[o]=n.filter(Of).join("&"):Of(n)||delete t[o]});let A=Date.now(),i={app_id:Jf,event_type:r,event_id:ee(),device_id:await gk(),unique_id:await Ik(),timestamp:A,host_name:"sider.ai",locale:await J("language"),system_language:await J("language"),country_code:navigator.language.split("-")[1],zone_offset:-new Date().getTimezoneOffset()*6e4,make:"Node",screen_height:typeof window<"u"?window.screen.height:0,screen_width:typeof window<"u"?window.screen.width:0,viewport_height:typeof window<"u"?window.innerHeight:0,viewport_width:typeof window<"u"?window.innerWidth:0,sdk_name:"aws-solution-clickstream-sdk",sdk_version:"0.12.2",platform:"Extension",app_version:ce,app_package_name:`Sider_${Ie?"edge":"chrome"}`,attributes:{...t,os:ck(),user_id:await lk(),user_premium:await uk()}};return fetch(`${fk}?appId=${Jf}&platform=Ext&event_bundle_sequence_id=1&upload_timestamp=${A}`,{method:"POST",headers:new Headers({"Content-Type":"application/json; charset=utf-8"}),body:JSON.stringify([i])}).catch(o=>{})},Kf={report:async(e,t)=>{try{await Vn(e,t)}catch{}}};function mr(e){let t,r,A,i,o,n,a;return s(),{feed:g,reset:s};function s(){t=!0,r="",A=0,i=-1,o=void 0,n=void 0,a=""}function g(l){r=r?r+l:l,t&&dk(r)&&(r=r.slice(Lf.length)),t=!1;let c=r.length,u=0,C=!1;for(;u<c;){C&&(r[u]===`
`&&++u,C=!1);let m=-1,y=i,h;for(let F=A;m<0&&F<c;++F)h=r[F],h===":"&&y<0?y=F-u:h==="\r"?(C=!0,m=F-u):h===`
`&&(m=F-u);if(m<0){A=c-u,i=y;break}else A=0,i=-1;I(r,u,y,m),u+=m+1}u===c?r="":u>0&&(r=r.slice(u))}function I(l,c,u,C){if(C===0){a.length>0&&(e({type:"event",id:o,event:n||void 0,data:a.slice(0,-1)}),a="",o=void 0),n=void 0;return}let m=u<0,y=l.slice(c,c+(m?C:u)),h=0;m?h=C:l[c+u+1]===" "?h=u+2:h=u+1;let F=c+h,b=C-h,d=l.slice(F,F+b).toString();if(y==="data")a+=d?"".concat(d,`
`):`
`;else if(y==="event")n=d;else if(y==="id"&&!d.includes("\0"))o=d;else if(y==="retry"){let w=parseInt(d,10);Number.isNaN(w)||e({type:"reconnect-interval",value:w})}}}var Lf=[239,187,191];function dk(e){return Lf.every((t,r)=>e.charCodeAt(r)===t)}async function*Er(e){let t=e.getReader();try{for(;;){let{done:r,value:A}=await t.read();if(r)return;yield A}}finally{t.releaseLock()}}var pk=Object.prototype.toString,Bk=e=>pk.call(e)==="[object Error]",Ck=new Set(["network error","Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Load failed","Network request failed","fetch failed","terminated"]);function zn(e){return e&&Bk(e)&&e.name==="TypeError"&&typeof e.message=="string"?e.message==="Load failed"?e.stack===void 0:Ck.has(e.message):!1}var Qk="https://apidomain.gptshere.com/api/static/domain_list",Yf="AES-GCM",hk="SHA-256";async function mk(e){let t=new TextEncoder().encode(e);return(await crypto.subtle.digest({name:hk},t)).slice(0,16)}async function Vf(){let e=new Date().getTime(),t=await fetch(Qk,{method:"GET",headers:{iv:e.toString()}}),r=t.headers.get("kl");if(!r)throw new Error("api error");let A=parseInt(r,10);if(isNaN(A)||A<0||A>64)throw new Error("api error");let o=await(await t.blob()).arrayBuffer(),n=new Uint8Array(o,0,A),a=new Uint8Array(o,A),s=await mk(e.toString()),g=await crypto.subtle.importKey("raw",n,{name:Yf},!1,["decrypt"]),I=await crypto.subtle.decrypt({name:Yf,iv:s},g,a),l=new TextDecoder().decode(I),c=JSON.parse(l);if(c.code!==0)throw new Error("api error");let u=c?.data?.list;if(!u||u.length===0)throw new Error("api error");return u}var Se="domainPool",iA="domainPoolIndex";async function Wn(){let e=await M({[Se]:[],[iA]:0}),t=e[iA]+1;t>=e[Se].length&&(t=0),e[Se].length>0&&k({[iA]:t})}async function Ek(){let e=await M({[Se]:[z.origin],[iA]:0});return e[Se][e[iA]]??z.origin}async function yr(){let e=await Ek();return new URL("api",e).toString()}async function zf(){let e=await M({[Se]:[]}),t=null,r=[];try{r=await Vf()}catch(A){throw t=A,A}finally{(t||!r?.length)&&(r=[z.origin,...e[Se]]),k({[Se]:[...new Set([z.origin,...r??[]])]})}}async function wr(e,t){let r=await M({[Se]:[]});if(zn(e)&&navigator.onLine)if(t){let A=!1;t instanceof URL?A=r[Se].some(i=>t.origin.includes(i)):A=r[Se].some(i=>t.includes(i)),A&&await Wn()}else await Wn()}async function oA(e,t,r={},A={}){let i=r.signal;if(i?.aborted)throw new DOMException("Aborted","AbortError");let o=await yr(),n=URL.parse(e)??new URL(`${o}${e}`),a=wk(r.body??t),s=new Headers(r.headers),g=(r.method??"GET").toUpperCase(),I=g==="GET"||g==="HEAD";s.has("Content-Type")||s.set("Content-Type","application/json");let{noAuth:l=!1,timeout:c,noAppInfo:u=!1}=A;if(!l&&!s.has("Authorization")){let F;try{F=(await bt()).token}catch(b){throw b instanceof Error?b:yk(b)&&b.msg?new Error(b.msg,{cause:b}):new Error("Failed to get token")}F&&s.set("Authorization",F)}if(a instanceof FormData&&s.delete("Content-Type"),!u){let F=function(b){if(I){let d=n.searchParams;for(let w in b)d.has(w)||d.append(w,b[w])}else if(a instanceof FormData)for(let d in b)a.has(d)||a.append(d,b[d]);else if(cr(a))for(let d in b)Object.hasOwn(a,d)||(a[d]=b[d])};var h=F;F({app_name:T,tz_name:Ae,app_version:ce})}let C=Object.assign({},r,{signal:tc([i,c?rc(c):null].filter(On)),headers:s,method:g,body:I?void 0:s.get("Content-Type")==="application/json"?JSON.stringify(a):a}),m=await fetch(n,C).catch(F=>{throw wr(F,n),F});if(A.onStream&&m.body&&m.ok){let F=A.onStream,b=mr(d=>{if(d.type!=="event")return;let w=d.data==="[DONE]";if(w){F({done:w});return}let f=JSON.parse(d.data);if(f.code!==0)throw new Error(f.msg,{cause:f});F({data:f.data})});for await(let d of Er(m.body)){let w=new TextDecoder().decode(d);b.feed(w)}return{}}let y=await m.json().catch(()=>{});if(!m.ok)throw new Error(`${m.status}: ${y?.msg||m.statusText}`,{cause:y});if(!y)throw new Error("Response body is not json");if(y.code!==0)throw(y.code===1003||y.code===1006)&&k({ERR_MUST_LOGIN:!0}),new Error(y.msg,{cause:y});return ae("ERR_MUST_LOGIN"),y.data}function yk(e){return cr(e)&&Object.hasOwn(e,"code")&&Object.hasOwn(e,"data")&&Object.hasOwn(e,"msg")&&typeof e.code=="number"}function wk(e){if(e instanceof FormData){let t=new FormData;for(let[r,A]of e.entries())t.append(r,A);return t}else return In(e)}async function ct(e,t,r){let A,i;(e==="gpt-3.5"||e==="gpt-4")&&t&&(A={[e]:ln({total:t.total,remain:t.remain,extraTotal:t.extra_total,extraRemain:t.extra_quota,period:t.remain_period,used:t.used},On)}),r&&(i={videoSummary:{total:r.total.video_summary,used:r.used.video_summary,remain:r.total.video_summary-r.used.video_summary},chatFile:{total:r.total.chat_file,used:r.used.chat_file,remain:r.total.chat_file-r.used.chat_file},painter:{total:r.total.painter,used:r.used.painter,remain:r.total.painter-r.used.painter},tts:{total:r.total.tts,used:r.used.tts,remain:r.total.tts-r.used.tts},artifacts:{total:r.total.artifacts,used:r.used.artifacts,remain:r.total.artifacts-r.used.artifacts},thinking_mode:{total:r.total.thinking_mode,used:r.used.thinking_mode,remain:r.total.thinking_mode-r.used.thinking_mode},data_analysis:{total:r.total.data_analysis,used:r.used.data_analysis,remain:r.total.data_analysis-r.used.data_analysis},text_to_image:{total:r.total.text_to_image,used:r.used.text_to_image,remain:r.total.text_to_image-r.used.text_to_image},search:{total:r.total.search,used:r.used.search,remain:r.total.search-r.used.search},...r.total.short_video?{shortVideo:{total:r.total.short_video,used:r.used.short_video,remain:r.total.short_video-r.used.short_video}}:{}}),await lt({...A&&A,...i&&{trial:i}})}async function Wf(e,t=5e3){return oA("/v1/image/manage/sync",{cids:e},{method:"POST"},{timeout:t})}function bi(e){return xt(z.origin,e)}async function Zf(){Ve({url:bi("/login")})}async function jf(){Ve({url:bi("/invite")})}async function Zn({openerTabId:e,subRoute:t="painter",hasDataToSend:r=!1}={}){if(!await J("painterMigrated",!1)){e:{let{"sider-image-creator:conversations":i}=await M({"sider-image-creator:conversations":[]});if(!i.length)break e;let o=i.map(s=>`sider-image-creator:messages:${s.id}`),n=await Xf.default.storage.local.get(o),a=Object.values(n).map(s=>s.cid).filter(s=>!!s);if(!a.length)break e;await Wf(a,5e3).catch(rt)}St("painterMigrated",!0)}return Ve({url:bi(`/tools/image/${t}${r?"?from=ext":""}`),openerTabId:e})}var jn={token:"",refresh_token:"","userinfo-type":"","userinfo-avatar":"","userinfo-name":""};async function le(){let e=await Ni("userinfo-type"),t=await Ni("token");return e===null?null:!!(t&&e&&e!=="device")}async function nA(){await k({__manual_logout__:!0}),await ae(Object.keys(jn)),await ae("userInfo"),await k({logged:!1})}async function $n(){let{vipInfo:e}=await M({vipInfo:{isVIP:!1,isTrial:!1,userTypeDetail:"login",resetTimeSec:0,"gpt-3.5":{total:0,remain:0,used:0,extraTotal:0,extraRemain:0,period:"total"},"gpt-4":{total:0,remain:0,used:0,extraTotal:0,extraRemain:0,period:"total"},trial:{chatFile:{total:0,remain:0,used:0},painter:{total:0,remain:0,used:0},videoSummary:{total:0,remain:0,used:0},tts:{total:0,remain:0,used:0},shortVideo:{total:0,remain:0,used:0},artifacts:{total:0,remain:0,used:0},search:{total:0,remain:0,used:0},text_to_image:{total:0,remain:0,used:0},data_analysis:{total:0,remain:0,used:0},thinking_mode:{total:0,remain:0,used:0}},"image-creator":{total:0,remain:0,used:0,extraTotal:0,extraRemain:0,period:"total"},summary:{total:0,remain:0,cost:3,period:"total"},ocr:{cost:1},reader:{total:0,remain:0,used:0,limitSize:104857600,period:"total"}}});return e}async function lt(e){let t=await $n();return typeof e=="function"&&(e=e(t)),Lr(t,e,(r,A)=>{if(Array.isArray(r))return A}),k({vipInfo:t})}async function bt(){let e=await Kt();return e?{...e,anonymous:!1}:{token:"",refreshToken:"",anonymous:!1}}async function Kt(){if(await le()){let e=await Ni("token"),t=await Ni("refresh_token");return e?{token:e,refreshToken:t}:null}return null}async function Ni(e){let{__manual_logout__:t,__force_logout_reason__:r}=await M({__manual_logout__:!1,__force_logout_reason__:""});if(t||r)return"";try{let A=await yi(e);if(!A)throw new Error("");return k({[e]:A}),A}catch{return(await M({[e]:""}))[e]}}var Lt={609:"error_sider_premium_required",610:"error_sider_high_traffic",1003:"error_sider_need_login",1006:"error_sider_device_bind_account",1011:"error_sider_login_expired",1012:"error_sider_admin_kickout",1013:"error_sider_device_limit_logout",1018:"error_sider_login_expired",1019:"error_sider_user_banned",1101:"error_sider_processing",1102:"error_sider_api_limit",1107:"error_sider_api_limit2",1109:"error_sider_gpt4_highload",1110:"error_sider_gpt_highload",1112:"error_sider_gpt4_limit",1113:"error_sider_gpt4_limit",1136:"error_sider_o1_limit",1137:"error_sider_unlimited_limit",1138:"error_sider_new_unlimited_limit_1",1139:"error_sider_new_unlimited_limit_2",1141:"error_sider_new_unlimited_limit_3",1142:"error_sider_data_analysis_credit",3509:"error_sider_audio_advanced_limit",1118:"error_sider_image_limit",1127:"error_sider_ocr_limit",1128:"error_sider_summary_video_limit",1501:"error_sider_openai_fault",1515:"error_sider_gemini_pro_busy",1129:"error_sider_basic_text_limit",1130:"error_sider_advanced_text_limit",1135:"error_sider_credit_freq_limit",1132:"error_sider_openai_filter",2003:"error_sider_embedding_limit_by_count",3511:"error_sider_audio_to_text_service_overload",4e3:"error_sider_trial_feat_limit",4500:"error_sider_video_too_long",4501:"error_sider_failed_to_create_user_video_task",4502:"error_sider_failed_to_send_whisper_request",4503:"error_sider_got_error_response_from_whisper",4504:"error_sider_failed_to_get_subtitle",4505:"error_sider_failed_to_get_video_info",4506:"error_sider_not_support_live_video"};function aA(e,t){switch(e){case 1011:case 1012:case 1013:case 1018:k({__force_logout_reason__:Lt[e]}).then(()=>{nA()});break;case 1102:case 1107:case 1112:case 1113:case 1118:case 1127:case 1128:case 3511:case 4e3:case 4501:case 4502:case 4503:case 4504:R.getVipInfoCached();break;default:break}throw new Error(ea(e,t))}function ea(e,t){if(e===1136)return t.includes(`ask.${z.domain}`)?Lt[e]:t;if(e===1135){let r=t.match(/after (.*) minutes/i)?.[1]||60;return`${Lt[e]}|${r}`}if(e===1137){let r=t.match(/is \( (.*) uses/i)?.[1],A=t.match(/every (.*) hours, resetting/i)?.[1],i=t.match(/resetting at (.*). Full/i)?.[1];return`${Lt[e]}|${r}|${A}|${i}`}if(e===1139||e===1141){let r=t.match(/Current speed limit is \((.*) times \//i)?.[1],A=t.match(/\/ (.*) hour/i)?.[1];return`${Lt[e]}|${r}|${A}`}return e in Lt?Lt[e]:typeof t=="string"&&t.startsWith("504")?"error_sider_timeout":t}async function Sk(e,t,r){return new Promise((A,i)=>{let o=new XMLHttpRequest;o.open(t.method||"GET",e),t.headers instanceof Headers&&t.headers.forEach((n,a)=>{o.setRequestHeader(a,n)}),o.onload=function(){A(new Response(o.responseText,{status:o.status,statusText:o.statusText}))},o.upload.onprogress=function(n){n.lengthComputable&&r&&r?.(n.loaded/n.total*100)},o.onerror=function(){i(new TypeError("Network request failed"))},o.ontimeout=function(){i(new TypeError("Network request timed out"))},o.send(t.body),t.signal&&(t.signal.onabort=function(){o.abort(),i(new DOMException("Aborted","AbortError"))})})}async function ta(e,t=null,r={}){if(!e.startsWith("http")){let C=await yr();e=xt(C,e)}let{onStreamData:A,getAbortMethod:i,noAuth:o,timeout:n,returnRawResponse:a,onProgress:s,...g}=r;g.method&&(g.method=g.method.toUpperCase());let I=new AbortController;if(g.signal=I.signal,i?.(()=>{I.abort()}),g.headers=new Headers(g.headers||{}),!o&&!g.headers.has("Authorization")){let C=(await bt()).token;C&&(g.headers.set("Authorization",C),ae("ERR_MUST_LOGIN"))}if(t)try{t instanceof FormData||t instanceof Blob||t instanceof URLSearchParams||t instanceof ReadableStream||t instanceof ArrayBuffer||t instanceof DataView?g.body=t:(g.body=JSON.stringify(t),g.headers.set("Content-Type","application/json"))}catch{g.body=t}let l;n&&(l=setTimeout(()=>I.abort(),n));let c=null;try{c=s?await Sk(e,g,s):await fetch(e,g)}catch(C){throw wr(C,e),C}if(!c)throw new Error("No response");if(n&&clearTimeout(l),a)return c;let u=null;if(A||(u=await c.json().catch(()=>({}))),!c.ok||c.status!==204&&u&&u.code!==0){if(u||(u=await c.json().catch(()=>({}))),u.errMsg=u.msg||u.message,Yr(u))u.errMsg=`${c.status} ${c.statusText}`;else{(u.code===1003||u.code===1006)&&k({ERR_MUST_LOGIN:!0});try{aA(u.code,u.msg||u.message)}catch(C){u.errMsg=C.message}}throw A&&A({data:null,done:!0}),u}if(A&&c.body){let C=mr(m=>{if(m.type==="event"){let y={code:0,data:null,msg:"",errMsg:"",done:m.data==="[DONE]"},h=null;try{h=JSON.parse(m.data)}catch{}if(h&&(y={...y,...h}),y.code!==0){try{aA(y.code,y.msg)}catch(F){y.errMsg=F.message}throw A({data:null,done:!0}),y}A({data:y.data,done:y.done})}});for await(let m of Er(c.body)){let y=new TextDecoder().decode(m);C.feed(y)}}return u?.data}var te=(...e)=>ta(e[0],e[1],{...e[2],method:"GET"}),P=(...e)=>ta(e[0],e[1],{...e[2],method:"POST"});var $f=(...e)=>ta(e[0],e[1],{...e[2],method:"DELETE"});var T=Qi,Y=ce,Ae=Intl.DateTimeFormat().resolvedOptions().timeZone,ra="ChitChat_Ext",Aa="ChitChat_Ext_UserStatus",R={async refreshToken(e){let t=await P("/v1/user/token/refresh",{refresh_token:e},{headers:{Authorization:""}});return{token:t.token.token,refreshToken:t.token.refresh_token}},getSiderAnonymousToken:ze(async()=>{let e=await AA();return P("/v1/user/login/device_id",{device_id:e,uuid:e,app_name:T,app_version:Y},{headers:{Authorization:""}})}),getUserInfo:async()=>{let e=await te(`/v1/user/info?app_name=${T}&app_version=${Y}`);return await k({userInfo:e}),e},getVipInfo:ed,getVipInfoCached:ze(ed,5e3),getVipPeriodInfo:ze(async()=>{let e=await te(`/v1/completion/limit/static?app_name=${T}&app_version=${Y}&tz_name=${Ae}`);return await k({vipPeriodInfo:e}),e},3e3),async getPricingPlan(){let e=await te("/v1/app/ipinfo",null,{headers:{Authorization:""}}),t=e.region==="CN"||Ae==="Asia/Shanghai"&&await J("language","en")==="zh_CN",r=await te(`/v1/payment/pricing?from=web&location=${t?"CN":e.region}`,null,{headers:{Authorization:""}});k({isCNUser:t,pricingPlan:r.plan.map(A=>({name:A.name,displayName:A.display_name,currency:A.currency,interval:A.interval,originPrice:A.origin_price/100,price:A.price/100,discount:A.discount/100||0,current:A.id==r.current_plan?.id}))})},getClientConfig:async e=>{let t=await te(`/v1/app/config?app_name=${T}&app_version=${Y}&tz_name=${Ae}`);return t&&await k({configByServer:t}),e?t?.[e]:t},getUserSettings:ze(async()=>await le()?(await te(`/v1/user/settings?app_name=${T}&keys=${ra}`)).keys?.[ra]:{},2e3),setUserSettings(e){if(!(!e||Object.keys(e).length===0))return kt(()=>P("/v1/user/settings",{app_name:T,key:ra,key_setting:e}))},getUserStatus:ze(async()=>{let t=(await te(`/v1/user/settings?app_name=${T}&keys=${Aa}`)).keys?.[Aa];return t&&Object.keys(t).length&&await k({userStatus:t}),t},2e3),async setUserStatus(e){if(!e||Object.keys(e).length===0)return;await kt(()=>P("/v1/user/settings",{app_name:T,key:Aa,key_setting:e}));let{userStatus:t}=await J({userStatus:{}});k({userStatus:{...t||{},...e}})},getUserPromptList(e){return te(`/v1/prompt/list?type=${e}&page_size=999`)},getAllPromptList:async()=>{let e=await J({language:"",chatVisiblePromptKeys:null,readVisiblePromptKeys:null,writeVisiblePromptKeys:null}),t=e.language;if(!t)throw new Error("no language");let r=await R.getUserSettings(),[A,i]=await Promise.all([te(`/v1/prompt/list_all?app_name=${T}&page_size=999&language=${t}`,null,{headers:{Authorization:(await Kt())?.token||""}}),te(`/v1/prompt/list?type=special&app_name=${T}&page_size=999&language=${t}`,null,{headers:{Authorization:(await Kt())?.token||""}})]),o=A.List;o.sort((h,F)=>(h.sort!==0||h.key==="improve_writing")&&(F.sort!==0||F.key==="improve_writing")?F.sort-h.sort:F.sort===0?1:h.sort===0?-1:0);let n=o.reduce((h,F)=>(h[F.key||F.id]=F,h),{});function a(h){return{id:String(h.id),key:String(h.key||h.id),isCustom:!h.key||h.key.startsWith("custom"),name:h.display_name||h.name,shortName:h.short_name,content:h.content,icon:h.icon,placeholder:h.placeholder,usedIn:h.use||void 0,children:h.has_child?[]:void 0,parentKey:h.parent_key}}let s=[],g={};for(let h of o){let{key:F,has_child:b,parent_key:d}=h;if(b){if(!(F in g)){let f=a(h);g[F]=f,s.push(f)}continue}if(d){let f=n[d];if(!f)continue;if(!(d in g)){let Q=a(f);g[d]=Q,s.push(Q)}g[d]?.children?.push(a(h));continue}let w=a(h);s.push(w)}let I=new Map(s.map(h=>[h.key,h]));function l(h,F){let b=I.get(h);if(b){let{usedIn:d}=b;return!d||d.includes(F)}return!1}function c(h,F=!1){let b=[];for(let d of s)l(d.key,h)&&(!F||d.isCustom)&&b.push(d.key);return b}let u=A.Sort,C={chat:["chatVisiblePromptKeys","ChatAsk"],read:["readVisiblePromptKeys","ReadingAssistant"],write:["writeVisiblePromptKeys","WritingAssistant"]},m={};for(let[h,[F,b]]of Object.entries(C)){let d=u[b].split(",").map(Q=>Q.trim()).filter(Q=>I.has(Q)),w=r?.[F],f=e[F]||w;if(f?m[F]=Pn([...f.filter(Q=>I.has(Q)),...c(h)]):m[F]=Pn([...c(h,!0),...d,...c(h)]),w?.length){let Q=w.reduce((p,N,S)=>(p[N]=S,p),{});m[F].sort((p,N)=>{let S=Q[p],x=Q[N],U=S===void 0,E=x===void 0;return U&&E?0:U?1:E?-1:S-x})}}let y=i.List.map(h=>a(h));await k({...m,allPromptList:s,specialPromptList:y,__DONT_SYNC__:`visiblePromptKeys${Date.now()}`})},createPrompt(e){return kt(()=>P("/v1/prompt/create",{is_template:!1,type:"sidebar",...e}))},editUserPrompt(e){return kt(()=>P("/v1/prompt/edit",e))},delUserPrompt(e){return kt(()=>P("/v1/prompt/update",{id:e,status:"Deleted"}))},async uploadHistoryMsg(e){let t=Array.from(new Set(e.flatMap(A=>A.files??[]))),r=await P("/v1/conversation/upload",{app_name:T,app_version:Y,messages:e,files:t.length?t:void 0});return{cid:r.cid,lastMsgId:r.messages[e.length-1].id}},uploadConversion(e){return P("/v1/conversation/upload",{share:!0,app_name:T,app_version:Y,messages:e})},saveConversion(e){return P("/v1/conversation/upload",{save_by_user:!0,app_name:T,app_version:Y,messages:e})},async shareConversion(e){return(await te(`/v1/conversation/share/${e}`)).share_key},saveSiderConversion(e){return te(`/v1/conversation/save-by-user/${e}`)},unSaveSiderConversion(e){return te(`/v1/conversation/unsave-by-user/${e}`)},delConversion(e){return $f(`/v1/conversation/delete/${e}`)},checkGrammarError(e){return P("/v1/completion/grammar_check",{content:e,tz_name:Ae,app_name:T,app_version:Y})},async improveWriting(e){function t(A){if(A?.total){let o={[e.model]:{total:A.total,remain:A.remain,extraTotal:A.extra_total,extraRemain:A.extra_quota,period:A.remain_period}};lt(o)}}let r=Ee(t,1e3,{leading:!0});return P("/v1/completion/improve_writing",{content:e.content,model:e.model,tz_name:Ae,app_name:T,app_version:Y},{onStreamData({data:A,done:i}){!i&&A&&r(A),e.onStreamData({text:A?.text||"",done:i})},getAbortMethod(){}})},async sendFeedback({title:e,detail:t,email:r}){let A=await Kt();return P("/v1/app/feedback",{title:e,email:r,data:{detail:t},app_name:T,app_version:Y},{headers:{Authorization:A?.token||""}})},async sendFiveStarFeedback(e,t){let r=await Kt(),A=await J("language","en"),i=`[FiveStarRate][${ce}][${A}] Feedback by FiveStarRate`;return P("/v1/app/feedback",{title:i,data:{from:t,detail:e},app_name:T,app_version:Y},{headers:{Authorization:r?.token||""}})},async sendSearchAgentDislikeFeedback(e,t,r){let A=await Kt(),i=await J("language","en"),o=`[SearchAgentDislike][${ce}][${i}] Feedback by SearchAgentDislike`;return P("/v1/app/feedback",{title:o,data:{from:t,feedbackData:r||{}},app_name:T,app_version:Y},{headers:{Authorization:A?.token||""}})},async getInviteRewardConfig(){let e=await te("/v1/invite/config",null,{headers:{Authorization:""}});return k({inviteRewardConfig:{"gpt3.5":e.GPT3Dot5Count,gpt4:e.GPT4Count}}),e},createInviteLink(){return P("/v1/invite/create",{type:"link"})},async getInviteRewardCount(e){let t=await te(`/v1/invite/reward?app_name=${T}&app_version=${Y}&last_req_time=${e}`);return{addedQuery:t.recent_reward_gpt3dot5_count+t.recent_reward_gpt4_count,addedUser:t.recent_invited_count}},inviteFinish:async()=>{let e=await AA();return P("/v1/invite/finish",{device_id:e})},async summaryVideo(e){function t(u){if(u?.total)if(e.vip){let C={"gpt-3.5":{total:u.total,remain:u.remain,extraTotal:u.extra_total,extraRemain:u.extra_quota,period:u.remain_period}};lt(C)}else{let C={summary:{remain:u.remain}};lt(C)}}let r=Ee(t,1e3,{leading:!0}),A={app_name:T,app_version:Y,tz_name:Ae,content:e.text,title:e.title,language:e.lang,source:e.source,source_type:e.sourceType,request_id:ee(),cid:""},i=[];e.getAbortMethod(()=>{for(let u of i)u()});let{content:o,cid:n,...a}=A,s=null;try{s=await P("/v1/completion/summarize_init",a,{getAbortMethod(u){i.push(u)}})}catch{}s&&(A.cid=s.cid||"");let g=P("/v1/completion/summarize_all",A,{onStreamData({data:u,done:C}){!C&&u&&r(u),e.onStreamData({text:u?.text||"",done:C})},getAbortMethod(u){i.push(u)}}),I=P("/v1/completion/summarize",A,{getAbortMethod(u){i.push(u)}}),[l,c]=await Promise.all([g,I]);return t(c),{text:c.text,subtitle:c.subtitle}},async summaryVideoByEid(e){function t(o){o?.total&&ct(o?.chat_model??"gpt-3.5",o,o.feature_info)}let r=Ee(t,1e3,{leading:!0}),A={app_name:T,app_version:Y,tz_name:Ae,use_whisper:!!e.useWhisper,eid:e.eid,language:e.language,re_summarize:!!e.reSummarize},i=await P("/v1/completion/video_summarize",A,{onStreamData({data:o,done:n}){!n&&o?(r(o),o.type==="text"?e.onStreamTextData({text:o.text,done:n}):o.type==="text_done"?e.onStreamTextData({text:o.text,done:!0}):o.type==="key_moments"&&e.onKey_momentsData(o.key_moments)):e.onStreamTextData({text:"",done:n})},getAbortMethod:o=>{e.getAbortMethod&&e.getAbortMethod(()=>{o()})}})},async getSummaryCache(e){let{is_creator:t,eid:r,summary:A,key_moments:i,language:o,from_whisper:n}=await P("/v1/completion/video_info",{source:e.source,source_type:e.source_type,title:e.title,app_name:T,app_version:Y,tz_name:Ae,language:e.language});return{is_creator:t,eid:r,summary:A,key_moments:i,from_whisper:n,language:o}},async getSummaryCacheRaw(e){let{is_creator:t,eid:r,summary:A,key_moments:i,language:o,task_id:n,subtitle:a,summary_language:s}=await P("/v1/completion/raw_video_info",{source:e.source,source_type:e.source_type,title:e.title,app_name:T,app_version:Y,tz_name:Ae,language:e.language});return{is_creator:t,eid:r,summary:A,subtitle:a,task_id:n,key_moments:i,language:o,summary_language:s}},async uploadWhisperSubtitle(e,t){return(await P("/v1/whisper/upload-subtitle",{app_name:T,app_version:Y,tz_name:Ae,url:e,summary_language:t})).task_id},async poolingWhisperProgress(e,t){let r=await P("/v1/whisper/progress",{app_name:T,app_version:Y,tz_name:Ae,task_id:e,webpage_url:t});return await ct("gpt-4",r.quota_map),{eid:r.eid,subtitle:r.subtitle_info.subtitle,language:r.subtitle_info.language,progress:r.progress}},statUserStop(e,t){return P("/v1/completion/mark-user-stop",{app_name:T,app_version:Y,cid:e,mid:t})},async OCR(e,t){let r=new FormData;return r.append("file",e),r.append("app_name",T),r.append("app_version",Y),r.append("tz_name",Ae),(await P("/v1/ocr/math",r,{getAbortMethod:t}))?.result?.text||""},adStat(e){return P("/v1/lp/action",{...e,meta:{browser:Ie?"Edge":"Chrome",ext_version:ce}},{headers:{}})},async googleAnalytics(e,t){if(!sA.default.tabs)return sA.default.runtime.sendMessage({type:"GA_API",args:[e,t]});let r=e.replace(/-/gi,"_");return r.length>40,P(`${ff}?measurement_id=${df}&api_secret=${pf}`,{client_id:await AA(),events:[{name:r,params:{...t}}]},{headers:{Authorization:""}})},uploadImage(e){let t=new FormData;return t.append("file",e),P("/v1/imagechat/upload",t,{onProgress:r=>{}})},signImageCookie(){return te("/v1/user/sign-file-cookies")},loadSiderModels(e){return te(`/v1/app/load_models?app_name=${T}&app_version=${Y}&lang=${e}`)},loadWebsiteTools(e){return te(`/v1/app/load_tools?app_name=${T}&app_version=${Y}&lang=${e}`)},uploadFile(e,t,r,A,i){let o=new FormData;return o.append("file",e),o.append("app_name",T),o.append("app_version",Y),o.append("tz_name",Ae),r&&o.append("webpage_url",r),A&&o.append("file_for",A),P("/v1/embedding/upload-file",o,{onProgress:t,getAbortMethod:n=>{i&&i(()=>{n()})}}).then(n=>{try{(n?.text_ready||!n.is_embedding)&&jr([n?.id],!0)}catch{}return n})},getFileStauts(e){return te(`/v1/embedding/status?ids=${e}`)},async getPromotionCountdown(e){return await te(`/v2/user/promotion/promotion_info?app_name=${T}&app_version=${Y}&tz_name=${Ae}${e?"&event_name="+e:""}`)},async getVoiceRoleList(){let e=uf,{voiceRoleList:t}=await M({voiceRoleList:[]});t?.length===0&&k({voiceRoleList:[e]});let A=(await te(`/v1/audio/voice/list?app_name=${T}&app_version=${Y}&tz_name=${Ae}&page=1&page_size=999`)).list.map(i=>({name:i.name,avatar:i.avatar,gender:i.gender,platform:i.platform,requireVIP:i.need_premium}));k({voiceRoleList:[e,...A]}),Promise.allSettled(A.map(i=>new Promise((o,n)=>{i.avatar?.startsWith("http")?fetch(i.avatar).then(async a=>{i.avatar=await It(await a.blob()),o("")}).catch(n):o("")}))).then(()=>{k({voiceRoleList:[e,...A]})})},async getTTSDemoText(){let{language:e}=await M({language:""});if(e){let t=await te(`/v1/audio/audition/text?language_code=${e}`);return k({systemVoiceDemoText:t.text}),t.text}return""},async ttsPrepay(e,t){let r=await P("/v1/audio/speech/prepaid",{app_name:T,app_version:Y,tz_name:Ae,texts:e.texts,voice:e.voice,scene:e.scene,scene_id:e.sceneId},{getAbortMethod:t});return r?.quota&&r?.quota_type&&ct(r.quota_type==="basic"?"gpt-3.5":"gpt-4",r.quota,r.feature_info),r},tts(e,t){return P("/v1/audio/speech",{app_name:T,app_version:Y,tz_name:Ae,input:e.input,voice:e.voice,scene:e.scene,scene_id:e.sceneId,...e.demoLang?{audition_opt:{audition:!0,language_code:e.demoLang}}:null},{returnRawResponse:!0,getAbortMethod:t})},publishArtifact(e){return P("/v1/artifacts_publish",e)},unpublishArtifact(e){return P("/v1/artifacts_unpublish",e)}};async function ed(){let e=await te(`/v1/completion/limit/user?app_name=${T}&app_version=${Y}&tz_name=${Ae}`);if(!e.basic_credit.count)throw k({ERR_MUST_LOGIN:!0}),new Error("wrong_data");let t=e.user_type,r=["device","login","premium"],{vipPeriodInfo:A}=await M({vipPeriodInfo:null});A||(A=await R.getVipPeriodInfo());let i=A.basic_credit_period_info,o=A.advanced_credit_period_info,n=A.ocr_period_info,a=A.feature_total,s=e.feature_used,g={isVIP:e.user_type==="premium",isTrial:e.is_trial,userTypeDetail:e.user_type_detail,resetTimeSec:e.basic_credit.reset_time,showNewPlan:!!e.show_new_plan,"gpt-3.5":{total:e.basic_credit.count,remain:e.basic_credit.remain,extraTotal:e.basic_credit.extra_total,extraRemain:e.basic_credit.extra_quota,used:e.basic_credit.used,period:e.basic_credit.period,maxToken:i[t]?.prompt_max_token,award:r.reduce((I,l)=>(I[l]={count:i[l].count},I),{})},"gpt-4":{total:e.advanced_credit.count,remain:e.advanced_credit.remain,extraTotal:e.advanced_credit.extra_total,extraRemain:e.advanced_credit.extra_quota,used:e.advanced_credit.used,period:e.advanced_credit.period,maxToken:o[t]?.prompt_max_token,award:r.reduce((I,l)=>(I[l]={count:o[l].count},I),{})},trial:{chatFile:{total:a.chat_file,used:s.chat_file,remain:a.chat_file-s.chat_file},painter:{total:a.painter,used:s.painter,remain:a.painter-s.painter},videoSummary:{total:a.video_summary,used:s.video_summary,remain:a.video_summary-s.video_summary},tts:{total:a.tts,used:s.tts,remain:a.tts-s.tts},data_analysis:{total:a.data_analysis,used:s.data_analysis,remain:a.data_analysis-s.data_analysis},artifacts:{total:a.artifacts,used:s.artifacts,remain:a.artifacts-s.artifacts},text_to_image:{total:a.text_to_image,used:s.text_to_image,remain:a.text_to_image-s.text_to_image},search:{total:a.search,used:s.search,remain:a.search-s.search},thinking_mode:{total:a.thinking_mode,used:s.thinking_mode,remain:a.thinking_mode-s.thinking_mode},...a.short_video?{shortVideo:{total:a.short_video,used:s.short_video,remain:a.short_video-s.short_video}}:{}},summary:{total:e.summarize.count,remain:e.summarize.remain,cost:e.summarize.deduct_count,period:e.summarize.period},ocr:{cost:n?.deduct_count||1},"image-creator":{total:e.image.count,remain:e.image.remain,used:e.image.used,extraTotal:e.image.extra_total,extraRemain:e.image.extra_quota,period:e.image.period},reader:{total:e.embedding.count,remain:e.embedding.remain,used:e.embedding.used,period:e.embedding.period,limitSize:e.embedding.size}};if(lt(g),g.isVIP){let{autoTools:I,isDoneAutoToolsAction:l}=await sA.default.storage.local.get(["autoTools","isDoneAutoToolsAction"]);(I===void 0||I&&!I.includes("search"))&&!l&&k({autoTools:yf.filter(c=>!c.isExperimental).map(c=>c.name),isDoneAutoToolsAction:!0})}else{let{autoTools:I}=await sA.default.storage.local.get("autoTools");typeof I<"u"&&k({autoTools:[]})}return g}async function td(e,t){let r=await oA("/v1/completion/email_summary",e,{method:"POST",signal:t}),A=r.quota_type?r.quota_type==="basic"?"gpt-3.5":"gpt-4":"gpt-3.5";return ct(A,r),r}function rd(e,t){return oA("/v1/completion/email_reply",e,{method:"POST",signal:t.signal},{onStream:r=>{if(!r.done){let A=r.data.quota_type?r.data.quota_type==="basic"?"gpt-3.5":"gpt-4":"gpt-3.5";ct(A,r.data)}t.onStream(r)}})}var Ad=[{version:"4.34.0",title:"Gmail Al Reply, Artifacts and Translate Enhancements",logContents:"xxxx",features:[{features:["Al Reply in Gmail: Support translation and Al model selection for better communication"]},{features:["Artifacts: Export flowcharts as images for easy sharing"]},{features:["Translate: Al dictionary for precise translations of words and phrases"]}],videoUrl:"https://sider.ai/whats-new/chrome-extension/Sider-v4_34_0",notifyType:"modal"},{version:"4.33.0",title:"O1 & Video Summary Upgrades",logContents:"xxxx",features:[{features:["OpenAI o1\u2060: Faster than \u2018o1-preview\u2019, excels at complex multi-step tasks with advanced accuracy"]},{features:["Summarize Videos Without Subtitles: Get transcripts and summaries for YouTube videos without subtitles"]},{features:["Web Content Summary: Improved for platforms like Reddit and Twitter "]}],videoUrl:"https://sider.ai/whats-new/chrome-extension/Sider-v4_33_0",notifyType:"modal"},{version:"4.32.0",title:"Support for Audio Files in Chat",logContents:"xxxx",features:[{features:["Audio to Text: Upload MP3, WAV, M4A, or MPGA file to generate transcripts"]},{features:["View & Listen: Read transcripts while listening to the audio"]},{features:["Summarize with Ease: Create quick summaries with one click"]}],videoUrl:"https://sider.ai/whats-new/chrome-extension/Sider-v4_32_0",notifyType:"modal"},{version:"4.31.0",title:"Toolbox, Input Translate, Quicker Copy",logContents:"xxxx",features:[{features:["Toolbox: Quickly access AI tools for images, PDFs, video and more from the navigation bar"]},{features:["Input Translate:  Instantly translate input text using a trigger key for faster communication"]},{features:['Copy Text : "Copy" is now a default option in the context menu for quicker text copying']}],videoUrl:"https://sider.ai/whats-new/chrome-extension/Sider-v4_31_0",notifyType:"modal"},{version:"4.30.0",title:"Enhanced GPT-4O, Page Translation and YouTube Subtitles",logContents:"xxxx",features:[{features:["GPT-4O Update: More natural writing and better file handling with deeper insights"]},{features:["View Translation Only: View translations without original text for a cleaner view"]},{features:["Better YouTube Subtitles: Enjoy improved bilingual subtitle translation quality"]}],videoUrl:"https://sider.ai/whats-new/chrome-extension/Sider-v4_30_0",notifyType:"modal"},{version:"4.29.0",title:"Enhanced Chat Experience",logContents:"xxxx",features:[{features:["Messaging Editing: Edit and resend messages for new answers\u2014no copy-pasting required"]},{features:["Side-by-side Comparison: Mention multiple models in a query and view answers in full-page for easier comparison."]},{features:["Custom Icons: Personalize prompt icons for better organization"]}],videoUrl:"https://sider.ai/whats-new/chrome-extension/Sider-v4_29_0",notifyType:"modal"},{version:"4.28.0",title:"Claude 3.5 Haiku & Enhanced Options",logContents:"xxxx",features:[{features:["Claude 3.5 Haiku: Delivers performance that surpasses Claude 3 Opus, excelling in coding, tool use, and reasoning"]},{features:["Large Font Size: You can now change the message font size"]},{features:["Streamlined UI: A cleaner, more intuitive Options UI for easy personalization"]}],videoUrl:"https://sider.ai/whats-new/chrome-extension/Sider-v4_28_0",notifyType:"modal"},{version:"4.27.0",title:"Improved Context Menu and Artifacts",logContents:"xxxx",features:[{features:["Streamlined Context Menu: Cleaner, more intuitive interface for a smoother experience"]},{features:["Enhanced Translation:  Delivers related word meanings with contextual accuracy"]},{features:["Publish & Share Artifacts: Easily share your Artifacts publicly via direct links"]}],videoUrl:"https://sider.ai/whats-new/chrome-extension/Sider-v4_27_0",notifyType:"modal"},{version:"4.26.0",title:"Gemini models just got smarter and faster!",logContents:"xxxx",features:[{features:["Gemini 1.5 Pro: Supercharged reasoning with enhanced math and visual skills."]},{features:["Gemini 1.5 Flash: 2x faster, 3x lower latency, better at visuals and coding."]},{features:["Gemini 1.5 Flash: 2x faster, 3x lower latency, better at visuals and coding."]}],videoUrl:"https://sider.ai/whats-new/chrome-extension/Sider-v4_26_0",notifyType:"modal"},{version:"4.25.0",title:"Gemini models just got smarter and faster!",logContents:"xxxx",features:[{features:["Gemini 1.5 Pro: Supercharged reasoning with enhanced math and visual skills."]},{features:["Gemini 1.5 Flash: 2x faster, 3x lower latency, better at visuals and coding."]},{features:["Gemini 1.5 Flash: 2x faster, 3x lower latency, better at visuals and coding."]}],videoUrl:"https://sider.ai/whats-new/chrome-extension/Sider-v4_25_0",notifyType:"modal"},{version:"4.24.0",title:"Gemini models just got smarter and faster!",features:[{features:["Gemini 1.5 Pro: Supercharged reasoning with enhanced math and visual skills."]},{features:["Gemini 1.5 Flash: 2x faster, 3x lower latency, better at visuals and coding."]}],notifyType:"modal"},{version:"4.23.0",title:"OpenAI o1-preview & o1-mini are available now!",features:[{features:["Multi-Model Translation: Use multiple models at once for more accurate translations."]},{features:["Versatile Translation Rewrites: Rewrite translations for different scenarios."]},{features:["Bilingual Subtitles: View YouTube subtitles in both languages simultaneously."]}],notifyType:"modal"},{version:"4.20.0",title:"Translation Features Upgrade",features:[{features:["Multi-Model Translation: Use multiple models at once for more accurate translations."]},{features:["Versatile Translation Rewrites: Rewrite translations for different scenarios."]},{features:["Bilingual Subtitles: View YouTube subtitles in both languages simultaneously."]}],videoUrl:"https://sider.ai/whats-new/chrome-extension/Sider-v4_20_0",notifyType:"modal"},{version:"4.19.0",title:"Artifacts: Real-Time Content Preview",features:[{features:["Dedicated Windows: Preview documents, websites or charts in separate windows during chats."]},{features:["Interactive and Editable: Modify content directly using natural language."]}],videoUrl:"https://sider.ai/whats-new/chrome-extension/Sider-v4_19_0",notifyType:"modal"},{version:"4.18.0",title:"Chat Sharing is Now Live!",features:[{features:["Multiple Formats: Share your chat as a link or an image."]},{features:["Flexible Selection: Select and share an entire conversation or just part of it."]},{features:["Easy Control: Revoke shared links anytime."]}],videoUrl:"https://sider.ai/whats-new/chrome-extension/Sider-v4_18_0",notifyType:"modal"},{version:"4.17.0",title:"Introducing Watch Highlights for YouTube",features:[{features:["Video Highlights: AI-generated narration saves you time by quickly highlighting key video points."]},{features:["Natural Narration: Realistic AI voices enhance your viewing experience."]},{features:["Multi-language Support: Easily understand videos across language barriers."]}],videoUrl:"https://sider.ai/whats-new/chrome-extension/Sider-v4_17_0",notifyType:"modal"},{version:"4.16.0",title:"",features:[{features:[""]},{features:[""]},{features:[""]}],videoUrl:"https://sider.ai/whats-new/chrome-extension/Sider-v4_16_0",notifyType:"modal"},{version:"4.13.0",title:"",features:[{features:[""]},{features:[""]},{features:[""]}],videoUrl:"https://sider.ai/whats-new/chrome-extension/Sider-v4_13_0",notifyType:"modal"},{version:"4.12.0",title:"Deep reader to boost your critical reading skills!",features:[{features:["Increased Speed: Get 2x faster responses than GPT-4"]},{features:["Enhanced Vision: Greatly improved image understanding"]},{features:["Enhanced Vision: Greatly improved image understanding"]}],videoUrl:"https://sider.ai/whats-new/chrome-extension/Sider-v4_12_0",notifyType:"modal"},{version:"4.11.0",title:"Deep reader to boost your critical reading skills!",features:[{features:["Increased Speed: Get 2x faster responses than GPT-4"]},{features:["Enhanced Vision: Greatly improved image understanding"]},{features:["Expanded Languages: More languages, better quality, and faster performance"]}],videoUrl:"https://sider.ai/whats-new/chrome-extension/Sider-v4_11_0",notifyType:"modal"},{version:"4.10.0",title:"OpenAI's GPT-4o is now here!",features:[{features:["Increased Speed: Get 2x faster responses than GPT-4"]},{features:["Enhanced Vision: Greatly improved image understanding"]},{features:["Expanded Languages: More languages, better quality, and faster performance"]}],videoUrl:"https://sider.ai/whats-new/chrome-extension/Sider-v4_10_0",notifyType:"modal"},{version:"4.9.0",title:"Llama 3 Now! The next generation of Meta's state-of-the-art open source LLM.",features:[{features:["<b>New Model:</b> Support Llama 3 now"]}],videoUrl:"",notifyType:"modal"},{version:"4.8.0",title:"In-Chat Video Summary, Subtitle Extraction, Claude 3 Haiku! \u{1F680}",features:[{features:["In-Chat Summary: Get key points of YouTube videos with 'Read this page' in the chat window."]},{features:["Easy Subtitle Extraction: Get subtitles with a single click on YouTube for deeper insights."]}],videoUrl:"",notifyType:"modal"},{version:"4.7.0",title:"In-Chat Video Summary, Subtitle Extraction, Claude 3 Haiku! \u{1F680}",features:[{features:["In-Chat Summary: Get key points of YouTube videos with 'Read this page' in the chat window."]},{features:["Easy Subtitle Extraction: Get subtitles with a single click on YouTube for deeper insights."]},{features:["Claude 3 Haiku: Now available to enrich your chat experience."]}],videoUrl:"https://sider.ai/whats-new/chrome-extension/Sider-V4_7",notifyType:"modal"},{version:"4.6.0",features:[{features:['Claude 3 Opus: Claims to have "near-human" abilities and can beat GPT-4.']},{features:["Claude 3 Sonnet: Balances intelligence and speed, ideal for retrieving info or automating sales."]}],videoUrl:"https://sider.ai/whats-new/chrome-extension/Sider-V4_6",notifyType:"modal"},{version:"4.5.0",features:[{features:["Search Agent Widget: Experience the future of search with AI automation"]},{features:["Translate webpage: More reader-friendly translation display styles"]},{features:["Supports automatically restoring the last chat on startup"]}],videoUrl:"https://sider.ai/whats-new/chrome-extension/Sider-V4_5",notifyType:"modal"},{version:"4.4.0",title:"Easy Artistry with Painter Tool & GPT-4 context menu",features:[{features:["New Painter Tool: Create images instantly in chat."]},{features:["Enhanced Context Menu: Use GPT-4 in context menu."]},{features:["Enhanced Context Menu: Use GPT-4 in context menu."]}],videoUrl:"https://sider.ai/whats-new/chrome-extension/Sider-V4_4",notifyType:"modal"},{version:"4.3.0",title:"Maximize Your Experience with Full-Screen Mode!",features:[{features:["Dive into an immersive, full-screen view"]},{features:["Enjoy all sidebar features, now in Full-Screen"]},{features:["Seamlessly toggle between modes for the best of both worlds"]}],videoUrl:"https://sider.ai/whats-new/chrome-extension/Sider-V4_3",notifyType:"modal"},{version:"4.2.0",title:"More Efficient UI & Sidebar GPTs Access (Here is the video tutorial)",features:[{features:["Refreshed Interface: Cleaner and easier to navigate"]},{features:["Collapsible Navigation Bar: Ensures a focused chat experiencewhile keeping essential features within easy reach"]},{features:["Sidebar GPTs Access: For ChatGPT Plus users, direct access toGPTs is now available in the sidebar in web app mode"]}],notifyType:"modal"},{version:"4.1.0",features:[{title:"GPT-4V(ision) Preview! & AI reply for Gmail",features:["Sider Vision is powered by GPT-4V","Better understanding of images","Quickly grasp email intentions","Select from diverse tones and personas","Effortlessly pick reply suggestions"]}],notifyType:"modal"},{version:"4.0.0",features:[{title:"GPT-4 Turbo and Chat web page!",features:["Support GPT-4 Turbo and GPT-3.5 Turbo","Translate whole web page","Chat web page in the Sidebar","Chat PDF in the Sidebar"]}],notifyType:"modal"},{version:"3.6.0",features:[{title:"Translation widget",features:["Customize your translation in a dedicated Translation widget","Improve ChatGPT anwers in Google, Bing, Baidu etc"]}],notifyType:"modal"},{version:"3.5.0",features:[{title:"Sider Vision Became Smarter",features:["GPT-4/Claude 2 + Vision","1-click to answer the same question with different bots"]}],notifyType:"modal"},{version:"3.4.0",features:[{title:"Sider Grammar Widget",features:["Check grammar errors","Fix grammar errors","Improve the writing beyond grammar"]}],notifyType:"modal"},{version:"3.3.0",features:[{title:"Sider Vision \u2014 ChatGPT sidebar with Vision",features:["Extract text from an image","Ask any question about the image","3 ways to send image to Sider Vision<div><ol><li>Take a  screenshot</li><li>Drag & Drop an image to Chat window</li><li>Upload an image</li></ol></div>"]}],notifyType:"modal"},{version:"3.2.0",features:[{title:"New pricing plan with 5x more  GPT-4 queries",features:["Great news! Our updated pricing now gives you even more access to GPT-4 and Claude 2 queries.","If you're already a premium user, you'll be upgraded automatically. Plus, we've got a new 'Unlimited' plan for all you power users!"]}],notifyType:"modal"},{version:"3.1.0",features:[{title:"More bot!",features:["Support Bard now!"]},{title:"OCR: Extract text from any image and send it to ChatGPT",features:["Recognize 10+ major languages of printed materials","Recognize handwritten in English","Recognize math equation in the text"]},{title:"Improve Painter",features:["Replace the whole background","Remove selected area"]}],notifyType:"modal"},{version:"3.0.0",features:[{features:["More Chatbots: Now Supporting Claude-instant, Claude 2, and Bard!"]},{features:["Group Chat: Compare Answers Across Chatbots!"]},{features:["Mention: Tag Chatbots with '@'!"]},{features:["Quick Prompt: Just Type '/' and Go!"]},{features:["Simple Design: Streamlined for Speed!"]}],notifyType:"modal"},{version:"2.9.0",features:[{title:"Enhanced prompt manager for",features:["Reading context menu","Writing context menu"]},{title:"AI image editor",features:["Remove background from any images","Remove text from any images"]}],notifyType:"modal"},{version:"2.8.0",features:["Reading Assistant: Use AI for fast understanding while reading web pages","Writing Assistant: Quickly generate content with AI in the web input box"],notifyType:"modal"},{version:"2.7.0",features:["Draw picture from text","Draw picture from a reference picture"],notifyType:"modal"},{version:"2.6.0",features:["Sider Supports Fixed Sidebar - You can chat between all tabs without overlapping any content (available in Chrome 114 or later)"],notifyType:"modal"},{version:"2.5.0",features:["Youtube Summary! Watch 1 hour of YouTube video in 1 minute","Compare the answers provided by humans and AI on Q&A sites such as Quora, StackOverflow, and Zhihu"],notifyType:"modal"},{version:"2.4.0",features:["Smart web access: Based on your query, the Al will decide if it needs to access the web.","Stability improvement"],notifyType:"modal"},{version:"2.3.0",features:["Support Browsing and Plugins for Plus users!","ChatGPT with internet access for everyone!"],notifyType:"modal"},{version:"2.2.0",features:["Compose any message","Reply email, tweet, comment etc"],notifyType:"modal"},{version:"2.1.0",features:["Shortcut for Quick Lookup","Resize the Quick Lookup window","Bug fixes and other UX improvements"],notifyType:"modal"},{version:"2.0.0",features:["Support GPT-4 for all users!","Invite friends and gain GPT-4 queries for both of you!","Bug fixes and other UX improvements"],notifyType:"modal"},{version:"1.1.0",features:["Full Chat in the new tab!","ChatGPT, Bing, Bard together!","Bug fixes"],notifyType:"modal"},{version:"1.0.13",features:["Continue the chat after asking questions","Switch between GPT-4 and GPT-3.5 for Plus users","Easily access and search chat history"],notifyType:"modal"},{version:"1.0.12",features:["Sync extension settings across computers","Access your prompts from different laptops","Save chats for future use","Share chats via link"],notifyType:"modal"},{version:"1.0.11",features:["Quickly access actions through a pop-up window without opening the sidebar.","Add support for additional languages.","Retain the user's language preference when using the translation feature.","Resolve shortcut conflicts on platforms like GitHub and others."],notifyType:"modal"},{version:"1.0.10",features:["Support 50+ languages now!"],notifyType:"modal"},{version:"1.0.8",features:["Support GPT-4 for Plus users! Check settings page!"],notifyType:"modal"},{version:"1.0.7",features:["Remember prompt used last time","Optimize the position of the chatGPT panel on search pages","Add an option to put the sidebar in-page icon on the left side","Optimize package size","Add dark mode","Support your API url proxy"],notifyType:"modal"},{version:"1.0.6",features:["Improve summarize feature in Youtube page"],notifyType:"modal"},{version:"1.0.5",features:["Remember the location of sidebar in\u2013age icon","Improve shortcuts","Save prompt templates from the sidebar directly"]},{version:"1.0.4",features:["Re-order prompt items in the dropdown list","Archive prompt items you will not use","Support response in 50+ languages"]},{version:"1.0.3",features:["CMD/Ctrl + Enter to do quick \u201CSubmit\u201D","Option to hide panel in the search results page","Support ESC to hide sidebar","Support summarize long article"]},{version:"1.0.2",features:["Add stop button to stop generating response","Change the place of collapse button"]},{version:"1.0.1",features:["Improve summarize feature in Youtube page","Fix some bugs related to copy/paste and print"]}];var id=G(K());var kk=864e5;var c8=kk*30;var bk=6e3;async function Nk(e=!1,t){if(R.setUserStatus({fiveStarRated:!0}),e)We.report("rate_feedback_total"),We.report(`rate_feedback_${t}`);else{let{__five_star_rate_from__:r}=await M({__five_star_rate_from__:""});We.report("rate_total"),We.report(`rate_${r}`)}ae(["__five_star_rate_checking__","__five_star_rate_checking_timer__","__five_star_rate_show_at__","__five_star_rate_show_count__","__five_star_rate_less_show__","__five_star_rate_from__"])}async function od(e){let{__five_star_rate_checking__:t,__five_star_rate_checking_timer__:r,userStatus:A}=await M({__five_star_rate_checking__:!1,__five_star_rate_checking_timer__:0,userStatus:{fiveStarRated:!1}});if(A?.fiveStarRated||!t)return;let i=await id.default.tabs.get(e),o=i.pendingUrl||i.url;if(o)if(vk(o)){r&&clearTimeout(r);let n=setTimeout(()=>{Nk()},bk);k({__five_star_rate_checking_timer__:n})}else r&&clearTimeout(r)}function vk(e){return new RegExp(`^https://.+?/detail/.+?/${Xr}${Ie?"":"/reviews"}`,"g").test(e)}var vi=class e{constructor(t,r,A,i){this.db=null;this.dbName="";this.storeName="";this.dbMapKey="";this.idbMapKey="";if(this.dbMapKey=`${t}_${i||1}`,this.idbMapKey=`${t}_${r}`,e.IDB_MAP[this.idbMapKey])return e.IDB_MAP[this.idbMapKey];e.IDB_MAP[this.idbMapKey]=this,this.dbName=t,this.storeName=r,this.onUpgrade=A.onUpgrade,this.onError=A.onError,this.version=i}static{this.DB_MAP={}}static{this.IDB_MAP={}}async openDB(){let{dbName:t,version:r,onUpgrade:A,onError:i}=this;return e.DB_MAP[this.dbMapKey]?e.DB_MAP[this.dbMapKey]:new Promise((o,n)=>{let a=indexedDB.open(t,r);a.onerror=s=>{n(s)},a.onblocked=s=>{n(s)},a.onupgradeneeded=s=>{A(a.result,s)},a.onsuccess=()=>{let s=a.result;this.db=e.DB_MAP[this.dbMapKey]=s,s.onerror=g=>{i?.(g)},s.onversionchange=()=>{s.close(),this.db=null,delete e.DB_MAP[this.dbMapKey]},o(s)}})}async removeDB(){let t=indexedDB.deleteDatabase(this.dbName);return new Promise((r,A)=>{t.onerror=i=>{A(i)},t.onblocked=i=>{A(i)},t.onsuccess=()=>{r(!0)}})}async transactionAction(t,r){this.db||(this.db=await this.openDB());let A=this.db.transaction(this.storeName,r).objectStore(this.storeName);return new Promise((i,o)=>{let n=t(A);n.onerror=o,n.onsuccess=()=>i(n.result)})}getData(t){return this.transactionAction(r=>r.get(t))}addData(t,r){return this.transactionAction(A=>A.add(t,r),"readwrite")}setData(t,r){return this.transactionAction(A=>A.put(t,r),"readwrite")}deleteData(t){return this.transactionAction(r=>r.delete(t),"readwrite")}clearData(){return this.transactionAction(t=>t.clear(),"readwrite")}};function nd(e){return new vi("CACHE",e,{onUpgrade(t){try{t.createObjectStore("TRANSLATION_CACHE",{keyPath:"key"})}catch{}try{t.createObjectStore("DEMO_TTS_CACHE ",{keyPath:"key"})}catch{}}},2)}function ad(){return nd("TRANSLATION_CACHE")}function sd(){return nd("DEMO_TTS_CACHE ")}var Ia=G(Ce()),ut=G(K());var md=G(Ce()),zk=G(K());async function Wk(e=Fe.English){let t=await le(),r=navigator.userAgentData?.platform||"Unknown";r=r.replace(" ",""),r=r.slice(0,1).toUpperCase()+r.slice(1);let A=xt(z.api,`/v1/app/promotion/promote_config?app_name=${Qi}&app_version=${ce}&language=${e}&device_name=${r}`),i={data:[],resources:{}};try{let o=await bt(),n=await fetch(A,{headers:{Authorization:o.token}}).then(a=>a.json());!("resources"in n)&&"resources"in n.data&&(n=n.data),i.data=n.data.map(a=>({...a})),i.resources=n.resources}catch{}return i}function ga(e,t){return!e||typeof e!="string"?e:e.replace(/{{\s*([^{{}}]+)\s*}}/g,(r,A)=>{if(A.includes(",")){let[i,o,n,a]=A.split(/\s*,\s*/);A=t[i]===o?n:a}return A?t[A]||A:""})}function Ed(e,t){return e&&Object.fromEntries(Object.entries(e).map(([r,A])=>[r,ga(A,t)]))}function Xk(e,t){return t?t.every(r=>e.includes(r)):!0}function Zk(e,t){if(e.payload.depOtherCampFilterCond&&e.payload.depOtherCampFilterCond.showAfter){let r=e.payload.depOtherCampFilterCond.showAfter;if(r.depKey&&(!t||!(r.depKey in t)||Date.now()-t[r.depKey]<r.gapTime))return!0}return!1}function jk(e){return(ut.default.storage.session||ut.default.storage.local).get(e)}async function $k(){let e=ut.default.storage.session||ut.default.storage.local,t=await jk({__promote_config__:{config:{data:[],resources:{}},timeStamp:0,maxAge:3e3},__promote_variants__:{}}),r=Date.now(),{__promote_variants__:A,language:i,isCNUser:o,userInfo:n,vipInfo:a,provider:s}=await M({language:Fe.English,__promote_variants__:{},provider:"siderApi",isCNUser:!1,userInfo:{id:"",avatar:"",nickname:"",email:"",phone:""},vipInfo:{userTypeDetail:"login"}}),g=t.__promote_config__,I=g?.maxAge||3e3,l=g.config;if(!l||r-g?.timeStamp>I){l=await Wk(i);let f=1e3*60*30;try{e.set({__promote_config__:{config:l,timeStamp:r,maxAge:f}})}catch{}}let c=navigator.userAgentData?.platform,u=a?.userTypeDetail||"login",C={lang:i,browser:Ie?"edge":"chrome",__LANG__:i,__BROWSER__:Ie?"edge":"chrome",__PLATFORM__:c,__VERSION__:ce,__IS_CN_USER__:o?"1":"0",__USER_PLAN__:Cf[u],__USER_ID__:n.id,__USER_NAME__:n.nickname,__USER_AVATAR__:n.avatar,__USER_EMAIL__:n.email,__USER_PHONE__:n.phone},m=[c,Ie?"edge_ext":"chrome_ext",u,["device","login"].includes(u)?"free":"paid",u=="device"?"unregistered":"registered",i,s],{__promote_off__:y}=await M({__promote_off__:{}}),h={},F={};for(let f of l.data){let Q=f.activityId||f.slot,p=typeof f.startAt=="number"?f.startAt:Date.parse(f.startAt),N=typeof f.stopAt=="number"?f.stopAt:Date.parse(f.stopAt);p>r||N<r||Xk(m,f.condition)&&(Zk(f,y)||(F[f.key]={startAt:f.startAt,stopAt:f.stopAt},!(y&&f.key in y)&&(h[Q]||(h[Q]=[]),h[Q].push(f))))}let b={...C,...Ed({...l.resources._,...l.resources.en,...l.resources[i]},C)},d={};for(let f of Object.values(h)){if(f.length==0)continue;let Q=f[0].key,p=f[0].persistent,N=A[Q]||t.__promote_variants__[Q];if(!isFinite(N)&&(N=Math.floor(Math.random()*100),p)){let x=p=="session"&&ut.default.storage.session?"session":"local";ut.default.storage[x].set({__promote_variants__:{...x=="session"?t.__promote_variants__:A,[Q]:N}})}let S=f.find(x=>N<=x.allocation);f.length==1&&f[0]?.allocation==null&&(S=f[0]),S&&(S.content=ga(S.content,b),S.style=S.style?ga(S.style,b):"",S.payload=Ed(S.payload,b),d[S.slot]=S)}let w=Object.fromEntries(Object.entries(d).map(([f,Q])=>[f,{key:Q.key,startAt:Q.startAt,stopAt:Q.stopAt}]));return await ut.default.storage.local.set({__promote_schedule__:w}),await ut.default.storage.local.set({__promote_ongoing__:F}),d}var Hi;async function yd(){return Hi||(Hi=$k().finally(()=>{Hi=null}))}function wd(e,t){let r=e.key;r&&M({[r]:null}).then(A=>{let i=A[r]||{},o=e.host,n=e.favicon;try{o=o||new URL(t.url||"").host,n=n||t.tab?.favIconUrl||t.url+"/favicon.ico"}catch{}if(!o||o==="undefined")return;let a=e.enable;return a?delete i[o]:i={...i,[o]:{favicon:n,enable:a,timestamp:Date.now()}},Object.entries(i).forEach(([s,g])=>{(s==="undefined"||g.enable)&&delete i[s]}),k({[r]:i})})}var Xe=G(K());async function Dd({prompt:e,windowId:t}){let A=(await Xe.default.tabs.query({url:"https://chat.openai.com/chat*",windowId:t}))[0];A||(A=await Xe.default.tabs.create({active:!0,url:"https://chat.openai.com",windowId:t}),await new Promise(i=>{let o=(n,a,s)=>{n==A.id&&a.status=="complete"&&(i(),Xe.default.tabs.onUpdated.removeListener(o))};Xe.default.tabs.onUpdated.addListener(o)})),Xe.default.tabs.update(A.id,{active:!0}),Xe.default.tabs.sendMessage(A.id,{type:"automate-send-prompt",prompt:e}),await new Promise(i=>{let o=0,n=(a,s)=>{if(s.tab?.id===A.id)switch(a.type){case"loaded":o+=1,o<2&&Xe.default.tabs.sendMessage(A.id,{type:"automate-send-prompt",prompt:e});return;case"automate-send-prompt-done":Xe.default.runtime.onMessage.removeListener(n),i();return}};Xe.default.runtime.onMessage.addListener(n),setTimeout(i,1e3*60)})}var ip=G(la()),ie=G(K());var Yd=G(la());function uA(e,t,r,A){function i(o){return o instanceof r?o:new r(function(n){n(o)})}return new(r||(r=Promise))(function(o,n){function a(I){try{g(A.next(I))}catch(l){n(l)}}function s(I){try{g(A.throw(I))}catch(l){n(l)}}function g(I){I.done?o(I.value):i(I.value).then(a,s)}g((A=A.apply(e,t||[])).next())})}var j=class{constructor(){this.mutex=Promise.resolve()}lock(){let t=()=>{};return this.mutex=this.mutex.then(()=>new Promise(t)),new Promise(r=>{t=r})}dispatch(t){return uA(this,void 0,void 0,function*(){let r=yield this.lock();try{return yield Promise.resolve(t())}finally{r()}})}},ua;function Ab(){return typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global}var pa=Ab(),fa=(ua=pa.Buffer)!==null&&ua!==void 0?ua:null,ib=pa.TextEncoder?new pa.TextEncoder:null;function Rd(e,t){return(e&15)+(e>>6|e>>3&8)<<4|(t&15)+(t>>6|t>>3&8)}function ob(e,t){let r=t.length>>1;for(let A=0;A<r;A++){let i=A<<1;e[A]=Rd(t.charCodeAt(i),t.charCodeAt(i+1))}}function nb(e,t){if(e.length!==t.length*2)return!1;for(let r=0;r<t.length;r++){let A=r<<1;if(t[r]!==Rd(e.charCodeAt(A),e.charCodeAt(A+1)))return!1}return!0}var Nd=87,vd=48;function Gd(e,t,r){let A=0;for(let i=0;i<r;i++){let o=t[i]>>>4;e[A++]=o>9?o+Nd:o+vd,o=t[i]&15,e[A++]=o>9?o+Nd:o+vd}return String.fromCharCode.apply(null,e)}var Ud=fa!==null?e=>{if(typeof e=="string"){let t=fa.from(e,"utf8");return new Uint8Array(t.buffer,t.byteOffset,t.length)}if(fa.isBuffer(e))return new Uint8Array(e.buffer,e.byteOffset,e.length);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Invalid data type!")}:e=>{if(typeof e=="string")return ib.encode(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Invalid data type!")},Md="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lA=new Uint8Array(256);for(let e=0;e<Md.length;e++)lA[Md.charCodeAt(e)]=e;function ab(e){let t=Math.floor(e.length*.75),r=e.length;return e[r-1]==="="&&(t-=1,e[r-2]==="="&&(t-=1)),t}function sb(e){let t=ab(e),r=e.length,A=new Uint8Array(t),i=0;for(let o=0;o<r;o+=4){let n=lA[e.charCodeAt(o)],a=lA[e.charCodeAt(o+1)],s=lA[e.charCodeAt(o+2)],g=lA[e.charCodeAt(o+3)];A[i]=n<<2|a>>4,i+=1,A[i]=(a&15)<<4|s>>2,i+=1,A[i]=(s&3)<<6|g&63,i+=1}return A}var Ri=16*1024,IA=4,gb=new j,da=new Map;function Ib(e,t){return uA(this,void 0,void 0,function*(){let r=null,A=null,i=!1;if(typeof WebAssembly>"u")throw new Error("WebAssembly is not supported in this environment!");let o=(f,Q=0)=>{A.set(f,Q)},n=()=>A,a=()=>r.exports,s=f=>{r.exports.Hash_SetMemorySize(f);let Q=r.exports.Hash_GetBuffer(),p=r.exports.memory.buffer;A=new Uint8Array(p,Q,f)},g=()=>new DataView(r.exports.memory.buffer).getUint32(r.exports.STATE_SIZE,!0),I=gb.dispatch(()=>uA(this,void 0,void 0,function*(){if(!da.has(e.name)){let Q=sb(e.data),p=WebAssembly.compile(Q);da.set(e.name,p)}let f=yield da.get(e.name);r=yield WebAssembly.instantiate(f,{})})),l=()=>uA(this,void 0,void 0,function*(){r||(yield I);let f=r.exports.Hash_GetBuffer(),Q=r.exports.memory.buffer;A=new Uint8Array(Q,f,Ri)}),c=(f=null)=>{i=!0,r.exports.Hash_Init(f)},u=f=>{let Q=0;for(;Q<f.length;){let p=f.subarray(Q,Q+Ri);Q+=p.length,A.set(p),r.exports.Hash_Update(p.length)}},C=f=>{if(!i)throw new Error("update() called before init()");let Q=Ud(f);u(Q)},m=new Uint8Array(t*2),y=(f,Q=null)=>{if(!i)throw new Error("digest() called before init()");return i=!1,r.exports.Hash_Final(Q),f==="binary"?A.slice(0,t):Gd(m,A,t)},h=()=>{if(!i)throw new Error("save() can only be called after init() and before digest()");let f=r.exports.Hash_GetState(),Q=g(),p=r.exports.memory.buffer,N=new Uint8Array(p,f,Q),S=new Uint8Array(IA+Q);return ob(S,e.hash),S.set(N,IA),S},F=f=>{if(!(f instanceof Uint8Array))throw new Error("load() expects an Uint8Array generated by save()");let Q=r.exports.Hash_GetState(),p=g(),N=IA+p,S=r.exports.memory.buffer;if(f.length!==N)throw new Error(`Bad state length (expected ${N} bytes, got ${f.length})`);if(!nb(e.hash,f.subarray(0,IA)))throw new Error("This state was written by an incompatible hash implementation");let x=f.subarray(IA);new Uint8Array(S,Q,p).set(x),i=!0},b=f=>typeof f=="string"?f.length<Ri/4:f.byteLength<Ri,d=b;switch(e.name){case"argon2":case"scrypt":d=()=>!0;break;case"blake2b":case"blake2s":d=(f,Q)=>Q<=512&&b(f);break;case"blake3":d=(f,Q)=>Q===0&&b(f);break;case"xxhash64":case"xxhash3":case"xxhash128":d=()=>!1;break}let w=(f,Q=null,p=null)=>{if(!d(f,Q))return c(Q),C(f),y("hex",p);let N=Ud(f);return A.set(N),r.exports.Hash_Calculate(N.length,Q,p),Gd(m,A,t)};return yield l(),{getMemory:n,writeMemory:o,getExports:a,setMemorySize:s,init:c,update:C,digest:y,save:h,load:F,calculate:w,hashLength:t}})}function cb(e,t,r){return uA(this,void 0,void 0,function*(){let A=yield e.lock(),i=yield Ib(t,r);return A(),i})}var b8=new j;var N8=new j;var v8=new DataView(new ArrayBuffer(4));var G8=new j;var U8=new j;var M8=new j;var H8=new j;var R8=new j;var q8=new j;var T8=new j;var lb="sha3",ub="AGFzbQEAAAABFARgAAF/YAF/AGACf38AYAN/f38AAwgHAAEBAgEAAwUEAQECAgYOAn8BQZCNBQt/AEGACAsHcAgGbWVtb3J5AgAOSGFzaF9HZXRCdWZmZXIAAAlIYXNoX0luaXQAAQtIYXNoX1VwZGF0ZQACCkhhc2hfRmluYWwABA1IYXNoX0dldFN0YXRlAAUOSGFzaF9DYWxjdWxhdGUABgpTVEFURV9TSVpFAwEKqBwHBQBBgAoL1wMAQQBCADcDgI0BQQBCADcD+IwBQQBCADcD8IwBQQBCADcD6IwBQQBCADcD4IwBQQBCADcD2IwBQQBCADcD0IwBQQBCADcDyIwBQQBCADcDwIwBQQBCADcDuIwBQQBCADcDsIwBQQBCADcDqIwBQQBCADcDoIwBQQBCADcDmIwBQQBCADcDkIwBQQBCADcDiIwBQQBCADcDgIwBQQBCADcD+IsBQQBCADcD8IsBQQBCADcD6IsBQQBCADcD4IsBQQBCADcD2IsBQQBCADcD0IsBQQBCADcDyIsBQQBCADcDwIsBQQBCADcDuIsBQQBCADcDsIsBQQBCADcDqIsBQQBCADcDoIsBQQBCADcDmIsBQQBCADcDkIsBQQBCADcDiIsBQQBCADcDgIsBQQBCADcD+IoBQQBCADcD8IoBQQBCADcD6IoBQQBCADcD4IoBQQBCADcD2IoBQQBCADcD0IoBQQBCADcDyIoBQQBCADcDwIoBQQBCADcDuIoBQQBCADcDsIoBQQBCADcDqIoBQQBCADcDoIoBQQBCADcDmIoBQQBCADcDkIoBQQBCADcDiIoBQQBCADcDgIoBQQBBwAwgAEEBdGtBA3Y2AoyNAUEAQQA2AoiNAQuMAwEIfwJAQQAoAoiNASIBQQBIDQBBACABIABqQQAoAoyNASICcDYCiI0BAkACQCABDQBBgAohAwwBCwJAIAIgAWsiBCAAIAQgAEkbIgNFDQAgA0EDcSEFQQAhBgJAIANBBEkNACABQYCKAWohByADQXxxIQhBACEGA0AgByAGaiIDQcgBaiAGQYAKai0AADoAACADQckBaiAGQYEKai0AADoAACADQcoBaiAGQYIKai0AADoAACADQcsBaiAGQYMKai0AADoAACAIIAZBBGoiBkcNAAsLIAVFDQAgAUHIiwFqIQMDQCADIAZqIAZBgApqLQAAOgAAIAZBAWohBiAFQX9qIgUNAAsLIAQgAEsNAUHIiwEgAhADIAAgBGshACAEQYAKaiEDCwJAIAAgAkkNAANAIAMgAhADIAMgAmohAyAAIAJrIgAgAk8NAAsLIABFDQBBACECQcgBIQYDQCAGQYCKAWogAyAGakG4fmotAAA6AAAgBkEBaiEGIAAgAkEBaiICQf8BcUsNAAsLC+QLAS1+IAApA0AhAkEAKQPAigEhAyAAKQM4IQRBACkDuIoBIQUgACkDMCEGQQApA7CKASEHIAApAyghCEEAKQOoigEhCSAAKQMgIQpBACkDoIoBIQsgACkDGCEMQQApA5iKASENIAApAxAhDkEAKQOQigEhDyAAKQMIIRBBACkDiIoBIREgACkDACESQQApA4CKASETQQApA8iKASEUAkACQCABQcgASw0AQQApA9CKASEVQQApA+CKASEWQQApA9iKASEXDAELQQApA+CKASAAKQNghSEWQQApA9iKASAAKQNYhSEXQQApA9CKASAAKQNQhSEVIBQgACkDSIUhFCABQekASQ0AQQBBACkD6IoBIAApA2iFNwPoigFBAEEAKQPwigEgACkDcIU3A/CKAUEAQQApA/iKASAAKQN4hTcD+IoBQQBBACkDgIsBIAApA4ABhTcDgIsBIAFBiQFJDQBBAEEAKQOIiwEgACkDiAGFNwOIiwELIAMgAoUhGCAFIASFIRkgByAGhSEHIAkgCIUhCCALIAqFIRogDSAMhSEJIA8gDoUhCiARIBCFIQsgEyAShSEMQQApA7iLASESQQApA5CLASETQQApA+iKASEbQQApA6CLASEcQQApA/iKASENQQApA7CLASEdQQApA4iLASEOQQApA8CLASEPQQApA5iLASEeQQApA/CKASEQQQApA6iLASERQQApA4CLASEfQcB+IQADQCAaIAcgC4UgF4UgH4UgEYVCAYmFIBSFIBCFIB6FIA+FIQIgDCAZIAqFIBaFIA6FIB2FQgGJhSAIhSAVhSANhSAchSIDIAeFISAgCSAIIAyFIBWFIA2FIByFQgGJhSAYhSAbhSAThSAShSIEIA+FISEgGCAKIBQgGoUgEIUgHoUgD4VCAYmFIBmFIBaFIA6FIB2FIgWFQjeJIiIgCyAYIAmFIBuFIBOFIBKFQgGJhSAHhSAXhSAfhSARhSIGIAqFQj6JIiNCf4WDIAMgEYVCAokiJIUhDyANIAKFQimJIiUgBCAQhUIniSImQn+FgyAihSERIBIgBYVCOIkiEiAGIA6FQg+JIidCf4WDIAMgF4VCCokiKIUhDiAEIBqFQhuJIikgKCAIIAKFQiSJIipCf4WDhSENIAYgGYVCBokiKyADIAuFQgGJIixCf4WDIBwgAoVCEokiLYUhECArIAQgHoVCCIkiLiAbIAWFQhmJIhtCf4WDhSEXIAYgHYVCPYkiGSAEIBSFQhSJIgQgCSAFhUIciSIIQn+Fg4UhFCAIIBlCf4WDIAMgH4VCLYkiA4UhGCAZIANCf4WDIBUgAoVCA4kiCYUhGSAEIAMgCUJ/hYOFIQcgCSAEQn+FgyAIhSEIIAwgAoUiAiAhQg6JIgNCf4WDIBMgBYVCFYkiBIUhCSAGIBaFQiuJIgUgAyAEQn+Fg4UhCiAEIAVCf4WDICBCLIkiBIUhCyAAQdAJaikDACAFIARCf4WDhSAChSEMICcgKEJ/hYMgKoUiBSEfIAMgBCACQn+Fg4UiAiEaICogKUJ/hYMgEoUiAyEeIC0gLkJ/hYMgG4UiBCEWICYgJCAlQn+Fg4UiBiEdIBsgK0J/hYMgLIUiKCEVICMgJiAiQn+Fg4UiIiEcIC4gLCAtQn+Fg4UiJiEbICcgKSASQn+Fg4UiJyETICMgJEJ/hYMgJYUiIyESIABBCGoiAA0AC0EAIBE3A6iLAUEAIAU3A4CLAUEAIBc3A9iKAUEAIAc3A7CKAUEAIAs3A4iKAUEAIA83A8CLAUEAIAM3A5iLAUEAIBA3A/CKAUEAIBQ3A8iKAUEAIAI3A6CKAUEAIAY3A7CLAUEAIA43A4iLAUEAIAQ3A+CKAUEAIBk3A7iKAUEAIAo3A5CKAUEAICI3A6CLAUEAIA03A/iKAUEAICg3A9CKAUEAIAg3A6iKAUEAIAw3A4CKAUEAICM3A7iLAUEAICc3A5CLAUEAICY3A+iKAUEAIBg3A8CKAUEAIAk3A5iKAQv4AgEFf0HkAEEAKAKMjQEiAUEBdmshAgJAQQAoAoiNASIDQQBIDQAgASEEAkAgASADRg0AIANByIsBaiEFQQAhAwNAIAUgA2pBADoAACADQQFqIgMgAUEAKAKIjQEiBGtJDQALCyAEQciLAWoiAyADLQAAIAByOgAAIAFBx4sBaiIDIAMtAABBgAFyOgAAQciLASABEANBAEGAgICAeDYCiI0BCwJAIAJBBEkNACACQQJ2IgNBA3EhBUEAIQQCQCADQX9qQQNJDQAgA0H8////A3EhAUEAIQNBACEEA0AgA0GACmogA0GAigFqKAIANgIAIANBhApqIANBhIoBaigCADYCACADQYgKaiADQYiKAWooAgA2AgAgA0GMCmogA0GMigFqKAIANgIAIANBEGohAyABIARBBGoiBEcNAAsLIAVFDQAgBUECdCEBIARBAnQhAwNAIANBgApqIANBgIoBaigCADYCACADQQRqIQMgAUF8aiIBDQALCwsGAEGAigEL0QYBA39BAEIANwOAjQFBAEIANwP4jAFBAEIANwPwjAFBAEIANwPojAFBAEIANwPgjAFBAEIANwPYjAFBAEIANwPQjAFBAEIANwPIjAFBAEIANwPAjAFBAEIANwO4jAFBAEIANwOwjAFBAEIANwOojAFBAEIANwOgjAFBAEIANwOYjAFBAEIANwOQjAFBAEIANwOIjAFBAEIANwOAjAFBAEIANwP4iwFBAEIANwPwiwFBAEIANwPoiwFBAEIANwPgiwFBAEIANwPYiwFBAEIANwPQiwFBAEIANwPIiwFBAEIANwPAiwFBAEIANwO4iwFBAEIANwOwiwFBAEIANwOoiwFBAEIANwOgiwFBAEIANwOYiwFBAEIANwOQiwFBAEIANwOIiwFBAEIANwOAiwFBAEIANwP4igFBAEIANwPwigFBAEIANwPoigFBAEIANwPgigFBAEIANwPYigFBAEIANwPQigFBAEIANwPIigFBAEIANwPAigFBAEIANwO4igFBAEIANwOwigFBAEIANwOoigFBAEIANwOgigFBAEIANwOYigFBAEIANwOQigFBAEIANwOIigFBAEIANwOAigFBAEHADCABQQF0a0EDdjYCjI0BQQBBADYCiI0BIAAQAkHkAEEAKAKMjQEiAEEBdmshAwJAQQAoAoiNASIBQQBIDQAgACEEAkAgACABRg0AIAFByIsBaiEFQQAhAQNAIAUgAWpBADoAACABQQFqIgEgAEEAKAKIjQEiBGtJDQALCyAEQciLAWoiASABLQAAIAJyOgAAIABBx4sBaiIBIAEtAABBgAFyOgAAQciLASAAEANBAEGAgICAeDYCiI0BCwJAIANBBEkNACADQQJ2IgFBA3EhBUEAIQQCQCABQX9qQQNJDQAgAUH8////A3EhAEEAIQFBACEEA0AgAUGACmogAUGAigFqKAIANgIAIAFBhApqIAFBhIoBaigCADYCACABQYgKaiABQYiKAWooAgA2AgAgAUGMCmogAUGMigFqKAIANgIAIAFBEGohASAAIARBBGoiBEcNAAsLIAVFDQAgBUECdCEAIARBAnQhAQNAIAFBgApqIAFBgIoBaigCADYCACABQQRqIQEgAEF8aiIADQALCwsL2AEBAEGACAvQAZABAAAAAAAAAAAAAAAAAAABAAAAAAAAAIKAAAAAAAAAioAAAAAAAIAAgACAAAAAgIuAAAAAAAAAAQAAgAAAAACBgACAAAAAgAmAAAAAAACAigAAAAAAAACIAAAAAAAAAAmAAIAAAAAACgAAgAAAAACLgACAAAAAAIsAAAAAAACAiYAAAAAAAIADgAAAAAAAgAKAAAAAAACAgAAAAAAAAIAKgAAAAAAAAAoAAIAAAACAgYAAgAAAAICAgAAAAAAAgAEAAIAAAAAACIAAgAAAAIA=",fb="f2f6f5b2",db={name:lb,data:ub,hash:fb},pb=new j,cA=null;function Hd(e){return[224,256,384,512].includes(e)?null:new Error("Invalid variant! Valid values: 224, 256, 384, 512")}function qd(e,t=512){if(Hd(t))return Promise.reject(Hd(t));let r=t/8;if(cA===null||cA.hashLength!==r)return cb(pb,db,r).then(A=>(cA=A,cA.calculate(e,t,6)));try{let A=cA.calculate(e,t,6);return Promise.resolve(A)}catch(A){return Promise.reject(A)}}var _8=new j;var P8=new j;var O8=new j;var J8=new j;var K8=new j;var L8=new j;var Y8=new j;var V8=new ArrayBuffer(8);var z8=new j;var W8=new ArrayBuffer(8);var X8=new j;var Z8=new ArrayBuffer(8);var j8=new j;var $8=new j;var e1=new j;var Nt=G(K());var Td=["text/x-java","text/javascript","text/html","text/x-c++","application/msword","text/x-csharp","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/pdf","text/x-script.python","text/x-c","text/x-tex","application/json","text/markdown","application/vnd.openxmlformats-officedocument.presentationml.presentation","text/x-ruby","text/x-sh","text/x-php","application/x-latext","text/x-typescript","text/plain"];var qi=class{constructor(){this.results=[];this.isBrowsing=!1}parseMessage(t){let r=t.message,A=this.results.findIndex(i=>i.id===r?.id);return r&&(r.author.role==="assistant"?r.recipient!=="bio"&&this.handleAssistantMessage(r,A):r.author.role==="tool"&&(r.author.name==="browser"||r.author.name==="myfiles_browser"?this.handleBrowserMessage(r):this.handlePluginResponseMessage(r))),this.results}handleAssistantMessage(t,r){if(t.recipient!=="all")if(t.recipient!=="browser"&&t.recipient!=="myfiles_browser")if(r===-1){let A=this.results[this.results.length-1];if(A&&A.type==="browsing"){let i=A;i.isLoading=!1,i.actions.push({messageId:"1",command:"finishBrowsing"}),this.isBrowsing=!1}this.results.push({id:t?.id,type:"plugin",pluginName:t?.recipient,isLoading:!0,info:[{type:"request",text:t?.content?.parts?.[0]||t?.content?.text}]})}else{let A=this.results[r];A.info[0].text=t?.content?.parts?.[0]||t?.content?.text}else this.isBrowsing||(this.results.push({id:t?.id,type:"browsing",subType:t?.recipient==="myfiles_browser"?"myfiles":"web",isLoading:!0,actions:[{messageId:"0",command:"startBrowsing",model_slug:t.metadata?.model_slug||""}]}),this.isBrowsing=!0);else if(r===-1)this.handleNewTextMessage(t);else{let A=this.results[r],i=this.getTextWithCitations(t);A.text=i.text,A.searchSnippets=i.searchSnippets}}handleBrowserMessage(t){if(this.isBrowsing){let r=this.results[this.results.length-1];if(r.type==="browsing"){let A=r,i=t.metadata;(A.actions.length===0||i.command!==A.actions[A.actions.length-1].command||A.actions[A.actions.length-1].messageId!==t?.id)&&(i.command!=="quote_lines"||A.actions[A.actions.length-1].command!=="quote_lines")?(i.command==="search"||i.command==="click"||i.command==="quote_lines"&&A.subType==="web")&&A.actions.push({messageId:t?.id,command:i.command,model_slug:i.model_slug,status:i.status,args:i.args,_cite_metadata:i.command==="click"?this.getClickMetadata(i._cite_metadata):{}}):(A.actions[A.actions.length-1].status=i.status,(i.command==="click"||i.command==="quote_lines")&&(A.actions[A.actions.length-1]._cite_metadata=this.getClickMetadata(i._cite_metadata)))}}}handlePluginResponseMessage(t){let r=this.results[this.results.length-1];r&&(r.isLoading=!1);let A=null;if(t?.author?.name==="python"?A=JSON.stringify(t.content):t?.author?.name==="dalle.text2im"?typeof t?.content?.parts?.[0]!="string"&&(A=t?.content?.text):A=t?.content?.parts?.[0],A&&r&&r.info.push({type:"response",text:A}),t?.author?.name==="dalle.text2im"){let i=t?.content?.parts?.[0];typeof i=="object"&&i.asset_pointer&&this.results.push({id:i.asset_pointer.replace("file-service://",""),type:"image",gen_id:i?.metadata?.dalle?.gen_id,prompt:i?.metadata?.dalle?.prompt})}else t?.metadata?.jit_plugin_data?.from_server.type==="confirm_action"&&this.results.push({id:t?.id,type:"pluginConfirm",metadata:t?.metadata?.jit_plugin_data?.from_server.body})}handleNewTextMessage(t){if(this.results.length>0){let r=this.results[this.results.length-1];if(r.type==="browsing"){let A=r;A.isLoading=!1,A.actions.push({messageId:"1",command:"finishBrowsing"}),this.isBrowsing=!1}}t?.content?.parts?.[0]&&this.results.push({id:t?.id,type:"text",text:t?.content?.parts?.[0]})}getClickMetadata(t){return{metadata_list:[{url:t?.metadata_list?.[0]?.url,title:t?.metadata_list?.[0]?.title}]}}getTextWithCitations(t){let r=t?.content?.parts?.[0],A=t?.metadata?.citations,i={};if(A&&A.length>0){let o=r,n=A.length;return A.sort((a,s)=>s.end_ix-a.end_ix).forEach((a,s)=>{let g=a.start_ix,I=a.end_ix,l=a.metadata?.url;l?(o=o.slice(0,g)+`[^${n-s}](${l})`+o.slice(I),i[n-s]={link:l,title:a.metadata.title,snippet:a.metadata.text}):o=o.slice(0,g)+o.slice(I)}),{text:o,searchSnippets:i}}else return{text:r}}};async function Fr(e,t,r=!1,A=!1){let{onMessage:i,...o}=t,a=await(r?Sr:fetch)(e,o).catch(g=>{throw wr(g,e),g});if(!a.ok){let g=await a.json().catch(()=>({}));throw new Error(Yr(g)?`${a.status} ${a.statusText}`:JSON.stringify({...g,responseStatus:a.status}))}let s=mr(g=>{g.type==="event"&&i(g.data)});for await(let g of Er(a.body)){let I=new TextDecoder().decode(g);if(A)try{if(JSON.parse(I).wss_url){i(I);return}}catch{}s.feed(I)}}var _d=G(K());async function Bb(e,t){return _d.default.runtime.sendMessage({type:"getArkoseToken",target:"offscreen",userType:e,dx:t})}async function Pd(e,t){return Bb(e,t)}var He="ChatGPT Webapp",Qa=`${He}: error_chatgpt_auth`,Pi="https://chatgpt.com",Ba="accessToken",Ca=new Yd.default(10*1e3);async function Qe(e,t,r,A){let i={"Content-Type":"application/json"};e&&(i.Authorization=`Bearer ${e}`),i={...i,...await rp()};let o={method:t,headers:i};return A&&(o.body=JSON.stringify(A)),Sr(`${Pi}/backend-api${r}`,o)}async function Vd(e,t){await Qe(e,"POST","/conversation/message_feedback",t)}async function Od(e,t,r){return!0}async function zd(e){let t=await ue({isForce:!0});return Qe(t,"GET","/models",null).then(r=>r.json())}async function Wd(e){let t=await ue({isForce:!0});return Qe(t,"GET","/gizmos/bootstrap?limit=2",null).then(r=>r.json()).catch(r=>({gizmos:[]}))}async function Jd(e,t){let r=await ue({isForce:!0});return Qe(r,"POST","/conversation/gen_title/"+e,{message_id:t}).then(A=>A.json())}function Cb(){return[navigator.hardwareConcurrency+1920+1080,new Date().toString(),4294705152,0,navigator.userAgent,"","",navigator.language,navigator.languages.join(","),0]}async function Xd(e,t){let r=performance.now(),A=Cb();for(let i=0;i<5e5;i++){A[3]=i,A[9]=Math.round(performance.now()-r);let o=JSON.stringify(A),n=btoa(String.fromCharCode(...new TextEncoder().encode(o)));if((await qd(e+n,512)).slice(0,t.length)<=t)return n}return"wQ8Lk5FbGpA2NcR9dShT6gYjU7VxZ4D"+btoa(String.fromCharCode(...new TextEncoder().encode(JSON.stringify(e+""))))}async function Qb(e,t){return"gAAAAAB"+await Xd(e,t)}async function hb(){return"gAAAAAC"+await Xd(Math.random()+"","0")}async function Zd(e,t){let r=await ue({isForce:!0});return Qe(r,"POST","/files",{file_name:e.name,file_size:e.size,use_case:t?"my_files":"multimodal"}).then(A=>A.json())}async function jd(e){let t=await ue({});return Qe(t,"POST","/files/"+e+"/uploaded",{}).then(r=>r.json())}async function ha(e){let t=await ue({isForce:!0});return Qe(t,"GET","/files/"+e+"/download",null).then(r=>r.json())}async function mb(){let e=await ue({});return Qe(e,"GET","/accounts/check/v4-2023-04-27",null).then(t=>t.json())}async function Eb(){let e=await ue({});return Qe(e,"POST","/sentinel/chat-requirements",{p:await hb()}).then(t=>t.json())}async function Kd(){let e=await ue({});return Qe(e,"POST","/register-websocket",null).then(t=>t.json()).then(t=>t.wss_url)}async function $d({conversationId:e,messageId:t,sandboxPath:r}){let A=await ue({isForce:!0});return Qe(A,"GET","/conversation/"+e+"/interpreter/download?message_id="+t+"&sandbox_path="+r.replace("sandbox:",""),null).then(i=>i.json())}async function ep(e){e||(e=await ue());let t=`${Pi}/backend-api/aip/p?offset=0&limit=250&is_installed=true`;return await(await Sr(t,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`}})).json()}async function ma(){if(Ca.get(Ba))return Ca.get(Ba);let e=null;try{e=await fetch(at.openaiApiSession)}catch(A){throw new Error(`${He}: ${A.message}`)}let t=Qa;if(e?.status===403)throw new Error(t);let r=await e?.json().catch(()=>({}));if(!r.accessToken)throw new Error(t);return Ca.set(Ba,r.accessToken),r.accessToken}async function tp(e){let t=await ue();return Qe(t,"POST",`/gizmos/${e}/sidebar`,{action:"keep"})}async function rp(){let e="Oai-",t={};return t[e+"Device-Id"]=await yb(),t[e+"Language"]="en-US",t}async function yb(){return(await chrome.cookies.get({url:Pi,name:"oai-did"}))?.value||ee()}async function wb(e){try{return(await Nt.default.storage.local.get({selectWebAppModel:"gpt-4"})).selectWebAppModel}catch{return null}}async function Ap(e){let t="";return t||(t=await ue()),new Promise((r,A)=>{let i=setInterval(async()=>{let n=await(await Qe(t,"GET","/files/"+e,null)).json();n.retrieval_index_status==="success"&&(clearInterval(i),r(n))},1e3)})}function Ld(e){return e.map(t=>{let r={name:t.name,size:t.size,mimeType:t.type,id:t.id};return t.type.startsWith("image")?(r.width=t.width,r.height=t.height):Td.includes(t.type)&&(r.fileTokenSize=t.fileTokenSize),r})}var ft={};function Db(e){let t=Ea(e);if(ft[t])return ft[t];{let r=new WebSocket(e);return ft[t]=r,r}}function Fb(e){let t=Ea(e);if(ft[t]&&ft[t].readyState===WebSocket.OPEN)return{ws:ft[t],isNew:!1};{let r=new WebSocket(e);return ft[t]=r,{ws:r,isNew:!0}}}function Ea(e){return e.split("?")[0]}function Ti(e){let t=Ea(e);ft[t]&&delete ft[t]}async function Sb(e){let t=await Nt.default.storage.local.get("chatRequirements");return Eb().then(r=>(Nt.default.storage.local.set({chatRequirements:{data:r,expireTime:Date.now()+9*60*1e3,token:e}}),r))}var _i=class{constructor(t){this.token=t;this.token=t}async generateAnswer(t){let r,A,i,o=Promise.resolve(),n=!1,a=await Sb(this.token);async function s(){if(u.filter(E=>E.type==="image").length>0){let E=u.filter(v=>v.type==="image").map(async v=>{let H=await ha(v.id);if(H.download_url)return fetch(H.download_url).then(q=>q.blob()).then(async q=>{let L=await It(q);return k({[Qf+v.id]:L})})});await Promise.all(E)}}let g=async()=>{try{await o}catch(E){throw r&&(await s(),await Od(this.token,r,{is_visible:!1}),A&&r&&await Jd(r,A),r="",A=""),new Error(`${He}: ${E}`)}i&&(i.onmessage=()=>{},i.onerror=()=>{},i.onclose=()=>{}),r&&(await s(),await Od(this.token,r,{is_visible:!1}),A&&r&&await Jd(r,A),r="",A="")};t.getCleanupMethod?.(g);function I(E,v){let H=v&&v.some(q=>q.type.startsWith("image"));return{content_type:H?"multimodal_text":"text",parts:H?v?.filter(q=>q.type.startsWith("image")).map(q=>({asset_pointer:"file-service://"+q.id,size_bytes:q.size,width:q.width,height:q.height})).concat([E]):[E]}}let l=Array.isArray(t.prompt)?t.prompt.map((E,v)=>({id:ee(),recipient:t.actionData?"all":void 0,author:t.actionData?t.actionData.author:{role:E.role},content:v===t.prompt.length-1?I(E.content,t.chatgptFiles):{content_type:"text",parts:[E.content]},metadata:t.actionData?t.actionData.metaData:v===t.prompt.length-1&&t.chatgptFiles&&t.chatgptFiles.length>0?{attachments:Ld(t.chatgptFiles)}:void 0})):[{id:ee(),recipient:t.actionData?"all":void 0,author:t.actionData?t.actionData.author:{role:"user"},content:I(t.prompt,t.chatgptFiles),metadata:t.actionData?t.actionData.metaData:t.chatgptFiles?{attachments:Ld(t.chatgptFiles)}:void 0}],c=()=>{c=null,t.onEvent({type:"done"}),g()},u=[],C=new qi,m=t.model||await wb(this.token)||"text-davinci-002-render-sha",{needArkoseToken:y}=await Nt.default.storage.local.get("needArkoseToken");function h(E){if(E.error&&Nt.default.storage.local.set({needArkoseToken:!0}),!E.message?.content?.parts?.[0]&&!E.message?.content?.text&&E.message?.author.role!=="assistant"&&!E.message?.metadata?.command&&!E.message?.metadata?.jit_plugin_data||E.message?.author.role==="system"||E.message?.author.role==="user"||E.message?.content?.content_type==="text"&&E.message?.author.name===null&&E.message?.status==="finished_successfully"&&!E.message?.end_turn&&!E.message_id)return;u=C.parseMessage(E);let v=E.message?.content?.parts?.[0];(v||u.length>0)&&(r=E.conversation_id,t.onEvent({type:"answer",data:{message:E.message,contents:u,text:v,messageId:E.message.id,conversationId:E.conversation_id}}),t.parentMsgId||(A=E.message.id))}function F(E){try{let v=JSON.parse(E);return v.wss_url?v.wss_url:!1}catch{return!1}}async function b(E){return E||(E=await Kd()),d(E)}function d(E){return new Promise((v,H)=>{let q=Fb(E);i=q.ws,i.onopen=()=>{q.isNew&&setTimeout(()=>{v(!0)},500)},i.onclose=()=>{throw Ti(E),t.onEvent({type:"error",data:{error:`${He}: Websoket error: close`}}),new Error("Websoket error: close")},i.onerror=L=>{throw Ti(E),t.onEvent({type:"error",data:{error:`${He}: Websoket error: ${L}`}}),new Error("Websoket error: "+L)},i.onmessage=L=>{let pe=JSON.parse(L.data),se=atob(pe.body).trim();if(!se.startsWith("data: "))return;let Gt=se.replace("data: ",""),Ur;if(Gt==="[DONE]"){c?.();return}try{Ur=JSON.parse(Gt)}catch{return}h(Ur)},q.isNew||v(!0)})}function w(E){i=Db(E),i.onopen=()=>{},i.onclose=()=>{throw Ti(E),t.onEvent({type:"error",data:{error:`${He}: Websoket error: close`}}),new Error("Websoket error: close")},i.onerror=v=>{throw Ti(E),t.onEvent({type:"error",data:{error:`${He}: Websoket error: ${v}`}}),new Error("Websoket error: "+v)},i.onmessage=v=>{let H=JSON.parse(v.data),q=atob(H.body).trim();if(!q.startsWith("data: "))return;let L=q.replace("data: ",""),pe;if(L==="[DONE]"){c?.();return}try{pe=JSON.parse(L)}catch{return}h(pe)}}try{t.parentMsgId||(m==="gpt-4-gizmo:g-BlafpMvzd"?We.report("browser_pro_new_chat"):m==="gpt-4-gizmo:g-nleealfRT"&&We.report("shoppingGPT_new_chat"))}catch{}let Q=(await Nt.default.storage.local.get("webAppNetwork")).webAppNetwork,p="";if(!Q){let E=await mb(),v=E.accounts[E.account_ordering[0]].features.includes("shared_websocket")?"websocket":"http";v==="websocket"&&(p=await Kd()),Q={method:v,wss_url:p},Nt.default.storage.local.set({webAppNetwork:Q})}Q.method==="websocket"&&await b(Q.wss_url);let N=null;if(chrome.offscreen&&a.arkose?.required)try{N=await Pd(a.persona,a.arkose?.dx)}catch(E){throw new Error(E)}let S=()=>{let E={};return this.token&&(E.Authorization=`Bearer ${this.token}`),E};async function x(){let E="OpenAI-Sentinel-",v={};if(a.token&&(v[`${E}Chat-Requirements-Token`]=a.token),N&&(v[`${E}Arkose-Token`]=N),a.proofofwork?.required){let{seed:H,difficulty:q}=a.proofofwork;v[`${E}Proof-Token`]=await Qb(H,q)}return v}let U={"Content-Type":"application/json",...S(),...await x(),...await rp()};o=Fr(Pi+"/backend-api/conversation",{method:"POST",signal:t.signal,headers:U,body:JSON.stringify({action:"next",conversation_mode:m.startsWith("gpt-4-gizmo:")?{gizmo_id:m.replace("gpt-4-gizmo:",""),kind:"gizmo_interaction"}:{kind:"primary_assistant"},force_paragen:!1,force_nulligen:this.token?void 0:!1,force_rate_limit:!1,force_paragen_model_slug:"",history_and_training_disabled:!1,messages:l,model:m.startsWith("gpt-4-gizmo:")?"gpt-4-gizmo":m,parent_message_id:t.parentMsgId||ee(),plugin_ids:t.pluginIds,timezone_offset_min:new Date().getTimezoneOffset(),arkose_token:N||void 0,conversation_id:t.cid?t.cid:void 0,suggestions:[],websocket_request_id:ee()}),onMessage(E){if(E==="[DONE]"){c?.();return}else if(F(E))n=!0,w(F(E));else if(E.startsWith("event: typing"))return;let v;try{v=JSON.parse(E)}catch{return}h(v)}},!0,!0).catch(E=>{let v=E.message;try{let H=JSON.parse(v);v=H.message||H.msg||H.error?.message||H.detail?.message||H.detail||v}catch{}throw t.onEvent({type:"error",data:{error:`${He}: ${v}`}}),new Error(`${He}: ${v}`)}).finally(()=>{n||c?.()})}};var vt=0,Oi=!1,xr=new ip.default(1e3*30),ya="accessToken",op="noCacheToken",xb="alwaysProxyFetch";ie.default.storage.local.get({guardChatgptTabId:0}).then(({guardChatgptTabId:e})=>{vt==0&&(vt=e),Oi=e!=0});async function np(){let e=null;try{e=await ie.default.tabs.get(vt),await ie.default.tabs.update(e.id,{active:!0})}catch{}e||(e=await ie.default.tabs.create({url:at.openaiChat,pinned:!0,active:!0}));let t=e.id;await ie.default.storage.local.set({guardChatgptTabId:t}),vt=t,Oi=!0,await new Promise(r=>{let A=(i,o)=>{switch(i.type){case"loaded":o.tab?.id==t&&ie.default.tabs.sendMessage(t,{type:"guard-session-activate"});break;case"guard-session-activated":ie.default.runtime.onMessage.removeListener(A),r();break}};ie.default.runtime.onMessage.addListener(A),setTimeout(()=>r(),1e3*40)})}async function kb(){let e=await ie.default.tabs.create({url:at.openaiChat,pinned:!0,active:!1});return await ie.default.storage.local.set({guardChatgptTabId:e.id}),vt=e.id,Oi=!0,e}async function bb(){let t=await ie.default.tabs.query({pinned:!0,url:"https://chatgpt.com/*"});if(t.length>0){let r=t[0];return vt=r.id,await ie.default.tabs.reload(r.id),r}return null}async function Nb(){let e=null;try{e=await ie.default.tabs.get(vt),/chat\.openai\.com/.test(e.url||"")?await ie.default.tabs.reload(e.id):e=await ie.default.tabs.update(e.id,{url:at.openaiChat})}catch{}e||(e=await bb()),e||(e=await kb());let t=e?.id||0;await new Promise(r=>{let A=(i,o)=>{switch(i.type){case"loaded":o.tab?.id==t&&ie.default.tabs.sendMessage(t,{type:"guard-session-activate"});break;case"guard-session-activated":ie.default.runtime.onMessage.removeListener(A),r();break;case"guard-session-logout":throw Error("")}};ie.default.runtime.onMessage.addListener(A),setTimeout(()=>r(),1e3*40)})}async function ue({onRefresh:e,throwGuideError:t,isForce:r}={}){if(!r&&xr.get(op)!==!0&&xr.get(ya))return xr.get(ya);let i=await(await Sr(at.openaiApiSession,{},{onRefresh:e,throwGuideError:t})).json().catch(()=>({}));return xr.set(ya,i.accessToken),i.accessToken}async function vb(e,t,r){let A=ie.default.tabs.connect(e,{name:"guard-proxy"}),i=null,o=null,n=new Promise((u,C)=>{i=u,o=C}),a;A.onDisconnect.addListener(()=>{o(new Error("proxy fetch aborted")),a?.close()}),r?.signal?.addEventListener("abort",()=>{a?.close(),A.disconnect()});let s={type:"guard-proxy-request",key:Date.now()+"",url:t,options:r};A.postMessage(s);let g=new ReadableStream({start(u){a=u},cancel(){A.disconnect()}}),I=setTimeout(()=>o(new Error("connect timeout")),1e3*1),l=u=>{switch(u.type){case"guard-proxy-request-received":clearTimeout(I);break;case"guard-proxy-response":i(new Response(g,u.options));break;case"guard-proxy-response-chunk":a.enqueue(new TextEncoder().encode(u.value)),u.done&&(a.close(),A.onMessage.removeListener(l),A.disconnect());break;case"guard-proxy-response-error":A.onMessage.removeListener(l),A.disconnect(),o(new Error(u.error)),a.close();break}};return A.onMessage.addListener(l),await n}async function Sr(e,t,r){let A=null;try{A=await fetch(e,t)}catch{}if(!A)throw new Error(Qa);if(A.status===401)throw new Error("");if(A.status==403){if(xr.set(op,!0),xr.set(xb,!0),!Oi&&r?.throwGuideError)throw Error(`${He}: error_chatgpt_session_timeout`);r?.onRefresh?.(),await Nb(),A=await vb(vt,e,t)}return A}var fA=G(K());function ap(){Gb("NEW","#F00","#FFF")}function Gb(e,t,r){fA.default.action.setBadgeBackgroundColor({color:t}),fA.default.action.setBadgeText({text:e}),r&&fA.default.action.setBadgeTextColor({color:r})}function wa(){return fA.default.action.setBadgeText({text:""})}var Ub={type:"logger",log(e){this.output("log",e)},warn(e){this.output("warn",e)},error(e){this.output("error",e)},output(e,t){console&&console[e]}},Fa=class e{constructor(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.init(t,r)}init(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.prefix=r.prefix||"i18next:",this.logger=t||Ub,this.options=r,this.debug=r.debug}log(){for(var t=arguments.length,r=new Array(t),A=0;A<t;A++)r[A]=arguments[A];return this.forward(r,"log","",!0)}warn(){for(var t=arguments.length,r=new Array(t),A=0;A<t;A++)r[A]=arguments[A];return this.forward(r,"warn","",!0)}error(){for(var t=arguments.length,r=new Array(t),A=0;A<t;A++)r[A]=arguments[A];return this.forward(r,"error","")}deprecate(){for(var t=arguments.length,r=new Array(t),A=0;A<t;A++)r[A]=arguments[A];return this.forward(r,"warn","WARNING DEPRECATED: ",!0)}forward(t,r,A,i){return i&&!this.debug?null:(typeof t[0]=="string"&&(t[0]=`${A}${this.prefix} ${t[0]}`),this.logger[r](t))}create(t){return new e(this.logger,{prefix:`${this.prefix}:${t}:`,...this.options})}clone(t){return t=t||this.options,t.prefix=t.prefix||this.prefix,new e(this.logger,t)}},Ze=new Fa,Nr=class{constructor(){this.observers={}}on(t,r){return t.split(" ").forEach(A=>{this.observers[A]=this.observers[A]||[],this.observers[A].push(r)}),this}off(t,r){if(this.observers[t]){if(!r){delete this.observers[t];return}this.observers[t]=this.observers[t].filter(A=>A!==r)}}emit(t){for(var r=arguments.length,A=new Array(r>1?r-1:0),i=1;i<r;i++)A[i-1]=arguments[i];this.observers[t]&&[].concat(this.observers[t]).forEach(n=>{n(...A)}),this.observers["*"]&&[].concat(this.observers["*"]).forEach(n=>{n.apply(n,[t,...A])})}};function dA(){let e,t,r=new Promise((A,i)=>{e=A,t=i});return r.resolve=e,r.reject=t,r}function sp(e){return e==null?"":""+e}function Mb(e,t,r){e.forEach(A=>{t[A]&&(r[A]=t[A])})}function Na(e,t,r){function A(n){return n&&n.indexOf("###")>-1?n.replace(/###/g,"."):n}function i(){return!e||typeof e=="string"}let o=typeof t!="string"?[].concat(t):t.split(".");for(;o.length>1;){if(i())return{};let n=A(o.shift());!e[n]&&r&&(e[n]=new r),Object.prototype.hasOwnProperty.call(e,n)?e=e[n]:e={}}return i()?{}:{obj:e,k:A(o.shift())}}function gp(e,t,r){let{obj:A,k:i}=Na(e,t,Object);A[i]=r}function Hb(e,t,r,A){let{obj:i,k:o}=Na(e,t,Object);i[o]=i[o]||[],A&&(i[o]=i[o].concat(r)),A||i[o].push(r)}function Ki(e,t){let{obj:r,k:A}=Na(e,t);if(r)return r[A]}function Rb(e,t,r){let A=Ki(e,r);return A!==void 0?A:Ki(t,r)}function dp(e,t,r){for(let A in t)A!=="__proto__"&&A!=="constructor"&&(A in e?typeof e[A]=="string"||e[A]instanceof String||typeof t[A]=="string"||t[A]instanceof String?r&&(e[A]=t[A]):dp(e[A],t[A],r):e[A]=t[A]);return e}function kr(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var qb={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function Tb(e){return typeof e=="string"?e.replace(/[&<>"'\/]/g,t=>qb[t]):e}var _b=[" ",",","?","!",";"];function Pb(e,t,r){t=t||"",r=r||"";let A=_b.filter(n=>t.indexOf(n)<0&&r.indexOf(n)<0);if(A.length===0)return!0;let i=new RegExp(`(${A.map(n=>n==="?"?"\\?":n).join("|")})`),o=!i.test(e);if(!o){let n=e.indexOf(r);n>0&&!i.test(e.substring(0,n))&&(o=!0)}return o}function Li(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:".";if(!e)return;if(e[t])return e[t];let A=t.split(r),i=e;for(let o=0;o<A.length;++o){if(!i||typeof i[A[o]]=="string"&&o+1<A.length)return;if(i[A[o]]===void 0){let n=2,a=A.slice(o,o+n).join(r),s=i[a];for(;s===void 0&&A.length>o+n;)n++,a=A.slice(o,o+n).join(r),s=i[a];if(s===void 0)return;if(s===null)return null;if(t.endsWith(a)){if(typeof s=="string")return s;if(a&&typeof s[a]=="string")return s[a]}let g=A.slice(o+n).join(r);return g?Li(s,g,r):void 0}i=i[A[o]]}return i}function Yi(e){return e&&e.indexOf("_")>0?e.replace("_","-"):e}var Vi=class extends Nr{constructor(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{ns:["translation"],defaultNS:"translation"};super(),this.data=t||{},this.options=r,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(t){this.options.ns.indexOf(t)<0&&this.options.ns.push(t)}removeNamespaces(t){let r=this.options.ns.indexOf(t);r>-1&&this.options.ns.splice(r,1)}getResource(t,r,A){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},o=i.keySeparator!==void 0?i.keySeparator:this.options.keySeparator,n=i.ignoreJSONStructure!==void 0?i.ignoreJSONStructure:this.options.ignoreJSONStructure,a=[t,r];A&&typeof A!="string"&&(a=a.concat(A)),A&&typeof A=="string"&&(a=a.concat(o?A.split(o):A)),t.indexOf(".")>-1&&(a=t.split("."));let s=Ki(this.data,a);return s||!n||typeof A!="string"?s:Li(this.data&&this.data[t]&&this.data[t][r],A,o)}addResource(t,r,A,i){let o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{silent:!1},n=o.keySeparator!==void 0?o.keySeparator:this.options.keySeparator,a=[t,r];A&&(a=a.concat(n?A.split(n):A)),t.indexOf(".")>-1&&(a=t.split("."),i=r,r=a[1]),this.addNamespaces(r),gp(this.data,a,i),o.silent||this.emit("added",t,r,A,i)}addResources(t,r,A){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{silent:!1};for(let o in A)(typeof A[o]=="string"||Object.prototype.toString.apply(A[o])==="[object Array]")&&this.addResource(t,r,o,A[o],{silent:!0});i.silent||this.emit("added",t,r,A)}addResourceBundle(t,r,A,i,o){let n=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{silent:!1},a=[t,r];t.indexOf(".")>-1&&(a=t.split("."),i=A,A=r,r=a[1]),this.addNamespaces(r);let s=Ki(this.data,a)||{};i?dp(s,A,o):s={...s,...A},gp(this.data,a,s),n.silent||this.emit("added",t,r,A)}removeResourceBundle(t,r){this.hasResourceBundle(t,r)&&delete this.data[t][r],this.removeNamespaces(r),this.emit("removed",t,r)}hasResourceBundle(t,r){return this.getResource(t,r)!==void 0}getResourceBundle(t,r){return r||(r=this.options.defaultNS),this.options.compatibilityAPI==="v1"?{...this.getResource(t,r)}:this.getResource(t,r)}getDataByLanguage(t){return this.data[t]}hasLanguageSomeTranslations(t){let r=this.getDataByLanguage(t);return!!(r&&Object.keys(r)||[]).find(i=>r[i]&&Object.keys(r[i]).length>0)}toJSON(){return this.data}},pp={processors:{},addPostProcessor(e){this.processors[e.name]=e},handle(e,t,r,A,i){return e.forEach(o=>{this.processors[o]&&(t=this.processors[o].process(t,r,A,i))}),t}},Ip={},zi=class e extends Nr{constructor(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Mb(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],t,this),this.options=r,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=Ze.create("translator")}changeLanguage(t){t&&(this.language=t)}exists(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};if(t==null)return!1;let A=this.resolve(t,r);return A&&A.res!==void 0}extractFromKey(t,r){let A=r.nsSeparator!==void 0?r.nsSeparator:this.options.nsSeparator;A===void 0&&(A=":");let i=r.keySeparator!==void 0?r.keySeparator:this.options.keySeparator,o=r.ns||this.options.defaultNS||[],n=A&&t.indexOf(A)>-1,a=!this.options.userDefinedKeySeparator&&!r.keySeparator&&!this.options.userDefinedNsSeparator&&!r.nsSeparator&&!Pb(t,A,i);if(n&&!a){let s=t.match(this.interpolator.nestingRegexp);if(s&&s.length>0)return{key:t,namespaces:o};let g=t.split(A);(A!==i||A===i&&this.options.ns.indexOf(g[0])>-1)&&(o=g.shift()),t=g.join(i)}return typeof o=="string"&&(o=[o]),{key:t,namespaces:o}}translate(t,r,A){if(typeof r!="object"&&this.options.overloadTranslationOptionHandler&&(r=this.options.overloadTranslationOptionHandler(arguments)),typeof r=="object"&&(r={...r}),r||(r={}),t==null)return"";Array.isArray(t)||(t=[String(t)]);let i=r.returnDetails!==void 0?r.returnDetails:this.options.returnDetails,o=r.keySeparator!==void 0?r.keySeparator:this.options.keySeparator,{key:n,namespaces:a}=this.extractFromKey(t[t.length-1],r),s=a[a.length-1],g=r.lng||this.language,I=r.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(g&&g.toLowerCase()==="cimode"){if(I){let d=r.nsSeparator||this.options.nsSeparator;return i?{res:`${s}${d}${n}`,usedKey:n,exactUsedKey:n,usedLng:g,usedNS:s,usedParams:this.getUsedParamsDetails(r)}:`${s}${d}${n}`}return i?{res:n,usedKey:n,exactUsedKey:n,usedLng:g,usedNS:s,usedParams:this.getUsedParamsDetails(r)}:n}let l=this.resolve(t,r),c=l&&l.res,u=l&&l.usedKey||n,C=l&&l.exactUsedKey||n,m=Object.prototype.toString.apply(c),y=["[object Number]","[object Function]","[object RegExp]"],h=r.joinArrays!==void 0?r.joinArrays:this.options.joinArrays,F=!this.i18nFormat||this.i18nFormat.handleAsObject;if(F&&c&&(typeof c!="string"&&typeof c!="boolean"&&typeof c!="number")&&y.indexOf(m)<0&&!(typeof h=="string"&&m==="[object Array]")){if(!r.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");let d=this.options.returnedObjectHandler?this.options.returnedObjectHandler(u,c,{...r,ns:a}):`key '${n} (${this.language})' returned an object instead of string.`;return i?(l.res=d,l.usedParams=this.getUsedParamsDetails(r),l):d}if(o){let d=m==="[object Array]",w=d?[]:{},f=d?C:u;for(let Q in c)if(Object.prototype.hasOwnProperty.call(c,Q)){let p=`${f}${o}${Q}`;w[Q]=this.translate(p,{...r,joinArrays:!1,ns:a}),w[Q]===p&&(w[Q]=c[Q])}c=w}}else if(F&&typeof h=="string"&&m==="[object Array]")c=c.join(h),c&&(c=this.extendTranslation(c,t,r,A));else{let d=!1,w=!1,f=r.count!==void 0&&typeof r.count!="string",Q=e.hasDefaultValue(r),p=f?this.pluralResolver.getSuffix(g,r.count,r):"",N=r.ordinal&&f?this.pluralResolver.getSuffix(g,r.count,{ordinal:!1}):"",S=r[`defaultValue${p}`]||r[`defaultValue${N}`]||r.defaultValue;!this.isValidLookup(c)&&Q&&(d=!0,c=S),this.isValidLookup(c)||(w=!0,c=n);let U=(r.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&w?void 0:c,E=Q&&S!==c&&this.options.updateMissing;if(w||d||E){if(this.logger.log(E?"updateKey":"missingKey",g,s,n,E?S:c),o){let L=this.resolve(n,{...r,keySeparator:!1});L&&L.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let v=[],H=this.languageUtils.getFallbackCodes(this.options.fallbackLng,r.lng||this.language);if(this.options.saveMissingTo==="fallback"&&H&&H[0])for(let L=0;L<H.length;L++)v.push(H[L]);else this.options.saveMissingTo==="all"?v=this.languageUtils.toResolveHierarchy(r.lng||this.language):v.push(r.lng||this.language);let q=(L,pe,se)=>{let Gt=Q&&se!==c?se:U;this.options.missingKeyHandler?this.options.missingKeyHandler(L,s,pe,Gt,E,r):this.backendConnector&&this.backendConnector.saveMissing&&this.backendConnector.saveMissing(L,s,pe,Gt,E,r),this.emit("missingKey",L,s,pe,c)};this.options.saveMissing&&(this.options.saveMissingPlurals&&f?v.forEach(L=>{this.pluralResolver.getSuffixes(L,r).forEach(pe=>{q([L],n+pe,r[`defaultValue${pe}`]||S)})}):q(v,n,S))}c=this.extendTranslation(c,t,r,l,A),w&&c===n&&this.options.appendNamespaceToMissingKey&&(c=`${s}:${n}`),(w||d)&&this.options.parseMissingKeyHandler&&(this.options.compatibilityAPI!=="v1"?c=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${s}:${n}`:n,d?c:void 0):c=this.options.parseMissingKeyHandler(c))}return i?(l.res=c,l.usedParams=this.getUsedParamsDetails(r),l):c}extendTranslation(t,r,A,i,o){var n=this;if(this.i18nFormat&&this.i18nFormat.parse)t=this.i18nFormat.parse(t,{...this.options.interpolation.defaultVariables,...A},A.lng||this.language||i.usedLng,i.usedNS,i.usedKey,{resolved:i});else if(!A.skipInterpolation){A.interpolation&&this.interpolator.init({...A,interpolation:{...this.options.interpolation,...A.interpolation}});let g=typeof t=="string"&&(A&&A.interpolation&&A.interpolation.skipOnVariables!==void 0?A.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables),I;if(g){let c=t.match(this.interpolator.nestingRegexp);I=c&&c.length}let l=A.replace&&typeof A.replace!="string"?A.replace:A;if(this.options.interpolation.defaultVariables&&(l={...this.options.interpolation.defaultVariables,...l}),t=this.interpolator.interpolate(t,l,A.lng||this.language,A),g){let c=t.match(this.interpolator.nestingRegexp),u=c&&c.length;I<u&&(A.nest=!1)}!A.lng&&this.options.compatibilityAPI!=="v1"&&i&&i.res&&(A.lng=i.usedLng),A.nest!==!1&&(t=this.interpolator.nest(t,function(){for(var c=arguments.length,u=new Array(c),C=0;C<c;C++)u[C]=arguments[C];return o&&o[0]===u[0]&&!A.context?(n.logger.warn(`It seems you are nesting recursively key: ${u[0]} in key: ${r[0]}`),null):n.translate(...u,r)},A)),A.interpolation&&this.interpolator.reset()}let a=A.postProcess||this.options.postProcess,s=typeof a=="string"?[a]:a;return t!=null&&s&&s.length&&A.applyPostProcessor!==!1&&(t=pp.handle(s,t,r,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...i,usedParams:this.getUsedParamsDetails(A)},...A}:A,this)),t}resolve(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},A,i,o,n,a;return typeof t=="string"&&(t=[t]),t.forEach(s=>{if(this.isValidLookup(A))return;let g=this.extractFromKey(s,r),I=g.key;i=I;let l=g.namespaces;this.options.fallbackNS&&(l=l.concat(this.options.fallbackNS));let c=r.count!==void 0&&typeof r.count!="string",u=c&&!r.ordinal&&r.count===0&&this.pluralResolver.shouldUseIntlApi(),C=r.context!==void 0&&(typeof r.context=="string"||typeof r.context=="number")&&r.context!=="",m=r.lngs?r.lngs:this.languageUtils.toResolveHierarchy(r.lng||this.language,r.fallbackLng);l.forEach(y=>{this.isValidLookup(A)||(a=y,!Ip[`${m[0]}-${y}`]&&this.utils&&this.utils.hasLoadedNamespace&&!this.utils.hasLoadedNamespace(a)&&(Ip[`${m[0]}-${y}`]=!0,this.logger.warn(`key "${i}" for languages "${m.join(", ")}" won't get resolved as namespace "${a}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),m.forEach(h=>{if(this.isValidLookup(A))return;n=h;let F=[I];if(this.i18nFormat&&this.i18nFormat.addLookupKeys)this.i18nFormat.addLookupKeys(F,I,h,y,r);else{let d;c&&(d=this.pluralResolver.getSuffix(h,r.count,r));let w=`${this.options.pluralSeparator}zero`,f=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(c&&(F.push(I+d),r.ordinal&&d.indexOf(f)===0&&F.push(I+d.replace(f,this.options.pluralSeparator)),u&&F.push(I+w)),C){let Q=`${I}${this.options.contextSeparator}${r.context}`;F.push(Q),c&&(F.push(Q+d),r.ordinal&&d.indexOf(f)===0&&F.push(Q+d.replace(f,this.options.pluralSeparator)),u&&F.push(Q+w))}}let b;for(;b=F.pop();)this.isValidLookup(A)||(o=b,A=this.getResource(h,y,b,r))}))})}),{res:A,usedKey:i,exactUsedKey:o,usedLng:n,usedNS:a}}isValidLookup(t){return t!==void 0&&!(!this.options.returnNull&&t===null)&&!(!this.options.returnEmptyString&&t==="")}getResource(t,r,A){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(t,r,A,i):this.resourceStore.getResource(t,r,A,i)}getUsedParamsDetails(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],A=t.replace&&typeof t.replace!="string",i=A?t.replace:t;if(A&&typeof t.count<"u"&&(i.count=t.count),this.options.interpolation.defaultVariables&&(i={...this.options.interpolation.defaultVariables,...i}),!A){i={...i};for(let o of r)delete i[o]}return i}static hasDefaultValue(t){let r="defaultValue";for(let A in t)if(Object.prototype.hasOwnProperty.call(t,A)&&r===A.substring(0,r.length)&&t[A]!==void 0)return!0;return!1}};function Da(e){return e.charAt(0).toUpperCase()+e.slice(1)}var Wi=class{constructor(t){this.options=t,this.supportedLngs=this.options.supportedLngs||!1,this.logger=Ze.create("languageUtils")}getScriptPartFromCode(t){if(t=Yi(t),!t||t.indexOf("-")<0)return null;let r=t.split("-");return r.length===2||(r.pop(),r[r.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(r.join("-"))}getLanguagePartFromCode(t){if(t=Yi(t),!t||t.indexOf("-")<0)return t;let r=t.split("-");return this.formatLanguageCode(r[0])}formatLanguageCode(t){if(typeof t=="string"&&t.indexOf("-")>-1){let r=["hans","hant","latn","cyrl","cans","mong","arab"],A=t.split("-");return this.options.lowerCaseLng?A=A.map(i=>i.toLowerCase()):A.length===2?(A[0]=A[0].toLowerCase(),A[1]=A[1].toUpperCase(),r.indexOf(A[1].toLowerCase())>-1&&(A[1]=Da(A[1].toLowerCase()))):A.length===3&&(A[0]=A[0].toLowerCase(),A[1].length===2&&(A[1]=A[1].toUpperCase()),A[0]!=="sgn"&&A[2].length===2&&(A[2]=A[2].toUpperCase()),r.indexOf(A[1].toLowerCase())>-1&&(A[1]=Da(A[1].toLowerCase())),r.indexOf(A[2].toLowerCase())>-1&&(A[2]=Da(A[2].toLowerCase()))),A.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?t.toLowerCase():t}isSupportedCode(t){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(t=this.getLanguagePartFromCode(t)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(t)>-1}getBestMatchFromCodes(t){if(!t)return null;let r;return t.forEach(A=>{if(r)return;let i=this.formatLanguageCode(A);(!this.options.supportedLngs||this.isSupportedCode(i))&&(r=i)}),!r&&this.options.supportedLngs&&t.forEach(A=>{if(r)return;let i=this.getLanguagePartFromCode(A);if(this.isSupportedCode(i))return r=i;r=this.options.supportedLngs.find(o=>{if(o===i)return o;if(!(o.indexOf("-")<0&&i.indexOf("-")<0)&&o.indexOf(i)===0)return o})}),r||(r=this.getFallbackCodes(this.options.fallbackLng)[0]),r}getFallbackCodes(t,r){if(!t)return[];if(typeof t=="function"&&(t=t(r)),typeof t=="string"&&(t=[t]),Object.prototype.toString.apply(t)==="[object Array]")return t;if(!r)return t.default||[];let A=t[r];return A||(A=t[this.getScriptPartFromCode(r)]),A||(A=t[this.formatLanguageCode(r)]),A||(A=t[this.getLanguagePartFromCode(r)]),A||(A=t.default),A||[]}toResolveHierarchy(t,r){let A=this.getFallbackCodes(r||this.options.fallbackLng||[],t),i=[],o=n=>{n&&(this.isSupportedCode(n)?i.push(n):this.logger.warn(`rejecting language code not found in supportedLngs: ${n}`))};return typeof t=="string"&&(t.indexOf("-")>-1||t.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&o(this.formatLanguageCode(t)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&o(this.getScriptPartFromCode(t)),this.options.load!=="currentOnly"&&o(this.getLanguagePartFromCode(t))):typeof t=="string"&&o(this.formatLanguageCode(t)),A.forEach(n=>{i.indexOf(n)<0&&o(this.formatLanguageCode(n))}),i}},Ob=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kk","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],Jb={1:function(e){return+(e>1)},2:function(e){return+(e!=1)},3:function(e){return 0},4:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2},5:function(e){return e==0?0:e==1?1:e==2?2:e%100>=3&&e%100<=10?3:e%100>=11?4:5},6:function(e){return e==1?0:e>=2&&e<=4?1:2},7:function(e){return e==1?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2},8:function(e){return e==1?0:e==2?1:e!=8&&e!=11?2:3},9:function(e){return+(e>=2)},10:function(e){return e==1?0:e==2?1:e<7?2:e<11?3:4},11:function(e){return e==1||e==11?0:e==2||e==12?1:e>2&&e<20?2:3},12:function(e){return+(e%10!=1||e%100==11)},13:function(e){return+(e!==0)},14:function(e){return e==1?0:e==2?1:e==3?2:3},15:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&(e%100<10||e%100>=20)?1:2},16:function(e){return e%10==1&&e%100!=11?0:e!==0?1:2},17:function(e){return e==1||e%10==1&&e%100!=11?0:1},18:function(e){return e==0?0:e==1?1:2},19:function(e){return e==1?0:e==0||e%100>1&&e%100<11?1:e%100>10&&e%100<20?2:3},20:function(e){return e==1?0:e==0||e%100>0&&e%100<20?1:2},21:function(e){return e%100==1?1:e%100==2?2:e%100==3||e%100==4?3:0},22:function(e){return e==1?0:e==2?1:(e<0||e>10)&&e%10==0?2:3}},Kb=["v1","v2","v3"],Lb=["v4"],cp={zero:0,one:1,two:2,few:3,many:4,other:5};function Yb(){let e={};return Ob.forEach(t=>{t.lngs.forEach(r=>{e[r]={numbers:t.nr,plurals:Jb[t.fc]}})}),e}var Sa=class{constructor(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.languageUtils=t,this.options=r,this.logger=Ze.create("pluralResolver"),(!this.options.compatibilityJSON||Lb.includes(this.options.compatibilityJSON))&&(typeof Intl>"u"||!Intl.PluralRules)&&(this.options.compatibilityJSON="v3",this.logger.error("Your environment seems not to be Intl API compatible, use an Intl.PluralRules polyfill. Will fallback to the compatibilityJSON v3 format handling.")),this.rules=Yb()}addRule(t,r){this.rules[t]=r}getRule(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.shouldUseIntlApi())try{return new Intl.PluralRules(Yi(t),{type:r.ordinal?"ordinal":"cardinal"})}catch{return}return this.rules[t]||this.rules[this.languageUtils.getLanguagePartFromCode(t)]}needsPlural(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},A=this.getRule(t,r);return this.shouldUseIntlApi()?A&&A.resolvedOptions().pluralCategories.length>1:A&&A.numbers.length>1}getPluralFormsOfKey(t,r){let A=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.getSuffixes(t,A).map(i=>`${r}${i}`)}getSuffixes(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},A=this.getRule(t,r);return A?this.shouldUseIntlApi()?A.resolvedOptions().pluralCategories.sort((i,o)=>cp[i]-cp[o]).map(i=>`${this.options.prepend}${r.ordinal?`ordinal${this.options.prepend}`:""}${i}`):A.numbers.map(i=>this.getSuffix(t,i,r)):[]}getSuffix(t,r){let A=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=this.getRule(t,A);return i?this.shouldUseIntlApi()?`${this.options.prepend}${A.ordinal?`ordinal${this.options.prepend}`:""}${i.select(r)}`:this.getSuffixRetroCompatible(i,r):(this.logger.warn(`no plural rule found for: ${t}`),"")}getSuffixRetroCompatible(t,r){let A=t.noAbs?t.plurals(r):t.plurals(Math.abs(r)),i=t.numbers[A];this.options.simplifyPluralSuffix&&t.numbers.length===2&&t.numbers[0]===1&&(i===2?i="plural":i===1&&(i=""));let o=()=>this.options.prepend&&i.toString()?this.options.prepend+i.toString():i.toString();return this.options.compatibilityJSON==="v1"?i===1?"":typeof i=="number"?`_plural_${i.toString()}`:o():this.options.compatibilityJSON==="v2"||this.options.simplifyPluralSuffix&&t.numbers.length===2&&t.numbers[0]===1?o():this.options.prepend&&A.toString()?this.options.prepend+A.toString():A.toString()}shouldUseIntlApi(){return!Kb.includes(this.options.compatibilityJSON)}};function lp(e,t,r){let A=arguments.length>3&&arguments[3]!==void 0?arguments[3]:".",i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,o=Rb(e,t,r);return!o&&i&&typeof r=="string"&&(o=Li(e,r,A),o===void 0&&(o=Li(t,r,A))),o}var xa=class{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=Ze.create("interpolator"),this.options=t,this.format=t.interpolation&&t.interpolation.format||(r=>r),this.init(t)}init(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};t.interpolation||(t.interpolation={escapeValue:!0});let r=t.interpolation;this.escape=r.escape!==void 0?r.escape:Tb,this.escapeValue=r.escapeValue!==void 0?r.escapeValue:!0,this.useRawValueToEscape=r.useRawValueToEscape!==void 0?r.useRawValueToEscape:!1,this.prefix=r.prefix?kr(r.prefix):r.prefixEscaped||"{{",this.suffix=r.suffix?kr(r.suffix):r.suffixEscaped||"}}",this.formatSeparator=r.formatSeparator?r.formatSeparator:r.formatSeparator||",",this.unescapePrefix=r.unescapeSuffix?"":r.unescapePrefix||"-",this.unescapeSuffix=this.unescapePrefix?"":r.unescapeSuffix||"",this.nestingPrefix=r.nestingPrefix?kr(r.nestingPrefix):r.nestingPrefixEscaped||kr("$t("),this.nestingSuffix=r.nestingSuffix?kr(r.nestingSuffix):r.nestingSuffixEscaped||kr(")"),this.nestingOptionsSeparator=r.nestingOptionsSeparator?r.nestingOptionsSeparator:r.nestingOptionsSeparator||",",this.maxReplaces=r.maxReplaces?r.maxReplaces:1e3,this.alwaysFormat=r.alwaysFormat!==void 0?r.alwaysFormat:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){let t=`${this.prefix}(.+?)${this.suffix}`;this.regexp=new RegExp(t,"g");let r=`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`;this.regexpUnescape=new RegExp(r,"g");let A=`${this.nestingPrefix}(.+?)${this.nestingSuffix}`;this.nestingRegexp=new RegExp(A,"g")}interpolate(t,r,A,i){let o,n,a,s=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{};function g(C){return C.replace(/\$/g,"$$$$")}let I=C=>{if(C.indexOf(this.formatSeparator)<0){let F=lp(r,s,C,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(F,void 0,A,{...i,...r,interpolationkey:C}):F}let m=C.split(this.formatSeparator),y=m.shift().trim(),h=m.join(this.formatSeparator).trim();return this.format(lp(r,s,y,this.options.keySeparator,this.options.ignoreJSONStructure),h,A,{...i,...r,interpolationkey:y})};this.resetRegExp();let l=i&&i.missingInterpolationHandler||this.options.missingInterpolationHandler,c=i&&i.interpolation&&i.interpolation.skipOnVariables!==void 0?i.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:C=>g(C)},{regex:this.regexp,safeValue:C=>this.escapeValue?g(this.escape(C)):g(C)}].forEach(C=>{for(a=0;o=C.regex.exec(t);){let m=o[1].trim();if(n=I(m),n===void 0)if(typeof l=="function"){let h=l(t,o,i);n=typeof h=="string"?h:""}else if(i&&Object.prototype.hasOwnProperty.call(i,m))n="";else if(c){n=o[0];continue}else this.logger.warn(`missed to pass in variable ${m} for interpolating ${t}`),n="";else typeof n!="string"&&!this.useRawValueToEscape&&(n=sp(n));let y=C.safeValue(n);if(t=t.replace(o[0],y),c?(C.regex.lastIndex+=n.length,C.regex.lastIndex-=o[0].length):C.regex.lastIndex=0,a++,a>=this.maxReplaces)break}}),t}nest(t,r){let A=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i,o,n;function a(s,g){let I=this.nestingOptionsSeparator;if(s.indexOf(I)<0)return s;let l=s.split(new RegExp(`${I}[ ]*{`)),c=`{${l[1]}`;s=l[0],c=this.interpolate(c,n);let u=c.match(/'/g),C=c.match(/"/g);(u&&u.length%2===0&&!C||C.length%2!==0)&&(c=c.replace(/'/g,'"'));try{n=JSON.parse(c),g&&(n={...g,...n})}catch(m){return this.logger.warn(`failed parsing options string in nesting for key ${s}`,m),`${s}${I}${c}`}return delete n.defaultValue,s}for(;i=this.nestingRegexp.exec(t);){let s=[];n={...A},n=n.replace&&typeof n.replace!="string"?n.replace:n,n.applyPostProcessor=!1,delete n.defaultValue;let g=!1;if(i[0].indexOf(this.formatSeparator)!==-1&&!/{.*}/.test(i[1])){let I=i[1].split(this.formatSeparator).map(l=>l.trim());i[1]=I.shift(),s=I,g=!0}if(o=r(a.call(this,i[1].trim(),n),n),o&&i[0]===t&&typeof o!="string")return o;typeof o!="string"&&(o=sp(o)),o||(this.logger.warn(`missed to resolve ${i[1]} for nesting ${t}`),o=""),g&&(o=s.reduce((I,l)=>this.format(I,l,A.lng,{...A,interpolationkey:i[1].trim()}),o.trim())),t=t.replace(i[0],o),this.regexp.lastIndex=0}return t}};function Vb(e){let t=e.toLowerCase().trim(),r={};if(e.indexOf("(")>-1){let A=e.split("(");t=A[0].toLowerCase().trim();let i=A[1].substring(0,A[1].length-1);t==="currency"&&i.indexOf(":")<0?r.currency||(r.currency=i.trim()):t==="relativetime"&&i.indexOf(":")<0?r.range||(r.range=i.trim()):i.split(";").forEach(n=>{if(!n)return;let[a,...s]=n.split(":"),g=s.join(":").trim().replace(/^'+|'+$/g,"");r[a.trim()]||(r[a.trim()]=g),g==="false"&&(r[a.trim()]=!1),g==="true"&&(r[a.trim()]=!0),isNaN(g)||(r[a.trim()]=parseInt(g,10))})}return{formatName:t,formatOptions:r}}function br(e){let t={};return function(A,i,o){let n=i+JSON.stringify(o),a=t[n];return a||(a=e(Yi(i),o),t[n]=a),a(A)}}var ka=class{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=Ze.create("formatter"),this.options=t,this.formats={number:br((r,A)=>{let i=new Intl.NumberFormat(r,{...A});return o=>i.format(o)}),currency:br((r,A)=>{let i=new Intl.NumberFormat(r,{...A,style:"currency"});return o=>i.format(o)}),datetime:br((r,A)=>{let i=new Intl.DateTimeFormat(r,{...A});return o=>i.format(o)}),relativetime:br((r,A)=>{let i=new Intl.RelativeTimeFormat(r,{...A});return o=>i.format(o,A.range||"day")}),list:br((r,A)=>{let i=new Intl.ListFormat(r,{...A});return o=>i.format(o)})},this.init(t)}init(t){let A=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}}).interpolation;this.formatSeparator=A.formatSeparator?A.formatSeparator:A.formatSeparator||","}add(t,r){this.formats[t.toLowerCase().trim()]=r}addCached(t,r){this.formats[t.toLowerCase().trim()]=br(r)}format(t,r,A){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return r.split(this.formatSeparator).reduce((a,s)=>{let{formatName:g,formatOptions:I}=Vb(s);if(this.formats[g]){let l=a;try{let c=i&&i.formatParams&&i.formatParams[i.interpolationkey]||{},u=c.locale||c.lng||i.locale||i.lng||A;l=this.formats[g](a,u,{...I,...i,...c})}catch(c){this.logger.warn(c)}return l}else this.logger.warn(`there was no format function for ${g}`);return a},t)}};function zb(e,t){e.pending[t]!==void 0&&(delete e.pending[t],e.pendingCount--)}var ba=class extends Nr{constructor(t,r,A){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};super(),this.backend=t,this.store=r,this.services=A,this.languageUtils=A.languageUtils,this.options=i,this.logger=Ze.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=i.maxParallelReads||10,this.readingCalls=0,this.maxRetries=i.maxRetries>=0?i.maxRetries:5,this.retryTimeout=i.retryTimeout>=1?i.retryTimeout:350,this.state={},this.queue=[],this.backend&&this.backend.init&&this.backend.init(A,i.backend,i)}queueLoad(t,r,A,i){let o={},n={},a={},s={};return t.forEach(g=>{let I=!0;r.forEach(l=>{let c=`${g}|${l}`;!A.reload&&this.store.hasResourceBundle(g,l)?this.state[c]=2:this.state[c]<0||(this.state[c]===1?n[c]===void 0&&(n[c]=!0):(this.state[c]=1,I=!1,n[c]===void 0&&(n[c]=!0),o[c]===void 0&&(o[c]=!0),s[l]===void 0&&(s[l]=!0)))}),I||(a[g]=!0)}),(Object.keys(o).length||Object.keys(n).length)&&this.queue.push({pending:n,pendingCount:Object.keys(n).length,loaded:{},errors:[],callback:i}),{toLoad:Object.keys(o),pending:Object.keys(n),toLoadLanguages:Object.keys(a),toLoadNamespaces:Object.keys(s)}}loaded(t,r,A){let i=t.split("|"),o=i[0],n=i[1];r&&this.emit("failedLoading",o,n,r),A&&this.store.addResourceBundle(o,n,A),this.state[t]=r?-1:2;let a={};this.queue.forEach(s=>{Hb(s.loaded,[o],n),zb(s,t),r&&s.errors.push(r),s.pendingCount===0&&!s.done&&(Object.keys(s.loaded).forEach(g=>{a[g]||(a[g]={});let I=s.loaded[g];I.length&&I.forEach(l=>{a[g][l]===void 0&&(a[g][l]=!0)})}),s.done=!0,s.errors.length?s.callback(s.errors):s.callback())}),this.emit("loaded",a),this.queue=this.queue.filter(s=>!s.done)}read(t,r,A){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:this.retryTimeout,n=arguments.length>5?arguments[5]:void 0;if(!t.length)return n(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:t,ns:r,fcName:A,tried:i,wait:o,callback:n});return}this.readingCalls++;let a=(g,I)=>{if(this.readingCalls--,this.waitingReads.length>0){let l=this.waitingReads.shift();this.read(l.lng,l.ns,l.fcName,l.tried,l.wait,l.callback)}if(g&&I&&i<this.maxRetries){setTimeout(()=>{this.read.call(this,t,r,A,i+1,o*2,n)},o);return}n(g,I)},s=this.backend[A].bind(this.backend);if(s.length===2){try{let g=s(t,r);g&&typeof g.then=="function"?g.then(I=>a(null,I)).catch(a):a(null,g)}catch(g){a(g)}return}return s(t,r,a)}prepareLoading(t,r){let A=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),i&&i();typeof t=="string"&&(t=this.languageUtils.toResolveHierarchy(t)),typeof r=="string"&&(r=[r]);let o=this.queueLoad(t,r,A,i);if(!o.toLoad.length)return o.pending.length||i(),null;o.toLoad.forEach(n=>{this.loadOne(n)})}load(t,r,A){this.prepareLoading(t,r,{},A)}reload(t,r,A){this.prepareLoading(t,r,{reload:!0},A)}loadOne(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",A=t.split("|"),i=A[0],o=A[1];this.read(i,o,"read",void 0,void 0,(n,a)=>{n&&this.logger.warn(`${r}loading namespace ${o} for language ${i} failed`,n),!n&&a&&this.logger.log(`${r}loaded namespace ${o} for language ${i}`,a),this.loaded(t,n,a)})}saveMissing(t,r,A,i,o){let n=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:()=>{};if(this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(r)){this.logger.warn(`did not save key "${A}" as the namespace "${r}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(A==null||A==="")){if(this.backend&&this.backend.create){let s={...n,isUpdate:o},g=this.backend.create.bind(this.backend);if(g.length<6)try{let I;g.length===5?I=g(t,r,A,i,s):I=g(t,r,A,i),I&&typeof I.then=="function"?I.then(l=>a(null,l)).catch(a):a(null,I)}catch(I){a(I)}else g(t,r,A,i,a,s)}!t||!t[0]||this.store.addResource(t[0],r,A,i)}}};function up(){return{debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:function(t){let r={};if(typeof t[1]=="object"&&(r=t[1]),typeof t[1]=="string"&&(r.defaultValue=t[1]),typeof t[2]=="string"&&(r.tDescription=t[2]),typeof t[2]=="object"||typeof t[3]=="object"){let A=t[3]||t[2];Object.keys(A).forEach(i=>{r[i]=A[i]})}return r},interpolation:{escapeValue:!0,format:e=>e,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}}function fp(e){return typeof e.ns=="string"&&(e.ns=[e.ns]),typeof e.fallbackLng=="string"&&(e.fallbackLng=[e.fallbackLng]),typeof e.fallbackNS=="string"&&(e.fallbackNS=[e.fallbackNS]),e.supportedLngs&&e.supportedLngs.indexOf("cimode")<0&&(e.supportedLngs=e.supportedLngs.concat(["cimode"])),e}function Ji(){}function Wb(e){Object.getOwnPropertyNames(Object.getPrototypeOf(e)).forEach(r=>{typeof e[r]=="function"&&(e[r]=e[r].bind(e))})}var Xi=class e extends Nr{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;if(super(),this.options=fp(t),this.services={},this.logger=Ze,this.modules={external:[]},Wb(this),r&&!this.isInitialized&&!t.isClone){if(!this.options.initImmediate)return this.init(t,r),this;setTimeout(()=>{this.init(t,r)},0)}}init(){var t=this;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},A=arguments.length>1?arguments[1]:void 0;typeof r=="function"&&(A=r,r={}),!r.defaultNS&&r.defaultNS!==!1&&r.ns&&(typeof r.ns=="string"?r.defaultNS=r.ns:r.ns.indexOf("translation")<0&&(r.defaultNS=r.ns[0]));let i=up();this.options={...i,...this.options,...fp(r)},this.options.compatibilityAPI!=="v1"&&(this.options.interpolation={...i.interpolation,...this.options.interpolation}),r.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=r.keySeparator),r.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=r.nsSeparator);function o(I){return I?typeof I=="function"?new I:I:null}if(!this.options.isClone){this.modules.logger?Ze.init(o(this.modules.logger),this.options):Ze.init(null,this.options);let I;this.modules.formatter?I=this.modules.formatter:typeof Intl<"u"&&(I=ka);let l=new Wi(this.options);this.store=new Vi(this.options.resources,this.options);let c=this.services;c.logger=Ze,c.resourceStore=this.store,c.languageUtils=l,c.pluralResolver=new Sa(l,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),I&&(!this.options.interpolation.format||this.options.interpolation.format===i.interpolation.format)&&(c.formatter=o(I),c.formatter.init(c,this.options),this.options.interpolation.format=c.formatter.format.bind(c.formatter)),c.interpolator=new xa(this.options),c.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},c.backendConnector=new ba(o(this.modules.backend),c.resourceStore,c,this.options),c.backendConnector.on("*",function(u){for(var C=arguments.length,m=new Array(C>1?C-1:0),y=1;y<C;y++)m[y-1]=arguments[y];t.emit(u,...m)}),this.modules.languageDetector&&(c.languageDetector=o(this.modules.languageDetector),c.languageDetector.init&&c.languageDetector.init(c,this.options.detection,this.options)),this.modules.i18nFormat&&(c.i18nFormat=o(this.modules.i18nFormat),c.i18nFormat.init&&c.i18nFormat.init(this)),this.translator=new zi(this.services,this.options),this.translator.on("*",function(u){for(var C=arguments.length,m=new Array(C>1?C-1:0),y=1;y<C;y++)m[y-1]=arguments[y];t.emit(u,...m)}),this.modules.external.forEach(u=>{u.init&&u.init(this)})}if(this.format=this.options.interpolation.format,A||(A=Ji),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){let I=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);I.length>0&&I[0]!=="dev"&&(this.options.lng=I[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(I=>{this[I]=function(){return t.store[I](...arguments)}}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(I=>{this[I]=function(){return t.store[I](...arguments),t}});let s=dA(),g=()=>{let I=(l,c)=>{this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),s.resolve(c),A(l,c)};if(this.languages&&this.options.compatibilityAPI!=="v1"&&!this.isInitialized)return I(null,this.t.bind(this));this.changeLanguage(this.options.lng,I)};return this.options.resources||!this.options.initImmediate?g():setTimeout(g,0),s}loadResources(t){let A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ji,i=typeof t=="string"?t:this.language;if(typeof t=="function"&&(A=t),!this.options.resources||this.options.partialBundledLanguages){if(i&&i.toLowerCase()==="cimode"&&(!this.options.preload||this.options.preload.length===0))return A();let o=[],n=a=>{if(!a||a==="cimode")return;this.services.languageUtils.toResolveHierarchy(a).forEach(g=>{g!=="cimode"&&o.indexOf(g)<0&&o.push(g)})};i?n(i):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(s=>n(s)),this.options.preload&&this.options.preload.forEach(a=>n(a)),this.services.backendConnector.load(o,this.options.ns,a=>{!a&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),A(a)})}else A(null)}reloadResources(t,r,A){let i=dA();return t||(t=this.languages),r||(r=this.options.ns),A||(A=Ji),this.services.backendConnector.reload(t,r,o=>{i.resolve(),A(o)}),i}use(t){if(!t)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!t.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return t.type==="backend"&&(this.modules.backend=t),(t.type==="logger"||t.log&&t.warn&&t.error)&&(this.modules.logger=t),t.type==="languageDetector"&&(this.modules.languageDetector=t),t.type==="i18nFormat"&&(this.modules.i18nFormat=t),t.type==="postProcessor"&&pp.addPostProcessor(t),t.type==="formatter"&&(this.modules.formatter=t),t.type==="3rdParty"&&this.modules.external.push(t),this}setResolvedLanguage(t){if(!(!t||!this.languages)&&!(["cimode","dev"].indexOf(t)>-1))for(let r=0;r<this.languages.length;r++){let A=this.languages[r];if(!(["cimode","dev"].indexOf(A)>-1)&&this.store.hasLanguageSomeTranslations(A)){this.resolvedLanguage=A;break}}}changeLanguage(t,r){var A=this;this.isLanguageChangingTo=t;let i=dA();this.emit("languageChanging",t);let o=s=>{this.language=s,this.languages=this.services.languageUtils.toResolveHierarchy(s),this.resolvedLanguage=void 0,this.setResolvedLanguage(s)},n=(s,g)=>{g?(o(g),this.translator.changeLanguage(g),this.isLanguageChangingTo=void 0,this.emit("languageChanged",g),this.logger.log("languageChanged",g)):this.isLanguageChangingTo=void 0,i.resolve(function(){return A.t(...arguments)}),r&&r(s,function(){return A.t(...arguments)})},a=s=>{!t&&!s&&this.services.languageDetector&&(s=[]);let g=typeof s=="string"?s:this.services.languageUtils.getBestMatchFromCodes(s);g&&(this.language||o(g),this.translator.language||this.translator.changeLanguage(g),this.services.languageDetector&&this.services.languageDetector.cacheUserLanguage&&this.services.languageDetector.cacheUserLanguage(g)),this.loadResources(g,I=>{n(I,g)})};return!t&&this.services.languageDetector&&!this.services.languageDetector.async?a(this.services.languageDetector.detect()):!t&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(a):this.services.languageDetector.detect(a):a(t),i}getFixedT(t,r,A){var i=this;let o=function(n,a){let s;if(typeof a!="object"){for(var g=arguments.length,I=new Array(g>2?g-2:0),l=2;l<g;l++)I[l-2]=arguments[l];s=i.options.overloadTranslationOptionHandler([n,a].concat(I))}else s={...a};s.lng=s.lng||o.lng,s.lngs=s.lngs||o.lngs,s.ns=s.ns||o.ns,s.keyPrefix=s.keyPrefix||A||o.keyPrefix;let c=i.options.keySeparator||".",u;return s.keyPrefix&&Array.isArray(n)?u=n.map(C=>`${s.keyPrefix}${c}${C}`):u=s.keyPrefix?`${s.keyPrefix}${c}${n}`:n,i.t(u,s)};return typeof t=="string"?o.lng=t:o.lngs=t,o.ns=r,o.keyPrefix=A,o}t(){return this.translator&&this.translator.translate(...arguments)}exists(){return this.translator&&this.translator.exists(...arguments)}setDefaultNamespace(t){this.options.defaultNS=t}hasLoadedNamespace(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;let A=r.lng||this.resolvedLanguage||this.languages[0],i=this.options?this.options.fallbackLng:!1,o=this.languages[this.languages.length-1];if(A.toLowerCase()==="cimode")return!0;let n=(a,s)=>{let g=this.services.backendConnector.state[`${a}|${s}`];return g===-1||g===2};if(r.precheck){let a=r.precheck(this,n);if(a!==void 0)return a}return!!(this.hasResourceBundle(A,t)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||n(A,t)&&(!i||n(o,t)))}loadNamespaces(t,r){let A=dA();return this.options.ns?(typeof t=="string"&&(t=[t]),t.forEach(i=>{this.options.ns.indexOf(i)<0&&this.options.ns.push(i)}),this.loadResources(i=>{A.resolve(),r&&r(i)}),A):(r&&r(),Promise.resolve())}loadLanguages(t,r){let A=dA();typeof t=="string"&&(t=[t]);let i=this.options.preload||[],o=t.filter(n=>i.indexOf(n)<0);return o.length?(this.options.preload=i.concat(o),this.loadResources(n=>{A.resolve(),r&&r(n)}),A):(r&&r(),Promise.resolve())}dir(t){if(t||(t=this.resolvedLanguage||(this.languages&&this.languages.length>0?this.languages[0]:this.language)),!t)return"rtl";let r=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],A=this.services&&this.services.languageUtils||new Wi(up());return r.indexOf(A.getLanguagePartFromCode(t))>-1||t.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;return new e(t,r)}cloneInstance(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ji,A=t.forkResourceStore;A&&delete t.forkResourceStore;let i={...this.options,...t,isClone:!0},o=new e(i);return(t.debug!==void 0||t.prefix!==void 0)&&(o.logger=o.logger.clone(t)),["store","services","language"].forEach(a=>{o[a]=this[a]}),o.services={...this.services},o.services.utils={hasLoadedNamespace:o.hasLoadedNamespace.bind(o)},A&&(o.store=new Vi(this.store.data,i),o.services.resourceStore=o.store),o.translator=new zi(o.services,i),o.translator.on("*",function(a){for(var s=arguments.length,g=new Array(s>1?s-1:0),I=1;I<s;I++)g[I-1]=arguments[I];o.emit(a,...g)}),o.init(i,r),o.translator.options=i,o.translator.backendConnector.services.utils={hasLoadedNamespace:o.hasLoadedNamespace.bind(o)},o}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}},oe=Xi.createInstance();oe.createInstance=Xi.createInstance;var S1=oe.createInstance,x1=oe.dir,k1=oe.init,b1=oe.loadResources,N1=oe.reloadResources,v1=oe.use,G1=oe.changeLanguage,U1=oe.getFixedT,M1=oe.t,H1=oe.exists,R1=oe.setDefaultNamespace,q1=oe.hasLoadedNamespace,T1=oe.loadNamespaces,_1=oe.loadLanguages;var Re=G(K());var wp=G(Ce());var e0=G(Ce(),1);var BA=G(Ce(),1);var Xb=G(Cp());var mp=G(Ce(),1);var CA=(0,mp.createContext)();var Zi=G(Ce(),1);var Ep=G(Ce(),1);var yp=G(Ce(),1);var o0=G(Ce(),1);var r0=G(Ce(),1);var Ua=G(Ce());var s0=G(K());var n0=G(Ce());async function Dp(e){let r=st(`/i18n/${e}.json`);return await(await fetch(r)).json()}async function Ma({image:e,type:t,quality:r=1}){if(e instanceof Blob||e instanceof ImageBitmap)return g0({image:e,type:t,quality:r});if(typeof e=="string"){let o=e;e=new Image,e.src=o}e.complete||await e.decode();let A=new OffscreenCanvas(e.naturalWidth,e.naturalHeight);return A.getContext("2d").drawImage(e,0,0),A.convertToBlob({type:t,quality:r})}async function g0({image:e,type:t,quality:r=1}){if(e instanceof Blob&&e.type===t)return e;let A=e instanceof Blob?await createImageBitmap(e):e,i=new OffscreenCanvas(A.width,A.height);return i.getContext("2d").drawImage(A,0,0),i.convertToBlob({type:t,quality:r})}function Fp(e){return!Re.default.sidePanel||!Re.default.sidePanel.open||e?.windowId===void 0?!1:Re.default.sidePanel.open({windowId:e?.windowId}).then(async()=>Re.default.runtime.getContexts?await Re.default.runtime.getContexts({contextTypes:["SIDE_PANEL"]}).then(r=>r.length>0):!1).catch(t=>!1)}function kp(e,t,r=new Map,A){for(let{children:i,i18nKey:o,...n}of e)t&&Re.default.contextMenus.create({...n,parentId:A}),o&&r.set(n.id,o),i&&kp(i,t,r,n.id);return r}function Sp(e,t){let r=kp(e,t);return function(){let i=Fe.English;oe.init({resources:{},lng:"en",fallbackLng:"en",interpolation:{escapeValue:!1,defaultVariables:{APP_NAME:If,AI:"AI"}}}).then(()=>J("language",Fe.English)).then(o=>{o!==i&&(i=o,xp(o,r))}).finally(()=>{kn.subscribe(o=>{if(!Tn(o,"language"))return;let n=o.language.newValue;n&&n!==i&&(i=n,xp(n,r))})})}}async function xp(e,t){if(!oe.hasResourceBundle(e,"translation")){let A=await Dp(e);oe.addResourceBundle(e,"translation",A)}let r=oe.getFixedT(e,"translation");for(let[A,i]of t.entries())Re.default.contextMenus.update(A,{title:r(i)})}function bp(){let e=[{contexts:["all"],id:"open-full-page-chat",title:"Open Full Page Chat",i18nKey:"contextMenu.openFullPageChat"},{id:"toggle-page-translation",documentUrlPatterns:["http://*/*","https://*/*"],title:"Translate the page / Show original text",i18nKey:"contextMenu.togglePageTranslation"},{contexts:["selection"],id:"query-selection",title:"Ask Sider",i18nKey:"contextMenu.askSider"},{contexts:["image"],title:"AI Image Tools",id:"ai-image-tools",i18nKey:"contextMenu.imageTools",children:[{contexts:["image"],id:"chat-with-image",title:"Chat with Image",i18nKey:"imageToolbar.chatWithImage"},{contexts:["image"],id:"extract-text-from-image",title:"Extract Text",i18nKey:"imageToolbar.extractText"},{contexts:["image"],id:"remove-background",title:"Remove Background",i18nKey:"imageToolbar.removeBackground"},{contexts:["image"],id:"remove-text",title:"Remove Text",i18nKey:"imageToolbar.removeText"},{contexts:["image"],id:"reomve-brushed-area",title:"Remove Brushed Area",i18nKey:"imageToolbar.inpaint"},{contexts:["image"],id:"replace-background",title:"Replace Background",i18nKey:"imageToolbar.replaceBackground"},{contexts:["image"],id:"upscale-image",title:"Upscale",i18nKey:"imageToolbar.upscale"},{contexts:["image"],id:"variation",title:"Create Variations",i18nKey:"imageToolbar.variation"}]}];Re.default.runtime.onInstalled.addListener(()=>{Sp(e,!0)}),Re.default.contextMenus.onClicked.addListener((r,A)=>{switch(r.menuItemId){case"open-full-page-chat":{$r();break}case"toggle-page-translation":{let i=A?.id;if(i===void 0)return;Jt("toggle-page-translation",null,{tabId:i});break}case"query-selection":{return Fp(A),Re.default.storage.local.set({initialSelectionText:r.selectionText,lastTab:"chat"}).then(()=>{});break}case"chat-with-image":case"extract-text-from-image":{(async function(){let i=r.srcUrl;if(!i)return;let o=r.menuItemId==="chat-with-image",n=["image/png","image/jpeg"];await Fp(A),St("lastTab",o?"chat":"ocr");let s=await(await fetch(i)).blob(),g=await createImageBitmap(s);n.includes(s.type)||(s=await Ma({image:g,type:"image/png"}));let I=await It(s),l=!1;for await(let c of Mf())if(c){l=!0;break}Jt(o?"send-image-to-chat":"send-image-to-ocr",{base64:I,imageUrl:i,width:g.width,height:g.height,type:s.type},l?{view:"sidebar"}:{tabId:A?.id})})();break}case"upscale-image":case"remove-background":case"remove-text":case"replace-background":case"reomve-brushed-area":case"variation":{let i=r.menuItemId,o=r.srcUrl;if(!o)return;(async function(){let n=["image/png","image/jpeg"],s=await(await fetch(o)).blob(),g=await createImageBitmap(s);n.includes(s.type)||(s=await Ma({image:g,type:"image/png"}));let I=await It(s),l=await new Promise(async(c,u)=>{let C=new AbortController,m=setTimeout(()=>{C.abort(),c(y)},1e4);ye("website-painter-ready",({sender:h})=>{h.tab?.id===y.id&&(C.abort(),clearTimeout(m),c(y))},{signal:C.signal});let y=await Zn({subRoute:_n(i,{variation:"painter",_:i}),hasDataToSend:!0})});Jt("send-image-to-image-tools",{toolName:i,base64:I,imageUrl:o,width:g.width,height:g.height,type:s.type},{tabId:l.id})})()}}}),Sp(e,!1)()}var ji=G(K());var Ha="do_ocr";async function Ra(e){ji.default.runtime.sendMessage({type:"is-sidepanel-open"}).then(r=>{r?ji.default.runtime.sendMessage({type:Ha,data:{img:e,isForSidepanel:!0}}):t()}).catch(t);async function t(){Ff({url:st("standalone.html")}),await Ot(500),ji.default.runtime.sendMessage({type:Ha,data:{img:e,isForSidepanel:!1}})}}async function qa(){if(await J("language"))return;let t=navigator.languages;for(let r of t){r=r.replace("-","_");let A=r.split("_");A[0]=A[0].toLowerCase(),A[1]&&(A[1]=A[1].toUpperCase()),r=A.join("_");let i="";if(r in vn?i=r:i=Object.keys(vn).find(o=>A[0]===o.split("_")[0])||"",i){await k({__DONT_SYNC__:`language${Date.now()}`,language:i});return}}await k({__DONT_SYNC__:`language${Date.now()}`,language:Fe.English})}var Np=G(K());function vp(){Np.default.storage.local.onChanged.addListener(e=>{if(e.__DONT_SYNC__?.newValue)return;let t=Object.keys(e).filter(r=>r in mi);t.length&&I0(t)})}var Gp=async e=>{if(!await le())return;await Up();let r=await M(e);r["provider:gpt3"]&&(r["provider:gpt3"].apiKey=""),vr(r,"translatorHostConfig"),vr(r,"quickActionInputIconDisabledHost"),vr(r,"sidebarFabDisabledHost"),vr(r,"webAssistantImageDisabledHost"),vr(r,"pageTranslationNeverHost"),vr(r,"inputTranslationDisabledHost"),R.setUserSettings(r)},Ta=new Map,I0=e=>{let t=e.sort().toString();Ta.has(t)||Ta.set(t,Ee(Gp,1e3)),Ta.get(t)?.(e)},Up=async()=>{let{allPromptList:e}=await J(["allPromptList"]),t=!1;t=!1,e&&(await Promise.all(e.map(async r=>{if(!r.id){t=!0;let A=await R.createPrompt({key:r.key,name:r.name,content:r.content,use:r.usedIn,icon:r.icon});r.id=String(A.id)}})),t&&await k({__DONT_SYNC__:`unsavedSidebarTpl${Date.now()}`,allPromptList:e}))},Mp=async()=>{if(!await le())throw new Error("login required");await Up(),await c0()};async function c0(){let e=Object.keys(mi),t={...await R.getUserSettings()||{}};if(!t||!Object.keys(t).length){await Gp(e);return}for(let i of Object.keys(t))(!(i in mi)||t[i]===null)&&delete t[i];let r=await M(e),A;r["provider:gpt3"]&&(A=r["provider:gpt3"].apiKey),Gr(t,"translatorHostConfig"),Gr(t,"quickActionInputIconDisabledHost"),Gr(t,"sidebarFabDisabledHost"),Gr(t,"webAssistantImageDisabledHost"),Gr(t,"pageTranslationNeverHost"),Gr(t,"inputTranslationDisabledHost"),["chatVisiblePromptKeys","readVisiblePromptKeys","writeVisiblePromptKeys"].forEach(i=>{delete t[i]}),Lr(r,t,{"provider:gpt3":{apiKey:A}},(i,o)=>{if(Array.isArray(i))return o}),await k({__DONT_SYNC__:`pullFromCloud${Date.now()}`,...r})}function vr(e,t){let r=[];if(e[t]&&typeof e[t]=="object"&&!Array.isArray(e[t])){for(let[A,i]of Object.entries(e[t]))A!=="undefined"&&r.push({__key__:A,...i||{}});e[t]=r}}function Gr(e,t){let r={};if(Array.isArray(e[t])){for(let A of e[t])A.__key__&&A.__key__!=="undefined"&&(r[A.__key__]=A,delete A.__key__);e[t]=r}}function Hp(){Gn("logged",e=>{l0(!!e.logged?.newValue)}),Gn(["language"],async e=>{if(typeof e.language?.oldValue>"u")return;await le()&&R.getAllPromptList(),ae("systemVoiceDemoText")})}var l0=e=>{e?u0():f0()},u0=Ee(()=>{_a(["getVipPeriodInfo","getUserInfo","getVipInfo","pullSettingsFromCloud","getAllPromptList","inviteFinishCallback","getUserStatus"].map(t=>je(t)))},3e3,{leading:!0}),f0=()=>{ae("userInfo")},Rp=ze(async()=>{let{__invited_reward_finish__:e}=await M({__invited_reward_finish__:!1});if(e)return;if(await le()){let r=await R.inviteFinish();r.is_invited&&r.is_rewarded&&(k({userIsInvited:!0,inviteRewardConfig:{"gpt3.5":r.reward.GPT3Dot5Count,gpt4:r.reward.GPT4Count}}),r.already_rewarded||k({__show_invited_reward__:!0})),k({__invited_reward_finish__:!0})}},1e4);function je(e,t=0){return Nf(e,async()=>{switch(e){case"getVipPeriodInfo":await R.getVipPeriodInfo();break;case"getVipInfo":await R.getVipInfo();break;case"getUserInfo":await R.getUserInfo();break;case"getUserStatus":await R.getUserStatus();break;case"pullSettingsFromCloud":await Mp();break;case"inviteFinishCallback":await Rp();break;case"getPricingPlan":await R.getPricingPlan();break;case"getAllPromptList":await R.getAllPromptList();break;case"getClientConfig":await R.getClientConfig();break;case"getVoiceRoleList":await R.getVoiceRoleList();break;case"getDomainPool":await zf();break;default:break}},t)()}async function Pa(e){await ae("__manual_logout__"),await qa();let t=await le();k({logged:t}),qp([],e)}async function qp(e,t){let r=await le(),i=[{name:"getAllPromptList",cacheDuration:1/0},{name:"getPricingPlan",cacheDuration:864e5},{name:"getClientConfig",cacheDuration:1/0},{name:"getDomainPool",cacheDuration:1/0},...r?[{name:"getVipPeriodInfo",cacheDuration:864e5},{name:"getUserInfo",cacheDuration:864e5},{name:"getUserStatus",cacheDuration:864e5},{name:"getVipInfo",cacheDuration:1/0},{name:"pullSettingsFromCloud",cacheDuration:1/0},{name:"getVoiceRoleList",cacheDuration:6048e5},{name:"inviteFinishCallback",cacheDuration:1/0}]:[]],o=e&&e.length>0?i.filter(n=>e.includes(n.name)):i;await _a(o.map(n=>je(n.name,n.cacheDuration)))}async function _a(e){let t=[];(await Promise.allSettled(e)).forEach(A=>{if(A.status==="rejected"){let i=A.reason?.message;i&&t.push(i)}}),t.length>0?await k({__requestDataFailedJobNames__:t}):await ae("__requestDataFailedJobNames__")}async function Tp(){return(await _p()).length>0}async function _p(){let{__requestDataFailedJobNames__:e}=await M({__requestDataFailedJobNames__:[]});return e}async function Pp(){let e=await _p();e.length>0&&await qp(e)}var Op=G(K());async function Jp(){let e={},t=["p","p1","p2"],r=Ie?`https://*.microsoft.com/*${Xr}*`:`https://*.google.com/*${Xr}*`,A=await Op.default.tabs.query({url:r,currentWindow:!0});if(A.length){A.reverse();for(let i of A){let o=i.url||z.origin,{searchParams:n}=new URL(o),a=!1;for(let[s,g]of n.entries())t.includes(s)&&g&&(a=!0,e[s]=g);if(a)break}}if(Object.keys(e).length>0)for(let[i,o]of Object.entries(e))await Hn(i==="p"?"source":i,o,7);else for(let i of t){let o=await yi(i==="p"?"source":i);o&&(e[i]=o)}if(Object.keys(e).length){R.adStat({action:"install-sider-successfully",source:e.p||"",p1:e.p1||"",p2:e.p2||""});let i=p0(e.p1||""),o={installByAD:!0,onBoardFrom:i};(i==="grammar"||i==="translate"||i==="write"||i==="ocr")&&(o.lastTab=i==="write"?"compose":i),await k(o)}}function p0(e){return e.includes("ytb")?"ytb":e.includes("translate")?"translate":e.includes("ocr")?"ocr":e.includes("write")?"write":e.includes("bgremover")?"bgremover":e.includes("chatpdf")?"pdf":e.includes("summarizer")?"summary":e.includes("grammar")?"grammar":e.includes("image")?"painter":e.includes("email")?"email":""}var Oa=G(K());var Kp="OpenAI";async function B0(e,t){let r=await Oa.default.storage.local.get("provider:gpt3"),{apiKey:A,enableCustomURL:i,customURL:o}=r["provider:gpt3"];if(A){let n=i&&o?Di(o):C0;return fetch(n+t,{method:e,headers:{"Content-Type":"application/json",Authorization:`Bearer ${r["provider:gpt3"].apiKey}`}}).then(a=>a.json())}else return!1}async function Lp(){return B0("GET","/v1/models")}var C0="https://api.openai.com",eo=class{constructor(t,r,A){this.token=t;this.model=r;this.url=A;this.token=t,this.model=r,this.url=A}async generateAnswer(t){let r="",A=xt(this.url?this.url:"https://api.openai.com","/v1","/chat/completions"),i=await Oa.default.storage.local.get({enableCustomModelName:!1,customModelName:""}),o={model:i.enableCustomModelName&&i.customModelName?i.customModelName:t.model||this.model,stream:!0};Array.isArray(t.prompt)?o.messages=t.prompt:o.messages=[{role:"user",content:t.prompt}],await Fr(A,{method:"POST",signal:t.signal,headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.token}`},body:JSON.stringify(o),onMessage(n){if(n==="[DONE]"){t.onEvent({type:"done"});return}let a;try{a=JSON.parse(n);let s=a.choices[0].delta.content;if(s==="<|im_end|>"||s==="<|im_sep|>"||!s)return;r+=s,t.onEvent({type:"answer",data:{text:r,messageId:a.id,conversationId:""}})}catch{return}}}).catch(n=>{let a=n.message;try{let s=JSON.parse(a);if(a=s.message||s.msg||s.error?.message||s.detail?.message||a,[502,503].includes(s.responseStatus))throw new Error(`${Kp}: error_service_unavailable`)}catch{}throw new Error(`${Kp}: ${a}`)})}};var zp=G(K());var to=class{constructor(){this.results=[];this.lastText="";this.lastTextIndex=-1}parse(t){return t.type==="text"?this.handleTextMsg(t):t.type==="tool_call"?this.handleToolCallMsg(t):t.type==="llm_status"?this.handleLLMStatusMsg(t):t.type==="image"?this.handleImageMsg(t):t.type==="data_analysis_image"?this.handleDataAnalysisImage(t):t.type==="key_moments"?this.handleKeyMomentsMsg(t):t.type==="file_highlight"?this.handleFileHighlightMsg(t):t.type==="notification"&&this.handleNotificationMsg(t),t.type!=="text"&&(this.lastText="",this.lastTextIndex=-1),this.results}getLastResult(){return this.results[this.results.length-1]}handleLLMStatusMsg(t){let r=t.llm_status.id,A=this.results.findIndex(i=>i.id===r);this.results[A]?this.results[A]={...t.llm_status}:this.results.push({type:"llmStatus",id:r,status:t.llm_status.status,data:t.llm_status.data})}handleNotificationMsg(t){this.results.push({type:"notification",id:ee(),notification:t.notification})}handleKeyMomentsMsg(t){t.key_moments&&this.results.push({type:"videoKeyMoments",keyMoments:t.key_moments,id:ee()})}handleTextMsg(t){if(t.text)if(this.lastText){let r=this.lastText+t.text,A=Yp(r),i=this.results.splice(this.lastTextIndex),o=h0(i,A.map(n=>({type:n.type==="markdown"?"text":n.type==="artifact"?"artifact":"thinking",text:n.type==="artifact"?n.content.replace(/^\n```(.*)\n/,`
`).replace(/```\n$/,`
`).replace(/^```(.*)\n/,`
`).replace(/```$/,`
`):n.content,attrs:n.type==="artifact"?n.attributes:{},status:n.type==="artifact"||n.type==="thinking"?n.isFinished?"finish":"start":void 0,id:ee()})));this.results=this.results.concat(o),this.lastText=r}else{if(t.text.trim()===""){this.lastText=t.text,this.results.push({type:"text",text:t.text,id:ee()}),this.lastTextIndex=this.results.length-1;return}let r=Yp(t.text);/<Thinking/.test(t.text)&&r.length===0&&r.push({type:"thinking",content:"",isFinished:!1}),/<Artifact/.test(t.text)&&r.length===0&&r.push({type:"artifact",content:"",attributes:{},isFinished:!1}),this.results=this.results.concat(r.map(A=>({type:A.type==="markdown"?"text":A.type==="artifact"?"artifact":"thinking",text:A.type==="artifact"?A.content.replace(/^\n```(.*)\n/,`
`).replace(/```\n$/,`
`).replace(/^```(.*)\n/,`
`).replace(/```$/,`
`):A.content,attrs:A.type==="artifact"?A.attributes:{},status:A.type==="artifact"||A.type==="thinking"?A.isFinished?"finish":"start":void 0,id:ee(),createAt:Date.now()}))),this.lastTextIndex=this.results.length-1,this.lastText=t.text}}handleToolCallMsg(t){let r=t.tool_call.id+(t.tool_call.data&&typeof t.tool_call.data.tool_call_id<"u"?t.tool_call.data.tool_call_id:"");if(t.tool_call.status==="start")this.results.push({type:"toolCall",id:r,status:t.tool_call.status,name:t.tool_call.name,data:t.tool_call.data});else if(t.tool_call.status==="processing"){let A=this.results.findIndex(o=>o.id===r),i=this.results[A];i&&(i.data={...i.data,...t.tool_call.data})}else if(t.tool_call.status==="finish"||t.tool_call.status==="fail"){let A=this.results.findIndex(o=>o.id===r),i=this.results[A];i&&(i.data={...i.data,...t.tool_call.data},i.status=t.tool_call.status)}}handleImageMsg(t){this.results.push({type:"siderImage",id:ee(),images:t.images.images})}handleDataAnalysisImage(t){this.results.push({type:"siderImage",id:ee(),images:[t.data_analysis_image]})}handleFileHighlightMsg(t){this.results.push({type:"fileHighlights",id:ee(),highlights:t.highlights})}};function Yp(e,t){let r=e.split(/(<Artifact[^>]*>?|<\/Artifact>|<Thinking>|<\/Thinking>)/),A=!1,i=!1,o={},n=[],a="",s=null,g=null,I=null,l="";for(let c=0;c<r.length;c++){let u=r[c];u.startsWith("<Artifact")?(a&&(n.push({type:"markdown",content:a.trim()}),a=""),u.endsWith(">")?(A=!0,o=Q0(u),g={type:"artifact",content:"",attributes:o,isFinished:!1},t&&o.id===t&&(s=g)):l=u):u==="</Artifact>"?A&&g?(A=!1,g.isFinished=!0,g.content=g.content.trim(),s!==g&&n.push(g),g=null):l+=u:u==="<Thinking>"?(a&&(n.push({type:"markdown",content:a.trim()}),a=""),i=!0,I={type:"thinking",content:"",isFinished:!1}):u==="</Thinking>"?i&&I&&(i=!1,I.isFinished=!0,I.content=I.content.trim(),n.push(I),I=null):A?g&&(g.content+=u):i?I&&(I.content+=u):l?(l+=u,l.includes("<Artifact")||(a+=l,l="")):a+=u}return a&&n.push({type:"markdown",content:a.trim()}),g&&n.push(g),I&&n.push(I),s||(t?null:(n=n.filter(c=>!(c.type==="markdown"&&c.content.trim()==="")),n))}function Q0(e){let t={},r=/(\w+)\s*=\s*(?:"([^"]*)"|'([^']*)'|([^>\s]+))/g,A;for(;(A=r.exec(e))!==null;){let[,i,o,n,a]=A;t[i]=o||n||a}return t}function h0(e,t){if(e.length>t.length)return e;let r=[...e],A=t.length,i=Math.max(0,e.length-A);for(let o=0;o<A;o++){let n=i+o;if(n<r.length)for(let a in t[o])a!=="id"&&(r[n][a]=t[o][a]);else r.push({...t[o]})}return r}function Vp(e){return/\${\s*(lang)\s*}/gi.test(e)}var ro=class{constructor(t){this.token="";this.refreshToken="";this.anonymous=!0;this.checkFileStatusTimer=null;this.cid=t}async getToken(){let t=await bt();this.token=t.token,this.refreshToken=t.refreshToken,this.anonymous=t.anonymous}async generateAnswer(t){let r={},A=null,i={};try{await this.getToken()}catch(p){throw new Error(p.errMsg)}if(!this.cid&&t.historyMsg)try{let{cid:p,lastMsgId:N}=await R.uploadHistoryMsg(t.historyMsg);this.cid=p,this.tempLastMsgId=N}catch(p){throw new Error(p.errMsg)}let{[Zr]:{model:o}}=await M({[Zr]:{model:"sider"}}),n=t.model||o,a="",s="",g=!1;function I(){!g&&a&&s&&R.statUserStop(a,s),A&&clearInterval(A)}t.getCleanupMethod?.(I);async function l(p){let N=p.join(","),{text_ready:S}=await R.getFileStauts(N);return S}async function c(p){let{handle_msg:N,is_embedding:S}=await R.getFileStauts(p),x=null;if(S)try{x=JSON.parse(N)}catch{if(N)throw new Error(N)}else x={accept_model:{"gpt-3.5":!0,"gpt-4":!0,"gpt-4o":!0,"gpt3.5-16k":!0,"claude-instant":!0,claude2:!0,"claude-3-haiku":!0,"claude-3-sonnet":!0,"claude-3.5-sonnet":!0,"claude-3-opus":!0,bard:!0,"gemini-pro":!0,"gemini-1.5-pro":!0,"gemini-1.5-flash":!0,gpts:!0,"llama-3":!0}};return x}async function u(p,N){let{fileTextStatus:S}=await zp.default.storage.local.get({fileTextStatus:{}});if(p.filter(U=>S[U]).length===p.length)return null;let x=await l(p);return x?(jr(p,!0),null):new Promise((U,E)=>{A=setInterval(async()=>{try{x=await l(p),x&&(jr(p,!0),A&&(clearInterval(A),U(null)))}catch(v){throw A&&clearInterval(A),new Error(v)}},1e3)})}t.eids&&t.sPromptTmpl&&!t.sPromptTmpl.key.includes("audio")&&await u(t.eids,n).catch(p=>{throw new Error("Getting file status error: "+p.toString())});let C=async(p,N,S)=>{try{return await Fr(p,{method:"POST",signal:t.signal,headers:{"Content-Type":"application/json",Authorization:this.token},body:JSON.stringify(N),onMessage(x){if(x=="[DONE]"){g=!0,t.onEvent({type:"done"});return}let U=JSON.parse(x);if(U.code!==0)throw new Error(JSON.stringify({code:U.code,msg:U.msg||U.message}));a=U.data.cid,s=U.data.message_id,k({lastMessageId:s}),S(U.data)}})}catch(x){let U=x.message,E=null;try{E=JSON.parse(U)}catch{}aA(E?.code,E?.msg||E?.message||U)}};function m(){let p={},N=t.autoTools||[];(t.freeTrailTool==="artifacts"||t.freeTrailTool==="thinking_mode")&&!N.includes(t.freeTrailTool)&&N.push(t.freeTrailTool);let S=t.sPromptTmpl?[t.sPromptTmpl]:[];if(!S.length){let x=[];(N.includes("artifacts")||N.includes("thinking_mode"))&&(N.includes("artifacts")&&x.push({key:"artifacts",attributes:{lang:"original"}}),N.includes("thinking_mode")&&x.push({key:"thinking_mode",attributes:{}}),S=x)}return p.auto=N.filter(x=>x!=="artifacts"&&x!=="thinking_mode"),t.forceSearch?p.force="search":S&&(Array.isArray(S)?S.length>0&&!S.some(x=>x?.key==="artifacts"||x?.key==="thinking_mode"):S&&S.key!=="artifacts"&&S.key!=="thinking_mode")&&(p.force="reader"),t.forceTool&&(p.force=t.forceTool),t.freeTrailTool&&(p.free_trial_tool=t.freeTrailTool,!p.force&&t.freeTrailTool!=="artifacts"&&t.freeTrailTool!=="thinking_mode"&&(p.force=t.freeTrailTool)),{tools:p,sPromptTmpl:S}}let y=new Fi,h=await gt(),F=await yr(),{outputLanguage:b}=await M({outputLanguage:""}),d=Date.now(),w=0,{tools:f,sPromptTmpl:Q}=m();await C(`${F}/v3/completion/text`,{system:t.system,prompt:t.prompt,stream:!0,app_name:T,app_version:ce,tz_name:Ae,cid:this.cid,model:n,search:t.forceSearch,auto_search:t.autoSearch,filter_search_history:t.filterSearchHistory,from:t.from,re_answer_by_mid:t.sReqId,group_id:t.from==="chat"?"default":void 0,prompt_key:t.promptKey||void 0,chat_models:t.chatModels,image_id:t.imageId,eid:t.eid,files:t.eids,force_ocr:t.forceOcr,ocr_option:t.ocrOption,prompt_template:Q.length===1&&Q[0]&&!Q[0].key.includes("video-summarize")&&!Q[0].key.includes("audio-summarize")?Q[0]:void 0,prompt_templates:Q.length>1?Q:void 0,deep_search:t.deepSearch,tools:f,extra_info:{origin_url:h?.url,origin_title:h?.title},video_summarize:t.sPromptTmpl?.key.includes("video-summarize")?{enable:!0,language:b&&b!=="auto"?hi[b].toLocaleUpperCase():t.sPromptTmpl?.attributes.lang}:void 0,audio_summarize:t.sPromptTmpl?.key.includes("audio-summarize")?{enable:!0,language:b&&b!=="auto"?hi[b].toLocaleUpperCase():t.sPromptTmpl?.attributes.lang}:void 0,search_option:t.searchOption,output_language:b&&await m0(t.from,t.promptKey)?b.replace("_","-"):void 0,parent_message_id:this.tempLastMsgId?this.tempLastMsgId:t.parentMessageId?t.parentMessageId:void 0,branch:!0},p=>{if(!p)return;if(typeof p.total<"u"){let U=p.chat_model?p.chat_model:n;p.quota_type==="fast_text"?U="gpt-3.5":p.quota_type==="advanced_text"&&(U="gpt-4");let E={[U]:{total:p.total,remain:p.remain,extraTotal:p.extra_total,extraRemain:p.extra_quota,period:p.remain_period,used:p.used}};$n().then(v=>{let H=v[U];(H.remain!==E[U].remain||H.extraRemain!==E[U].extraRemain||H.period!==E[U].period||H.extraTotal!==E[U].extraTotal||H.total!==E[U].total||H.used!==E[U].used||H.period!==E[U].period)&&(H.remain+H.extraRemain>E[U].remain+E[U].extraRemain||H.used!==E[U].used||p.type==="quota")&&y.run(()=>lt(E))})}p.type==="feature_used"&&p.feature_info&&ct(p.quota_type==="fast_text"?"gpt-3.5":"gpt-4",p,p.feature_info);let N=p.text,S=p.chat_model||n;(N||p.type!=="pulse")&&(w===0&&(w=Date.now()-d),r[S]||(r[S]=""),i[S]||(i[S]={parser:null,contents:[]},i[S].parser=new to),N&&(r[p.chat_model]+=N),i[S].contents=i[S].parser.parse(p),t.onEvent({type:"answer",data:{text:r[S],contents:i[S].contents,messageId:p.message_id,serverRequestId:p.req_message_id,conversationId:p.cid,chatModel:p.chat_model}})),p.code&&p.code!==0&&t.onEvent({type:"error",data:{error:ea(p.code,p.msg),chatModel:p.chat_model||n}}),p.done&&t.onEvent({type:"done",data:{chatModel:p.chat_model||n,done:!0}}),p.type==="tool_call"&&p.tool_call.name==="search"&&t.onEvent({type:"searchKeywords",data:{searchKeywords:p.tool_call.data.keywords,searchSnippets:p.tool_call.data.snippets,chatModel:p.chat_model}}),p.type==="deep_search"&&t.onEvent({type:"deepSearch",data:{deep_search:p.deep_search,cid:p.cid,message_id:p.message_id}})});try{Kf.report("send_message",{conversation_id:this.cid,model:t.chatModels&&t.chatModels?.length>0?t.chatModels.join(","):n,prompt_id:t.promptKey||t.sPromptTmpl?.key,uploaded_files:t.eids?.join(","),tool_enabled:f.auto.join(",")})}catch{}}};async function m0(e,t){if(e==="translate"||e==="writing"||e==="ocr")return!1;if(!t)return!0;if(t.startsWith("translate"))return!1;let r=await J("allPromptList");if(r){let A=r.find(i=>{let o=i.key||i.id;return t===o});if(A)return Vp(A.content)?!0:A.isCustom}return!0}var Xp=Ee(ze(async()=>{await le()&&(await Tp()&&await Pp(),await Promise.allSettled([je("getVipInfo",30*6e4),je("pullSettingsFromCloud",6*36e5),je("getAllPromptList",6*36e5),je("getClientConfig",36e5),je("getDomainPool",30*6e4)]))}),5e3,{leading:!0});var Ka=G(K());function Zp(e){Ka.default.storage.local.get({userClickedWidgets:[]}).then(t=>{let r=e.filter(A=>!t.userClickedWidgets.includes(A));Ka.default.storage.local.set({needShowTipWidgets:r})})}Hp();vp();B.default.runtime.onStartup.addListener(()=>{B.default.storage.local.remove("searchAgentSuggestionsCache"),Pa()});async function E0(e,{system:t,question:r,type:A,cid:i,historyMsg:o,model:n,chatModels:a,pluginIds:s,forceSearch:g,autoSearch:I,filterSearchHistory:l,from:c,promptKey:u,imageId:C,eids:m,forceOcr:y,ocrOption:h,forceProvider:F,sPromptTmpl:b,parentMsgId:d,chatgptFiles:w,actionData:f,autoTools:Q,forceTool:p,deepSearch:N,sReqId:S,searchOption:x,parentMessageId:U,freeTrailTool:E}){let v=await Bf(),H,q=F||v.provider;if(q==="chatgpt"){let se=await ue({onRefresh:()=>e.postMessage({event:"GUARD_TAB_REFRESHING"}),throwGuideError:!0});H=new _i(se)}else if(q==="gpt3"){let{apiKey:se,enableCustomURL:Gt,customURL:Ur,model:Ya}=v.configs.gpt3,$p=Gt&&Ur?Di(Ur):"";H=new eo(se,Ya||Nn,$p)}else if(q==="siderApi")H=new ro(i);else throw new Error(`Unknown provider ${q}`);let L=()=>{},pe=new AbortController;e.onDisconnect.addListener(()=>{pe.abort(),L?.()}),await H.generateAnswer({system:t,prompt:r,type:A,signal:pe.signal,historyMsg:o,pluginIds:s,onEvent(se){if(se.type==="done"){se.data?.chatModel?e.postMessage(se.data):e.postMessage({event:"DONE"});return}e.postMessage(se.data)},getCleanupMethod(se){L=se},forceSearch:g,autoSearch:I,filterSearchHistory:l,from:c,promptKey:u,model:n,chatModels:a,imageId:C,eids:m,forceOcr:y,ocrOption:h,sPromptTmpl:b,cid:i,parentMsgId:d,chatgptFiles:w,actionData:f,autoTools:Q,forceTool:p,deepSearch:N,sReqId:S,searchOption:x,parentMessageId:U,freeTrailTool:E})}var y0=async e=>{let t=await J("webAppModelsLastUpdateTime"),r=await J("webAppModels");if(e||!r||!t||t-Date.now()>1e3*60*60*24)return Promise.all([zd(),Wd()]).then(([A,i])=>{let o=i.gizmos.reduce((a,s)=>(a[s.resource.gizmo.id]=s,a),{}),n=i.gizmos.map(a=>a.resource.gizmo.id);return B.default.storage.local.get(["webAppGPTs","selectWebAppModel"]).then(a=>{let g={...a.webAppGPTs||{},...o};hf.forEach(l=>{g[l]||(g[l]=mf[l])});let I={webAppGPTsList:n,webAppGPTs:g,webAppModels:A.models,webAppModelsLastUpdateTime:Date.now()};return a.selectWebAppModel||(A.models.some(l=>l.slug==="gpt-4")?I.selectWebAppModel="gpt-4":I.selectWebAppModel="text-davinci-002-render-sha"),B.default.storage.local.set(I)})})},w0=()=>Lp().then(async e=>{if(e.data){let t=e.data.map(i=>({name:i.id})),r=await J("provider:gpt3"),A={apiModels:t};return r&&r.model&&(t.find(i=>i.name===r.model)||(A["provider:gpt3"]={...r,model:Nn})),B.default.storage.local.set(A)}else return e.error?.message||"error"}),La=null;B.default.runtime.onConnect.addListener(e=>{if(e.name==="artifacts-page"){La&&clearTimeout(La),e.onDisconnect.addListener(()=>{La=setTimeout(()=>{B.default.storage.local.remove("artifactsData")},500)});return}if(e.name==="sidepanel"){e.onDisconnect.addListener(()=>{B.default.storage.local.set({sidebarLastCloseTime:Date.now(),webAppNetwork:null}),B.default.storage.local.remove("chatRequirements")}),e.onMessage.addListener(r=>{});return}Ln(e)||e.onMessage.addListener(async r=>{try{await E0(e,{system:r.system,question:r.question,type:r.type,cid:r.cid,historyMsg:r.historyMsg,chatModels:r.chatModels,model:r.model,pluginIds:r.pluginIds,autoSearch:r.autoSearch,forceSearch:r.forceSearch,filterSearchHistory:r.filterSearchHistory,from:r.from,promptKey:r.promptKey,imageId:r.imageId,eids:r.eids,forceOcr:r.forceOcr,ocrOption:r.ocrOption,forceProvider:r.forceProvider,sPromptTmpl:r.sPromptTmpl,parentMsgId:r.parentMsgId,chatgptFiles:r.chatgptFiles,actionData:r.actionData,autoTools:r.autoTools,forceTool:r.forceTool,deepSearch:r.deepSearch,sReqId:r.sReqId,searchOption:r.searchOption,parentMessageId:r.parentMessageId,freeTrailTool:r.freeTrailTool})}catch(A){e.postMessage({error:A.message})}})});ki("email-enhance-reply",e=>{e.onMessage(t=>{rd(t,{signal:e.signal,onStream(r){r.done?(e.send({done:!0}),e.close()):e.send({data:r.data})}}).catch(r=>{r.name!=="AbortError"&&(e.send({error:Vr(r)}),e.close())})})});ki("email-enhance-summary",e=>{e.onMessage(t=>{td(t,e.signal).then(r=>e.send({data:r})).catch(r=>{r.name!=="AbortError"&&e.send({error:Vr(r)})}).finally(()=>e.close())})});B.default.runtime.onMessage.addListener(async(e,t)=>{let r=Kn(e,t);if(r)return r;switch(e.type){case"FEEDBACK":{let A=await ma();await Vd(A,e.data);break}case"OPEN_OPTIONS_PAGE":{Rn(e.section,e.hash,e.otherParams);break}case"GET_ACCESS_TOKEN":return ma();case"SEND_CHATGPT":return Dd({prompt:e.promt});case"IS_CHAT_LOGIN":return vf().then(A=>{t.tab?.id&&B.default.tabs.sendMessage(t.tab.id,{type:"CHAT_LOGIN_STATE",value:A}),B.default.runtime.sendMessage({type:"CHAT_LOGIN_STATE",value:A})});case"POPUP_OPEN":return QA(e.isShow);case"OPEN_URL_IN_NEW_TAB":return B.default.tabs.create(e.details);case"OPEN_URL":{B.default.tabs.create({url:e.url});break}case"UPDATE_TAB":return Df(e.queryInfo,e.updateDetails);case"RELOAD_TAB":return wi(e.queryInfo,!0);case"SWITCH_TAB":return wi(e.queryInfo);case"GET_TAB_ZOOM":return B.default.tabs.getZoom();case"IS_ALLOWED_FILE_SCHEME_ACCESS":return Sf();case"GET_CHATGPT_MODELS":return y0(e.isForce);case"GET_API_MODELS":return w0();case"GET_COOKIE":try{let A=await B.default.cookies.get(e.data);return A?.value?decodeURIComponent(A.value):""}catch(A){return Promise.reject(A)}case"SET_COOKIE":try{return await B.default.cookies.set(e.data)}catch(A){return Promise.reject(A)}case"CHECK_SCHEDULE_JOB":{Xp();break}case"REFRESH_VIP_INFO":{kt(async()=>{if((await R.getVipInfo()).isVIP){k({lastUpgradeTime:Date.now()});let{autoTools:i,isDoneAutoToolsAction:o}=await B.default.storage.local.get(["autoTools","isDoneAutoToolsAction"]);(i===void 0||i&&i.length===0)&&!o&&k({autoTools:Ef,isDoneAutoToolsAction:!0})}else throw new Error("")},2e3);break}case"UPDATE_USERINFO":{await R.getUserInfo();break}case"USER_LOGIN":{await k(Object.keys(jn).reduce((A,i)=>{let o=e?.data[i];return o&&(A[i]=o),A},{})),await ae(["__manual_logout__","__force_logout_reason__"]),await k({logged:!0});break}case"USER_LOGOUT":{await nA();break}case"FORWARD_TO_CHAT":{B.default.runtime.sendMessage({type:"is-sidepanel-open"}).then(A=>{if(A)return B.default.runtime.sendMessage({...e,type:"SEND_TO_CHAT",isForSidepanel:!0});B.default.tabs.sendMessage(t.tab?.id,{...e,type:"SEND_TO_CHAT"})}).catch(()=>{B.default.tabs.sendMessage(t.tab?.id,{...e,type:"SEND_TO_CHAT"})});return}case"CONTINUE_IN_CHAT":{B.default.runtime.sendMessage({type:"is-sidepanel-open"}).then(A=>{if(A)return B.default.runtime.sendMessage({...e,type:"DO_CONTINUE_IN_CHAT",isForSidepanel:!0});B.default.tabs.sendMessage(t.tab?.id,{...e,type:"DO_CONTINUE_IN_CHAT"})}).catch(()=>{B.default.tabs.sendMessage(t.tab?.id,{...e,type:"DO_CONTINUE_IN_CHAT"})});return}case"SEND_MSG_IN_CHAT":{B.default.runtime.sendMessage({type:"is-sidepanel-open"}).then(A=>{if(A)return B.default.runtime.sendMessage({...e,type:"DO_SEND_MSG_IN_CHAT",isForSidepanel:!0});B.default.tabs.sendMessage(t.tab?.id,{...e,type:"DO_SEND_MSG_IN_CHAT"})}).catch(()=>{B.default.tabs.sendMessage(t.tab?.id,{...e,type:"DO_SEND_MSG_IN_CHAT"})});return}case"CHECK_PINNED":return!!(await B.default.action.getUserSettings())?.isOnToolbar;case"OPEN_CHAT_PAGE":return Gf("",()=>{B.default.runtime.sendMessage({type:"switchChat",data:{contact:e.contact||"chat",conversation:e.currentCid}})},()=>k({activeConversation:{contact:e.contact||"chat",conversation:e.currentCid}}));case"QUERY_SELECTION":return B.default.tabs.sendMessage(e.tabId||t.tab?.id,{type:"query-selection",selectionText:e.selectionText});case"TOGGLE_HOST_TRANSLATOR_FAB":return wd(e,t);case"TOGGLE_SIDEBAR":{QA(e.isShow);break}case"GUARD_CHATGPT_TAB":{np();break}case"TOGGLE_TRANSLATOR":B.default.tabs.sendMessage(e.tabId||t.tab?.id,{type:"toggle-translator",show:e.show});break;case"GO_LOGIN":{Zf();break}case"GO_INVITE":{jf();break}case"GET_INVITE_LINK":return R.createInviteLink();case"GET_CHATGPT_PLUGINS":return D0();case"REMOVE_SELECTION":{let A=await gt();A?.id&&B.default.tabs.sendMessage(A.id,{type:"remove-selection"});break}case"SEND_TO_CURRENT_TAB":{let A=await gt();A?.id&&B.default.tabs.sendMessage(A.id,e.data);break}case"CAPTURE_VISIBLE_TAB":return B.default.tabs.captureVisibleTab(void 0,{format:"jpeg"});case"RUNTIME_FORWARD_MSG":return B.default.runtime.sendMessage(e.msg);case"FORWARD_MSG":{let A=await gt();if(A?.id)return B.default.tabs.sendMessage(A.id,e);break}case"FORWARD_TO_CONTENT":{let A=await gt();if(A?.id){let i=e.subtype;return delete e.type,delete e.subtype,B.default.tabs.sendMessage(A.id,{type:i,...e})}break}case"FORWARD_MSG_TO_SELF":return B.default.runtime.sendMessage({...e,type:e.originalType});case"GET_SRC_SUFFIX":{let A="",i=await jp();i.length||await R.signImageCookie(),i=await jp();let o=i.join("&");return A=o?"?"+o:"",A;break}case"CLEAR_BADGE":return wa();case"GA_API":return R.googleAnalytics(...Array.from(e.args));case"SIDER_STAT_API":return Vn(...Array.from(e.args));case"DETECT_PAGE_LANGUAGE":return(await B.default.tabs.detectLanguage()).replace("-","_");case"TRANSLATION_CACHE":{let A=ad();if(e.action==="get")return await Promise.all(e.keys.map(i=>A.getData(i)));if(e.action==="set")return await Promise.all(e.values.map(i=>A.setData(i)));if(e.action==="clear")return await A.clearData();break}case"DEMO_TTS_CACHE":{let A=sd();if(e.action==="get")return await A.getData(e.key);if(e.action==="set")return await A.setData(e.value);if(e.action==="clear")return await A.clearData();break}case"GET_PROMOTE_DATA":{yd().then(A=>{let i={type:"PROMOTE_DATA",data:A};return t.tab?.id?B.default.tabs.sendMessage(t.tab.id,i):B.default.runtime.sendMessage(i)});break}case"GET_IMAGE":return ha(e.id).then(A=>A);case"GET_CHATGPT_UPLOAD_URL":return Zd(e.data,e.isMyFile);case"REPORT_CHATGPT_FILE_UPLOADED":return jd(e.fileId);case"GET_CHATGPT_FILE_STATUS":return Ap(e.fileId);case"GET_INTERPRETER_DOWNLOAD_URL":return $d(e.data);case"GET_IS_SIDEPANEL_OPEN":return B.default.runtime.getContexts?B.default.runtime.getContexts({contextTypes:["SIDE_PANEL"]}).then(A=>A.length>0):!1;case"OPEN_SIDEPANEL":return F0(t.tab);case"CLOSE_SIDEPANEL":return!B.default.sidePanel||!B.default.sidePanel.setOptions?!1:B.default.sidePanel.setOptions({enabled:!1}).then(()=>B.default.sidePanel.setOptions({enabled:!0}));case"KEEP_GPT_IN_SIDEBAR":return tp(e.id);case"GET_FAVICON":return t.tab?.favIconUrl;case"GET_TABS":return B.default.tabs.query({currentWindow:!0});case"GET_CURRENT_TAB":return gt();case"GET_READABILITY_TEXT_FROM_TAB":return B.default.tabs.sendMessage(e.tabId,{type:"get-readability-text",dryRun:e.dryRun});case"ENSURE_CONTENT":return tA(e.tabId);case"GET_SIDEPANEL_OPEN":return B.default.runtime.getContexts?.({contextTypes:["SIDE_PANEL"]}).then(A=>A.length>0);case"OPEN_ARTIFACT_PAGE":return B.default.runtime.getContexts?.({documentUrls:[st("artifacts.html")]}).then(A=>{A.length===0?Ve({url:"/artifacts.html"}):B.default.windows.getCurrent().then(i=>{A[0].windowId!==i.id?B.default.tabs.move(A[0].tabId,{windowId:i.id,index:-1}).then(()=>{B.default.tabs.update(A[0].tabId,{active:!0})}):B.default.tabs.update(A[0].tabId,{active:!0})})});case"OPEN_ANSWER_COMPARE_PAGE":return B.default.runtime.getContexts?.({documentUrls:[st("answer-compare.html")]}).then(A=>{A.length===0?Ve({url:"/answer-compare.html"}):B.default.windows.getCurrent().then(i=>{A[0].windowId!==i.id?B.default.tabs.move(A[0].tabId,{windowId:i.id,index:-1}).then(()=>{B.default.tabs.update(A[0].tabId,{active:!0})}):B.default.tabs.update(A[0].tabId,{active:!0})})});case"OPEN_BLOCK_PREVIEW_PAGE":return B.default.runtime.getContexts?.({documentUrls:[st("block-preview.html")]}).then(A=>{A.length===0?Ve({url:"/block-preview.html"}):B.default.windows.getCurrent().then(i=>{A[0].windowId!==i.id?B.default.tabs.move(A[0].tabId,{windowId:i.id,index:-1}).then(()=>{B.default.tabs.update(A[0].tabId,{active:!0})}):B.default.tabs.update(A[0].tabId,{active:!0})})});case"OPEN_AUDIO_PREVIEW_PAGE":return B.default.runtime.getContexts?.({documentUrls:[st("audio-preview.html")]}).then(A=>{A.length===0?Ve({url:"/audio-preview.html"}):B.default.windows.getCurrent().then(i=>{A[0].windowId!==i.id?B.default.tabs.move(A[0].tabId,{windowId:i.id,index:-1}).then(()=>{B.default.tabs.update(A[0].tabId,{active:!0})}):B.default.tabs.update(A[0].tabId,{active:!0})})});case"CLEAR_ARTIFACTS_DATA":return B.default.storage.local.remove("artifactsData");case"UPLOAD_ROAST":{let{obj:A,siteType:i}=e,o=`https://roast-vs-boast.${z.domain}/api/combined_agent_direct`;return i==="facebook"?o=`https://roast-vs-boast.${z.domain}/api/facebook/roast`:i==="instagram"&&(o=`https://roast-vs-boast.${z.domain}/api/instagram_agent_direct`),fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({data:e.obj})}).then(n=>n.json())}default:break}return new Promise(A=>{setTimeout(()=>{A()},32)})});async function jp(){return(await B.default.cookies.getAll({domain:z.domain})).filter(t=>t.name.startsWith("CloudFront-")&&t.domain==="."+z.domain).map(t=>t.name.split("CloudFront-")[1]+"="+t.value)}ye("open-standalone-page",()=>$r());ye("detect-language",({data:e,sender:t})=>B.default.tabs.detectLanguage(e??t.tab?.id));ye("get-window-value",async({data:{tabId:e,keys:t},sender:r})=>{let A=e==="sender"?r.tab?.id:e;if(A===void 0)throw new Error("tabId is required");return B.default.scripting.executeScript({args:[t],target:{tabId:A},func:i=>{let o={};e:for(let[n,a]of Object.entries(i)){let s=window;for(let g of a){if(s==null){o[n]=void 0;continue e}s=s[g]}o[n]=s}return o},world:"MAIN"}).then(([i])=>{if(!i)throw new Error("executeScript failed");let{error:o,result:n}=i;if(o)throw o instanceof Error?o:new Error("executeScript failed: unknown error");return n})});ye("detect-youtube-ad",async({data:{tabId:e},sender:t})=>{let r=e==="sender"?t.tab?.id:e;if(r===void 0)throw new Error("tabId is required");return B.default.scripting.executeScript({target:{tabId:r},func:()=>{let A=document.querySelector("#movie_player");if(!A)return;function i(o,n){let a=new CustomEvent("sider-onYoutubeChange",{detail:{eventName:o,value:n}});window.dispatchEvent(a)}A.addEventListener("onAdStateChange",o=>{i("onAdStateChange",o)}),A.addEventListener("onStateChange",o=>{i("onStateChange",o)})},world:"MAIN"}).then(([A])=>{if(!A)throw new Error("executeScript failed");let{error:i,result:o}=A;if(i)throw i instanceof Error?i:new Error("executeScript failed: unknown error");return o})});ye("get-webpage-chatgpt-message",async({data:e,sender:t})=>{let r=t.tab?.id,A=e;if(r===void 0)throw new Error("tabId is required");return B.default.scripting.executeScript({target:{tabId:r},args:[A],func:i=>{let o=document.querySelector(`article[data-testid="conversation-turn-${i}"] [data-message-author-role][data-message-id]`);if(!o)throw new Error("message element not found");let n=Object.keys(o).find(l=>l.startsWith("__reactFiber$"));if(!n)throw new Error("fiber key not found");let a=o[n];if(!a)throw new Error("fiber not found");let s,g,I=20;for(;a&&I>0;){if(Array.isArray(a.memoizedProps.messages)&&(s=a.memoizedProps.messages),Array.isArray(a.memoizedProps.groupedMessagesToRender)&&(g=a.memoizedProps.groupedMessagesToRender),s&&g)return{messages:s,groupedMessagesToRender:g};a=a.return,I--}throw new Error("messages not found")},world:"MAIN"}).then(([i])=>{if(!i)throw new Error("executeScript failed");let{error:o,result:n}=i;if(o)throw o instanceof Error?o:new Error("executeScript failed: unknown error");return n})});ye("get-value-from-react-fiber",async({data:e,sender:t})=>{let r=t.tab?.id,{propName:A,querySelector:i,querySelectorAll:o,maxDepth:n=999}=e;if(r===void 0)throw new Error("tabId is required");if(!i&&!o)throw new Error("querySelector or querySelectorAll is required");if(!A)throw new Error("propName is required");return B.default.scripting.executeScript({target:{tabId:r},args:[i??null,o??null,A,n],func:(a,s,g,I)=>{let l=s?document.querySelectorAll(s):[document.querySelector(a)],c=[];for(let u of l){let C=0,m=Object.keys(u).find(h=>h.startsWith("__reactFiber$"));if(!m)continue;let y=u[m];for(;y&&!(y.memoizedProps&&Object.hasOwn(y.memoizedProps,g))&&C<I;)y=y.return,C++;y&&y.memoizedProps&&Object.hasOwn(y.memoizedProps,g)&&c.push(y.memoizedProps[g])}if(c.length)return c;throw new Error("value not found")},world:"MAIN"}).then(([a])=>{if(!a)throw new Error("executeScript failed");let{error:s,result:g}=a;if(s)throw s instanceof Error?s:new Error("executeScript failed: unknown error");return g})});ye("get-google-doc-content",({sender:e})=>{let t=e.tab?.id;if(t===void 0)throw new Error("tabId is required");return B.default.scripting.executeScript({target:{tabId:t},func:async()=>{function r(i,o){o.add(i),Array.isArray(i)||(i=Object.values(i));for(let n of i)if(n&&!(typeof n!="string"&&typeof n!="object")&&!o.has(n)){if(o.add(n),typeof n=="string"&&n[0]===""&&n[n.length-1]===`
`)return n;{let a=r(n,o);if(a)return a}}}let A=Reflect.get(document,"__wizmanager");if(A)return r(A,new Set)},world:"MAIN"}).then(([r])=>{if(!r)throw new Error("executeScript failed");let{error:A,result:i}=r;if(A)throw A instanceof Error?A:new Error("executeScript failed: unknown error");return i})});ye("fetch-base64-from-bg",async({data:e})=>{let{url:t}=e,A=await(await fetch(t)).blob();return{base64:await It(A),size:A.size,type:A.type}});ye("get-sender",({sender:e})=>e);chrome&&chrome.sidePanel&&chrome.sidePanel.setPanelBehavior({openPanelOnActionClick:!0}).catch(e=>{});B.default.runtime.onInstalled.addListener(async e=>{if(e.reason==="install"&&(B.default.storage.local.set({installedAt:Date.now(),installedFirstVersion:B.default.runtime.getManifest().version,__autoShowSwitchbar__:!0}),await Jp(),setTimeout(async()=>{B.default.tabs.create({url:z.origin+"/setup"})},200)),(e.reason==="install"||e.reason==="update")&&(Pa(e.reason==="update"),B.default.storage.local.get("provider:siderApi").then(t=>{t&&t["provider:siderApi"]?.model==="gpt-4"&&B.default.storage.local.set({"provider:siderApi":{model:"gpt-4o"}}),t&&t["provider:siderApi"]?.model==="gemini-pro"&&B.default.storage.local.set({"provider:siderApi":{model:"gemini-1.5-flash"}}),t&&(t["provider:siderApi"]?.model==="claude-3-sonnet"||t["provider:siderApi"]?.model==="claude-3-opus")&&B.default.storage.local.set({"provider:siderApi":{model:"claude-3.5-sonnet"}})}),B.default.storage.local.get(["autoTools","forceOpenArtifacts"]).then(t=>{if(t&&!t.forceOpenArtifacts&&(!t.autoTools||!t.autoTools.includes("artifacts"))){let r=t.autoTools||[];B.default.storage.local.set({autoTools:["artifacts",...r],forceOpenArtifacts:!0})}}),B.default.storage.local.get(["toolsShowNew","isSetThinkingModeShowNew"]).then(t=>{(!t||!t.toolsShowNew||!t.toolsShowNew.includes("thinking_mode"))&&(t.isSetThinkingModeShowNew||B.default.storage.local.set({toolsShowNew:["thinking_mode",...t.toolsShowNew||[]],isSetThinkingModeShowNew:!0}))}),B.default.storage.local.get("quickAction:provider:siderApi").then(t=>{t&&(t["quickAction:provider:siderApi"]?.model==="claude-3-sonnet"||t["quickAction:provider:siderApi"]?.model==="claude-3-opus")&&B.default.storage.local.set({"quickAction:provider:siderApi":{model:"claude-3.5-sonnet"}}),t&&t["quickAction:provider:siderApi"]?.model==="gpt-3.5"&&B.default.storage.local.set({"quickAction:provider:siderApi":{model:"sider"}}),t&&t["quickAction:provider:siderApi"]?.model==="gpt-4"&&B.default.storage.local.set({"quickAction:provider:siderApi":{model:"gpt-4o"}})}),B.default.storage.local.get(["finishSwitchSider","provider:siderApi"]).then(t=>{t&&!t.finishSwitchSider&&t["provider:siderApi"]?.model==="gpt-3.5"?B.default.storage.local.set({"provider:siderApi":{model:"sider"},finishSwitchSider:!0}):B.default.storage.local.set({finishSwitchSider:!0})}),B.default.storage.local.get("siderGrammarKey").then(t=>{t&&t.siderGrammarKey?.model==="gpt-4"&&B.default.storage.local.set({siderGrammarKey:{model:"gpt-4o"}})}),B.default.tabs.query({active:!0,currentWindow:!0}).then(t=>{let r=t[0];!r||r.id===void 0||!r.url||r.url.startsWith("chrome://")||tA(r.id)})),e.reason==="update"){let t=Ad[0];if(B.default.storage.local.get({shownChangelogVersion:"",installedFirstVersion:"1.0.0"}).then(({shownChangelogVersion:r,installedFirstVersion:A})=>{r!==t.version&&t.notifyType==="modal"&&Jn(A)!==Jn(t.version)&&(ap(),Zp(lf))}),B.default.storage.local.get("webAccessEnabled").then(r=>{r.webAccessEnabled&&(B.default.storage.local.set({autoTools:["search"]}),B.default.storage.local.remove("webAccessEnabled"))}),B.default.storage.local.remove(["webAppNetwork","chatRequirements"]),ae(["__GET_TMP_GPT5_INFO_AT__","__InviteQueryArrivalQueryAt__","__INVITE_QUERY_ARRIVAL_AT__","__LAST_REFRESH_DISPLAY_DATA__","__REFRESH_DISPLAY_DATA_AT__","__LOAD_TTS_INIT_DATA_AT__","__SCHEDULE_GET_CONFIG_RUN_AT__","__SCHEDULE_GET_PRICING_RUN_AT__","__SCHEDULE_GET_PROMPTS_RUN_AT__","__SCHEDULE_PULL_SETTINGS_RUN_AT__","__SCHEDULE_RUN_AT__","__SCHEDULE_VIPINFO_RUN_AT__","sidebarPromptTemplate","selectedSearchTemplate","promptTemplates","ratingTipShowTimes","__can_enjoy_trial__","lastTranslateWidgetLang","__FlagAutoPinTTSReading__","__FlagAutoPinTTSWriting__","__halloween_stopat_241016__"]),e.previousVersion){let[r,A]=e.previousVersion.split(".");~~r<=4&&~~A<=28&&J("sidebarShortcut").then(i=>{(!i||i.useDefault)&&St("sidebarShortcut",{key:"p",keyCode:80,metaKey:!0,ctrlKey:!0,altKey:!1,shiftKey:!1,disabled:!1})})}e.previousVersion&&Uf(e.previousVersion,"<","4.31.0")&&J({quickActionPinnedReading:[],quickActionPinnedWriting:[]}).then(({quickActionPinnedReading:r,quickActionPinnedWriting:A})=>{let i=r||[],o=A||[];i?.length>0?i=["copy",...i]:i=["copy","tts","translate","explain_this"],o?.length>0?o=["copy",...o]:o=["copy","improve_writing","fix_spelling_grammar","change_tone"],k({quickActionPinnedReading:i,quickActionPinnedWriting:o})})}B.default.alarms.create("refresh-image-cookie",{periodInMinutes:5*24*60})});B.default.alarms.onAlarm.addListener(e=>{e.name==="refresh-image-cookie"&&R.signImageCookie()});B.default.tabs.onActivated.addListener(e=>{let t=e.tabId;tA(t),od(t)});bp();B.default.runtime.onMessageExternal.addListener((e,t,r)=>{if(cf.includes(t.id||""))switch(e.type){case"SIDER_OCR":r(!0),e.data?.img&&Ra(e.data.img);break;default:r(!0),QA();break}});B.default.action.onClicked.addListener(e=>{e.status==="loading"?B.default.runtime.onMessage.addListener(function t(r,A){A.tab&&A.tab.id===e.id&&r.type==="sidebar-ready"&&(B.default.runtime.onMessage.removeListener(t),QA())}):QA(),wa()});async function QA(e){let t=await B.default.tabs.query({active:!0,currentWindow:!0});try{return await B.default.tabs.sendMessage(t[0].id,{type:"toggle-sidebar",isShow:e}),{action:"close"}}catch{return $r(),!1}}var D0=Ee(async function(){let r=(await ep()).items;if(Array.isArray(r)){let A=r.map(i=>({id:i.id,logo:i.manifest.logo_url,name:i.manifest.name_for_human,description:i.manifest.description_for_human}));return B.default.storage.local.set({chatgptPlugins:A})}},1e3);B.default.runtime.setUninstallURL("https://sider.ai/uninstall?app_version="+B.default.runtime.getManifest().version);function F0(e){return!B.default.sidePanel||!B.default.sidePanel.open||e?.windowId===void 0?!1:B.default.sidePanel.open({windowId:e?.windowId}).then(async()=>B.default.runtime.getContexts?await B.default.runtime.getContexts({contextTypes:["SIDE_PANEL"]}).then(r=>r.length>0):!1).catch(t=>!1)}B.default.storage.local.onChanged.addListener(e=>{e.language&&e.language.newValue&&(Hf(e.language.newValue,!0),Rf(e.language.newValue,!0))});})();
